---
title: Recordset, objet (ADO)
TOCTitle: Recordset Object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 26172a73f0967ef299b79e0bae30088eec0f77c9
ms.sourcegitcommit: c557bbcccf37a6011f89aae1ddd399dfe549d087
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/31/2018
ms.locfileid: "25872584"
---
# <a name="recordset-object-ado"></a><span data-ttu-id="4c566-102">Recordset, objet (ADO)</span><span class="sxs-lookup"><span data-stu-id="4c566-102">Recordset Object (ADO)</span></span>

<span data-ttu-id="4c566-103">**S’applique à**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="4c566-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="4c566-p101">Représente le jeu entier d'enregistrements d'une table de base ou les résultats d'une commande exécutée. L'objet **Recordset** ne peut faire référence qu'à un seul enregistrement à l'intérieur du jeu en tant qu'enregistrement actif.</span><span class="sxs-lookup"><span data-stu-id="4c566-p101">Represents the entire set of records from a base table or the results of an executed command. At any time, the **Recordset** object refers to only a single record within the set as the current record.</span></span>

## <a name="remarks"></a><span data-ttu-id="4c566-106">Notes</span><span class="sxs-lookup"><span data-stu-id="4c566-106">Remarks</span></span>

<span data-ttu-id="4c566-p102">Les objets **Recordset** servent à manipuler les données provenant d'un fournisseur. Lorsque vous utilisez ADO, vous manipulez des données presqu'exclusivement à l'aide d'objets **Recordset**. Tous les objets **Recordset** sont constitués d'enregistrements (lignes) et de champs (colonnes). Selon les fonctionnalités prises en charge par le fournisseur, certaines méthodes ou propriétés de **Recordset** risquent de ne pas être disponibles.</span><span class="sxs-lookup"><span data-stu-id="4c566-p102">You use **Recordset** objects to manipulate data from a provider. When you use ADO, you manipulate data almost entirely using **Recordset** objects. All **Recordset** objects consist of records (rows) and fields (columns). Depending on the functionality supported by the provider, some **Recordset** methods or properties may not be available.</span></span>

<span data-ttu-id="4c566-p103">ADODB.Recordset est l'identificateur de programme (ProgID) qui doit être utilisé pour créer un objet **Recordset**. Les applications existantes qui font référence aux ProgID ADOR.Recordset obsolètes continueront à fonctionner sans être recompilées, mais les nouvelles applications développées doivent faire référence à ADODB.Recordset.</span><span class="sxs-lookup"><span data-stu-id="4c566-p103">ADODB.Recordset is the ProgID that should be used to create a **Recordset** object. Existing applications that reference the outdated ADOR.Recordset ProgID will continue to work without recompiling, but new development should reference ADODB.Recordset.</span></span>

<span data-ttu-id="4c566-113">Il existe quatre types de curseurs définis dans ADO :</span><span class="sxs-lookup"><span data-stu-id="4c566-113">There are four different cursor types defined in ADO:</span></span>

  - <span data-ttu-id="4c566-114">**Curseur dynamique**  Permet de visualiser des ajouts, des modifications et des suppressions effectués par d'autres utilisateurs ; permet d'effectuer tous types de déplacements dans l'objet **Recordset** qui ne repose pas sur les signets ; prend également l'utilisation de signets si le fournisseur les prend en charge.</span><span class="sxs-lookup"><span data-stu-id="4c566-114">**Dynamic cursor** — allows you to view additions, changes, and deletions by other users; allows all types of movement through the **Recordset** that doesn't rely on bookmarks; and allows bookmarks if the provider supports them.</span></span>

  - <span data-ttu-id="4c566-p104">**Curseur de jeu de clés**  Se comporte comme un curseur dynamique, sauf qu'il empêche l'affichage des enregistrements ajoutés par d'autres utilisateurs et l'accès aux enregistrements supprimés par ceux-ci. Les modifications apportées aux données par d'autres utilisateurs restent visibles. Ce curseur prend en charge les signets et permet donc tous types de déplacements à l'intérieur du **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="4c566-p104">**Keyset cursor** — behaves like a dynamic cursor, except that it prevents you from seeing records that other users add, and prevents access to records that other users delete. Data changes by other users will still be visible. It always supports bookmarks and therefore allows all types of movement through the **Recordset**.</span></span>

  - <span data-ttu-id="4c566-p105">**Curseur statique**  Fournit une copie statique d'un jeu d'enregistrements pour que vous puissiez y rechercher des données ou générer des rapports ; permet l'utilisation de signets et donc tous types de déplacements à l'intérieur du **Recordset**. Les ajouts, modifications et suppressions effectués par les autres utilisateurs ne sont pas visibles. Il s'agit du seul type de curseur accepté lorsque vous ouvrez un objet **Recordset** côté client.</span><span class="sxs-lookup"><span data-stu-id="4c566-p105">**Static cursor** — provides a static copy of a set of records for you to use to find data or generate reports; always allows bookmarks and therefore allows all types of movement through the **Recordset**. Additions, changes, or deletions by other users will not be visible. This is the only type of cursor allowed when you open a client-side **Recordset** object.</span></span>

  - <span data-ttu-id="4c566-p106">**Curseur en avance seule**  Permet uniquement le défilement en avant à l'intérieur du **Recordset**. Les ajouts, modifications et suppressions effectués par les autres utilisateurs ne sont pas visibles. Cela permet d'améliorer les performances lorsque vous ne devez effectuer qu'un seul passage dans un objet **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="4c566-p106">**Forward-only cursor** — allows you to only scroll forward through the **Recordset**. Additions, changes, or deletions by other users will not be visible. This improves performance in situations where you need to make only a single pass through a **Recordset**.</span></span>

<span data-ttu-id="4c566-124">Définissez la propriété [CursorType](cursortype-property-ado.md) avant l’ouverture de l' **objet Recordset** pour choisir le type de curseur, ou passez un argument *CursorType* avec la méthode [Open](open-method-ado-recordset.md) .</span><span class="sxs-lookup"><span data-stu-id="4c566-124">Set the [CursorType](cursortype-property-ado.md) property prior to opening the **Recordset** to choose the cursor type, or pass a *CursorType* argument with the [Open](open-method-ado-recordset.md) method.</span></span> <span data-ttu-id="4c566-125">Certains fournisseurs ne prennent pas en charge tous les types de curseur.</span><span class="sxs-lookup"><span data-stu-id="4c566-125">Some providers don't support all cursor types.</span></span> <span data-ttu-id="4c566-126">Consultez la documentation spécifique du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="4c566-126">Check the documentation for the provider.</span></span> <span data-ttu-id="4c566-127">Si vous ne spécifiez pas de type de curseur, ADO ouvre un curseur en avance seule par défaut.</span><span class="sxs-lookup"><span data-stu-id="4c566-127">If you don't specify a cursor type, ADO opens a forward-only cursor by default.</span></span>

<span data-ttu-id="4c566-p108">Si la propriété [CursorLocation](cursorlocation-property-ado.md) a la valeur **adUseClient** pour ouvrir un **Recordset**, la propriété **UnderlyingValue** sur les objets [Field](field-object-ado.md) n'est pas disponible dans l'objet **Recordset** renvoyé. S'ils sont utilisés avec certains fournisseurs (comme Microsoft ODBC Provider for OLE DB conjointement avec Microsoft SQL Server), vous pouvez créer des objets **Recordset** indépendamment d'un objet [Connection](connection-object-ado.md) déjà défini, en transmettant une chaîne de connexion avec la méthode **Open**. ADO crée tout de même un objet [Connection](connection-object-ado.md), il ne l'affecte pas à une variable objet. Toutefois, si vous ouvrez plusieurs objets **Recordset** sur la même connexion, il est conseillé de créer un objet **Connection** de manière explicite et de l'ouvrir ; l'objet **Connection** est ainsi affecté à une variable objet. Si vous n'utilisez pas de variable objet lorsque vous ouvrez vos objets **Recordset**, ADO crée un nouvel objet **Connection** pour chaque nouveau **Recordset**, même si vous transmettez la même chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="4c566-p108">If the [CursorLocation](cursorlocation-property-ado.md) property is set to **adUseClient** to open a **Recordset**, the **UnderlyingValue** property on [Field](field-object-ado.md) objects is not available in the returned **Recordset** object. When used with some providers (such as the Microsoft ODBC Provider for OLE DB in conjunction with Microsoft SQL Server), you can create **Recordset** objects independently of a previously defined [Connection](connection-object-ado.md) object by passing a connection string with the **Open** method. ADO still creates a [Connection](connection-object-ado.md) object, but it doesn't assign that object to an object variable. However, if you are opening multiple **Recordset** objects over the same connection, you should explicitly create and open a **Connection** object; this assigns the **Connection** object to an object variable. If you do not use this object variable when opening your **Recordset** objects, ADO creates a new **Connection** object for each new **Recordset**, even if you pass the same connection string.</span></span>

<span data-ttu-id="4c566-133">Vous pouvez créer autant d'objets **Recordset** que nécessaire.</span><span class="sxs-lookup"><span data-stu-id="4c566-133">You can create as many **Recordset** objects as needed.</span></span>

<span data-ttu-id="4c566-p109">Lorsque vous ouvrez un **Recordset**, l'enregistrement actif est le premier enregistrement (s'il existe) et les propriétés [BOF](bof-eof-properties-ado.md) et [EOF](bof-eof-properties-ado.md) prennent la valeur **False**. S'il n'existe pas d'enregistrement, les paramètres de la propriété **BOF** et **EOF** ont la valeur **True**.</span><span class="sxs-lookup"><span data-stu-id="4c566-p109">When you open a **Recordset**, the current record is positioned to the first record (if any) and the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are set to **False**. If there are no records, the **BOF** and **EOF** property settings are **True**.</span></span>

<span data-ttu-id="4c566-p110">Vous pouvez utiliser les méthodes [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext** et **MovePrevious**, la méthode [Move](move-method-ado.md) ainsi que les propriétés [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md) et [Filter](filter-property-ado.md) pour repositionner l’enregistrement actif, à condition que le fournisseur prenne en charge la fonctionnalité requise. Les objets **Recordset** ne prennent en charge que la méthode [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). Si vous utilisez les méthodes **Move** pour consulter chaque enregistrement (ou énumérer l’objet **Recordset**), vous pouvez utiliser les propriétés **BOF** et **EOF** pour déterminer si vous vous avez dépassé le début ou la fin de l’objet **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="4c566-p110">You can use the [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**, and **MovePrevious** methods; the [Move](move-method-ado.md) method; and the [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md), and [Filter](filter-property-ado.md) properties to reposition the current record, assuming the provider supports the relevant functionality. Forward-only **Recordset** objects support only the [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) method. When you use the **Move** methods to visit each record (or enumerate the **Recordset**), you can use the **BOF** and **EOF** properties to determine if you've moved beyond the beginning or end of the **Recordset**.</span></span>

<span data-ttu-id="4c566-p111">Les objets **Recordset** peuvent prendre en charge deux types de mise à jour : immédiate et par lot. Avec la mise à jour immédiate, toutes les modifications apportées aux données sont écrites instantanément dans la source de données sous-jacente lorsque vous appelez la méthode [Update](update-method-ado.md). Vous pouvez également passer des tableaux de valeurs comme paramètres avec les méthodes [AddNew](addnew-method-ado.md) et **Update** et mettre à jour plusieurs champs simultanément dans un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="4c566-p111">**Recordset** objects can support two types of updating: immediate and batched. In immediate updating, all changes to data are written immediately to the underlying data source once you call the [Update](update-method-ado.md) method. You can also pass arrays of values as parameters with the [AddNew](addnew-method-ado.md) and **Update** methods and simultaneously update several fields in a record.</span></span>

<span data-ttu-id="4c566-p112">Si un fournisseur prend en charge la mise à jour par lot, vous pouvez décider que le fournisseur mette en cache plusieurs enregistrements et les transmette ensuite par l'intermédiaire d'un seul appel à la base de données ; utilisez pour cela la méthode [UpdateBatch](updatebatch-method-ado.md). Cela s'applique aux modifications effectuées avec les méthodes **AddNew**, **Update** et [Delete](delete-method-ado-recordset.md). Après avoir appelé la méthode **UpdateBatch**, vous pouvez recourir à la propriété [Status](status-property-ado-recordset.md) pour rechercher les éventuels conflits au niveau des données afin de les résoudre.</span><span class="sxs-lookup"><span data-stu-id="4c566-p112">If a provider supports batch updating, you can have the provider cache changes to more than one record and then transmit them in a single call to the database with the [UpdateBatch](updatebatch-method-ado.md) method. This applies to changes made with the **AddNew**, **Update**, and [Delete](delete-method-ado-recordset.md) methods. After you call the **UpdateBatch** method, you can use the [Status](status-property-ado-recordset.md) property to check for any data conflicts in order to resolve them.</span></span>

> [!NOTE]
> <span data-ttu-id="4c566-p113">[!REMARQUE] Pour exécuter une requête sans utiliser d'objet [Command](command-object-ado.md), passez une chaîne de requête à la méthode **Open** d'un objet **Recordset**. Toutefois, un objet **Command** est nécessaire si vous voulez rendre persistant le texte de commande et l'exécuter de nouveau, ou utiliser des paramètres de requête.</span><span class="sxs-lookup"><span data-stu-id="4c566-p113">To execute a query without using a [Command](command-object-ado.md) object, pass a query string to the **Open** method of a **Recordset** object. However, a **Command** object is required when you want to persist the command text and re-execute it, or use query parameters.</span></span>

<span data-ttu-id="4c566-147">La propriété [Mode](mode-property-ado.md) régit les autorisations d'accès.</span><span class="sxs-lookup"><span data-stu-id="4c566-147">The [Mode](mode-property-ado.md) property governs access permissions.</span></span>

<span data-ttu-id="4c566-p114">La collection **Fields** est le membre par défaut de l'objet **Recordset**. Les deux instructions suivantes sont donc équivalentes.</span><span class="sxs-lookup"><span data-stu-id="4c566-p114">The **Fields** collection is the default member of the **Recordset** object. As a result, the following two code statements are equivalent.</span></span>

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```
