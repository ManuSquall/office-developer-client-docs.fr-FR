---
title: NextRecordset, méthode (ADO)
TOCTitle: NextRecordset method (ADO)
ms:assetid: d2776dd5-d521-c57f-dbe5-e02ee238104d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250051(v=office.15)
ms:contentKeyID: 48547887
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: b572f4ebe55da1add781ecd86df97937cfeae126
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288616"
---
# <a name="nextrecordset-method-ado"></a><span data-ttu-id="568b7-102">NextRecordset, méthode (ADO)</span><span class="sxs-lookup"><span data-stu-id="568b7-102">NextRecordset method (ADO)</span></span>

<span data-ttu-id="568b7-103">**S’applique à** : Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="568b7-103">**Applies to**: Access 2013, Office 2013</span></span>
 
<span data-ttu-id="568b7-104">Efface l’objet [Recordset](recordset-object-ado.md) actif et retourne l’objet **Recordset** suivant en exécutant une série de commandes.</span><span class="sxs-lookup"><span data-stu-id="568b7-104">Clears the current [Recordset](recordset-object-ado.md) object and returns the next **Recordset** by advancing through a series of commands.</span></span>

## <a name="syntax"></a><span data-ttu-id="568b7-105">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="568b7-105">Syntax</span></span>

<span data-ttu-id="568b7-106">Définissez *Recordset2* = *JeuEnregistrements1*. NextRecordset (*RecordsAffected* )</span><span class="sxs-lookup"><span data-stu-id="568b7-106">Set *recordset2* = *recordset1*.NextRecordset(*RecordsAffected* )</span></span>

## <a name="return-value"></a><span data-ttu-id="568b7-107">Valeur renvoyée</span><span class="sxs-lookup"><span data-stu-id="568b7-107">Return value</span></span>

<span data-ttu-id="568b7-p101">Retourne un objet **Recordset**. Dans le modèle de syntaxe, *JeuEnregistrements1* et *JeuEnregistrements2* peuvent représenter le même objet **Recordset** ou vous pouvez utiliser des objets distincts. Lorsque vous utilisez des objets **Recordset** distincts et que vous réinitialisez la propriété **ActiveConnection** sur l'objet **Recordset** d'origine (*JeuEnregistrements1*) après l'appel de **NextRecordset**, une erreur se produit.</span><span class="sxs-lookup"><span data-stu-id="568b7-p101">Returns a **Recordset** object. In the syntax model, *recordset1* and *recordset2* can be the same **Recordset** object, or you can use separate objects. When using separate **Recordset** objects, resetting the **ActiveConnection** property on the original **Recordset** (*recordset1*) after **NextRecordset** has been called will generate an error.</span></span>

## <a name="parameters"></a><span data-ttu-id="568b7-111">Paramètres</span><span class="sxs-lookup"><span data-stu-id="568b7-111">Parameters</span></span>

|<span data-ttu-id="568b7-112">Parameter</span><span class="sxs-lookup"><span data-stu-id="568b7-112">Parameter</span></span>|<span data-ttu-id="568b7-113">Description</span><span class="sxs-lookup"><span data-stu-id="568b7-113">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="568b7-114">*RecordsAffected*</span><span class="sxs-lookup"><span data-stu-id="568b7-114">*RecordsAffected*</span></span> |<span data-ttu-id="568b7-p102">Facultatif. Variable de type **Long** dans laquelle le fournisseur retourne le nombre d'enregistrements concernés par l'opération actuelle.</span><span class="sxs-lookup"><span data-stu-id="568b7-p102">Optional. A **Long** variable to which the provider returns the number of records that the current operation affected.</span></span>|

> [!NOTE]
> <span data-ttu-id="568b7-117">Ce paramètre ne retourne que le nombre d'enregistrements concernés par une opération ; il ne retourne pas le décompte d'enregistrements d'une instruction Select utilisée pour générer l'objet **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="568b7-117">This parameter only returns the number of records affected by an operation; it does not return a count of records from a select statement used to generate the **Recordset**.</span></span>

## <a name="remarks"></a><span data-ttu-id="568b7-118">Remarques</span><span class="sxs-lookup"><span data-stu-id="568b7-118">Remarks</span></span>

<span data-ttu-id="568b7-119">Utilisez la méthode **NextRecordset** pour retourner les résultats de la commande suivante dans une instruction de commandes composée ou les résultats d’une procédure stockée qui retourne plusieurs résultats.</span><span class="sxs-lookup"><span data-stu-id="568b7-119">Use the **NextRecordset** method to return the results of the next command in a compound command statement or of a stored procedure that returns multiple results.</span></span> <span data-ttu-id="568b7-120">Si vous ouvrez un \*\*\*\* objet Recordset à partir d'une instruction de commande composée (par exemple, \* «SELECT FROM table1; SÉLECTIONNER \* à partir de Table2 ") [](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) à l'aide de la méthode Execute sur une [commande](command-object-ado.md) ou la méthode [Open](open-method-ado-recordset.md) sur un **objet Recordset**, ADO exécute uniquement la première commande et renvoie les résultats à l' *objet Recordset*.</span><span class="sxs-lookup"><span data-stu-id="568b7-120">If you open a **Recordset** object based on a compound command statement (for example, "SELECT \* FROM table1;SELECT \* FROM table2") using the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) method on a [Command](command-object-ado.md) or the [Open](open-method-ado-recordset.md) method on a **Recordset**, ADO executes only the first command and returns the results to *recordset*.</span></span> <span data-ttu-id="568b7-121">Pour accéder aux résultats des commandes suivantes de l'instruction, appelez la méthode **NextRecordset**.</span><span class="sxs-lookup"><span data-stu-id="568b7-121">To access the results of subsequent commands in the statement, call the **NextRecordset** method.</span></span>

<span data-ttu-id="568b7-122">Tant qu'il y a des résultats supplémentaires et que l' **objet Recordset** contenant les instructions composées n'est pas déconnecté ni marshalé au sein des limites de processus, la méthode **NextRecordset** continue de renvoyer les objets **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="568b7-122">As long as there are additional results and the **Recordset** containing the compound statements is not disconnected or marshaled across process boundaries, the **NextRecordset** method will continue to return **Recordset** objects.</span></span> <span data-ttu-id="568b7-123">Si une commande de retour de ligne s'exécute correctement mais ne renvoie aucun enregistrement, \*\*\*\* l'objet Recordset renvoyé est ouvert mais vide.</span><span class="sxs-lookup"><span data-stu-id="568b7-123">If a row-returning command executes successfully but returns no records, the returned **Recordset** object will be open but empty.</span></span> <span data-ttu-id="568b7-124">Testez ce cas en vérifiant que les propriétés [BOF](bof-eof-properties-ado.md) et [EOF](bof-eof-properties-ado.md) ont toutes deux la **valeur true**.</span><span class="sxs-lookup"><span data-stu-id="568b7-124">Test for this case by verifying that the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are both **True**.</span></span> <span data-ttu-id="568b7-125">Si une commande non retournant des lignes s'exécute correctement, l'objet **Recordset** retourné est fermé, que vous pouvez vérifier en testant la propriété [State](state-property-ado.md) sur l'objet **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="568b7-125">If a non–row-returning command executes successfully, the returned **Recordset** object will be closed, which you can verify by testing the [State](state-property-ado.md) property on the **Recordset**.</span></span> <span data-ttu-id="568b7-126">Lorsqu'il n'y a plus de \*\* résultats, Recordset prend la valeur *Nothing*.</span><span class="sxs-lookup"><span data-stu-id="568b7-126">When there are no more results, *recordset* will be set to *Nothing*.</span></span>

<span data-ttu-id="568b7-127">La méthode **NextRecordset** n’est pas disponible sur un objet **Recordset** déconnecté, dont la propriété [ActiveConnection](activeconnection-property-ado.md) a la valeur **Nothing** (en Microsoft Visual Basic) ou NULL (dans les autres langages).</span><span class="sxs-lookup"><span data-stu-id="568b7-127">The **NextRecordset** method is not available on a disconnected **Recordset** object, where [ActiveConnection](activeconnection-property-ado.md) has been set to **Nothing** (in Microsoft Visual Basic) or NULL (in other languages).</span></span>

<span data-ttu-id="568b7-128">Si une modification est en cours en mode de mise à jour immédiate, l’appel de la méthode **NextRecordset** génère une erreur ; il faut d’abord appeler la méthode [Update](update-method-ado.md) ou [CancelUpdate](cancelupdate-method-ado.md).</span><span class="sxs-lookup"><span data-stu-id="568b7-128">If an edit is in progress while in immediate update mode, calling the **NextRecordset** method generates an error; call the [Update](update-method-ado.md) or [CancelUpdate](cancelupdate-method-ado.md) method first.</span></span>

<span data-ttu-id="568b7-p105">Pour passer des paramètres à plusieurs commandes dans l'instruction composée en complétant la collection [Parameters](parameters-collection-ado.md) ou en passant un tableau avec l'appel de **Open** ou **Execute** d'origine, les paramètres de la collection ou du tableau doivent respecter le même ordre que leurs commandes correspondantes dans la série de commandes. Vous devez terminer la lecture de tous les résultats avant de lire les valeurs des paramètres de sortie.</span><span class="sxs-lookup"><span data-stu-id="568b7-p105">To pass parameters for more than one command in the compound statement by filling the [Parameters](parameters-collection-ado.md) collection, or by passing an array with the original **Open** or **Execute** call, the parameters must be in the same order in the collection or array as their respective commands in the command series. You must finish reading all the results before reading output parameter values.</span></span>

<span data-ttu-id="568b7-p106">Votre fournisseur OLE DB détermine le moment où chaque commande d'une instruction composée est exécutée. Le [fournisseur Microsoft OLE DB pour SQL Server](microsoft-ole-db-provider-for-sql-server.md), par exemple, exécute toutes les commandes dans un lot lorsqu'il reçoit l'instruction composée. Les objets **Recordset** résultants sont simplement retournés lorsque vous appelez **NextRecordset**.</span><span class="sxs-lookup"><span data-stu-id="568b7-p106">Your OLE DB provider determines when each command command in a compound statement is executed. The [Microsoft OLE DB Provider for SQL Server](microsoft-ole-db-provider-for-sql-server.md), for example, executes all commands in a batch upon receiving the compound statement. The resulting **Recordsets** are simply returned when you call **NextRecordset**.</span></span>

<span data-ttu-id="568b7-p107">En revanche, il est possible que d'autres fournisseurs n'exécutent la commande suivante d'une instruction qu'après l'appel de NextRecordset. Pour ces fournisseurs, si vous fermez explicitement l'objet **Recordset** avant d'exécuter toute l'instruction, commande par commande, ADO n'exécute jamais les commandes restantes.</span><span class="sxs-lookup"><span data-stu-id="568b7-p107">However, other providers may execute the next command in a statement only after NextRecordset is called. For these providers, if you explicitly close the **Recordset** object before stepping through the entire command statement, ADO never executes the remaining commands.</span></span>

