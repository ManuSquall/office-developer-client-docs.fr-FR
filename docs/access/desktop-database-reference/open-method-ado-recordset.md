---
title: Open, méthode (Recordset ADO)
TOCTitle: Open method (ADO Recordset)
ms:assetid: 87ef19a4-28e1-dec7-ed33-4ae500b9c460
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249591(v=office.15)
ms:contentKeyID: 48546119
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e5f8dbdfa61a671e2efb9aac2596cfda5cd1727b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288405"
---
# <a name="open-method-ado-recordset"></a><span data-ttu-id="08a14-102">Open, méthode (Recordset ADO)</span><span class="sxs-lookup"><span data-stu-id="08a14-102">Open method (ADO Recordset)</span></span>

<span data-ttu-id="08a14-103">**S’applique à** : Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="08a14-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="08a14-104">Ouvre un curseur.</span><span class="sxs-lookup"><span data-stu-id="08a14-104">Opens a cursor.</span></span>

## <a name="syntax"></a><span data-ttu-id="08a14-105">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="08a14-105">Syntax</span></span>

<span data-ttu-id="08a14-106">*Recordset*. Open*source*, *ActiveConnection*, *CursorType*, *LockType*, *options*</span><span class="sxs-lookup"><span data-stu-id="08a14-106">*recordset*.Open*Source*, *ActiveConnection*, *CursorType*, *LockType*, *Options*</span></span>

## <a name="parameters"></a><span data-ttu-id="08a14-107">Paramètres</span><span class="sxs-lookup"><span data-stu-id="08a14-107">Parameters</span></span>

|<span data-ttu-id="08a14-108">Parameter</span><span class="sxs-lookup"><span data-stu-id="08a14-108">Parameter</span></span>|<span data-ttu-id="08a14-109">Description</span><span class="sxs-lookup"><span data-stu-id="08a14-109">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="08a14-110">*Source*</span><span class="sxs-lookup"><span data-stu-id="08a14-110">*Source*</span></span> |<span data-ttu-id="08a14-p101">Facultatif. Valeur de type **Variant** qui représente un objet [Command](command-object-ado.md), une instruction SQL, un nom de table, un appel de procédure stockée, une URL ou le nom d'un fichier ou objet [Stream](stream-object-ado.md) contenant un objet [Recordset](recordset-object-ado.md) stocké de façon permanente.</span><span class="sxs-lookup"><span data-stu-id="08a14-p101">Optional. A **Variant** that evaluates to a valid [Command](command-object-ado.md) object, an SQL statement, a table name, a stored procedure call, a URL, or the name of a file or [Stream](stream-object-ado.md) object containing a persistently stored [Recordset](recordset-object-ado.md).</span></span>|
|<span data-ttu-id="08a14-113">*ActiveConnection*</span><span class="sxs-lookup"><span data-stu-id="08a14-113">*ActiveConnection*</span></span> |<span data-ttu-id="08a14-p102">Facultatif. Valeur de type **Variant** qui représente un nom de variable objet [Connection](connection-object-ado.md) valide ou valeur de type **String** qui contient les paramètres de la propriété [ConnectionString](connectionstring-property-ado.md).</span><span class="sxs-lookup"><span data-stu-id="08a14-p102">Optional. Either a **Variant** that evaluates to a valid [Connection](connection-object-ado.md) object variable name, or a **String** that contains [ConnectionString](connectionstring-property-ado.md) parameters.</span></span>|
|<span data-ttu-id="08a14-116">*CursorType*</span><span class="sxs-lookup"><span data-stu-id="08a14-116">*CursorType*</span></span> |<span data-ttu-id="08a14-p103">Facultatif. Valeur [CursorTypeEnum](cursortypeenum.md) déterminant le type de curseur que le fournisseur doit utiliser pour ouvrir l'objet **Recordset**. La valeur par défaut est **adOpenForwardOnly**.</span><span class="sxs-lookup"><span data-stu-id="08a14-p103">Optional. A [CursorTypeEnum](cursortypeenum.md) value that determines the type of cursor that the provider should use when opening the **Recordset**. The default value is **adOpenForwardOnly**.</span></span>|
|<span data-ttu-id="08a14-120">*LockType*</span><span class="sxs-lookup"><span data-stu-id="08a14-120">*LockType*</span></span> |<span data-ttu-id="08a14-p104">Facultatif. Valeur [LockTypeEnum](locktypeenum.md) déterminant le type de verrouillage (accès concurrentiel) que le fournisseur doit utiliser pour ouvrir l'objet **Recordset**. La valeur par défaut est **adLockReadOnly**.</span><span class="sxs-lookup"><span data-stu-id="08a14-p104">Optional. A [LockTypeEnum](locktypeenum.md) value that determines what type of locking (concurrency) the provider should use when opening the **Recordset**. The default value is **adLockReadOnly**.</span></span>|
|<span data-ttu-id="08a14-124">*Options*</span><span class="sxs-lookup"><span data-stu-id="08a14-124">*Options*</span></span> |<span data-ttu-id="08a14-p105">Facultatif. Valeur de type **Long** spécifiant comment le fournisseur doit retourner l’argument *Source* s’il représente autre chose qu’un objet **Command** ou indiquant que l’objet **Recordset** doit être restauré à partir d’un fichier dans lequel il a été précédemment enregistré. Il peut représenter une ou plusieurs valeurs [CommandTypeEnum](commandtypeenum.md) ou [ExecuteOptionEnum](executeoptionenum.md), lesquelles peuvent être combinées avec un opérateur de bits AND.</span><span class="sxs-lookup"><span data-stu-id="08a14-p105">Optional. A **Long** value that indicates how the provider should evaluate the *Source* argument if it represents something other than a **Command** object, or that the **Recordset** should be restored from a file where it was previously saved. Can be one or more [CommandTypeEnum](commandtypeenum.md) or [ExecuteOptionEnum](executeoptionenum.md) values, which can be combined with a bitwise AND operator.</span></span>|

> [!NOTE]
> <span data-ttu-id="08a14-128">[!REMARQUE] Si vous ouvrez un objet **Recordset** à partir d'un objet **Stream** contenant un objet **Recordset** persistant, l'utilisation d'une valeur **ExecuteOptionEnum** **adAsyncFetchNonBlocking** n'aura aucune incidence ; l'extraction sera synchrone et bloquante.</span><span class="sxs-lookup"><span data-stu-id="08a14-128">If you open a **Recordset** from a **Stream** containing a persisted **Recordset**, using an **ExecuteOptionEnum** value of **adAsyncFetchNonBlocking** will not have an effect; the fetch will be synchronous and blocking.</span></span>

<span data-ttu-id="08a14-129">Les valeurs **adExecuteNoRecords** ou **adExecuteStream** de **ExecuteOpenEnum** ne doivent pas être utilisées avec **Open**.</span><span class="sxs-lookup"><span data-stu-id="08a14-129">The **ExecuteOpenEnum** values of **adExecuteNoRecords** or **adExecuteStream** should not be used with **Open**.</span></span>

## <a name="remarks"></a><span data-ttu-id="08a14-130">Remarques</span><span class="sxs-lookup"><span data-stu-id="08a14-130">Remarks</span></span>

<span data-ttu-id="08a14-131">Le curseur par défaut d'un objet \*\*Recordset \*\* ADO est un curseur en lecture seule, avant uniquement et situé sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="08a14-131">The default cursor for an ADO **Recordset** is a forward-only, read-only cursor located on the server.</span></span>

<span data-ttu-id="08a14-132">L'utilisation de la méthode **Open** sur un objet **Recordset** ouvre un curseur qui représente des enregistrements d'une table de base, les résultats d'une requête ou un objet **Recordset** précédemment enregistré.</span><span class="sxs-lookup"><span data-stu-id="08a14-132">Using the **Open** method on a **Recordset** object opens a cursor that represents records from a base table, the results of a query, or a previously saved **Recordset**.</span></span>

<span data-ttu-id="08a14-133">Utilisez l'argument *Source* facultatif pour spécifier une source de données à l'aide d'un des éléments suivants : variable objet **Command**, instruction SQL, procédure stockée, nom de table, URL ou nom de chemin d'accès complet d'un fichier.</span><span class="sxs-lookup"><span data-stu-id="08a14-133">Use the optional *Source* argument to specify a data source using one of the following: a **Command** object variable, an SQL statement, a stored procedure, a table name, a URL, or a complete file path name.</span></span> <span data-ttu-id="08a14-134">Si *source* est un nom de chemin d'accès de fichier, il peut s'agir d'un\\chemin\\d'accès complet («c: dir. RST»), d'un chemin d'accès relatif («.. \\file. RST ") ou une URL ("https://files/file.rst").</span><span class="sxs-lookup"><span data-stu-id="08a14-134">If *Source* is a file path name, it can be a full path ("c:\\dir\\file.rst"), a relative path ("..\\file.rst"), or a URL ("https://files/file.rst").</span></span>

<span data-ttu-id="08a14-p107">Il est déconseillé d’utiliser l’argument *Source* de la méthode **Open** pour exécuter une requête Action qui ne retourne pas d’enregistrement car il est toujours difficile de déterminer si l’appel a réussi ou échoué. L’objet **Recordset** retourné par ce type de requête sera fermé. Appelez plutôt la méthode [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) d’un objet **Command** ou la méthode [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) d’un objet **Connection** pour exécuter une requête qui ne retourne pas d’enregistrement, comme une instruction INSERT SQL.</span><span class="sxs-lookup"><span data-stu-id="08a14-p107">It is not a good idea to use the *Source* argument of the **Open** method to perform an action query that doesnt return records because there is no easy way to determine whether the call succeeded. The **Recordset** returned by such a query will be closed. Call the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) method of a **Command** object or the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) method of a **Connection** object instead to perform a query that, such as a SQL INSERT statement, that doesnt return records.</span></span>

<span data-ttu-id="08a14-138">L’argument *ConnexionActive* correspond à la propriété [ActiveConnection](activeconnection-property-ado.md) et spécifie la connexion dans laquelle ouvrir l’objet **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="08a14-138">The *ActiveConnection* argument corresponds to the [ActiveConnection](activeconnection-property-ado.md) property and specifies in which connection to open the **Recordset** object.</span></span> <span data-ttu-id="08a14-139">Si vous transférez une définition de connexion pour cet argument, ADO ouvre une nouvelle connexion à l'aide des paramètres spécifiés.</span><span class="sxs-lookup"><span data-stu-id="08a14-139">If you pass a connection definition for this argument, ADO opens a new connection using the specified parameters.</span></span> <span data-ttu-id="08a14-140">Après l'ouverture de l' **objet Recordset** avec un curseur côté client (**CursorLocation** = **adUseClient**), vous pouvez modifier la valeur de cette propriété pour envoyer des mises à jour à un autre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="08a14-140">After opening the **Recordset** with a client-side cursor (**CursorLocation** = **adUseClient**), you can change the value of this property to send updates to another provider.</span></span> <span data-ttu-id="08a14-141">Vous pouvez également attribuer la valeur **Nothing** (en Microsoft Visual Basic) ou NULL à cette propriété pour déconnecter l'objet **Recordset** de tous les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="08a14-141">Or you can set this property to **Nothing** (in Microsoft Visual Basic) or NULL to disconnect the **Recordset** from any provider.</span></span> <span data-ttu-id="08a14-142">La modification de **ConnexionActive** pour un curseur côté serveur génère, en revanche, une erreur.</span><span class="sxs-lookup"><span data-stu-id="08a14-142">Changing **ActiveConnection** for a server-side cursor generates an error, however.</span></span>

<span data-ttu-id="08a14-143">En ce qui concerne les autres arguments correspondant directement aux propriétés d'un objet **Recordset** (*Source*, *TypeCurseur* et *TypeVerrou*), la relation entre les arguments et les propriétés est la suivante :</span><span class="sxs-lookup"><span data-stu-id="08a14-143">For the other arguments that correspond directly to properties of a **Recordset** object (*Source*, *CursorType*, and *LockType*), the relationship of the arguments to the properties is as follows:</span></span>

- <span data-ttu-id="08a14-144">La propriété est en lecture/écriture avant l'ouverture de l'objet **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="08a14-144">The property is read/write before the **Recordset** object is opened.</span></span>

- <span data-ttu-id="08a14-p109">Les paramètres de propriété sont utilisés sauf si vous passez les arguments correspondants lors de l'exécution de la méthode **Open**. Si vous passez un argument, il remplace le paramètre de propriété correspondant et le paramètre de la propriété est mis à jour avec la valeur de l'argument.</span><span class="sxs-lookup"><span data-stu-id="08a14-p109">The property settings are used unless you pass the corresponding arguments when executing the **Open** method. If you pass an argument, it overrides the corresponding property setting, and the property setting is updated with the argument value.</span></span>

- <span data-ttu-id="08a14-147">Une fois l'objet **Recordset** ouvert, ces propriétés sont alors en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="08a14-147">After you open the **Recordset** object, these properties become read-only.</span></span>

> [!NOTE]
> <span data-ttu-id="08a14-148">La propriété **ActiveConnection** est lue uniquement pour les objets **Recordset** dont la propriété [Source](source-property-ado-recordset.md) a pour valeur un objet **Command** valide même si l’objet **Recordset** n’est pas ouvert.</span><span class="sxs-lookup"><span data-stu-id="08a14-148">The **ActiveConnection** property is read only for **Recordset** objects whose [Source](source-property-ado-recordset.md) property is set to a valid **Command** object, even if the **Recordset** object isn't open.</span></span>

<span data-ttu-id="08a14-p110">Si vous passez un objet **Command** dans l'argument *Source* et que vous passez aussi un argument *ConnexionActive*, une erreur se produit. La propriété **ActiveConnection** de l'objet **Command** doit déjà avoir pour valeur un objet **Connection** ou une chaîne de connexion valide.</span><span class="sxs-lookup"><span data-stu-id="08a14-p110">If you pass a **Command** object in the *Source* argument and also pass an *ActiveConnection* argument, an error occurs. The **ActiveConnection** property of the **Command** object must already be set to a valid **Connection** object or connection string.</span></span>

<span data-ttu-id="08a14-p111">Si vous passez un autre élément qu'un objet **Command** dans l'argument *Source*, vous pouvez utiliser l'argument *Options* pour optimiser l'évaluation de l'argument *Source*. Si l'argument *Options* n'est pas défini, il se peut que les performances diminuent car ADO doit passer des appels au fournisseur afin de déterminer si l'argument est une instruction SQL, une procédure stockée ou un nom de table. SI vous connaissez le type d'argument *Source* utilisé, la définition de l'argument *Options* permet à ADO d'accéder directement au code approprié. Si l'argument *Options* ne correspond pas au type de l'argument *Source*, une erreur se produit.</span><span class="sxs-lookup"><span data-stu-id="08a14-p111">If you pass something other than a **Command** object in the *Source* argument, you can use the *Options* argument to optimize evaluation of the *Source* argument. If the *Options* argument is not defined, you may experience diminished performance because ADO must make calls to the provider to determine if the argument is an SQL statement, a stored procedure, a URL, or a table name. If you know what *Source* type you're using, setting the *Options* argument instructs ADO to jump directly to the relevant code. If the *Options* argument does not match the *Source* type, an error occurs.</span></span>

<span data-ttu-id="08a14-p112">Si vous passez un objet **Stream** dans l'argument *Source*, ne passez pas d'informations dans les autres arguments. Si vous le faites, une erreur sera générée. Les informations du paramètre **ConnexionActive** ne sont pas conservées lorsqu'un objet **Recordset** est ouvert à partir d'un objet **Stream**.</span><span class="sxs-lookup"><span data-stu-id="08a14-p112">If you pass a **Stream** object in the *Source* argument, you should not pass information into the other arguments. Doing so will generate an error. The **ActiveConnection** information is not retained when a **Recordset** is opened from a **Stream**.</span></span>

<span data-ttu-id="08a14-p113">La valeur par défaut de l'argument *Options* est **adCmdFile** si aucune connexion n'est associée à l'objet **Recordset**. C'est généralement le cas des objets **Recordset** stockés de façon permanente.</span><span class="sxs-lookup"><span data-stu-id="08a14-p113">The default for the *Options* argument is **adCmdFile** if no connection is associated with the **Recordset**. This will typically be the case for persistently stored **Recordset** objects.</span></span>

<span data-ttu-id="08a14-p114">Si la source de données ne retourne aucun enregistrement, le fournisseur affecte aux propriétés [BOF](bof-eof-properties-ado.md) et [EOF](bof-eof-properties-ado.md) la valeur **True** et la position d'enregistrement actif n'est pas définie. Vous pouvez néanmoins ajouter de nouvelles données à cet objet **Recordset** vide si le type de curseur le permet.</span><span class="sxs-lookup"><span data-stu-id="08a14-p114">If the data source returns no records, the provider sets both the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties to **True**, and the current record position is undefined. You can still add new data to this empty **Recordset** object if the cursor type allows it.</span></span>

<span data-ttu-id="08a14-p115">Lorsque vous avez terminé les opérations relatives à un objet **Recordset** ouvert, utilisez la méthode [Close](close-method-ado.md) pour libérer les ressources système associées. La fermeture d’un objet ne le supprime pas de la mémoire ; vous pouvez modifier les paramètres de ses propriétés et utiliser la méthode **Open** pour le rouvrir ultérieurement. Pour éliminer définitivement un objet de la mémoire, attribuez à la variable objet la valeur *Nothing*.</span><span class="sxs-lookup"><span data-stu-id="08a14-p115">When you have concluded your operations over an open **Recordset** object, use the [Close](close-method-ado.md) method to free any associated system resources. Closing an object does not remove it from memory; you can change its property settings and use the **Open** method to open it again later. To completely eliminate an object from memory, set the object variable to *Nothing*.</span></span>

<span data-ttu-id="08a14-165">Avant de définir la propriété **ActiveConnection** , appelez la méthode **Open** sans opérande pour créer une instance d'un **objet Recordset** créée par l'ajout de champs à la collection Fields de l' **objet Recordset** [](fields-collection-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="08a14-165">Before the **ActiveConnection** property is set, call **Open** with no operands to create an instance of a **Recordset** created by appending fields to the **Recordset** [Fields](fields-collection-ado.md) collection.</span></span>

<span data-ttu-id="08a14-166">Si vous avez attribué à la propriété [CursorLocation](cursorlocation-property-ado.md) la valeur **adUseClient**, vous disposez de deux possibilités pour récupérer des lignes de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="08a14-166">If you have set the [CursorLocation](cursorlocation-property-ado.md) property to **adUseClient**, you can retrieve rows asynchronously in one of two ways.</span></span> <span data-ttu-id="08a14-167">La méthode recommandée consiste à attribuer à *Options* la valeur **adAsyncFetch**.</span><span class="sxs-lookup"><span data-stu-id="08a14-167">The recommended method is to set *Options* to **adAsyncFetch**.</span></span> <span data-ttu-id="08a14-168">Vous pouvez, par ailleurs, utiliser la propriété dynamique « Asynchronous Rowset Processing » dans la collection [Properties](properties-collection-ado.md) mais il se peut que vous perdiez des événements récupérés si vous n'attribuez pas au paramètre **Options** la valeur **adAsyncFetch**.</span><span class="sxs-lookup"><span data-stu-id="08a14-168">Alternatively, you can use the "Asynchronous Rowset Processing" dynamic property in the [Properties](properties-collection-ado.md) collection, but related retrieved events can be lost if you do not set the **Options** parameter to **adAsyncFetch**.</span></span>

> [!NOTE]
> <span data-ttu-id="08a14-169">L'extraction en arrière-plan dans le fournisseur distant Microsoft est pris en charge uniquement par le paramètre *Options* de la méthode **Open**.</span><span class="sxs-lookup"><span data-stu-id="08a14-169">Background fetching in the MS Remote provider is supported only through the **Open** method's *Options* parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="08a14-170">Les URL qui utilisent le schéma http appellent automatiquement le [fournisseur Microsoft OLE DB pour la publication Internet](microsoft-ole-db-provider-for-internet-publishing.md).</span><span class="sxs-lookup"><span data-stu-id="08a14-170">URLs using the http scheme will automatically invoke the [Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md).</span></span> <span data-ttu-id="08a14-171">Pour plus d'informations, consultez la rubrique [URL absolues et relatives](absolute-and-relative-urls.md).</span><span class="sxs-lookup"><span data-stu-id="08a14-171">For more information, see [Absolute and relative URLs](absolute-and-relative-urls.md).</span></span>


