---
title: Détails HelloData (référence de base de données de bureau Access)
TOCTitle: HelloData details
ms:assetid: db51e15c-1b5b-c64a-2f84-34dd0e78c6cf
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250105(v=office.15)
ms:contentKeyID: 48548103
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 78b04b74d4e2b8d9c215235d6e7ccebed4fa2ef2
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291998"
---
# <a name="hellodata-details"></a><span data-ttu-id="dead6-102">Détails concernant HelloData</span><span class="sxs-lookup"><span data-stu-id="dead6-102">HelloData details</span></span>


<span data-ttu-id="dead6-103">**S’applique à** : Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="dead6-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="dead6-p101">L'application HelloData effectue les opérations de base d'une application ADO standard : extraction, vérification, modification et mise à jour des données. Lorsque vous démarrez l'application, cliquez sur le premier bouton, **Get Data**. Cette action déclenche l'exécution de la sous-routine GetData().</span><span class="sxs-lookup"><span data-stu-id="dead6-p101">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data. When you start the application, click the first button, **Get Data**. This will run the GetData() subroutine.</span></span>

## <a name="getdata"></a><span data-ttu-id="dead6-107">GetData</span><span class="sxs-lookup"><span data-stu-id="dead6-107">GetData</span></span>

<span data-ttu-id="dead6-108">GetData place une chaîne de connexion valide dans une variable de niveau module, *m \_ sConnStr*.</span><span class="sxs-lookup"><span data-stu-id="dead6-108">GetData places a valid connection string into a module-level variable, *m\_sConnStr*.</span></span> <span data-ttu-id="dead6-109">Pour plus d’informations sur les chaînes de connexion, consultez la rubrique [Création de la chaîne de connexion](creating-the-connection-string.md).</span><span class="sxs-lookup"><span data-stu-id="dead6-109">For more information about connection strings, see [Creating the Connection String](creating-the-connection-string.md).</span></span>

<span data-ttu-id="dead6-p103">Affectez un gestionnaire d’erreurs utilisant une instruction Visual Basic **SurErreur**  Pour plus d’informations sur la gestion des erreurs dans ADO, consultez le [Chapitre 6 : Gestion des erreurs](chapter-6-error-handling.md). Un nouvel objet **Connection** est créé et la propriété **CursorLocation** a la valeur **adUseClient** car l’exemple HelloData crée un *jeu de données déconnecté*.  Cela signifie qu’une fois les données extraites de la source de données, la connexion physique à la source de données est interrompue mais que vous pouvez néanmoins continuer à travailler avec les données mises en cache localement dans votre objet **Recordset**</span><span class="sxs-lookup"><span data-stu-id="dead6-p103">Assign an error handler using a Visual Basic **OnError** statement. For more information about error handling in ADO, see [Chapter 6: Error Handling](chapter-6-error-handling.md). A new **Connection** object is created, and the **CursorLocation** property is set to **adUseClient** because the HelloData example creates a *disconnected Recordset*. This means that once the data has been fetched from the data source, the physical connection with the data source is broken, but you can still work with the data that is cached locally in your **Recordset** object.</span></span>

<span data-ttu-id="dead6-114">Après ouverture de la connexion, affectez une chaîne SQL à une variable (sSQL).</span><span class="sxs-lookup"><span data-stu-id="dead6-114">After the connection has been opened, assign a SQL string to a variable (sSQL).</span></span> <span data-ttu-id="dead6-115">Insère ensuite un nouvel **objet Recordset,** m \_ oRecordset1 .</span><span class="sxs-lookup"><span data-stu-id="dead6-115">Then instantiate a new **Recordset** object, m\_oRecordset1 .</span></span> <span data-ttu-id="dead6-116">Dans la ligne de code suivante, ouvrez **le jeu d’enregistrements** sur la **connexion** existante, en passant .</span><span class="sxs-lookup"><span data-stu-id="dead6-116">In the next line of code, open the **Recordset** over the existing **Connection**, passing in .</span></span> <span data-ttu-id="dead6-117">Dans la ligne de code  suivante, ouvrez le jeu d’enregistrements sur la connexion **existante,** en passant sSQL comme source du **jeu d’enregistrements.**</span><span class="sxs-lookup"><span data-stu-id="dead6-117">In the next line of code, open the **Recordset** over the existing **Connection**, passing in sSQL as the source of the **Recordset**.</span></span> <span data-ttu-id="dead6-118">Vous aidez ADO à déterminer que la chaîne SQL transmise en tant que source du **Recordset** est une définition textuelle d'une commande en spécifiant **adCmdText** dans l'argument final de la méthode **Open** du **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="dead6-118">You assist ADO in making the determination that the SQL string you have passed as the source for the **Recordset** is a textual definition of a command by passing **adCmdText** in the final argument to the **Recordset** **Open** method.</span></span> <span data-ttu-id="dead6-119">Cette ligne définit aussi les propriétés **LockType** et **CursorType** associées au **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="dead6-119">This line also sets the **LockType** and **CursorType** associated with the **Recordset**.</span></span>

<span data-ttu-id="dead6-120">La ligne de code suivante précise que la propriété **MarshalOptions** est égale à **adMarshalModifiedOnly**.</span><span class="sxs-lookup"><span data-stu-id="dead6-120">The next line of code sets the **MarshalOptions** property equal to **adMarshalModifiedOnly**.</span></span> <span data-ttu-id="dead6-121">**MarshalOptions indique** quels enregistrements doivent être marshalés au niveau intermédiaire (ou serveur web).</span><span class="sxs-lookup"><span data-stu-id="dead6-121">**MarshalOptions** indicates which records should be marshaled to the middle tier (or web server).</span></span> <span data-ttu-id="dead6-122">Pour plus d’informations sur le marshaling, voir la documentation COM.</span><span class="sxs-lookup"><span data-stu-id="dead6-122">For more information about marshaling, see the COM documentation.</span></span> <span data-ttu-id="dead6-123">Lorsque vous utilisez **adMarshalModifiedOnly** avec un curseur côté client ([CursorLocation](cursorlocation-property-ado.md)  =  **adUseClient**), seuls les enregistrements qui ont été modifiés sur le client sont écrits dans le niveau intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="dead6-123">When using **adMarshalModifiedOnly** with a client-side cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), only records that have been modified on the client are written back to the middle tier.</span></span> <span data-ttu-id="dead6-124">Le fait de définir la propriété **MarshalOptions** sur **adMarshalModifiedOnly** peut améliorer les performances car les lignes à marshaler sont moins nombreuses.</span><span class="sxs-lookup"><span data-stu-id="dead6-124">Setting **MarshalOptions** to **adMarshalModifiedOnly** can improve performance because fewer rows are marshaled.</span></span>

<span data-ttu-id="dead6-p106">Ensuite, déconnectez le **Recordset** en indiquant que sa propriété **ActiveConnection** est égale à **Nothing**. Pour plus d'informations, consultez la rubrique [Déconnexion et reconnexion de l'objet Recordset](disconnecting-and-reconnecting-the-recordset.md) dans le Chapitre 5 : Mise à jour et persistance des données.</span><span class="sxs-lookup"><span data-stu-id="dead6-p106">Next, disconnect the **Recordset** by setting its **ActiveConnection** property equal to **Nothing**. For more information, see [Disconnecting and Reconnecting the Recordset](disconnecting-and-reconnecting-the-recordset.md) in Chapter 5: Updating and Persisting Data.</span></span>

<span data-ttu-id="dead6-127">Fermez la connexion à la source de données et détruisez l'objet **Connection** existant de façon à libérer les ressources qu'il utilise.</span><span class="sxs-lookup"><span data-stu-id="dead6-127">Close the connection to the data source and destroy the existing **Connection** object, thereby releasing the resources it consumed.</span></span>

<span data-ttu-id="dead6-128">La dernière étape consiste à définir le **Recordset** comme **DataSource** de la grille Microsoft liée aux données sur le formulaire de façon à pouvoir afficher facilement les données du **Recordset** sur ce formulaire.</span><span class="sxs-lookup"><span data-stu-id="dead6-128">The final step is to set the **Recordset** as the **DataSource** for the Microsoft DataBound Grid Control on the form so that you can easily display the data from the **Recordset** on the form.</span></span>

<span data-ttu-id="dead6-p107">Cliquez sur le deuxième bouton, **Examine Data**. Cette action déclenche l'exécution de la sous-routine ExamineData.</span><span class="sxs-lookup"><span data-stu-id="dead6-p107">Click the second button, **Examine Data**. This runs the ExamineData subroutine.</span></span>

## <a name="examinedata"></a><span data-ttu-id="dead6-131">ExamineData</span><span class="sxs-lookup"><span data-stu-id="dead6-131">ExamineData</span></span>

<span data-ttu-id="dead6-132">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="dead6-132">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**.</span></span> <span data-ttu-id="dead6-133">It reports the number of records by using the **RecordCount** property.</span><span class="sxs-lookup"><span data-stu-id="dead6-133">It reports the number of records by using the **RecordCount** property.</span></span> <span data-ttu-id="dead6-134">It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form.</span><span class="sxs-lookup"><span data-stu-id="dead6-134">It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form.</span></span> <span data-ttu-id="dead6-135">En outre, pendant la boucle, la valeur de la propriété **Bookmark** pour le troisième enregistrement est placée dans une variable de variante, *vBookmark*, pour une utilisation ultérieure.</span><span class="sxs-lookup"><span data-stu-id="dead6-135">Also while in the loop, the value of the **Bookmark** property for the third record is placed into a variant variable, *vBookmark*, for later use.</span></span>

<span data-ttu-id="dead6-p109">La routine revient directement au troisième enregistrement grâce à la variable bookmark enregistrée précédemment. Elle appelle la sous-routine WalkFields qui exécute une boucle dans la collection **Fields** du **Recordset** et affiche les détails relatifs à chaque objet **Field** de la collection.</span><span class="sxs-lookup"><span data-stu-id="dead6-p109">The routine navigates directly back to the third record using the bookmark variable that it stored earlier. The routine calls the WalkFields subroutine, which loops through the **Fields** collection of the **Recordset** and displays details about each **Field** in the collection.</span></span>

<span data-ttu-id="dead6-p110">Enfin, ExamineData utilise la propriété **Filter** du **Recordset** pour filtrer les enregistrements selon le critère « CategoryId égale 2 ». L'application de ce filtre a un résultat immédiatement visible dans la grille d'affichage du formulaire.</span><span class="sxs-lookup"><span data-stu-id="dead6-p110">Finally, ExamineData uses the **Filter** property of the **Recordset** to screen for only those records with a CategoryId equal to 2. The result of applying this filter is immediately visible in the display grid on the form.</span></span>

<span data-ttu-id="dead6-140">Pour plus d'informations sur la fonctionnalité de la sous-routine ExamineData, consultez le [chapitre 3 : Examen des données](chapter-3-examining-data.md).</span><span class="sxs-lookup"><span data-stu-id="dead6-140">For more information about the functionality shown in the ExamineData subroutine, see [Chapter 3: Examining Data](chapter-3-examining-data.md).</span></span>

<span data-ttu-id="dead6-p111">Cliquez ensuite sur le troisième bouton, **Edit Data**. Cette action déclenche l'exécution de la sous-routine EditData.</span><span class="sxs-lookup"><span data-stu-id="dead6-p111">Next, click the third button, **Edit Data**. This will run the EditData subroutine.</span></span>

## <a name="editdata"></a><span data-ttu-id="dead6-143">EditData</span><span class="sxs-lookup"><span data-stu-id="dead6-143">EditData</span></span>

<span data-ttu-id="dead6-p112">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible. It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent. The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span><span class="sxs-lookup"><span data-stu-id="dead6-p112">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible. It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent. The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span></span>

<span data-ttu-id="dead6-p113">N'oubliez pas que le **Recordset** est déconnecté de la source de données. Les modifications apportées à EditData ne sont effectuées que sur la copie des données dans le cache local. Pour plus d'informations, consultez le [Chapitre 4 : Modification des données](chapter-4-editing-data.md).</span><span class="sxs-lookup"><span data-stu-id="dead6-p113">Remember that the **Recordset** is disconnected from the data source. The changes made in EditData are made only to the locally cached copy of the data. For more information, see [Chapter 4: Editing Data](chapter-4-editing-data.md).</span></span>

<span data-ttu-id="dead6-p114">Aucune modification ne sera apportée à la source de données tant que vous n'aurez pas cliqué sur le quatrième bouton, **Update Data**. Cette action déclenche l'exécution de la sous-routine UpdateData.</span><span class="sxs-lookup"><span data-stu-id="dead6-p114">The changes will not be made on the data source until you click the fourth button, **Update Data**. This will run the UpdateData subroutine.</span></span>

## <a name="updatedata"></a><span data-ttu-id="dead6-152">UpdateData</span><span class="sxs-lookup"><span data-stu-id="dead6-152">UpdateData</span></span>

<span data-ttu-id="dead6-153">La sous-routine UpdateData élimine d’abord le filtre appliqué au **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="dead6-153">UpdateData first removes the filter that has been applied to the **Recordset**.</span></span> <span data-ttu-id="dead6-154">Le code supprime et réinitialise en tant que **DataSource** pour le Microsoft  Bound DataGrid sur le formulaire afin que le jeu d’enregistrements non filtré apparaisse dans la grille.</span><span class="sxs-lookup"><span data-stu-id="dead6-154">The code removes and resets as the **DataSource** for the Microsoft Bound DataGrid on the form so that the unfiltered **Recordset** appears in the grid.</span></span>

<span data-ttu-id="dead6-155">Le code vérifie alors si vous pouvez revenir en arrière dans le **Recordset** en utilisant la méthode **Supports** avec l'argument **adMovePrevious**.</span><span class="sxs-lookup"><span data-stu-id="dead6-155">The code then checks to see whether you can move backward in the **Recordset** by using the **Supports** method with the **adMovePrevious** argument.</span></span>

<span data-ttu-id="dead6-p116">La routine passe au premier enregistrement grâce à la méthode **MoveFirst** et affiche les valeurs d'origine et actuelles du champ par le biais des propriétés **OriginalValue** et **Value** de l'objet **Field**. Ces propriétés, ainsi que la propriété **UnderlyingValue** (non utilisée ici), sont présentées au [Chapitre 5 : Mise à jour et persistance des données](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="dead6-p116">The routine moves to the first record using the **MoveFirst** method and displays the field's original and current values, using the **OriginalValue** and **Value** properties of the **Field** object. These properties, along with the **UnderlyingValue** property (not used here), are discussed in [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

<span data-ttu-id="dead6-p117">Un nouvel objet **Connection** est ensuite créé et est utilisé pour rétablir la connexion à la source de données. Vous reconnectez le **Recordset** à la source de données en définissant le nouvel objet **Connexion** comme **ActiveConnection** du **Recordset**. Pour envoyer les mises à jour au serveur, le code appelle **UpdateBatch** sur le **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="dead6-p117">Next, a new **Connection** object is created and used to reestablish a connection to the data source. You reconnect the **Recordset** to the data source by setting the new **Connection** as the **ActiveConnection** for the **Recordset**. To send the updates to the server, the code calls **UpdateBatch** on the **Recordset**.</span></span>

<span data-ttu-id="dead6-161">Si la mise à jour par lot réussit, une variable d’indicateur au niveau du module, est définie sur True.</span><span class="sxs-lookup"><span data-stu-id="dead6-161">If the batch update succeeds, a module-level flag variable, , is set to True.</span></span> <span data-ttu-id="dead6-162">Cet indicateur vous rappellera ultérieurement de nettoyer toutes les modifications apportées à la base de données.</span><span class="sxs-lookup"><span data-stu-id="dead6-162">This will remind you later to clean up all changes made to the database.</span></span>

<span data-ttu-id="dead6-p119">Enfin, le code revient au premier enregistrement du **Recordset** et affiche les valeurs d'origine et actuelles. Les valeurs sont identiques après l'appel de la méthode **UpdateBatch**.</span><span class="sxs-lookup"><span data-stu-id="dead6-p119">Finally, the code moves back to the first record in the **Recordset** and displays the original and current values. The values are the same after the call to **UpdateBatch**.</span></span>

<span data-ttu-id="dead6-165">Pour obtenir des informations plus détaillées sur la mise à jour des données, notamment ce qu'il faut faire lorsque les données du serveur sont modifiées alors que votre **Recordset** est déconnecté, consultez le [Chapitre 5 : Mise à jour et persistance des données](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="dead6-165">For more detailed information about updating data, including what to do when data on the server changes while your **Recordset** is disconnected, see [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

## <a name="form_unload"></a><span data-ttu-id="dead6-166">Form \_ Unload</span><span class="sxs-lookup"><span data-stu-id="dead6-166">Form\_Unload</span></span>

<span data-ttu-id="dead6-167">La \_ sous-routine Form Unload est importante pour plusieurs raisons.</span><span class="sxs-lookup"><span data-stu-id="dead6-167">The Form\_Unload subroutine is important for several reasons.</span></span> <span data-ttu-id="dead6-168">Tout d’abord, étant donné qu’il s’agit d’un exemple d’application, Form Unload nettoie les modifications apportées à la base de données avant la fin de \_ l’application.</span><span class="sxs-lookup"><span data-stu-id="dead6-168">First, because this is a sample application, Form\_Unload cleans up the changes made to the database before the application exits.</span></span> <span data-ttu-id="dead6-169">Ensuite, le code montre comment une commande peut être exécutée directement à partir d'un objet **Connection** ouvert grâce à la méthode **Execute**.</span><span class="sxs-lookup"><span data-stu-id="dead6-169">Second, the code shows how a command can be executed directly from an open **Connection** object using the **Execute** method.</span></span> <span data-ttu-id="dead6-170">Enfin, il montre un exemple d'exécution d'une requête sans renvoi de ligne (requête UPDATE) sur la source de données.</span><span class="sxs-lookup"><span data-stu-id="dead6-170">Finally, it shows an example of executing a non-row–returning query (an UPDATE query) against the data source.</span></span>

