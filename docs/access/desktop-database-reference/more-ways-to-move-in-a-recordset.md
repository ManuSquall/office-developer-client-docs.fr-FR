---
title: Plusieurs méthodes permettent de déplacer dans un jeu d’enregistrements
TOCTitle: More ways to move in a Recordset
ms:assetid: ae49b20e-0050-c44b-67e9-7e39de5098c4
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249822(v=office.15)
ms:contentKeyID: 48547067
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 8524f34da92d1d38c6ecedddf3877dd9e4361ade
ms.sourcegitcommit: 558d09fad81f8d80b5ad0edd21934fc09c098f2c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/03/2018
ms.locfileid: "25945046"
---
# <a name="more-ways-to-move-in-a-recordset"></a><span data-ttu-id="d3465-102">Plusieurs méthodes permettent de déplacer dans un jeu d’enregistrements</span><span class="sxs-lookup"><span data-stu-id="d3465-102">More ways to move in a Recordset</span></span>

<span data-ttu-id="d3465-103">**S’applique à**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="d3465-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="d3465-p101">Les quatre méthodes suivantes vous permettent de vous déplacer dans l'objet **Recordset** ou de parcourir celui-ci : [MoveFirst, MoveLast, MoveNext et MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). Notez que certaines de ces méthodes ne sont pas disponibles avec des curseurs avant uniquement.</span><span class="sxs-lookup"><span data-stu-id="d3465-p101">The following four methods are used to move around, or scroll, in the **Recordset**: [MoveFirst, MoveLast, MoveNext, and MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). (Some of these methods are unavailable on forward-only cursors.)</span></span>

<span data-ttu-id="d3465-p102">**MoveFirst** fait du premier enregistrement de l'objet **Recordset** l'enregistrement actif. **MoveLast** fait du dernier enregistrement de l'objet **Recordset** l'enregistrement actif. Pour pouvoir utiliser les méthodes **MoveFirst** ou **MoveLast**, l'objet **Recordset** doit prendre en charge les signets ou le déplacement de curseur arrière. Dans le cas contraire, l'appel de la méthode génère une erreur.</span><span class="sxs-lookup"><span data-stu-id="d3465-p102">**MoveFirst** changes the current record position to the first record in the **Recordset**. **MoveLast** changes the current record position to the last record in the **Recordset**. To use **MoveFirst** or **MoveLast**, the **Recordset** object must support bookmarks or backward cursor movement; otherwise, the method call will generate an error.</span></span>

<span data-ttu-id="d3465-p103">**MoveNext** fait avancer l'enregistrement actif d'une position. Si vous êtes au niveau du dernier enregistrement lors de l'appel de la méthode **MoveNext**, la propriété **EOF** prend la valeur **True**. **MovePrevious** fait reculer l'enregistrement actif d'une position. Si vous êtes au niveau du premier enregistrement lors de l'appel de la méthode **MovePrevious**, la propriété **BOF** prend la valeur **True**. Il est utile de vérifier la valeur des propriétés **EOF** et **BOF** lors de l'utilisation de ces méthodes, et de replacer le curseur à une position d'enregistrement actif valide si vous dépassez l'une des extrémités de l'objet **Recordset**, comme dans l'exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="d3465-p103">**MoveNext** moves the current record position one place forward. If you are on the last record when you call **MoveNext**, **EOF** will be set to **True**. **MovePrevious** moves the current record position one place backward. If you are on the first record when you call **MovePrevious**, **BOF** will be set to **True**. It is wise to check the **EOF** and **BOF** properties when using these methods and to move the cursor back to a valid current record position if you move off either end of the **Recordset**, as shown here:</span></span>

```vb
. . . 
oRs.MoveNext 
If oRs.EOF Then oRs.MoveLast 
. . . 
```

<span data-ttu-id="d3465-114">Ou, dans le cas de la méthode **MovePrevious**:</span><span class="sxs-lookup"><span data-stu-id="d3465-114">Or, in the case of the **MovePrevious** method:</span></span>

```vb
. . . 
oRs.MovePrevious 
If oRs.BOF Then oRs.MoveFirst 
. . . 
```

<span data-ttu-id="d3465-115">Dans le cas où l' **objet Recordset** a été filtré ou trié et données de l’enregistrement actif sont modifiées, la position peut également changer.</span><span class="sxs-lookup"><span data-stu-id="d3465-115">In cases where the **Recordset** has been filtered or sorted and the current record's data is changed, the position may also change.</span></span> <span data-ttu-id="d3465-116">Dans ce cas, la méthode **MoveNext** fonctionne normalement, mais vous oubliez pas que la position est déplacé d’un enregistrement à partir de la nouvelle position, pas de l’ancien.</span><span class="sxs-lookup"><span data-stu-id="d3465-116">In such cases the **MoveNext** method works normally, but be aware that the position is moved one record forward from the new position, not the old position.</span></span> <span data-ttu-id="d3465-117">Modification des données dans l’enregistrement en cours, telles que l’enregistrement est déplacé à la fin du tri **jeu d’enregistrements**, par exemple, qui signifie que appelant **MoveNext** l'aboutit à ADO la définition de l’enregistrement actif sur la position après le dernier enregistrement dans le \*\* Jeu d’enregistrements\*\* (**EOF** = **la valeur True**).</span><span class="sxs-lookup"><span data-stu-id="d3465-117">For example, changing the data in the current record, such that the record is moved to the end of the sorted **Recordset**, would mean that calling **MoveNext** results in ADO setting the current record to the position after the last record in the **Recordset** (**EOF** = **True**).</span></span>

<span data-ttu-id="d3465-118">Le comportement des diverses méthodes Move de l’objet **Recordset** dépend, dans une certaine mesure, sur les données de l' **objet Recordset**.</span><span class="sxs-lookup"><span data-stu-id="d3465-118">The behavior of the various Move methods of the **Recordset** object depends, to some extent, on the data within the **Recordset**.</span></span> <span data-ttu-id="d3465-119">Nouveaux enregistrements ajoutés à l' **objet Recordset** sont initialement ajoutés dans un ordre particulier, qui est défini par la source de données et peut-être dépendre, implicitement ou explicitement des données dans le nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="d3465-119">New records added to the **Recordset** are initially added in a particular order, which is defined by the data source and may be dependent implicitly or explicitly on the data in the new record.</span></span> <span data-ttu-id="d3465-120">Par exemple, si un tri ou une jointure est effectuée dans la requête qui remplit l' **objet Recordset**, le nouvel enregistrement sera inséré dans l’emplacement approprié dans le **jeu d’enregistrements**.</span><span class="sxs-lookup"><span data-stu-id="d3465-120">For example, if a sort or a join is done within the query that populates the **Recordset**, the new record will be inserted in the appropriate place within the **Recordset**.</span></span> <span data-ttu-id="d3465-121">Si la commande n’est pas explicitement spécifié lors de la création de l' **objet Recordset**, les modifications dans l’implémentation de source de données peuvent entraîner l’ordre des lignes renvoyées modifier par inadvertance.</span><span class="sxs-lookup"><span data-stu-id="d3465-121">If ordering is not explicitly specified when creating the **Recordset**, changes in the data source implementation may cause the ordering of the returned rows to change inadvertently.</span></span> <span data-ttu-id="d3465-122">En outre, le tri, filtrage et modification des fonctions de **l’objet Recordset** peuvent affectent l’ordre et l’affichage des lignes dans le jeu d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="d3465-122">In addition, the sorting, filtering, and editing functions of the **Recordset** can affect the order and possibly which rows in the recordset will be visible.</span></span>

<span data-ttu-id="d3465-p106">Les méthodes **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast** et **Move** sont donc sensibles aux autres opérations effectuées dans le même objet **Recordset**. Même si ADO tente toujours de conserver votre position active jusqu'à ce que vous la déplaciez explicitement, il arrive que les modifications intervenues rendent l'impact d'un changement ultérieur difficilement prévisible. Supposons, par exemple, que vous appeliez la méthode **MoveFirst** pour accéder à la première ligne d'un objet **Recordset** trié. Si vous changez l'ordre de tri ascendant en ordre descendant, vous êtes toujours sur la même ligne , mais il s'agit désormais de la dernière ligne de l'objet **Recordset**. La méthode **MoveFirst** vous permet d'accéder à une autre ligne (la nouvelle première ligne).</span><span class="sxs-lookup"><span data-stu-id="d3465-p106">Therefore, **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast**, and **Move** are all sensitive to other operations performed on the same **Recordset**. ADO will always try to maintain your current position until you explicitly move it, but sometimes intervening changes make it difficult to understand the effects of a subsequent move. For example, if you call **MoveFirst** to position on the first row of a sorted **Recordset** and you change the sort from ascending order to descending order, you are still on the same row — but now it is the last row in the **Recordset**. **MoveFirst** will take you to a different row (the new first row).</span></span>

<span data-ttu-id="d3465-p107">Autre exemple : vous êtes positionné sur une ligne donnée, au milieu d'un objet **Recordset**, et vous appelez la méthode **Delete**, puis la méthode **MoveNext**. Vous êtes donc au niveau de l'enregistrement qui suit directement l'enregistrement supprimé. Mais l'appel de la méthode **MovePrevious** fait de l'enregistrement précédant celui que vous avez supprimé l'enregistrement actif, car l'enregistrement supprimé n'est plus considéré comme un membre actif du **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="d3465-p107">As another example, if you are positioned on a particular row in the middle of a **Recordset** and you call **Delete** and then call **MoveNext**, you are now on the record immediately following the deleted record. But calling **MovePrevious** makes the record preceding the one you deleted the current record, because the deleted record is no longer counted in the active membership of the **Recordset**.</span></span>

<span data-ttu-id="d3465-p108">Il est particulièrement difficile de définir une sémantique de déplacement cohérente entre tous les fournisseurs pour les méthodes qui exécutent des déplacements relatifs à l'enregistrement actif, à savoir **MovePrevious**, **MoveNext** et **Move** , en raison des modifications apportées aux données de l'enregistrement actif. Imaginons que vous utilisez un **Recordset** trié et filtré. Vous modifiez les données de l'enregistrement actif de telle sorte qu'il précède tous les autres enregistrements mais vos données modifiées ne correspondent plus au filtre. Dans ce cas, il est difficile de prévoir le résultat d'une opération **MoveNext**. En guise de conclusion, nous dirons donc que les déplacements relatifs au sein d'un objet **Recordset** sont plus risqués que les déplacements absolus (tels que les opérations **MoveFirst** ou **MoveLast**) lorsque les données sont modifiées par l'ajout, la suppression ou la modification des enregistrements. Il est conseillé de baser les opérations de tri et de filtrage sur une clé primaire ou un ID, car ce type de valeur reste inchangé.</span><span class="sxs-lookup"><span data-stu-id="d3465-p108">It is particularly difficult to define consistent move semantics across all providers for methods that move relative to the current record — **MovePrevious**, **MoveNext**, and **Move** — in the face of changing data in the current record. For example, if you are working with a sorted, filtered **Recordset**, and you change the data in the current record so that it would precede all other records, but your changed data also no longer matches the filter, it is not clear where a **MoveNext** operation should take you. The safest conclusion is that relative movement within a **Recordset** is riskier than absolute movement (such as using **MoveFirst** or **MoveLast**) when the data is changing while records are being edited, added, or deleted. Sorting and filtering should be based on a primary key or ID, because this type of value should not change.</span></span>

