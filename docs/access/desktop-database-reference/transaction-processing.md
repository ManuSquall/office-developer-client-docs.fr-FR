---
title: Traitement des transactions
TOCTitle: Transaction Processing
ms:assetid: 7cacf3bb-e523-8739-f9ff-c8663c9ddfeb
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249523(v=office.15)
ms:contentKeyID: 48545842
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: c13f25df31bea1eb742b4a7e7c958ccdbfb7274a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32314006"
---
# <a name="transaction-processing"></a><span data-ttu-id="7e89a-102">Traitement de transactions</span><span class="sxs-lookup"><span data-stu-id="7e89a-102">Transaction processing</span></span>

<span data-ttu-id="7e89a-103">**S’applique à** : Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="7e89a-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="7e89a-p101">ADO fournit les méthodes suivantes pour le contrôle des transactions : **BeginTrans**, **CommitTrans** et **RollbackTrans**. Utilisez ces méthodes avec un objet **Connection** pour enregistrer ou annuler en bloc une série de modifications apportées à la source de données. Par exemple, pour un transfert financier entre deux comptes, vous devez soustraire un montant de l'un et ajouter ce même montant à l'autre. Si l'une des deux mises à jour échoue, les comptes ne sont pas équilibrés. Si ces modifications sont effectuées par l'intermédiaire d'une transaction ouverte, vous êtes assuré de l'échec ou de la réussite de toutes les modifications.</span><span class="sxs-lookup"><span data-stu-id="7e89a-p101">ADO provides the following methods for controlling transactions: **BeginTrans**, **CommitTrans**, and **RollbackTrans**. Use these methods with a **Connection** object when you want to save or cancel a series of changes made to the source data as a single unit. For example, to transfer money between accounts, you subtract an amount from one and add the same amount to the other. If either update fails, the accounts no longer balance. Making these changes within an open transaction ensures that either all or none of the changes go through.</span></span>

> [!NOTE]
> <span data-ttu-id="7e89a-p102">Tous les fournisseurs ne prennent pas en charge les transactions. Vérifiez que la propriété « **Transaction DDL** », définie par le fournisseur, apparaît dans la collection [Properties](properties-collection-ado.md) de l’objet **Connection** ; elle indique que le fournisseur prend en charge les transactions. Si ce n’est pas le cas, l’appel de l’une de ces méthodes retourne une erreur.</span><span class="sxs-lookup"><span data-stu-id="7e89a-p102">Not all providers support transactions. Verify that the provider-defined property "**Transaction DDL**" appears in the **Connection** object's [Properties](properties-collection-ado.md) collection, indicating that the provider supports transactions. If the provider does not support transactions, calling one of these methods will return an error.</span></span>

<span data-ttu-id="7e89a-112">Après l'appel de la méthode **BeginTrans**, le fournisseur ne validera plus les modifications instantanément. Vous devrez, pour cela, appeler les méthodes **CommitTrans** ou **RollbackTrans** pour clôturer la transaction.</span><span class="sxs-lookup"><span data-stu-id="7e89a-112">After you call the **BeginTrans** method, the provider will no longer instantaneously commit changes you make until you call **CommitTrans** or **RollbackTrans** to end the transaction.</span></span>

<span data-ttu-id="7e89a-p103">L'appel de la méthode **CommitTrans** permet d'enregistrer les modifications apportées à une transaction ouverte sur la connexion et de clôturer la transaction. L'appel de la méthode **RollbackTrans** permet d'annuler toutes les modifications effectuées dans une transaction ouverte et de clôturer la transaction. L'appel de l'une ou l'autre méthode sans transaction ouverte provoque une erreur.</span><span class="sxs-lookup"><span data-stu-id="7e89a-p103">Calling the **CommitTrans** method saves changes made within an open transaction on the connection and ends the transaction. Calling the **RollbackTrans** method reverses any changes made within an open transaction and ends the transaction. Calling either method when there is no open transaction generates an error.</span></span>

<span data-ttu-id="7e89a-p104">En fonction de la propriété **Attributes** de l'objet [Connection](attributes-property-ado.md), l'appel des méthodes **CommitTrans** ou **RollbackTrans** permet de lancer automatiquement une nouvelle transaction. Si la propriété **Attributes** a la valeur **adXactCommitRetaining**, le fournisseur lance automatiquement une nouvelle transaction après un appel à **CommitTrans**. Si la propriété **Attributes** a la valeur **adXactAbortRetaining**, le fournisseur lance automatiquement une nouvelle transaction après un appel à **RollbackTrans**.</span><span class="sxs-lookup"><span data-stu-id="7e89a-p104">Depending on the **Connection** object's [Attributes](attributes-property-ado.md) property, calling either the **CommitTrans** or **RollbackTrans** method may automatically start a new transaction. If the **Attributes** property is set to **adXactCommitRetaining**, the provider automatically starts a new transaction after a **CommitTrans** call. If the **Attributes** property is set to **adXactAbortRetaining**, the provider automatically starts a new transaction after a **RollbackTrans** call.</span></span>

## <a name="transaction-isolation-level"></a><span data-ttu-id="7e89a-119">Niveau d'isolation des transactions</span><span class="sxs-lookup"><span data-stu-id="7e89a-119">Transaction isolation level</span></span>

<span data-ttu-id="7e89a-120">La propriété **IsolationLevel** permet de définir le niveau d'isolation d'une transaction sur un objet **Connection**.</span><span class="sxs-lookup"><span data-stu-id="7e89a-120">Use the **IsolationLevel** property to set the isolation level of a transaction on a **Connection** object.</span></span> <span data-ttu-id="7e89a-121">Le paramètre ne prend effet qu'au prochain appel de la méthode [BeginTrans](begintrans-committrans-and-rollbacktrans-methods-ado.md).</span><span class="sxs-lookup"><span data-stu-id="7e89a-121">The setting does not take effect until the next time you call the [BeginTrans](begintrans-committrans-and-rollbacktrans-methods-ado.md) method.</span></span> <span data-ttu-id="7e89a-122">Si le niveau d'isolation demandé n'est pas disponible, le fournisseur peut renvoyer le niveau d'isolation le plus élevé suivant.</span><span class="sxs-lookup"><span data-stu-id="7e89a-122">If the level of isolation you request is unavailable, the provider may return the next greater level of isolation.</span></span> <span data-ttu-id="7e89a-123">Pour plus d'informations sur les valeurs valides, rePortez-vous à la propriété **IsolationLevel** dans le Guide de référence du programmeur ADO.</span><span class="sxs-lookup"><span data-stu-id="7e89a-123">Refer to the **IsolationLevel** property in the ADO programmer's reference for more details on valid values.</span></span>

## <a name="nested-transactions"></a><span data-ttu-id="7e89a-124">Transactions imbriquées</span><span class="sxs-lookup"><span data-stu-id="7e89a-124">Nested transactions</span></span>

<span data-ttu-id="7e89a-p106">Pour les fournisseurs qui prennent en charge les transactions imbriquées, l'appel de la méthode **BeginTrans** dans une transaction ouverte permet de lancer une nouvelle transaction imbriquée. La valeur de retour indique le niveau d'imbrication : une valeur de retour « 1 » indique que vous avez ouvert une transaction de niveau supérieur (la transaction n'est pas imbriquée dans une autre transaction) « 2 » indique que vous avez ouvert une transaction de second niveau (une transaction imbriquée dans une transaction de niveau supérieur) etc... L'appel de **CommitTrans** ou de **RollbackTrans** n'affecte que la dernière transaction ouverte. Vous devez fermer ou annuler la transaction active avant de pouvoir résoudre une transaction de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="7e89a-p106">For providers that support nested transactions, calling the **BeginTrans** method within an open transaction starts a new, nested transaction. The return value indicates the level of nesting: a return value of "1" indicates you have opened a top-level transaction (that is, the transaction is not nested within another transaction), "2" indicates that you have opened a second-level transaction (a transaction nested within a top-level transaction), and so forth. Calling **CommitTrans** or **RollbackTrans** affects only the most recently opened transaction; you must close or roll back the current transaction before you can resolve any higher-level transactions.</span></span>

