---
title: AddNew, méthode (ADO)
TOCTitle: AddNew method (ADO)
ms:assetid: bae09be0-5707-4f38-9c74-0acd0f29dbac
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249899(v=office.15)
ms:contentKeyID: 48547384
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 54217fdfe40bd8fea9b94ac78f1e05d2d94daa71
ms.sourcegitcommit: 980a96cf444882d3d34cecb5faac8f8a7b7c4b57
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/03/2018
ms.locfileid: "25949984"
---
# <a name="addnew-method-ado"></a><span data-ttu-id="b0b57-102">AddNew, méthode (ADO)</span><span class="sxs-lookup"><span data-stu-id="b0b57-102">AddNew method (ADO)</span></span>

<span data-ttu-id="b0b57-103">**S’applique à**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="b0b57-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="b0b57-104">Crée un enregistrement pour un objet [Recordset](recordset-object-ado.md) actualisable.</span><span class="sxs-lookup"><span data-stu-id="b0b57-104">Creates a new record for an updatable [Recordset](recordset-object-ado.md) object.</span></span>

## <a name="syntax"></a><span data-ttu-id="b0b57-105">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="b0b57-105">Syntax</span></span>

<span data-ttu-id="b0b57-106">*jeu d’enregistrements*. De AddNew *FieldList*, groupes de *valeurs*</span><span class="sxs-lookup"><span data-stu-id="b0b57-106">*recordset*.AddNew *FieldList*, *Values*</span></span>

## <a name="parameters"></a><span data-ttu-id="b0b57-107">Paramètres</span><span class="sxs-lookup"><span data-stu-id="b0b57-107">Parameters</span></span>

|<span data-ttu-id="b0b57-108">Paramètre</span><span class="sxs-lookup"><span data-stu-id="b0b57-108">Parameter</span></span>|<span data-ttu-id="b0b57-109">Description</span><span class="sxs-lookup"><span data-stu-id="b0b57-109">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="b0b57-110">*recordset*</span><span class="sxs-lookup"><span data-stu-id="b0b57-110">*recordset*</span></span> |<span data-ttu-id="b0b57-111">Objet **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="b0b57-111">A **Recordset** object.</span></span>|
|<span data-ttu-id="b0b57-112">*Liste de champs*</span><span class="sxs-lookup"><span data-stu-id="b0b57-112">*FieldList*</span></span> |<span data-ttu-id="b0b57-p101">Facultatif. Nom unique ou tableau de noms ou de positions ordinales des champs dans le nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="b0b57-p101">Optional. A single name, or an array of names or ordinal positions of the fields in the new record.</span></span>|
|<span data-ttu-id="b0b57-115">*Values*</span><span class="sxs-lookup"><span data-stu-id="b0b57-115">*Values*</span></span> |<span data-ttu-id="b0b57-116">Facultatif.</span><span class="sxs-lookup"><span data-stu-id="b0b57-116">Optional.</span></span> <span data-ttu-id="b0b57-117">Valeur unique ou tableau de valeurs des champs dans le nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="b0b57-117">A single value, or an array of values for the fields in the new record.</span></span> <span data-ttu-id="b0b57-118">Si *Fieldlist* est un tableau, les *valeurs* doivent être également un tableau avec le même nombre de membres ; dans le cas contraire, une erreur se produit.</span><span class="sxs-lookup"><span data-stu-id="b0b57-118">If *Fieldlist* is an array, *Values* must also be an array with the same number of members; otherwise, an error occurs.</span></span> <span data-ttu-id="b0b57-119">L'ordre des noms de champs doit correspondre à celui des valeurs de ces champs dans chaque tableau.</span><span class="sxs-lookup"><span data-stu-id="b0b57-119">The order of field names must match the order of field values in each array.</span></span>|

## <a name="remarks"></a><span data-ttu-id="b0b57-120">Notes</span><span class="sxs-lookup"><span data-stu-id="b0b57-120">Remarks</span></span>

<span data-ttu-id="b0b57-p103">Faites appel à la méthode **AddNew** pour créer et initialiser un enregistrement. Utilisez la méthode [Supports](supports-method-ado.md) avec **adAddNew** (une valeur [CursorOptionEnum](cursoroptionenum.md)) pour vérifier si vous pouvez ajouter des enregistrements à l'objet **Recordset** actif.</span><span class="sxs-lookup"><span data-stu-id="b0b57-p103">Use the **AddNew** method to create and initialize a new record. Use the [Supports](supports-method-ado.md) method with **adAddNew** (a [CursorOptionEnum](cursoroptionenum.md) value) to verify whether you can add records to the current **Recordset** object.</span></span>

<span data-ttu-id="b0b57-p104">Une fois la méthode **AddNew** appelée, le nouvel enregistrement devient l'enregistrement actif et reste actif jusqu'à ce que vous appeliez la méthode [Update](update-method-ado.md). Comme ce nouvel enregistrement est ajouté au **Recordset**, l'appel de **MoveNext** après Update déplace la position actuelle au delà de l'objet **Recordset** et **EOF** prend la valeur True. Si l'objet **Recordset** ne prend pas en charge les signets, vous risquez de ne pas pouvoir accéder au nouvel enregistrement après être passé à un autre enregistrement. Selon le type de curseur que vous utilisez, il vous faudra peut-être appeler la méthode [Requery](requery-method-ado.md) pour rendre le nouvel enregistrement accessible.</span><span class="sxs-lookup"><span data-stu-id="b0b57-p104">After you call the **AddNew** method, the new record becomes the current record and remains current after you call the [Update](update-method-ado.md) method. Since the new record is appended to the **Recordset**, a call to **MoveNext** following the Update will move past the end of the **Recordset**, making **EOF** True. If the **Recordset** object does not support bookmarks, you may not be able to access the new record once you move to another record. Depending on your cursor type, you may need to call the [Requery](requery-method-ado.md) method to make the new record accessible.</span></span>

<span data-ttu-id="b0b57-127">Si vous appelez la méthode **AddNew** pendant que vous modifiez l'enregistrement actif ou que vous ajoutez un nouvel enregistrement, ADO appelle la méthode **Update** pour enregistrer les modifications apportées, puis crée l'enregistrement.</span><span class="sxs-lookup"><span data-stu-id="b0b57-127">If you call **AddNew** while editing the current record or while adding a new record, ADO calls the **Update** method to save any changes and then creates the new record.</span></span>

<span data-ttu-id="b0b57-128">Le comportement de la méthode **AddNew** varie selon le mode de mise à jour de l’objet **Recordset** et selon que vous passez les arguments *Fieldlist* et *Values* .</span><span class="sxs-lookup"><span data-stu-id="b0b57-128">The behavior of the **AddNew** method depends on the updating mode of the **Recordset** object and whether you pass the *Fieldlist* and *Values* arguments.</span></span>

<span data-ttu-id="b0b57-p105">En *mode de mise à jour immédiate* (dans lequel le fournisseur écrit les modifications apportées dans la source de données sous-jacente dès que vous appelez la méthode **Update**), l’appel de la méthode **AddNew** sans arguments attribue la valeur **adEditAdd** (une valeur [EditModeEnum](editmodeenum.md)) à la propriété [EditMode](editmode-property-ado.md). Le fournisseur met en cache toutes les modifications locales de valeurs de champ. L’appel de la méthode **Update** publie le nouvel enregistrement dans la base de données et réinitialise la propriété **EditMode** à **adEditNone** (valeur **EditModeEnum**). Si vous passez les arguments *Fieldlist* et *Values*, ADO publie immédiatement le nouvel enregistrement dans la base de données (aucun appel de la méthode **Update** n’est requis) ; la valeur de la propriété **EditMode** reste inchangée (**adEditNone**).</span><span class="sxs-lookup"><span data-stu-id="b0b57-p105">In *immediate update mode* (in which the provider writes changes to the underlying data source once you call the **Update** method), calling the **AddNew** method without arguments sets the [EditMode](editmode-property-ado.md) property to **adEditAdd** (an [EditModeEnum](editmodeenum.md) value). The provider caches any field value changes locally. Calling the **Update** method posts the new record to the database and resets the **EditMode** property to **adEditNone** (an **EditModeEnum** value). If you pass the *Fieldlist* and *Values* arguments, ADO immediately posts the new record to the database (no **Update** call is necessary); the **EditMode** property value does not change (**adEditNone**).</span></span>

<span data-ttu-id="b0b57-133">En *mode de mise à jour par lot* (dans lequel le fournisseur met en cache plusieurs modifications et les écrit dans la source de données sous-jacente uniquement lorsque vous appelez la méthode [UpdateBatch](updatebatch-method-ado.md) ), l’appel de la méthode **AddNew** sans arguments définit **EditMode** propriété **adEditAdd**.</span><span class="sxs-lookup"><span data-stu-id="b0b57-133">In *batch update mode* (in which the provider caches multiple changes and writes them to the underlying data source only when you call the [UpdateBatch](updatebatch-method-ado.md) method), calling the **AddNew** method without arguments sets the **EditMode** property to **adEditAdd**.</span></span> <span data-ttu-id="b0b57-134">Le fournisseur met en cache toutes les modifications locales de valeurs de champ.</span><span class="sxs-lookup"><span data-stu-id="b0b57-134">The provider caches any field value changes locally.</span></span> <span data-ttu-id="b0b57-135">Appeler la méthode **Update** ajoute le nouvel enregistrement au **Recordset** actif et réinitialise la propriété **EditMode** à **adEditNone**, mais le fournisseur ne valide pas les modifications apportées à la base de données sous-jacente que lorsque vous appelez la méthode UpdateBatch \*\* \*\*méthode.</span><span class="sxs-lookup"><span data-stu-id="b0b57-135">Calling the **Update** method adds the new record to the current **Recordset** and resets the **EditMode** property to **adEditNone**, but the provider does not post the changes to the underlying database until you call the **UpdateBatch** method.</span></span> <span data-ttu-id="b0b57-136">Si vous passez des arguments *Fieldlist* et *Values* , ADO envoie le nouvel enregistrement au fournisseur pour le stockage dans un cache ; Vous devez appeler la méthode **UpdateBatch** pour publier le nouvel enregistrement dans la base de données sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="b0b57-136">If you pass the *Fieldlist* and *Values* arguments, ADO sends the new record to the provider for storage in a cache; you need to call the **UpdateBatch** method to post the new record to the underlying database.</span></span>

