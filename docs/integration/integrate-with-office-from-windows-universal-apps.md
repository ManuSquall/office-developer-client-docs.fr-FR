---
title: Intégration à Office à partir d'applications universelles Windows
manager: soliver
ms.date: 02/06/2017
ms.audience: Developer
localization_priority: Normal
ms.assetid: 60b4fa23-0075-4f6a-8bd0-9e53e99432d5
description: Vous pouvez intégrer vos applications tierces de plateforme d'application universelle Windows à Excel Mobile, PowerPoint Mobile et Word Mobile. Les applications universelles s'intègrent aux applications Office via les contrats de sélecteur de fichiers Windows, les propriétés Expando et les contrats de mise à jour des fichiers mis en cache.
ms.openlocfilehash: ad04ccc3ceb6e0f1d53e4aebc12cf9724ab8ab66
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32299765"
---
# <a name="integrate-with-office-from-windows-universal-apps"></a><span data-ttu-id="53457-104">Intégration à Office à partir d’applications universelles Windows</span><span class="sxs-lookup"><span data-stu-id="53457-104">Integrate with Office from Windows universal apps</span></span>

<span data-ttu-id="53457-p102">Vous pouvez intégrer vos applications tierces de plateforme d'application universelle Windows à Excel Mobile, PowerPoint Mobile et Word Mobile. Les applications universelles s'intègrent aux applications Office via les [contrats de sélecteur de fichiers](https://msdn.microsoft.com/library/windows/apps/hh465174.aspx) Windows, les [propriétés Expando](https://msdn.microsoft.com/library/windows/apps/xaml/hh770655.aspx) et les [contrats de mise à jour des fichiers mis en cache](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileupdater.aspx).</span><span class="sxs-lookup"><span data-stu-id="53457-p102">You can integrate your Windows universal app platform third-party apps with Excel Mobile, PowerPoint Mobile, and Word Mobile. Universal apps integrate with Office apps via Windows [file picker contracts](https://msdn.microsoft.com/library/windows/apps/hh465174.aspx), [expando properties](https://msdn.microsoft.com/library/windows/apps/xaml/hh770655.aspx), and [Cached File Updater contracts](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileupdater.aspx).</span></span>
  
<span data-ttu-id="53457-p103">Lorsque vous intégrez votre application universelle à Excel, PowerPoint ou Word Mobile, vos utilisateurs peuvent ouvrir les documents Office fournis par votre application, que ce soit lorsqu'ils parcourent Office ou lorsqu'ils utilisent Windows pour ouvrir des fichiers dans votre application. Les utilisateurs peuvent également enregistrer le fichier dans votre application universelle, qui télécharge le fichier vers votre service.</span><span class="sxs-lookup"><span data-stu-id="53457-p103">When you integrate your universal app with Excel, PowerPoint, or Word Mobile, your users can open Office documents that your app provides, either when they browse from within Office or when they use Windows to open files from within your app. Users can also save the file back to your universal app, which uploads the file back to your service.</span></span>
  
<span data-ttu-id="53457-109">Les fichiers ouverts de cette façon apparaissent dans la liste récente d'Office, afin que vos utilisateurs puissent facilement les trouver et les ouvrir à nouveau.</span><span class="sxs-lookup"><span data-stu-id="53457-109">Files opened this way appear in the Recent list in Office, so your users can easily find and reopen them.</span></span>
  
<span data-ttu-id="53457-110">Cette intégration exige que votre application universelle :</span><span class="sxs-lookup"><span data-stu-id="53457-110">This integration requires that your universal app:</span></span>
    
- <span data-ttu-id="53457-111">Implémente les [contrats de sélecteur de fichiers](https://msdn.microsoft.com/library/windows/apps/hh465174.aspx) Windows.</span><span class="sxs-lookup"><span data-stu-id="53457-111">Implements the Windows [file picker contracts](https://msdn.microsoft.com/library/windows/apps/hh465174.aspx).</span></span>
    
- <span data-ttu-id="53457-112">représente un magasin de fichiers (par exemple, une application qui permet d’accéder au stockage cloud).</span><span class="sxs-lookup"><span data-stu-id="53457-112">Represents a file store (for example, an app that allows access to cloud storage).</span></span>
    
## <a name="expando-properties"></a><span data-ttu-id="53457-113">Propriétés Expando</span><span class="sxs-lookup"><span data-stu-id="53457-113">Expando properties</span></span>

<span data-ttu-id="53457-p104">Les applications universelles Windows peuvent utiliser des propriétés Expando pour communiquer des informations supplémentaires qui sont associées aux fichiers. Pour plus d'informations sur leur fonctionnement dans Windows, voir « System.ExpandoProperties » dans [StorageItemContentProperties.SavePropertiesAsync](https://msdn.microsoft.com/library/windows/apps/xaml/hh770655.aspx).</span><span class="sxs-lookup"><span data-stu-id="53457-p104">Windows universal apps can use Expando properties to communicate additional information that is associated with files. For information about how this works in Windows, see "System.ExpandoProperties" in [StorageItemContentProperties.SavePropertiesAsync](https://msdn.microsoft.com/library/windows/apps/xaml/hh770655.aspx).</span></span>
  
<span data-ttu-id="53457-p105">Le tableau suivant décrit les propriétés que votre application doit fournir à Office pour activer des scénarios de fichiers ouverts. Si cette information n'est pas indiquée, tous les fichiers de votre application sont ouverts en lecture seule. Les utilisateurs peuvent les ouvrir et les modifier en fonction du type de licence Office dont ils disposent, et du type de document qu'ils essaient d'ouvrir.</span><span class="sxs-lookup"><span data-stu-id="53457-p105">The following table describes the properties that your app has to provide to Office to enable file open scenarios. If this information is not provided, all files from your app are opened as read only. Whether users can open files for editing depends on the type of Office license they have and the type of document they're trying to open.</span></span>
  
<span data-ttu-id="53457-119">Définissez ces propriétés dans l'ensemble de propriétés **System.ExpandoProperties**.</span><span class="sxs-lookup"><span data-stu-id="53457-119">Set these properties in the **System.ExpandoProperties** property set.</span></span> 
  
|<span data-ttu-id="53457-120">**Propriété**</span><span class="sxs-lookup"><span data-stu-id="53457-120">**Property**</span></span>|<span data-ttu-id="53457-121">**Description**</span><span class="sxs-lookup"><span data-stu-id="53457-121">**Description**</span></span>|<span data-ttu-id="53457-122">**Type**</span><span class="sxs-lookup"><span data-stu-id="53457-122">**Type**</span></span>|<span data-ttu-id="53457-123">**Exemple**</span><span class="sxs-lookup"><span data-stu-id="53457-123">**Example**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="53457-124">**AppDisplayName**</span><span class="sxs-lookup"><span data-stu-id="53457-124">**AppDisplayName**</span></span> <br/> |<span data-ttu-id="53457-p106">Nom du fournisseur à afficher pour l'utilisateur. Il s'affiche à plusieurs endroits dans Office, comme la liste des documents récents.</span><span class="sxs-lookup"><span data-stu-id="53457-p106">Provider name to display to the user. Appears in multiple places in Office, such as the recent document list.</span></span>  <br/> |<span data-ttu-id="53457-127">String</span><span class="sxs-lookup"><span data-stu-id="53457-127">String</span></span>  <br/> |<span data-ttu-id="53457-128">Contoso</span><span class="sxs-lookup"><span data-stu-id="53457-128">Contoso</span></span>  <br/> |
|<span data-ttu-id="53457-129">**MicrosoftOfficeOwnershipType**</span><span class="sxs-lookup"><span data-stu-id="53457-129">**MicrosoftOfficeOwnershipType**</span></span> <br/> |<span data-ttu-id="53457-p107">En ce qui concerne la gestion des licences, indiquez si le document/l'emplacement est personnel ou professionnel. Les valeurs autorisées sont 1 (personnel) et 2 (professionnel). Par exemple, si le fichier de votre utilisateur est stocké dans Contoso Business, utilisez la valeur « 2 » pour les documents professionnels.</span><span class="sxs-lookup"><span data-stu-id="53457-p107">For licensing, indicate whether the document/location is Personal/Consumer or Work/Business. Allowed values are 1 (personal) and 2 (business). For example, if your user's file is stored in Contoso Business, use the value "2" for business.</span></span>  <br/> |<span data-ttu-id="53457-133">Unit32</span><span class="sxs-lookup"><span data-stu-id="53457-133">Unit32</span></span>  <br/> | <span data-ttu-id="53457-134">1 ou 2</span><span class="sxs-lookup"><span data-stu-id="53457-134">1 or 2</span></span>  <br/> <span data-ttu-id="53457-135">Par exemple, si le fichier de votre utilisateur est stocké dans Contoso Business, vous devez lui attribuer la valeur 2 pour les documents professionnels.</span><span class="sxs-lookup"><span data-stu-id="53457-135">For example, if your user's file is stored in Contoso Business, this file should be marked 2 for business.</span></span>  <br/> |
|<span data-ttu-id="53457-136">**MicrosoftOfficeTermsOfUse**</span><span class="sxs-lookup"><span data-stu-id="53457-136">**MicrosoftOfficeTermsOfUse**</span></span> <br/> |<span data-ttu-id="53457-p108">Texte juridique pour déclarer que les informations que vous fournissez sont exactes conformément à nos conditions d'utilisation. Ce texte n'est pas visible par l'utilisateur. Il s'agit d'un accord entre vous, le fournisseur de l'application et Microsoft.</span><span class="sxs-lookup"><span data-stu-id="53457-p108">Legal text to declare that the information you provide is accurate per our terms of use. This text is not displayed to the user. It is an agreement between you, the application provider, and Microsoft.</span></span>  <br/> <span data-ttu-id="53457-140">Consultez la rubrique suivante pour obtenir un exemple.</span><span class="sxs-lookup"><span data-stu-id="53457-140">See the following for an example.</span></span>  <br/> | <span data-ttu-id="53457-141">String</span><span class="sxs-lookup"><span data-stu-id="53457-141">String</span></span>  <br/> | <span data-ttu-id="53457-142">J'accepte les conditions indiquées sur la page [https://go.microsoft.com/fwlink/p/?LinkId=528381](third-party-applications-integrating-with-office-mobile-products.md)</span><span class="sxs-lookup"><span data-stu-id="53457-142">I agree to the terms located in [https://go.microsoft.com/fwlink/p/?LinkId=528381](third-party-applications-integrating-with-office-mobile-products.md)</span></span> <br/> |
   
<span data-ttu-id="53457-143">L’exemple de code suivant montre comment définir ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="53457-143">The following code example shows how to set these properties.</span></span>
  
```cs
public static async Task SetExpandoProperties(StorageFile file,... other params ...) 
  { 
     var expandoProperties = new PropertySet(); 
     expandoProperties.Add("AppDisplayName", "Contoso",);  
     // String value. 
     expandoProperties.Add("MicrosoftOfficeOwnershipType", 1);  
     // Unit32 value - 1 (for personal), 2 (for business).  
     expandoProperties.Add("MicrosoftOfficeTermsOfUse", "I agree to the terms located at https://go.microsoft.com/fwlink/p/?LinkId=528381");   
    // String value. 
          
       var fileProperties = new PropertySet(); 
       fileProperties.Add("System.ExpandoProperties", expandoProperties); 
       await file.Properties.SavePropertiesAsync(fileProperties); 
  } 

```

## <a name="cached-file-updater-contracts"></a><span data-ttu-id="53457-144">Contrats de mise à jour des fichiers mis en cache</span><span class="sxs-lookup"><span data-stu-id="53457-144">Cached File Updater contracts</span></span>

<span data-ttu-id="53457-p109">Si votre application universelle participe aux contrats de mise à jour des fichiers mis en cache, elle recevra les notifications des modifications apportées par une autre application universelle (comme Office) au fichier. Pour plus d'informations sur le fonctionnement dans Windows, voir la classe [CachedFileUpdater](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileupdater.aspx).</span><span class="sxs-lookup"><span data-stu-id="53457-p109">If your universal app participates in Cached File Updater contracts, it will be notified of changes another universal app (such as Office) makes to the file. For information about how this works in Windows, see [CachedFileUpdater class](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileupdater.aspx).</span></span>
  
<span data-ttu-id="53457-p110">Office utilise l'option **AllowOnlyReaders** pour ouvrir les fichiers en lecture et en écriture que votre application universelle fournit via les contrats de sélecteur de fichiers. Cela signifie que le fichier ne peut pas être déplacé, supprimé, renommé ou écrit par une autre application, y compris la vôtre, tant qu'il est ouvert dans Office. Office enregistre automatiquement le fichier, mais définit CachedFileManager.DeferUpdates pour empêcher l'activation de votre application jusqu'à ce qu'Office ferme le document, ou qu'Office soit suspendu par Windows (lorsque l'utilisateur bascule vers une autre application). Lorsqu'Office ferme le fichier, votre application peut écrire dans celui-ci.</span><span class="sxs-lookup"><span data-stu-id="53457-p110">Office uses the **AllowOnlyReaders** option to open the read-write files your universal app provides via the file picker contracts. This means the file cannot be moved, deleted, renamed, or written to by another app, including your own, while it is open in Office. Office will autosave the file, but sets CachedFileManager.DeferUpdates to prevent activating your app until Office closes the document, or Office is suspended by Windows (when the user switches to another app). When Office closes the file, your app can write to it.</span></span> 
  
<span data-ttu-id="53457-151">Votre application doit gérer toutes les communications avec votre service, y compris le téléchargement, l'actualisation et le chargement.</span><span class="sxs-lookup"><span data-stu-id="53457-151">Your app must handle all communication with your service, including download, refresh, and upload.</span></span>
  
<span data-ttu-id="53457-152">Le tableau suivant répertorie les paramètres à définir pour gérer les interactions entre votre application et Office.</span><span class="sxs-lookup"><span data-stu-id="53457-152">The following tables lists the parameters to set to handle interactions between your app and Office.</span></span>
  
|<span data-ttu-id="53457-153">**Paramètre**</span><span class="sxs-lookup"><span data-stu-id="53457-153">**Parameter**</span></span>|<span data-ttu-id="53457-154">**Description**</span><span class="sxs-lookup"><span data-stu-id="53457-154">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="53457-155">ReadActivationMode</span><span class="sxs-lookup"><span data-stu-id="53457-155">ReadActivationMode</span></span>](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.readactivationmode.aspx) <br/> |<span data-ttu-id="53457-156">Définissez **BeforeAccess** pour autoriser votre application à mettre à jour le fichier avant de l'envoyer à Office.</span><span class="sxs-lookup"><span data-stu-id="53457-156">Set **BeforeAccess** to allow your app to update the file before it sends it to Office.</span></span>  <br/> |
|[<span data-ttu-id="53457-157">WriteActivationMode</span><span class="sxs-lookup"><span data-stu-id="53457-157">WriteActivationMode</span></span>](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.writeactivationmode.aspx) <br/> |<span data-ttu-id="53457-p111">Définissez **ReadOnly** pour faire en sorte que le fichier soit en lecture seule. Définissez **AfterWrite** pour vous assurer que votre application sera déclenchée par l'élément CacheFileUpdater lorsqu'Office aura terminé d'utiliser le fichier.  </span><span class="sxs-lookup"><span data-stu-id="53457-p111">Set **ReadOnly** to make the file read only. Set **AfterWrite** to ensure that your app will be triggered by the CacheFileUpdater when Office is finished with the file.</span></span><br/><br/><span data-ttu-id="53457-160">**REMARQUE :** si vous ne définissez pas **AfterWrite**, votre application ne sera pas notifiée des modifications, ce qui signifie que les modifications de l’utilisateur seront locales uniquement.</span><span class="sxs-lookup"><span data-stu-id="53457-160">**NOTE**: If you do not set **AfterWrite**, your app will not be notified to upload the changes, which means that the user's changes will only be local.</span></span>           |
|[<span data-ttu-id="53457-161">CachedFileOptions.RequireUpdateOnAccess</span><span class="sxs-lookup"><span data-stu-id="53457-161">CachedFileOptions.RequireUpdateOnAccess</span></span>](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileoptions.aspx) <br/> |<span data-ttu-id="53457-162">Définissez cette propriété pour vous assurer que votre application peut mettre à jour le fichier lorsqu’un utilisateur accède à la liste récente.</span><span class="sxs-lookup"><span data-stu-id="53457-162">Set this property to ensure that your app can update the file when a user accesses it from the Recent list.</span></span>  <br/> |
   
## <a name="invoking-office-from-your-app"></a><span data-ttu-id="53457-163">Appel d'Office à partir de votre application</span><span class="sxs-lookup"><span data-stu-id="53457-163">Invoking Office from your app</span></span>

<span data-ttu-id="53457-p112">Lorsqu'un utilisateur ouvre un document Office à partir de votre application, il peut être ouvert dans Excel Mobile, PowerPoint Mobile et Word Mobile. Par exemple, lorsqu'un utilisateur sélectionne un fichier \*.docx dans votre application, Word Mobile démarre avec le fichier \*.docx ouvert. L'application Office qui s'ouvre est basée sur l'application à laquelle l'utilisateur a associé le type du fichier.</span><span class="sxs-lookup"><span data-stu-id="53457-p112">When a user opens an Office document from your app, the document can open in Excel Mobile, PowerPoint Mobile, and Word Mobile. For example, when a user selects a \*.docx file in your app, Word Mobile launches with the \*.docx file opened. The Office app that opens is based on which app the user associated with the file type.</span></span>
  
<span data-ttu-id="53457-p113">Pour ouvrir un fichier à partir de votre application dans Office, nous vous recommandons d'utiliser **LaunchFileAsync()** afin de lancer le fichier. Nous vous déconseillons d'utiliser **LaunchUriAsync()** pour ce faire, car cela entrainera le lancement de l'application inscrite pour le schéma d'URI (le navigateur) au lieu d'Office. Toutefois, l'élément **LaunchUriAsync()** avec l'option **LauncherOptions.ContentType()** peut appeler Office, et dans ce cas, le fichier ouvert est marqué comme temporaire et est en lecture seule dans Office.</span><span class="sxs-lookup"><span data-stu-id="53457-p113">To open a file from your app in Office, we recommend that you use **LaunchFileAsync()** to launch the file. We don't recommend that you use **LaunchUriAsync()** to launch the file because that will cause the application registered for the URI scheme to launch (the browser) instead of Office. Although **LaunchUriAsync()** with the **LauncherOptions.ContentType()** option can invoke Office, in this case the file opened is marked as temporary and is read-only in Office.</span></span> 
  
<span data-ttu-id="53457-170">Pour plus d'informations, voir la [classe Launcher](https://msdn.microsoft.com/library/windows/apps/windows.system.launcher.aspx).</span><span class="sxs-lookup"><span data-stu-id="53457-170">For more information, see [Launcher class](https://msdn.microsoft.com/library/windows/apps/windows.system.launcher.aspx).</span></span>
  
## <a name="temporary-and-read-only-files"></a><span data-ttu-id="53457-171">Fichiers temporaires et en lecture seule</span><span class="sxs-lookup"><span data-stu-id="53457-171">Temporary and read-only files</span></span>

<span data-ttu-id="53457-172">Définissez l'attribut **FILE_ATTRIBUTE_TEMPORARY** sur les fichiers temporaires et l'attribut **FILE_ATTRIBUTE_READONLY** sur les fichiers en lecture seule dans votre application.</span><span class="sxs-lookup"><span data-stu-id="53457-172">Set the **FILE_ATTRIBUTE_TEMPORARY** attribute on temporary files and the **FILE_ATTRIBUTE_READONLY** attribute on read-only files in your app.</span></span> 
  
<span data-ttu-id="53457-p114">Les fichiers dont les attributs **FILE_ATTRIBUTE_TEMPORARY** ou **FILE_ATTRIBUTE_READONLY** sont définis s'ouvrent en lecture seule dans Office. L'attribut **FILE_ATTRIBUTE_TEMPORARY** empêche également le fichier d'apparaître dans la liste récente.</span><span class="sxs-lookup"><span data-stu-id="53457-p114">Files that have the **FILE_ATTRIBUTE_TEMPORARY** or **FILE_ATTRIBUTE_READONLY** attributes set open as read-only in Office. The **FILE_ATTRIBUTE_TEMPORARY** also prevents the file from appearing in the Recent list.</span></span> 
  
<span data-ttu-id="53457-175">Pour plus d'informations sur les attributs de fichier, voir la [fonction SetFileAttributes](https://msdn.microsoft.com/library/windows/desktop/aa365535%28v=vs.85%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="53457-175">For more information about file attributes, see [SetFileAttributes function](https://msdn.microsoft.com/library/windows/desktop/aa365535%28v=vs.85%29.aspx).</span></span>
  
## <a name="other-best-practices"></a><span data-ttu-id="53457-176">Autres méthodes conseillées</span><span class="sxs-lookup"><span data-stu-id="53457-176">Other best practices</span></span>

<span data-ttu-id="53457-177">Pour optimiser la cohérence des fichiers, par exemple lorsque des erreurs ou des modifications conflictuelles se produisent, appliquez les meilleures pratiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="53457-177">To optimize for file consistency, for example when conflicting edits or errors occur, apply the following best practices:</span></span>
  
- <span data-ttu-id="53457-178">Évitez les conflits d'enregistrement.</span><span class="sxs-lookup"><span data-stu-id="53457-178">Prevent save conflicts.</span></span>
    
  - <span data-ttu-id="53457-p115">Mettez le téléchargement sur pause en cas de conflit de serveur afin d'éviter la duplication (uniquement lorsqu'Office ne dispose plus de fichier ouvert en écriture). En règle générale, si un fichier provenant de votre application est ouvert dans Office, votre application est activée uniquement lorsqu'Office ferme ou est suspendu par Windows.</span><span class="sxs-lookup"><span data-stu-id="53457-p115">Pause uploads when server conflicts occur to avoid forking (only fork when Office no longer has a write file open). Typically, if a file from your app is open in Office, your app is activated only when Office closes or is suspended by Windows.</span></span>
    
  - <span data-ttu-id="53457-181">Si vous avez besoin de l’interface utilisateur pour gérer les conflits, implémentez les notifications toast.</span><span class="sxs-lookup"><span data-stu-id="53457-181">If you need UI to handle conflicts, implement toast notifications.</span></span> <span data-ttu-id="53457-182">L’interface utilisateur n’est pas disponible dans son intégralité lorsqu’Office est suspendu.</span><span class="sxs-lookup"><span data-stu-id="53457-182">Full UI is not available when Office is suspended.</span></span>
    
- <span data-ttu-id="53457-183">Gérez les erreurs.</span><span class="sxs-lookup"><span data-stu-id="53457-183">Handle errors.</span></span>
    
  - <span data-ttu-id="53457-184">Lorsqu’un verrou est libéré, informez les utilisateurs du conflit et indiquez un chemin pour résoudre ce problème dans votre application.</span><span class="sxs-lookup"><span data-stu-id="53457-184">When a lock is released, notify users of the conflict and provide a path to resolve it within your app.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="53457-185">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="53457-185">See also</span></span>

- [<span data-ttu-id="53457-186">Intégration à Office</span><span class="sxs-lookup"><span data-stu-id="53457-186">Integrate with Office</span></span>](integrate-with-office.md)   
- [<span data-ttu-id="53457-187">Intégration à Office à partir de clients de synchronisation Win32</span><span class="sxs-lookup"><span data-stu-id="53457-187">Integrate with Office from Win32 sync clients</span></span>](integrate-with-office-from-win32-sync-clients.md)
    

