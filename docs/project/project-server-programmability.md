---
title: Programmabilité de Project Server
manager: lindalu
ms.date: 12/03/2019
ms.audience: Developer
f1_keywords:
- events
- PDS
- PDS compatibility
- Project Server databases
- Project Server events
- Project Server Interface
- Project Server workflow
- Project workflow
- PSI
- PSI limitations
- PSI uses
- SharePoint Services
- WF
- workflow
- Workflow Foundation
- WSS
keywords:
- Project 2013, architecture et programmabilité, PSI, Projets, versions, Programmabilité, Project Server, PSI, limitations, interface de Project Server, fonctionnalités non prises en charge, interface de Project Server, compatibilité PDS, Interface de Project Server, générique, Project Server, versions de projet, Versions, projets, Project Server, bases de données, Project 2013, plateforme, Interface de Project Server, scénarios d’utilisation, Project Server, événements, Project Server, service de données Project, compatibilité avec PSI, Interface de Project Server
ms.assetid: a93d2153-5132-4289-af51-69350471e248
description: Découvrez les principales fonctionnalités de programmabilité dans Project Server 2013. Cet article comprend des informations sur le portage d’applications créées pour des versions précédentes de Project Server.
localization_priority: Priority
ms.openlocfilehash: db5e09ebe7a820255ba3d61c719b838289005e12
ms.sourcegitcommit: 37080eb0087261320e24e6f067e5f434a812b2d2
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/04/2019
ms.locfileid: "39819307"
---
# <a name="project-server-programmability"></a><span data-ttu-id="72fb6-105">Programmabilité de Project Server</span><span class="sxs-lookup"><span data-stu-id="72fb6-105">Project Server programmability</span></span>

<span data-ttu-id="72fb6-106">Découvrez les principales fonctionnalités de programmabilité dans Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-106">Learn about the major programmability features in Project Server 2013.</span></span> <span data-ttu-id="72fb6-107">Cet article comprend des informations sur le portage d’applications créées pour des versions précédentes de Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-107">This article includes information about porting applications that were built for previous versions of Project Server.</span></span>

<span data-ttu-id="72fb6-108">Project Server 2013 est conçu pour prendre en charge la plupart des applications développées pour Project Server 2010 et de nouvelles solutions pour plusieurs plateformes, où les applications peuvent accéder aux installations Project Server locales et en ligne.</span><span class="sxs-lookup"><span data-stu-id="72fb6-108">Project Server 2013 is designed to support most applications that were developed for Project Server 2010 and new solutions for multiple platforms, where apps can access both online and on-premises Project Server installations.</span></span> <span data-ttu-id="72fb6-109">Les applications et les extensions développées pour Project Server 2003 ou les versions antérieures doivent être repensées pour utiliser le modèle CSOM ou l’interface PSI (Project Server Interface).</span><span class="sxs-lookup"><span data-stu-id="72fb6-109">Applications and extensions that were developed for Project Server 2003 or earlier must be redesigned to use the client-side object model (CSOM) or the Project Server Interface (PSI).</span></span> <span data-ttu-id="72fb6-110">Les applications développées pour Office Project Server 2007 ou Project Server 2010 peuvent nécessiter des modifications et une recompilation pour pouvoir utiliser l’interface PSI ; pour utiliser le modèle CSOM, ces applications nécessitent une nouvelle conception.</span><span class="sxs-lookup"><span data-stu-id="72fb6-110">Applications that were developed for Office Project Server 2007 or Project Server 2010 may require some changes and recompiling to use the PSI; to use the CSOM, those applications require a redesign.</span></span>
  
<span data-ttu-id="72fb6-111">La plateforme Project Server permet un haut niveau de productivité pour les programmeurs, car elle s’appuie sur SharePoint Server 2013, .NET Framework 4 et le protocole OData avec le modèle CSOM.</span><span class="sxs-lookup"><span data-stu-id="72fb6-111">The Project Server platform enables high levels of programmer productivity by building on SharePoint Server 2013, .NET Framework 4, and the OData protocol with the CSOM.</span></span> <span data-ttu-id="72fb6-112">Les développeurs peuvent étendre Project Web App avec des applications, des composants d’application et des composants WebPart, définir des flux de travail à l’aide de SharePoint Designer 2013 et appliquer des règles métier à l’aide de récepteurs d’événements distants pour les événements Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-112">Developers can extend Project Web App with apps, app parts, and Web Parts, define workflows by using SharePoint Designer 2013, and enforce business rules by using remote event receivers for Project Server events.</span></span>
  
## <a name="project-server-and-sharepoint-server"></a><span data-ttu-id="72fb6-113">Project Server et SharePoint Server</span><span class="sxs-lookup"><span data-stu-id="72fb6-113">Project Server and SharePoint Server</span></span>
<span data-ttu-id="72fb6-114"><a name="pj15_Programmability_MOSS"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-114"></span></span>

<span data-ttu-id="72fb6-115">Project Web App est intégrée sur SharePoint Server 2013 et utilise des pages maîtres et des composants WebPart pour rendre plus facile de créer des applications personnalisées et les solutions Project Web App.</span><span class="sxs-lookup"><span data-stu-id="72fb6-115">Project Web App is built upon SharePoint Server 2013, and uses master pages and Web Parts to make it easier to build custom apps and Project Web App solutions.</span></span> <span data-ttu-id="72fb6-116">Project Server 2013 fait l’objet d’une intégration approfondie avec SharePoint Server 2013, où il sert de plateforme pour la collaboration sur les projets, la création de rapports, l’administration de site, la sécurité et la gestion des flux de travail.</span><span class="sxs-lookup"><span data-stu-id="72fb6-116">Project Server 2013 integrates deeply with SharePoint Server 2013 as the platform for project collaboration, reporting, site administration, security, and workflow management.</span></span>
  
<span data-ttu-id="72fb6-117">Les sites de projets incluent d’autres informations et options de collaboration pour les membres d’équipes, où vous pouvez ajouter des applications par défaut qui incluent un récapitulatif du projet, des listes SharePoint spécialisées pour les tâches avec une chronologie, le suivi des problèmes, risques, éléments livrables du projet et le calendrier de l’équipe, ainsi que les discussions d’équipe et la bibliothèque de documents.</span><span class="sxs-lookup"><span data-stu-id="72fb6-117">The project sites include more information and collaboration options for team members, where you can add default apps that include a project summary, specialized SharePoint lists for tasks with a timeline, tracking issues, risks, project deliverables, and the team calendar, along with the document library and team discussions.</span></span> <span data-ttu-id="72fb6-118">Les applications personnalisées pour Project Server 2013 offrent une grande flexibilité et des extensions pour la collaboration des équipes.</span><span class="sxs-lookup"><span data-stu-id="72fb6-118">Custom apps for Project Server 2013 provide extensions and flexibility for team collaboration.</span></span> <span data-ttu-id="72fb6-119">Vous pouvez également ajouter des composants d’application pour personnaliser une application, à l’aide du mécanisme qui permet d’ajouter et de modifier des composants WebPart lorsque vous modifiez une page.</span><span class="sxs-lookup"><span data-stu-id="72fb6-119">You can also add app parts to customize an app, by using the same mechanism to add and edit Web Parts when you edit a page.</span></span> <span data-ttu-id="72fb6-120">Vous pouvez localiser les sites de projets n’importe où dans la batterie de serveurs SharePoint dans laquelle Project Server est installé.</span><span class="sxs-lookup"><span data-stu-id="72fb6-120">You can locate project sites anywhere within the SharePoint farm where Project Server is installed.</span></span> <span data-ttu-id="72fb6-121">Pour utiliser d’autres services de base de Project Server 2013, tels qu’Excel Services et Enterprise Search, un administrateur peut activer et configurer les services.</span><span class="sxs-lookup"><span data-stu-id="72fb6-121">To use other core services of SharePoint Server 2013, such as Excel Services and Enterprise Search, an administrator can enable and configure the services.</span></span> 
  
<span data-ttu-id="72fb6-122">Lorsque vous installez Project Server 2013, vous devez configurer l’application de service de projet dans le site SharePoint Web Services.</span><span class="sxs-lookup"><span data-stu-id="72fb6-122">When you install Project Server 2013, you provision the Project Service Application in the SharePoint Web Services site.</span></span> <span data-ttu-id="72fb6-123">L’application de service de projet inclut des services Windows Communication Foundation (WCF) locaux et des services web ASMX pour l’interface PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-123">The Project Service Application includes the local Windows Communication Foundation (WCF) services and ASMX web services for the PSI.</span></span> <span data-ttu-id="72fb6-124">La recherche SharePoint et la gestion de documents SharePoint sont d’autres exemples d’applications de service.</span><span class="sxs-lookup"><span data-stu-id="72fb6-124">Other examples of service applications include SharePoint Search and SharePoint Document Management.</span></span> <span data-ttu-id="72fb6-125">Pour plus d’informations, consultez la documentation pour les développeurs de SharePoint Server 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-125">For more information, see the SharePoint Server 2013 developer documentation.</span></span>
  
<span data-ttu-id="72fb6-126">L’application de service de projet est un fournisseur de services logiques qui peut gérer plusieurs instances de Project Web App.</span><span class="sxs-lookup"><span data-stu-id="72fb6-126">The Project Service Application is a logical service provider that can manage multiple instances of Project Web App.</span></span> <span data-ttu-id="72fb6-127">Le déploiement de Project Server crée un site Project Web App spécifique au sein d’une application web SharePoint.</span><span class="sxs-lookup"><span data-stu-id="72fb6-127">Project Server provisioning creates a specific Project Web App site within a SharePoint web application.</span></span> <span data-ttu-id="72fb6-128">La page d’accueil de Project Web App contient des liens vers la page Project Center, la page du Centre de ressources et la page Centre d’aide à la décision pour la création de rapports, ainsi qu’une page qui contient une liste d’applications standard supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="72fb6-128">The Home page of Project Web App contains links to the Project Center page, Resource Center page, and the Business Intelligence Center page for reporting, plus a page that contains a list of additional standard apps.</span></span> <span data-ttu-id="72fb6-129">La figure 1 présente la commande **Modifier la page** dans la liste déroulante **Paramètres** de la page d’accueil de Project Web App, qui vous permet d’ajouter ou de modifier des composants WebPart.</span><span class="sxs-lookup"><span data-stu-id="72fb6-129">Figure 1 shows the **Edit Page** command in the **Setttings** drop-down list on the Home page of Project Web App, which allows you to add or edit Web Parts.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="72fb6-130">Certaines pages d’administration dans Project Web App, telles que la page Paramètres Project Web App, ne sont pas modifiables et n’affichent pas la commande **Modifier la page**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-130">Some administrative pages in Project Web App—such as the PWA Settings page—are not editable, and do not show the **Edit Page** command.</span></span> <span data-ttu-id="72fb6-131">Project Web App ne vous permet pas de modifier des pages à l’aide de SharePoint Designer 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-131">Project Web App does not allow you to edit pages by using SharePoint Designer 2013.</span></span> <span data-ttu-id="72fb6-132">Vous pouvez modifier les pages des sites de projets avec SharePoint Designer 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-132">You can edit project site pages with SharePoint Designer 2013.</span></span> 
  
<span data-ttu-id="72fb6-133">**Figure 1. Utilisation du menu Modifier la page dans Project Web App**</span><span class="sxs-lookup"><span data-stu-id="72fb6-133">**Figure 1. Using the Edit Page menu in Project Web App**</span></span>

<span data-ttu-id="72fb6-134">![Modification de la page d’accueil dans Project Web Access](media/pj15_Programmability_PWAHome.gif "Modification de la page d’accueil dans Project Web Access")</span><span class="sxs-lookup"><span data-stu-id="72fb6-134">![Editing the Home page in Project Web Access](media/pj15_Programmability_PWAHome.gif "Editing the Home page in Project Web Access")</span></span>
  
<span data-ttu-id="72fb6-135">Pour accéder à la page Paramètres du site dans Project Web App, choisissez l’icône **Paramètres** dans le coin supérieur droit de la page.</span><span class="sxs-lookup"><span data-stu-id="72fb6-135">To access the Site Settings page in Project Web App, choose the **Settings** icon in the top-right corner of the page.</span></span> <span data-ttu-id="72fb6-136">La page Paramètres du site ( `https://ServerName/ProjectServerName/_layouts/15/settings.aspx`) permet de modifier l’apparence et le thème du site, d’ajouter des composants WebPart personnalisés et de modifier ou créer des pages maîtres pour les sites de projets.</span><span class="sxs-lookup"><span data-stu-id="72fb6-136">The Site Settings page (  `https://ServerName/ProjectServerName/_layouts/15/settings.aspx`) enables changing the look and feel and the site theme, adding custom Web Parts, and modifying or creating master pages for project sites.</span></span>
  
<span data-ttu-id="72fb6-137">La personnalisation du code dans les pages ASPX ou personnalisation des pages maîtres Project Web App avec SharePoint Designer 2013 n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="72fb6-137">Customization of the code in ASPX pages, or customization of Project Web App master pages with SharePoint Designer 2013, is not supported.</span></span> <span data-ttu-id="72fb6-138">La personnalisation du code dans les pages Project Web App peut provoquer des problèmes avec les mises à jour et Service Packs Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-138">Customization of the code in Project Web App pages can cause problems with Project Server updates and service packs.</span></span> 
  
### <a name="customization-of-project-web-app-with-sharepoint-packages"></a><span data-ttu-id="72fb6-139">Personnalisation de Project Web App avec des packages SharePoint</span><span class="sxs-lookup"><span data-stu-id="72fb6-139">Customization of Project Web App with SharePoint packages</span></span>
<span data-ttu-id="72fb6-140"><a name="pj15_Programmability_CustomizationOfPWA"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-140"></span></span>

<span data-ttu-id="72fb6-141">Étant donné que Project Web App est une application SharePoint et que les sites de projet sont des sites SharePoint, vous pouvez ajouter des applications personnalisées, des composants WebPart, des gestionnaires d’événements, des champs personnalisés et d’autres fonctionnalités à l’aide de packages SharePoint (fichiers .wsp) ou d’applications SharePoint (fichiers .spapp).</span><span class="sxs-lookup"><span data-stu-id="72fb6-141">Because Project Web App is a SharePoint application, and project sites are SharePoint sites, you can add custom apps, Web Parts, event handlers, custom fields, and other features by using SharePoint packages (.wsp files) or SharePoint apps (.spapp files).</span></span> <span data-ttu-id="72fb6-142">Un package SharePoint ou un package d’application peut inclure plusieurs entités Project Server, où les définitions d’entité sont spécifiées dans un fichier elements.xml dans le package.</span><span class="sxs-lookup"><span data-stu-id="72fb6-142">A SharePoint package or an app package can include multiple Project Server entities, where entity definitions are specified in an elements.xml file within the package.</span></span>
  
<span data-ttu-id="72fb6-143">Pour Microsoft Project Online, vous pouvez ajouter des boutons au ruban de Project Web App, mais vous ne pouvez pas supprimer ou renommer des boutons produit existants et vous ne pouvez pas créer de nouveaux onglets de ruban.</span><span class="sxs-lookup"><span data-stu-id="72fb6-143">For Project Online, you can add buttons to the Project Web App ribbon, but you can't remove or rename existing product buttons, and you can't create new ribbon tabs.</span></span> <span data-ttu-id="72fb6-144">Pour plus d’informations, consultez la section [Créer des actions personnalisées à déployer avec les applications pour SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins).</span><span class="sxs-lookup"><span data-stu-id="72fb6-144">For more information, see [Create custom actions to deploy with apps for SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins).</span></span>
  
> [!CAUTION]
> <span data-ttu-id="72fb6-145">Lorsque vous installez un package SharePoint ou un package d’application, les types d’entité Project Server doivent apparaître dans l’ordre spécifié par le schéma PSEntityProvision.xsd. Sinon, la validation du schéma du package échoue et l’installation s’interrompt.</span><span class="sxs-lookup"><span data-stu-id="72fb6-145">When you install a SharePoint package or an app package, the types of Project Server entities must appear in the order that the PSEntityProvision.xsd schema specifies or schema validation of the package fails and installation is not completed.</span></span> 
  
<span data-ttu-id="72fb6-146">Le fichier de schéma PSEntityProvision.xsd est disponible dans le kit de développement logiciel (SDK) Project 2013, dans le sous-répertoire `Documentation\Schemas\AppProvisioning`.</span><span class="sxs-lookup"><span data-stu-id="72fb6-146">The PSEntityProvision.xsd schema file is available in the Project 2013 SDK download, in the  `Documentation\Schemas\AppProvisioning` subdirectory.</span></span> <span data-ttu-id="72fb6-147">La Figure 2 illustre l’affichage de l’Explorateur de fichiers de schéma XML dans Visual Studio du schéma **PSEntityProvision**, où la séquence **LookupTable** est développée.</span><span class="sxs-lookup"><span data-stu-id="72fb6-147">Figure 2 shows the XML Schema Explorer view in Visual Studio of the **PSEntityProvision** schema, where the **LookupTable** sequence is expanded.</span></span> 
  
<span data-ttu-id="72fb6-148">**Figure 2. Affichage Visual Studio du schéma d’approvisionnement de l’entité Project Server**</span><span class="sxs-lookup"><span data-stu-id="72fb6-148">**Figure 2. Visual Studio view of the Project Server entity provisioning schema**</span></span>

<span data-ttu-id="72fb6-149">![Affichage du schéma d’entité Project Server](media/pj15_Programmability_EntitySchema.gif "Affichage du schéma d’entité Project Server")</span><span class="sxs-lookup"><span data-stu-id="72fb6-149">![View of the Project Server entity schema](media/pj15_Programmability_EntitySchema.gif "View of the Project Server entity schema")</span></span>
  
<span data-ttu-id="72fb6-p115">Les packages SharePoint qui installent des fonctionnalités Project Server peuvent contenir un ou plusieurs fichiers elements.xml qui suivent le schéma **PSEntityProvision**. Les entités Project Server d’un même fichier XML doivent apparaître dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="72fb6-p115">SharePoint packages that install features for Project Server can contain one or more elements.xml files that follow the **PSEntityProvision** schema. The Project Server entities in a single XML file must appear in the following order:</span></span> 
  
1. <span data-ttu-id="72fb6-152">Phases de flux de travail</span><span class="sxs-lookup"><span data-stu-id="72fb6-152">Workflow phases</span></span>
    
2. <span data-ttu-id="72fb6-153">Tables de recherche</span><span class="sxs-lookup"><span data-stu-id="72fb6-153">Lookup tables</span></span>
    
3. <span data-ttu-id="72fb6-154">Champs personnalisés</span><span class="sxs-lookup"><span data-stu-id="72fb6-154">Custom fields</span></span>
    
4. <span data-ttu-id="72fb6-155">Étapes du flux de travail</span><span class="sxs-lookup"><span data-stu-id="72fb6-155">Workflow stages</span></span>
    
5. <span data-ttu-id="72fb6-156">Types de projet d’entreprise</span><span class="sxs-lookup"><span data-stu-id="72fb6-156">Enterprise project types</span></span>
    
6. <span data-ttu-id="72fb6-157">Gestionnaires d'événements</span><span class="sxs-lookup"><span data-stu-id="72fb6-157">Event handlers</span></span>
    
<span data-ttu-id="72fb6-p116">Lorsque vous créez un package SharePoint qui contient des entités Project Server, il est possible de placer les définitions d’entité dans plusieurs fichiers elements.xml. Chaque fichier XML peut réussir la validation de schéma sans que les entités de l’intégralité du package ne soient dans l’ordre correct. Par exemple, une entité de champ personnalisé dans le premier fichier XML peut faire référence à une table de recherche dans le second fichier XML. Pendant l’installation, le champ personnalisé ne peut pas être créé, car la table de recherche n’a pas encore été créée.</span><span class="sxs-lookup"><span data-stu-id="72fb6-p116">When you create a SharePoint package that contains Project Server entities, it is possible to put the entity definitions in multiple elements.xml files. Each XML file could pass the schema validation, but the entities in the whole package might not be in the correct order. For example, a custom field entity in the first XML file could refer to a lookup table in the second XML file. During installation, the custom field cannot be created because the lookup table has not yet been created.</span></span>
  
<span data-ttu-id="72fb6-162">Si l’installation du package échoue, les objets créés restent dans Project Web App, mais le package ne s’installe pas complètement.</span><span class="sxs-lookup"><span data-stu-id="72fb6-162">If a package installation fails, objects that have been created remain in Project Web App, but the package does not install completely.</span></span> <span data-ttu-id="72fb6-163">La réinstallation du package peut fonctionner, mais ce n’est pas une bonne expérience pour les clients.</span><span class="sxs-lookup"><span data-stu-id="72fb6-163">Reinstalling the package can work, but that is not a good experience for customers.</span></span> <span data-ttu-id="72fb6-164">Lorsque les définitions d’entité s’étendent sur plusieurs fichiers elements.xml, organisez les entités Project Server dans l’ensemble du package SharePoint pour vous assurer que l’installation suit l’ordre correct.</span><span class="sxs-lookup"><span data-stu-id="72fb6-164">When the entity definitions span multiple elements.xml files, organize the Project Server entities in the entire SharePoint package to ensure that installation follows the correct order.</span></span> <span data-ttu-id="72fb6-165">Avec le schéma PSEntityProvision.xsd dans le téléchargement du kit de développement logiciel (SDK) Project 2013, il est possible de développer un outil qui vérifie l’ordre prescrit des entités dans les fichiers XML.</span><span class="sxs-lookup"><span data-stu-id="72fb6-165">With the PSEntityProvision.xsd schema in the Project 2013 SDK download, it is possible to develop a tool that checks for the prescribed order of entities in the XML files.</span></span>
  
## <a name="upgrading-applications-with-the-project-server-apis"></a><span data-ttu-id="72fb6-166">Mise à niveau d’application avec les API Project Server</span><span class="sxs-lookup"><span data-stu-id="72fb6-166">Upgrading applications with the Project Server APIs</span></span>
<span data-ttu-id="72fb6-167"><a name="pj15_Programmability_APIs"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-167"></span></span>

<span data-ttu-id="72fb6-p118">Lorsque vous mettez à niveau une application développée pour une version précédente de Project Server, vous pouvez choisir d’utiliser le modèle CSOM ou l’interface PSI pour une interface de programmation qui inclut des méthodes pour créer, lire, mettre à jour et supprimer des entités de projet (opérations CRUD). Bien que le modèle CSOM appelle en interne l’interface PSI, il ne remplace pas entièrement toutes les méthodes PSI. Pour les scénarios et les limitations de l’interface PSI et le modèle CSOM, consultez la page sur [les fonctionnalité de l’interface PSI](what-the-psi-does-and-does-not-do.md) et la page sur [les fonctionnalités du modèle CSOM](what-the-csom-does-and-does-not-do.md).</span><span class="sxs-lookup"><span data-stu-id="72fb6-p118">When you upgrade an application that was developed for a previous version of Project Server, you can choose to use either the CSOM or the PSI for a programmatic interface that includes methods to create, read, update, and delete project entities (the CRUD operations). Although the CSOM internally calls the PSI, it does not fully replace all PSI methods. For scenarios and limitations of the PSI and of the CSOM, see [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md) and [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="72fb6-171">Si le modèle CSOM inclut les fonctionnalités dont vous avez besoin, nous vous recommandons de mettre à niveau les applications pour qu’elles utilisent le modèle CSOM.</span><span class="sxs-lookup"><span data-stu-id="72fb6-171">If the CSOM includes the functionality you require, we recommend that you upgrade applications to use the CSOM.</span></span> <span data-ttu-id="72fb6-172">Le modèle CSOM permet aux applications d’être utilisées pour les installations locales et en ligne de Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-172">The CSOM enables applications to be used for both on-premises and online installations of Project Server 2013.</span></span> 
  
<span data-ttu-id="72fb6-173">Si votre application lit principalement des données à partir de Project Server, vous pouvez utiliser les vues et les tables de création de rapports dans la base de données Project Server pour un scénario local.</span><span class="sxs-lookup"><span data-stu-id="72fb6-173">If your application primarily reads data from Project Server, you can use the reporting tables and views in the Project Server database for an on-premises scenario.</span></span> <span data-ttu-id="72fb6-174">Si vous envisagez d’utiliser l’application avec Microsoft Project Online, vous pouvez utiliser le protocole OData pour le service **ProjectData**, qui permet un accès local et en ligne aux données de rapport.</span><span class="sxs-lookup"><span data-stu-id="72fb6-174">If you intend to use the application with Project Online, you can use the OData protocol for the **ProjectData** service, which provides both on-premises and online access to the reporting data.</span></span> <span data-ttu-id="72fb6-175">Pour plus d’informations, consultez la rubrique [ProjectData – Référence de service Project OData](https://docs.microsoft.com/en-us/previous-versions/office/project-odata/jj163015(v=office.15)).</span><span class="sxs-lookup"><span data-stu-id="72fb6-175">For more information, see [ProjectData - Project OData service reference](https://docs.microsoft.com/en-us/previous-versions/office/project-odata/jj163015(v=office.15))</span></span>
  
### <a name="using-the-psi"></a><span data-ttu-id="72fb6-176">Utilisation de l’interface PSI</span><span class="sxs-lookup"><span data-stu-id="72fb6-176">Using the PSI</span></span>
<span data-ttu-id="72fb6-177"><a name="pj15_Programmability_PSI"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-177"></span></span>

<span data-ttu-id="72fb6-178">L’interface PSI permet aux applications clientes de confiance totale, notamment Project Professionnel 2013, Project Web App et les applications métiers, d’accéder aux données Project Server dans une batterie de serveurs SharePoint.</span><span class="sxs-lookup"><span data-stu-id="72fb6-178">The PSI enables full-trust client applications, including Project Professional 2013, Project Web App, and LOB applications, to access Project Server data within a SharePoint farm.</span></span> <span data-ttu-id="72fb6-179">L’interface PSI est créée et utilisée avec .NET Framework 4 et offre des avantages comme un environnement de développement connu, une sécurité intégrée, la gestion des erreurs et le nettoyage de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="72fb6-179">The PSI is built and used with .NET Framework 4 and provides advantages such as a well-known development environment with built-in security, error handling, and garbage collection.</span></span>
  
<span data-ttu-id="72fb6-180">L’interface PSI est accessible par le biais des services WCF ou des services web ASMX.</span><span class="sxs-lookup"><span data-stu-id="72fb6-180">The PSI is accessed through WCF services or ASMX web services.</span></span> <span data-ttu-id="72fb6-181">L’interface ASMX est basée sur WCF.</span><span class="sxs-lookup"><span data-stu-id="72fb6-181">The ASMX interface is based on WCF.</span></span> <span data-ttu-id="72fb6-182">Chaque service PSI contient généralement une classe de base avec des méthodes CRUD pour les éléments au sein de cette classe.</span><span class="sxs-lookup"><span data-stu-id="72fb6-182">Each PSI service typically contains a base class with CRUD methods for items within that class.</span></span> <span data-ttu-id="72fb6-183">Les éléments sont spécifiés par les classes **DataSet** liées.</span><span class="sxs-lookup"><span data-stu-id="72fb6-183">Items are specified by related **DataSet** classes.</span></span> <span data-ttu-id="72fb6-184">Par exemple, le service **CustomFields** contient la classe **CustomFields** avec des méthodes telles que [CreateCustomFields2](https://docs.microsoft.com/previous-versions/office/ee767959(v=office.14)).</span><span class="sxs-lookup"><span data-stu-id="72fb6-184">For example, the **CustomFields** service contains the **CustomFields** class with methods such as [CreateCustomFields2](https://docs.microsoft.com/previous-versions/office/ee767959(v=office.14)) .</span></span> <span data-ttu-id="72fb6-185">Les données d’un ou de plusieurs champs personnalisés d’entreprise sont spécifiées dans **CustomFieldDataSet**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-185">Data for one or more enterprise custom fields are specified in the **CustomFieldDataSet**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="72fb6-186">L’interface des services web ASMX PSI est déconseillée dans Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-186">The ASMX web services interface of the PSI is deprecated in Project Server 2013.</span></span> <span data-ttu-id="72fb6-187">Bien que l’interface ASMX soit toujours disponible, les nouvelles applications qui utilisent l’interface PSI doivent utiliser l’interface WCF, ou si possible, les nouvelles applications doivent préférer le modèle CSOM.</span><span class="sxs-lookup"><span data-stu-id="72fb6-187">Although the ASMX interface is still available, new applications that use the PSI should use the WCF interface, or if possible, new applications should use the CSOM instead of the PSI.</span></span> <span data-ttu-id="72fb6-188">Les versions ultérieures de Project Server nécessitent une mise à niveau des applications ASMX existantes pour utiliser l’interface WCF de l’interface PSI ou le modèle CSOM.</span><span class="sxs-lookup"><span data-stu-id="72fb6-188">Future versions of Project Server will require an upgrade of existing ASMX-based applications to use the WCF interface of the PSI or to use the CSOM.</span></span> 
  
<span data-ttu-id="72fb6-189">Il existe 22 services PSI publics documentés qui sont dupliqués dans l’interface WCF et l’interface ASMX.</span><span class="sxs-lookup"><span data-stu-id="72fb6-189">There are 22 public, documented PSI services, which are duplicated in the WCF interface and the ASMX interface.</span></span> <span data-ttu-id="72fb6-190">L’interface PSI inclut également huit services privés et non documentés.</span><span class="sxs-lookup"><span data-stu-id="72fb6-190">The PSI also includes eight private, undocumented services.</span></span> <span data-ttu-id="72fb6-191">Project Web App et Project Professionnel utilisent les services PSI publics et les services PSI privés.</span><span class="sxs-lookup"><span data-stu-id="72fb6-191">Project Web App and Project Professional use the public PSI services and the private PSI services.</span></span> <span data-ttu-id="72fb6-192">L’interface PSI est généralement factorisée pour correspondre aux objets d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="72fb6-192">The PSI is generally factored to match the business objects.</span></span> <span data-ttu-id="72fb6-193">Autrement dit, chaque méthode PSI est associée à un objet d’entreprise tel que **Calendrier** ou **Ressource**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-193">That is, each PSI method is associated with a business object such as **Calendar** or **Resource**.</span></span> <span data-ttu-id="72fb6-194">L’interface PSI est l’interface principale pour les objets d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="72fb6-194">The PSI is the primary interface to the business objects.</span></span> <span data-ttu-id="72fb6-195">Étant donné que la couche métier fournit des composants de logique métier réutilisables, différentes applications qui interagissent avec les données Project Server utilisent la même logique métier.</span><span class="sxs-lookup"><span data-stu-id="72fb6-195">Because the business layer provides reusable business logic components, different applications that interact with Project Server data use the same business logic.</span></span>
  
<span data-ttu-id="72fb6-196">Les méthodes PSI qui interagissent de façon asynchrone avec Project Server ont des noms qui commencent par **Queue**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-196">PSI methods that asynchronously interact with Project Server have names that begin with **Queue**.</span></span> <span data-ttu-id="72fb6-197">Chaque méthode PSI est implémentée avec une interface distincte qui utilise des données fortement typées.</span><span class="sxs-lookup"><span data-stu-id="72fb6-197">Each PSI method is implemented with a separate interface that uses strongly typed data.</span></span> <span data-ttu-id="72fb6-198">Par exemple, la méthode **QueueCreateProject** du service **Project** accepte le paramètre _dataset_ de type **ProjectDataSet**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-198">For example, the **QueueCreateProject** method in the **Project** service accepts the  _dataset_ parameter of type **ProjectDataSet**.</span></span> <span data-ttu-id="72fb6-199">La classe **ProjectDataSet** est dérivée du type **DataSet**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-199">The **ProjectDataSet** class is derived from the **DataSet** type.</span></span> <span data-ttu-id="72fb6-200">La vérification du type dans .NET Framework et l’exécution IntelliSense dans Visual Studio permettent de réduire les erreurs de développement avec l’interface PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-200">Type checking in the .NET Framework and IntelliSense completion in Visual Studio help to reduce errors in development with the PSI.</span></span> <span data-ttu-id="72fb6-201">Pour une introduction à la documentation de référence détaillée des espaces de noms, classes, méthodes, propriétés, événements et assemblys connexes PSI, consultez la rubrique [Vue d’ensemble de la référence Project PSI](project-psi-reference-overview.md).</span><span class="sxs-lookup"><span data-stu-id="72fb6-201">For an introduction to the detailed reference for PSI namespaces, classes, methods, properties, events, and related assemblies, see [Project PSI reference overview](project-psi-reference-overview.md).</span></span>
  
<span data-ttu-id="72fb6-202">Project Server 2013 utilise la gestion des exceptions de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="72fb6-202">Project Server 2013 uses the exception handling of the .NET Framework.</span></span> <span data-ttu-id="72fb6-203">Toutes les erreurs sont journalisées dans le serveur, en haut de la pile PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-203">All errors are logged in the server, at the top of the PSI stack.</span></span> <span data-ttu-id="72fb6-204">Certaines erreurs envoient un simple rapport au client, comme un objet **SoapException** pour l’interface ASMX ou un objet **FaultException** pour l’interface WCF.</span><span class="sxs-lookup"><span data-stu-id="72fb6-204">Some errors send a simple report to the client, such as a **SoapException** object for the ASMX interface or a **FaultException** object for the WCF interface.</span></span> <span data-ttu-id="72fb6-205">Les exceptions peuvent être enregistrées dans le journal des événements d’application et certaines erreurs enregistrent également un rapport détaillé sur le serveur dans les journaux de suivi du service ULS (Unified Logging Service).</span><span class="sxs-lookup"><span data-stu-id="72fb6-205">Exceptions can be recorded in the application event log, and some errors also record a detailed report on the server in the Unified Logging Service (ULS) trace logs.</span></span> 
  
<span data-ttu-id="72fb6-p127">Pour les applications locales de confiance totale, l’interface PSI est également extensible. Vous pouvez ajouter un assembly .NET avec un service qui offre de nouvelles fonctionnalités, utilise la même infrastructure de sécurité Project Server et appelle les autres méthodes PSI ou hérite de classes PSI. Une extension PSI peut également fournir l’accès requis à la base de données et à la logique métier pour les nouvelles fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="72fb6-p127">For local full-trust applications, the PSI is also extensible. You can add a .NET assembly with a service that provides new functionality, uses the same Project Server security infrastructure, and calls other PSI methods or inherits from PSI classes. A PSI extension can also provide the business logic and database access required for new functionality.</span></span>
  
### <a name="using-the-csom"></a><span data-ttu-id="72fb6-209">Utilisation du modèle CSOM</span><span class="sxs-lookup"><span data-stu-id="72fb6-209">Using the CSOM</span></span>
<span data-ttu-id="72fb6-210"><a name="pj15_Programmability_CSOM"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-210"></span></span>

<span data-ttu-id="72fb6-211">Avec le modèle CSOM, vous pouvez développer des applications qui accèdent à Microsoft Project Online ou une installation Project Server 2013 locale.</span><span class="sxs-lookup"><span data-stu-id="72fb6-211">With the CSOM, you can develop apps that access Project Online or an on-premises Project Server 2013 installation.</span></span> <span data-ttu-id="72fb6-212">Les applications peuvent être distribuées dans un Office Store public ou dans un catalogue d’applications privé.</span><span class="sxs-lookup"><span data-stu-id="72fb6-212">Apps can be distributed in a public Office Store or a private app catalog.</span></span> <span data-ttu-id="72fb6-213">Le modèle CSOM est conçu pour être une API facile à utiliser qui consomme ou fournit directement les données par nom avec des requêtes LINQ, plutôt qu’en transmettant des jeux de données et en construisant des paramètres _changeXml_ ou des paramètres de _filtre_ XML.</span><span class="sxs-lookup"><span data-stu-id="72fb6-213">The CSOM is designed to be an easy-to-use API that directly consumes or provides data by name with LINQ queries, rather than by passing datasets and constructing  _changeXml_ parameters or XML  _filter_ parameters.</span></span> <span data-ttu-id="72fb6-214">Le modèle CSOM implémente les mêmes fonctionnalités principales que l’interface PSI pour les entités principales telles que **Project**, **Task**, **EnterpriseResource** et **Assignment**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-214">The CSOM implements the main functionality of the Project Server Interface (PSI) for the primary entities such as **Project**, **Task**, **EnterpriseResource**, and **Assignment**.</span></span> <span data-ttu-id="72fb6-215">Le modèle CSOM comprend de nombreuses autres entités telles que **CustomField**, **LookupTable**, **WorkflowActivities**, **EventHandler** et **QueueJob**, qui prennent en charge d’autres fonctionnalités courantes de Project Server .</span><span class="sxs-lookup"><span data-stu-id="72fb6-215">The CSOM includes many additional entities such as **CustomField**, **LookupTable**, **WorkflowActivities**, **EventHandler**, and **QueueJob**, which support other common Project Server functionality.</span></span>
  
<span data-ttu-id="72fb6-216">Il peut être utilisé en copiant les ressources suivantes sur votre ordinateur de développement local :</span><span class="sxs-lookup"><span data-stu-id="72fb6-216">The CSOM can be used by copying the following resources to your local development computer:</span></span>
  
- <span data-ttu-id="72fb6-217">Pour le développement .NET Framework 4, copiez l’assembly `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll`.</span><span class="sxs-lookup"><span data-stu-id="72fb6-217">For .NET Framework 4 development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll` assembly.</span></span> 
    
  <span data-ttu-id="72fb6-218">Pour la documentation des classes et des membres CSOM, consultez l’espace de noms [Microsoft.ProjectServer.Client](https://docs.microsoft.com/previous-versions/office/dn529530(v=office.15)).</span><span class="sxs-lookup"><span data-stu-id="72fb6-218">For documentation of the CSOM classes and members, see the [Microsoft.ProjectServer.Client](https://docs.microsoft.com/previous-versions/office/dn529530(v=office.15)) namespace.</span></span> <span data-ttu-id="72fb6-219">Pour un exemple d’application, consultez la rubrique [Prise en main de CSOM et .NET](getting-started-with-the-project-server-csom-and-net.md).</span><span class="sxs-lookup"><span data-stu-id="72fb6-219">For an example application, see [Getting started with the CSOM and .NET](getting-started-with-the-project-server-csom-and-net.md).</span></span>
    
- <span data-ttu-id="72fb6-220">Pour le développement de Microsoft Silverlight, copiez l’assembly `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll`.</span><span class="sxs-lookup"><span data-stu-id="72fb6-220">For Microsoft Silverlight development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll` assembly.</span></span> 
    
- <span data-ttu-id="72fb6-221">Pour développer des applications pour Windows Phone 8, copiez l’assembly `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll`.</span><span class="sxs-lookup"><span data-stu-id="72fb6-221">To develop apps for Windows Phone 8, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll` assembly.</span></span> 
    
- <span data-ttu-id="72fb6-222">Pour utiliser JavaScript pour le développement d’applications web et d’applications pour d’autres appareils, copiez les fichiers `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` et `PS.debug.js`.</span><span class="sxs-lookup"><span data-stu-id="72fb6-222">To use JavaScript for developing web apps and apps for other devices, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` file and the  `PS.debug.js` file.</span></span> <span data-ttu-id="72fb6-223">Pour un exemple d’application web, consultez la rubrique [Prise en main du modèle objet JavaScript Project Server 2013](getting-started-with-the-project-server-2013-javascript-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="72fb6-223">For an example web app, see [Getting started with the Project Server 2013 JavaScript object model](getting-started-with-the-project-server-2013-javascript-object-model.md).</span></span>
    
<span data-ttu-id="72fb6-224">Le modèle CSOM appelle en interne l’interface PSI. Par conséquent, si cette dernière ne peut pas effectuer une tâche, le modèle CSOM n’est pas en mesure de le faire non plus.</span><span class="sxs-lookup"><span data-stu-id="72fb6-224">The CSOM internally calls the PSI; therefore, if the PSI cannot do a job, neither can the CSOM.</span></span> <span data-ttu-id="72fb6-225">Pour les limitations du modèle CSOM, consultez la page sur [les fonctionnalités de l’interface CSOM](what-the-csom-does-and-does-not-do.md) et la page sur [les fonctionnalités du modèle PSI](what-the-psi-does-and-does-not-do.md).</span><span class="sxs-lookup"><span data-stu-id="72fb6-225">For limitations of the CSOM, see [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md) and [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md).</span></span> <span data-ttu-id="72fb6-226">Pour plus d’informations sur le développement avec le modèle CSOM, consultez les rubriques [Mises à jour pour les développeurs dans Project 2013](updates-for-developers-in-project-2013.md) et [Modèle CSOM pour Project 2013](client-side-object-model-csom-for-project-2013.md).</span><span class="sxs-lookup"><span data-stu-id="72fb6-226">For more information about developing with the CSOM, see [Updates for developers in Project 2013](updates-for-developers-in-project-2013.md) and [Client-side object model (CSOM) for Project 2013](client-side-object-model-csom-for-project-2013.md).</span></span>
  
### <a name="porting-applications-built-for-project-server-2003"></a><span data-ttu-id="72fb6-227">Portage des applications conçues pour Project Server 2003</span><span class="sxs-lookup"><span data-stu-id="72fb6-227">Porting applications built for Project Server 2003</span></span>
<span data-ttu-id="72fb6-228"><a name="pj15_Programmability_Porting2003"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-228"></span></span>

<span data-ttu-id="72fb6-p132">Dans Project Server 2003, de nombreuses données et fonctionnalités sont disponibles uniquement avec Project Professional 2003 ou par accès direct à la base de données. L’interface PSI, introduite dans Project Server 2007, supprime une grande partie de cette restriction. Contrairement au projet PDS (Project Data Service) dans Project Server 2003, l’interface PSI et le modèle CSOM fournissent des interfaces complètes aux objets d’entreprise dans Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-p132">In Project Server 2003, much data and functionality is available only with Project Professional 2003 or by direct database access. The PSI, introduced in Project Server 2007, removes much of that restriction. Unlike the Project Data Service (PDS) in Project Server 2003, the PSI and the CSOM provide comprehensive interfaces to business objects in Project Server.</span></span>
  
<span data-ttu-id="72fb6-p133">Les applications développées pour le service PDS ne sont pas compatibles avec les versions ultérieures de Project Server. Le modèle CSOM et l’interface PSI prévoient une parité fonctionnelle pour le service PDS, mais ne correspondent pas aux méthodes et paramètres PDS.</span><span class="sxs-lookup"><span data-stu-id="72fb6-p133">Applications developed for the PDS are not compatible with later versions of Project Server. The CSOM and the PSI provide functional parity for the PDS, but do not match PDS methods or parameters.</span></span>
  
> [!NOTE]
> <span data-ttu-id="72fb6-234">Étant donné que les applications PDS doivent être complètement repensées pour Project Server 2013, nous vous recommandons d’utiliser le modèle CSOM.</span><span class="sxs-lookup"><span data-stu-id="72fb6-234">Because PDS applications must be completely redesigned for Project Server 2013, we recommend that you use the CSOM.</span></span> 
  
<span data-ttu-id="72fb6-235">Pour plus d’informations sur la compatibilité PDS et des instructions sur le portage des extensions PDS vers l’interface PSI, consultez la rubrique [Parité PDS dans les services web PSI](https://docs.microsoft.com/previous-versions/office/developer/office-2007/ms197081(v=office.12)).</span><span class="sxs-lookup"><span data-stu-id="72fb6-235">For more information about PDS compatibility and guidelines for porting PDS extensions to the PSI, see [PDS Parity in PSI Web Services](https://docs.microsoft.com/previous-versions/office/developer/office-2007/ms197081(v=office.12)).</span></span>
  
### <a name="porting-applications-built-for-project-server-2007-and-project-server-2010"></a><span data-ttu-id="72fb6-236">Portage des applications conçues pour Project Server 2007 et Project Server 2010</span><span class="sxs-lookup"><span data-stu-id="72fb6-236">Porting applications built for Project Server 2007 and Project Server 2010</span></span>
<span data-ttu-id="72fb6-237"><a name="pj15_Programmability_Porting2007"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-237"></span></span>

<span data-ttu-id="72fb6-238">L’interface PSI dans Project Server 2013 est un sur-ensemble du modèle objet PSI dans Office Project Server 2007 et Project Server 2010.</span><span class="sxs-lookup"><span data-stu-id="72fb6-238">The PSI in Project Server 2013 is a superset of the PSI object model in Office Project Server 2007 and Project Server 2010.</span></span> <span data-ttu-id="72fb6-239">De nombreuses applications conçues pour les deux versions précédentes de Project Server continuent à travailler dans des installations locales de confiance totale de Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-239">Many applications built for the two previous versions of Project Server continue to work in local full-trust, on-premises installations of Project Server 2013.</span></span> <span data-ttu-id="72fb6-240">Toutefois, les types d’application suivants requièrent des mises à jour ou une nouvelle conception :</span><span class="sxs-lookup"><span data-stu-id="72fb6-240">However, the following kinds of applications require updates or redesign:</span></span>
  
- <span data-ttu-id="72fb6-241">Utilisez le modèle CSOM pour les applications qui sont adaptées à une utilisation avec Microsoft Project Online.</span><span class="sxs-lookup"><span data-stu-id="72fb6-241">Use the CSOM for applications that are adapted for use with Project Online.</span></span>
    
- <span data-ttu-id="72fb6-242">Utilisez le modèle CSOM pour les applications qui sont adaptées aux appareils mobiles et tablettes.</span><span class="sxs-lookup"><span data-stu-id="72fb6-242">Use the CSOM for applications that are adapted for use on mobile devices and tablet computers.</span></span>
    
- <span data-ttu-id="72fb6-243">Utilisez le modèle CSOM pour les applications disponibles dans Office Store ou dans un catalogue d’applications privé.</span><span class="sxs-lookup"><span data-stu-id="72fb6-243">Use the CSOM for applications that are available as apps in the Office Store or a private app catalog.</span></span>
    
- <span data-ttu-id="72fb6-244">Pour les applications qui modifient la planification de projets, utilisez le modèle CSOM ou modifiez l’application pour qu’elle utilise la méthode PSI [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)).</span><span class="sxs-lookup"><span data-stu-id="72fb6-244">For applications that modify project scheduling, use the CSOM, or change the application to use the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) PSI method.</span></span> 
    
- <span data-ttu-id="72fb6-245">Les applications web ou locales qui connectent les utilisateurs à différentes instances de Project Web App doivent utiliser les paramètres de programmation pour les points de terminaison WCF du modèle CSOM ou de l’interface PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-245">Local or web applications that log on users to different instances of Project Web App should use programmatic settings for WCF endpoints of the CSOM or the PSI.</span></span> <span data-ttu-id="72fb6-246">Les méthodes sont déconseillées.</span><span class="sxs-lookup"><span data-stu-id="72fb6-246">The methods are deprecated.</span></span> <span data-ttu-id="72fb6-247">Les applications doivent utiliser l’authentification OAuth à la place de l’authentification par formulaire et pour une utilisation avec Microsoft Project Online.</span><span class="sxs-lookup"><span data-stu-id="72fb6-247">Apps should use OAuth authentication in place of Forms authentication and for use with Project Online.</span></span> <span data-ttu-id="72fb6-248">Pour plus d’informations, consultez la rubrique [Autorisation et authentification pour les applications dans SharePoint 2013](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/authorization-and-authentication-of-sharepoint-add-ins).</span><span class="sxs-lookup"><span data-stu-id="72fb6-248">For more information, see [Authorization and authentication for apps in SharePoint 2013](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/authorization-and-authentication-of-sharepoint-add-ins).</span></span>
    
- <span data-ttu-id="72fb6-249">Les applications qui s’appuient sur des paramètres de sécurité Project Server spécifiques ou en modifient.</span><span class="sxs-lookup"><span data-stu-id="72fb6-249">Applications that rely on or modify specific Project Server security settings.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="72fb6-250">Une installation par défaut locale de Project Server 2013 utilise le mode d’autorisation SharePoint, où les paramètres de sécurité Project Server ne sont pas accessibles par le biais de l’interface PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-250">A default on-premises installation of Project Server 2013 uses the SharePoint permission mode, where Project Server security settings are not accessible through the PSI.</span></span> <span data-ttu-id="72fb6-251">Pour modifier le mode d’autorisation Project, consultez la section *Mode d’autorisation SharePoint* de la page [Nouveautés pour les professionnels de l’informatique dans Project Server 2013](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016).</span><span class="sxs-lookup"><span data-stu-id="72fb6-251">To change to the Project permission mode, see the  *SharePoint Permission Mode*  section in [What's new for IT pros in Project Server 2013](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016).</span></span> 
  
- <span data-ttu-id="72fb6-252">Pour de nombreux flux de travail Project Server personnalisés, vous pouvez utiliser SharePoint Designer 2013 pour créer des flux de travail déclaratifs.</span><span class="sxs-lookup"><span data-stu-id="72fb6-252">For many custom Project Server workflows, you can use SharePoint Designer 2013 to create declarative workflows.</span></span> <span data-ttu-id="72fb6-253">Pour les flux de travail personnalisés qui nécessitent une programmation supplémentaire, vous ne devez *pas* utiliser directement des classes ou des membres dans l’espace de noms **Microsoft.Office.Project.Server.Workflow**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-253">For custom workflows that require additional programming, you should  *not*  directly use classes or members in the **Microsoft.Office.Project.Server.Workflow** namespace.</span></span> <span data-ttu-id="72fb6-254">Au lieu de cela, utilisez la classe [Microsoft.ProjectServer.Client.WorkflowActivities](https://docs.microsoft.com/previous-versions/office/mt780562(v=office.15)) dans le modèle CSOM.</span><span class="sxs-lookup"><span data-stu-id="72fb6-254">Instead, use the [Microsoft.ProjectServer.Client.WorkflowActivities](https://docs.microsoft.com/previous-versions/office/mt780562(v=office.15)) class in the CSOM.</span></span> 
    
- <span data-ttu-id="72fb6-255">En règle générale, les applications qui utilisent l’emprunt d’identité doivent être réécrites pour utiliser l’interface WCF PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-255">In general, applications that use impersonation should be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="72fb6-256">Les applications qui effectuent des mises à jour de statut simples pour les autres utilisateurs ne requièrent pas d’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="72fb6-256">Applications that do simple status updates for other users do not require impersonation.</span></span> <span data-ttu-id="72fb6-257">Ils peuvent utiliser la méthode [StatusAssignment.SubmitStatusUpdates](https://docs.microsoft.com/previous-versions/office/project-class/jj235883(v=office.15)) dans le modèle CSOM ou la méthode [Statusing.SubmitStatusForResource](https://docs.microsoft.com/previous-versions/office/ee755393(v=office.14)) dans l’interface PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-257">They can use the [StatusAssignment.SubmitStatusUpdates](https://docs.microsoft.com/previous-versions/office/project-class/jj235883(v=office.15)) method in the CSOM or the [Statusing.SubmitStatusForResource](https://docs.microsoft.com/previous-versions/office/ee755393(v=office.14)) method in the PSI.</span></span> 
    
- <span data-ttu-id="72fb6-258">Les composants intergiciels qui s’exécutent sur l’ordinateur Project Server peuvent être installés uniquement pour une utilisation en local et doivent utiliser l’interface WCF PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-258">Middleware components that run on the Project Server computer can be installed only for on-premises use, and must use the WCF interface of the PSI.</span></span> <span data-ttu-id="72fb6-259">Par exemple, un composant intergiciel qui utilise l’interface ASMX pour échanger des données entre Project Web App en local et une application de feuille de temps externe doit être réécrit pour utiliser l’interface WCF PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-259">For example, a middleware component that uses the ASMX interface to exchange data between Project Web App on-premises and an external timesheet application would have to be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="72fb6-260">Pour fonctionner avec Microsoft Project Online, le composant doit être repensé sous la forme d’une application et utiliser le modèle CSOM.</span><span class="sxs-lookup"><span data-stu-id="72fb6-260">To work with Project Online, the component would have to be redesigned as an app and use the CSOM.</span></span>
    
### <a name="migration-and-compatibility-of-custom-solutions"></a><span data-ttu-id="72fb6-261">Migration et compatibilité des solutions personnalisées</span><span class="sxs-lookup"><span data-stu-id="72fb6-261">Migration and compatibility of custom solutions</span></span>
<span data-ttu-id="72fb6-262"><a name="pj15_Programmability_CustomSolutions"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-262"></span></span>

<span data-ttu-id="72fb6-263">Les classes et membres des interfaces publiques ASMX et WCF PSI sont identiques.</span><span class="sxs-lookup"><span data-stu-id="72fb6-263">Classes and members in the public ASMX and WCF interfaces of the PSI are identical.</span></span> <span data-ttu-id="72fb6-264">Toutefois, le nombre de colonnes et la taille des tables de données utilisées ou renvoyées par les méthodes PSI peuvent être différents entre Project Server 2013 et les deux versions précédentes de Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-264">But, the number of columns and size of datatables used or returned by PSI methods can be different between Project Server 2013 and the two previous Project Server versions.</span></span> <span data-ttu-id="72fb6-265">Il existe également des différences entre les vues et les tables de création de rapports en comparaison avec la base de données de création de rapports des versions précédentes.</span><span class="sxs-lookup"><span data-stu-id="72fb6-265">There are also differences in the reporting tables and views, compared with the Reporting database in previous versions.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="72fb6-266">Nous vous recommandons vivement de tester les solutions sur une installation hors production de Project Server 2013 avant de les déployer sur un serveur de production.</span><span class="sxs-lookup"><span data-stu-id="72fb6-266">We strongly recommend that you thoroughly test solutions on a non-production installation of Project Server 2013 before deploying them to a production server.</span></span> 
  
<span data-ttu-id="72fb6-267">Lorsque vous migrez une solution vers Project Server 2013 ou qu’une solution ne fonctionne pas comme prévu, vous devez au minimum procéder comme suit :</span><span class="sxs-lookup"><span data-stu-id="72fb6-267">When you migrate a solution to Project Server 2013, or if a solution does not work as expected, you should at a minimum do the following:</span></span>
  
- <span data-ttu-id="72fb6-268">Mettez à jour la solution en l’ouvrant dans Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="72fb6-268">Update the solution by opening it in Visual Studio 2012.</span></span> <span data-ttu-id="72fb6-269">Certaines solutions peuvent également utiliser Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="72fb6-269">Some solutions can also use Visual Studio 2010.</span></span>
    
- <span data-ttu-id="72fb6-270">Modifiez la cible sur .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="72fb6-270">Change the target to .NET Framework 4.</span></span>
    
- <span data-ttu-id="72fb6-271">Modifiez les références d’assembly pour qu’elles utilisent les assemblys Project Server 2013, tels que Microsoft.Office.Project.Server.Library.dll et Microsoft.Office.Project.Server.Events.Receivers.dll.</span><span class="sxs-lookup"><span data-stu-id="72fb6-271">Change assembly references to use the Project Server 2013 assemblies, such as Microsoft.Office.Project.Server.Library.dll and Microsoft.Office.Project.Server.Events.Receivers.dll.</span></span>
    
- <span data-ttu-id="72fb6-272">Dressez la liste des références web ASMX ou des références de services WCF et des espaces de noms et supprimez les références Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-272">Make a list of the ASMX web references or the WCF service references and namespace names, and then delete the Project Server references.</span></span>
    
- <span data-ttu-id="72fb6-273">Ajoutez l’assembly de proxy ProjectServerServices.dll que vous pouvez générer à partir des fichiers WCF proxy sources dans le téléchargement du kit de développement logiciel (SDK) Project Server 2013 ou ajoutez les fichiers proxy sources pour les services WCF requis.</span><span class="sxs-lookup"><span data-stu-id="72fb6-273">Add the ProjectServerServices.dll proxy assembly that you can build from the WCF proxy source files in the Project 2013 SDK download, or add the proxy source files for the required WCF services.</span></span> <span data-ttu-id="72fb6-274">Pour les services ASMX, ajoutez à nouveau les références de service web ASMX frontales en utilisant les mêmes noms d’espace de noms ; ou ajoutez l’assembly de proxy ProjectServerServices.dll que vous pouvez générer à partir des sources WSDL dans le téléchargement du kit de développement logiciel (SDK) Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-274">For ASMX services, add the front-end ASMX web service references again, by using the same namespace names; or add the ProjectServerServices.dll proxy assembly that you can build from the WSDL sources in the Project 2013 SDK download.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="72fb6-275">Dans le téléchargement du kit de développement logiciel (SDK) Project Server 2013, les espaces de noms des fichiers proxy sources commencent tous par *Svc*.</span><span class="sxs-lookup"><span data-stu-id="72fb6-275">In the Project 2013 SDK download, the namespaces in the proxy source files all start with  *Svc*  .</span></span> <span data-ttu-id="72fb6-276">Par exemple, l’espace de noms de service **Resource** dans le fichier proxy WCF et le fichier proxy ASMX est **SvcResource**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-276">For example, the **Resource** service namespace in the WCF proxy file and in the ASMX proxy file is **SvcResource**.</span></span> <span data-ttu-id="72fb6-277">> Si votre application utilise différents noms d’espaces de noms, vous pouvez recompiler l’assembly de proxy pour utiliser vos espaces de noms. Vous pouvez également modifier les espaces de noms PSI dans votre application.</span><span class="sxs-lookup"><span data-stu-id="72fb6-277">> If your application uses different namespace names, you can either recompile the proxy assembly to use your namespaces, or change the PSI namespaces in your application.</span></span> <span data-ttu-id="72fb6-278">Par exemple, vous pouvez modifier le script CompileWCFProxyAssembly.cmd et recompiler ProjectServerServices.dll à partir des fichiers proxy sources du téléchargement du kit de développement logiciel (SDK).</span><span class="sxs-lookup"><span data-stu-id="72fb6-278">For example, you can modify the CompileWCFProxyAssembly.cmd script and recompile ProjectServerServices.dll from the proxy source files in the SDK download.</span></span> 
  
- <span data-ttu-id="72fb6-279">Si vous passez de l’interface ASMX PSI à l’interface WCF, vous pouvez initialiser les classes clientes par programme ou à l’aide de points de terminaison WCF dans app.config. Utilisez l’initialisation par programme lorsque vous avez besoin de passer rapidement à des instances distinctes de Project Web App ou lorsque vous développez un composant WebPart qui utilise l’interface PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-279">If you change from using the ASMX interface of the PSI to the WCF interface, you can initialize the client classes either programmatically or by using WCF endpoints in app.config. Use programmatic initialization when you have to quickly switch to different instances of Project Web App, or when you are developing a web part that uses the PSI.</span></span>
    
- <span data-ttu-id="72fb6-280">Il existe plusieurs nouvelles méthodes et jeux de données dans les services PSI dans Project Server 2013 et certaines classes **DataRow** contiennent de nouvelles propriétés.</span><span class="sxs-lookup"><span data-stu-id="72fb6-280">There are several new methods and datasets in the PSI services in Project Server 2013 and some **DataRow** classes contain new properties.</span></span> <span data-ttu-id="72fb6-281">Par exemple, la méthode [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) de l’interface PSI utilise le moteur de planification Project Server pour replanifier un projet mis à jour sans avoir à ouvrir le projet dans Project Professionnel 2013, et permet également d’ajouter ou de supprimer des entités de projet dans le même appel.</span><span class="sxs-lookup"><span data-stu-id="72fb6-281">For example, the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) method in the PSI uses the Project Server scheduling engine to reschedule an updated project without you having to open the project in Project Professional 2013, and also allows adding or deleting project entities in the same call.</span></span> 
    
- <span data-ttu-id="72fb6-282">Compilez et testez la solution.</span><span class="sxs-lookup"><span data-stu-id="72fb6-282">Compile and test the solution.</span></span>
    
## <a name="project-scheduling-on-the-server"></a><span data-ttu-id="72fb6-283">Planification de projets sur le serveur</span><span class="sxs-lookup"><span data-stu-id="72fb6-283">Project scheduling on the server</span></span>
<span data-ttu-id="72fb6-284"><a name="pj15_Programmability_Scheduling"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-284"></span></span>

<span data-ttu-id="72fb6-285">Project Server 2013 a deux moteurs de planification.</span><span class="sxs-lookup"><span data-stu-id="72fb6-285">Project Server 2013 has two scheduling engines.</span></span> <span data-ttu-id="72fb6-286">Le moteur de planification le plus récent est le même que le moteur de planification dans Project Professionnel 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-286">The newer scheduling engine is the same as the scheduling engine in Project Professional 2013.</span></span> <span data-ttu-id="72fb6-287">Lorsque vous apportez des modifications à la planification et que vous les publiez à l’aide du composant WebPart Planification (page de détails du projet) dans Project Web App ou un site de projet, ou à l’aide du modèle CSOM, le calcul des dates, les coûts, la durée, le travail restant, les références et les autres modifications liées à la planification sont les mêmes que si vous apportez les modifications et publiez le projet à l’aide de Project Professionnel 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-287">When you make scheduling changes and publish the changes by using the Scheduling web part (Project Details page) in Project Web App or a project site, or by using the CSOM, the calculation of dates, costs, duration, remaining work, baselines, and other changes related to scheduling are the same as if you made the changes and published the project by using Project Professional 2013.</span></span> <span data-ttu-id="72fb6-288">Toutefois, à l’exception de la méthode [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)), les méthodes PSI utilisent le moteur de planification plus ancien qui a migré à partir de Project Server 2010.</span><span class="sxs-lookup"><span data-stu-id="72fb6-288">However, except for the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) method, PSI methods use the older scheduling engine that was migrated from Project Server 2010.</span></span> <span data-ttu-id="72fb6-289">Cela permet de garantir que les applications héritées fonctionnent de la même façon qu’auparavant dans Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-289">The reason is to ensure that legacy applications behave the same in Project Server 2013 as they previously did.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="72fb6-290">Pour utiliser le moteur de planification mis à jour dans Project Server 2013, les applications peuvent utiliser le modèle CSOM.</span><span class="sxs-lookup"><span data-stu-id="72fb6-290">To use the updated scheduling engine in Project Server 2013, applications can use the CSOM.</span></span> 
  
<span data-ttu-id="72fb6-291">Les deux moteurs (ancien et nouveau) de planification possèdent les restrictions suivantes :</span><span class="sxs-lookup"><span data-stu-id="72fb6-291">Both the older and the newer scheduling engines have the following limitations:</span></span>
  
- <span data-ttu-id="72fb6-292">**Planification d’un seul projet** La planification affecte uniquement le projet actuel, lorsque des modifications sont apportées par le biais des mises à jour de l’état des tâches avec l’interface PSI ou le modèle CSOM ou avec Project Web App.</span><span class="sxs-lookup"><span data-stu-id="72fb6-292">**Single project scheduling only** Scheduling affects only the current project, when changes are made through task status updates with the PSI or the CSOM, or with Project Web App.</span></span> <span data-ttu-id="72fb6-293">Si le projet actuel comporte des liens vers d’autres projets, sous-projets ou projets maîtres, les projets liés ne sont pas modifiés.</span><span class="sxs-lookup"><span data-stu-id="72fb6-293">If the current project has links to other projects, subprojects, or master projects, the linked projects are not changed.</span></span> 
    
- <span data-ttu-id="72fb6-294">**Tâches récapitulatives** Les tâches récapitulatives sont généralement en lecture seule sur Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-294">**Summary tasks** Summary tasks are generally read-only on Project Server.</span></span> <span data-ttu-id="72fb6-295">Par exemple, les affectations pour les tâches récapitulatives ne peuvent pas être créées et le pourcentage d’achèvement ne peut pas être modifié.</span><span class="sxs-lookup"><span data-stu-id="72fb6-295">For example, assignments for summary tasks cannot be created, and percent completion cannot be modified.</span></span> <span data-ttu-id="72fb6-296">Toutefois, Project Server prend en charge la modification des dates et de la durée des tâches récapitulatives planifiées manuellement.</span><span class="sxs-lookup"><span data-stu-id="72fb6-296">However, Project Server does support editing the dates and duration of manually scheduled summary tasks.</span></span> 
    
    <span data-ttu-id="72fb6-p148">Les données réelles dans Project Server ne sont pas ajoutées automatiquement à une affectation de tâche récapitulative, car cela contournerait le processus d’approbation dans Project Server. Dans Project Professionnel, lorsque vous ajoutez des données réelles à une tâche subordonnée, ces données sont également ajoutées pour une affectation sur la tâche récapitulative. La différence de comportement peut être source de confusion pour un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="72fb6-p148">Actuals on Project Server are not added automatically to a summary task assignment, because that would bypass the approval process in Project Server. In Project Professional, when you add actuals to a subtask, the actuals are also added for an assignment on the summary task. The difference in behavior can be confusing for a user.</span></span>
    
    <span data-ttu-id="72fb6-300">Project Server supprime les données réelles sur une affectation de tâche récapitulative si la durée de la tâche subordonnée diminue ou si la date de fin est modifiée.</span><span class="sxs-lookup"><span data-stu-id="72fb6-300">Project Server deletes actuals on a summary task assignment if the subtask duration shortens or the finish date is changed.</span></span>
    
    > [!CAUTION]
    > <span data-ttu-id="72fb6-301">Bien que Project Professionnel puisse le faire, nous vous recommandons de ne pas émettre d’affectations sur les tâches récapitulatives.</span><span class="sxs-lookup"><span data-stu-id="72fb6-301">Although Project Professional can do it, we recommend that you do not make assignments on summary tasks.</span></span> 
  
<span data-ttu-id="72fb6-302">Voici les problèmes et limitations de la programmation PSI avec l’ancien moteur de planification Project Server :</span><span class="sxs-lookup"><span data-stu-id="72fb6-302">Following are issues and limitations of PSI programming with the older Project Server scheduling engine:</span></span>
  
- <span data-ttu-id="72fb6-303">**Modification de l’état actif d’une tâche** L’ancien moteur de planification Project Server peut afficher des heures de début et de fin incohérentes lorsque vous utilisez la méthode [QueueUpdateProject](https://docs.microsoft.com/en-us/previous-versions/office/ms471014(v=office.14)) pour modifier l’état actif d’une tâche, s’il y a plusieurs modifications dans l’objet **ProjectDataSet** pour le paramètre _dataset_.</span><span class="sxs-lookup"><span data-stu-id="72fb6-303">**Changing the active status of a task** The older Project Server scheduling engine can show inconsistent start or finish times when you use the [QueueUpdateProject](https://docs.microsoft.com/en-us/previous-versions/office/ms471014(v=office.14)) method to change the active status of a task, if there are multiple changes in the **ProjectDataSet** object for the  _dataset_ parameter.</span></span> <span data-ttu-id="72fb6-304">Si la propriété **TASK_IS_ACTIVE** est la seule modification du paramètre _dataset_ de **QueueUpdateProject**, vous pouvez mettre à jour le projet.</span><span class="sxs-lookup"><span data-stu-id="72fb6-304">If the **TASK_IS_ACTIVE** property is the only change in the  _dataset_ parameter of **QueueUpdateProject**, you can update the project.</span></span>
    
    <span data-ttu-id="72fb6-305">Pour plus d’informations sur les tâches inactives et l’ancien moteur de planification, consultez les billets de blog sur la [présentation des tâches inactives dans Project 2010](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx) et [Project Server 2010 : Planification sur le web, l’interface PSI et Project Professionnel](https://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0).</span><span class="sxs-lookup"><span data-stu-id="72fb6-305">For more information about inactive tasks and the older scheduling engine, see the blog articles [Introducing inactive tasks in Project 2010](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx) and [Project Server 2010: Scheduling on the web, the PSI and Project Professional](https://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0).</span></span> <span data-ttu-id="72fb6-306">Pour une comparaison de la planification dans Project Professionnel 2010 et Project Web App dans Project Server 2010, reportez-vous à la rubrique [Comparaison de la gestion de la planification basée sur le Web](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/).</span><span class="sxs-lookup"><span data-stu-id="72fb6-306">For a comparison of scheduling in Project Professional 2010 and Project Web App in Project Server 2010, see [Web-based schedule management comparison](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/).</span></span>
    
- <span data-ttu-id="72fb6-307">**Valeur acquise non calculée** L’ancien moteur de planification ne calcule pas les champs de valeur acquise : CRTE, BAA, VA, CBTP, IPC, VC, VC%, EAA, IPE, ED, ED%, IPAA, VAA, Variation de durée, Variation de début, Variation de fin, Variation de coût et Variation de travail.</span><span class="sxs-lookup"><span data-stu-id="72fb6-307">**Earned value not calculated** The older scheduling engine does not calculate the earned value fields: ACWP, BAC, BCWP, BCWS, CPI, CV, CV%, EAC, SPI, SV, SV%, TCPI, VAC, Duration Variance, Start Variance, Finish Variance, Cost Variance, and Work Variance.</span></span> <span data-ttu-id="72fb6-308">Si un projet comporte des valeurs pour ces champs et qu’il est mis à jour à l’aide de la méthode **QueueUpdateProject**, les valeurs de champ ne changent pas.</span><span class="sxs-lookup"><span data-stu-id="72fb6-308">If a project has values for these fields and the project is updated by using the **QueueUpdateProject** method, the field values do not change.</span></span> <span data-ttu-id="72fb6-309">Pour éviter ce problème, utilisez la méthode **QueueUpdateProject2**.</span><span class="sxs-lookup"><span data-stu-id="72fb6-309">To avoid the problem, use the **QueueUpdateProject2** method.</span></span> 
    
<span data-ttu-id="72fb6-310">Vous pouvez gérer les limitations de la planification PSI des façons suivantes :</span><span class="sxs-lookup"><span data-stu-id="72fb6-310">You can handle the PSI scheduling limitations in the following ways:</span></span>
  
- <span data-ttu-id="72fb6-311">Si le modèle CSOM possède les méthodes que requiert l’application, utilisez-le au lieu de l’interface PSI.</span><span class="sxs-lookup"><span data-stu-id="72fb6-311">If the CSOM has the methods the application requires, use the CSOM instead of the PSI.</span></span>
    
- <span data-ttu-id="72fb6-312">Ouvrez des projets dans Project Professionnel et réenregistrez-les sur Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-312">Open projects in Project Professional and save them back to Project Server.</span></span>
    
- <span data-ttu-id="72fb6-313">Dans les rapports, n’incluez pas les champs que l’interface PSI ne met pas à jour.</span><span class="sxs-lookup"><span data-stu-id="72fb6-313">In reports, do not include fields that the PSI does not update.</span></span>
    
- <span data-ttu-id="72fb6-314">Ajoutez une note dans les rapports au sujet des données qui peuvent être obsolètes.</span><span class="sxs-lookup"><span data-stu-id="72fb6-314">Add a note in reports about data that may be stale.</span></span>
    
<span data-ttu-id="72fb6-p152">Il existe des indicateurs dans les tables de création de rapports et les cubes qui vous aident à détecter lorsque certaines données de projet ne sont pas mises à jour. Les données de rapport dans la table MSP_EpmProject et dans MSP_EpmProject_UserView comprennent les champs suivants : </span><span class="sxs-lookup"><span data-stu-id="72fb6-p152">There are flags in the reporting tables and the cubes that help you detect when some project data is not updated. The reporting data in the MSP_EpmProject table and in MSP_EpmProject_UserView includes the following fields:</span></span> 
  
-  <span data-ttu-id="72fb6-317">_ProjectWbsIsStale_ &ndash; Indique si la structure de répartition du travail (structure de plan de la tâche) est obsolète.</span><span class="sxs-lookup"><span data-stu-id="72fb6-317">_ProjectWbsIsStale_ &ndash; Indicates whether the work breakdown structure (task outline hierarchy) is stale.</span></span> 
    
-  <span data-ttu-id="72fb6-318">_ProjectEarnedValueIsStale_ &ndash; Indique si les champs de valeur acquise sont obsolètes.</span><span class="sxs-lookup"><span data-stu-id="72fb6-318">_ProjectEarnedValueIsStale_ &ndash; Indicates the earned value fields are stale.</span></span> 
    
-  <span data-ttu-id="72fb6-319">_ProjectRollupsAreStale_ &ndash; Indique qu’un sous-projet est mis à jour dans l’ébauche de base de données, mais que le projet maître ne l’est pas.</span><span class="sxs-lookup"><span data-stu-id="72fb6-319">_ProjectRollupsAreStale_ &ndash; Indicates that a subproject is updated in the draft database, but the master project is not updated.</span></span> <span data-ttu-id="72fb6-320">Les valeurs répétées du sous-projet sont obsolètes.</span><span class="sxs-lookup"><span data-stu-id="72fb6-320">The rolled-up values from the subproject are stale.</span></span> 
    
-  <span data-ttu-id="72fb6-321">_ProjectHierarchyNotSynchronized_ &ndash; Le projet maître n’est pas synchronisé avec ses enfants.</span><span class="sxs-lookup"><span data-stu-id="72fb6-321">_ProjectHierarchyNotSynchronized_ &ndash; The master project is not synchronized with its children.</span></span> <span data-ttu-id="72fb6-322">Cela se produit lorsque les projets enfants sont publiés explicitement, et pas dans le cadre de la publication du projet maître.</span><span class="sxs-lookup"><span data-stu-id="72fb6-322">This happens when the child projects are published explicitly, not as part of the master project publishing.</span></span> 
    
-  <span data-ttu-id="72fb6-323">_ProjectCalculationsAreStale_ &ndash; Project Professionnel a enregistré un projet sans calculer la planification (autrement dit, le mode de calcul est défini sur **Manuel** sous l’onglet **Planifier** de la boîte de dialogue **Options de Project**).</span><span class="sxs-lookup"><span data-stu-id="72fb6-323">_ProjectCalculationsAreStale_ &ndash; Project Professional saved a project without calculating the schedule (that is, the calculation mode is set to **Manual** on the **Schedule** tab in the **Project Options** dialog box).</span></span> 
    
-  <span data-ttu-id="72fb6-324">_ProjectGhostTaskAreStale_ &ndash; Similaire à l’option _ProjectHierarchyNotSynchronized_, mais vous avertit en cas de données de liaisons entre projets.</span><span class="sxs-lookup"><span data-stu-id="72fb6-324">_ProjectGhostTaskAreStale_ &ndash; Similar to  _ProjectHierarchyNotSynchronized_, but warns on cross-project link data.</span></span> <span data-ttu-id="72fb6-325">Il est possible qu’aucun projet maître n’existe, mais les données de projet sur un côté du lien sont plus récentes que celles de l’autre côté.</span><span class="sxs-lookup"><span data-stu-id="72fb6-325">It is possible that no master project exists, but the project data on one side of the link is newer than on the other side.</span></span>
    
## <a name="about-accessing-the-project-server-database"></a><span data-ttu-id="72fb6-326">À propos de l’accès à la base de données Project Server</span><span class="sxs-lookup"><span data-stu-id="72fb6-326">About accessing the Project Server database</span></span>
<span data-ttu-id="72fb6-327"><a name="pj15_Programmability_Databases"> </a></span><span class="sxs-lookup"><span data-stu-id="72fb6-327"></span></span>

<span data-ttu-id="72fb6-328">Si vous disposez des autorisations dans Microsoft SQL Server pour accéder à la base de données Project Server, vous pouvez lire les vues et les tables de création de rapports.</span><span class="sxs-lookup"><span data-stu-id="72fb6-328">If you have permissions in Microsoft SQL Server to access the Project Server database, you can read the reporting tables and views.</span></span> <span data-ttu-id="72fb6-329">Si vous disposez des autorisations Project Server nécessaires, vous pouvez également lire des données dans les tables de création de rapports à l’aide de requêtes OData.</span><span class="sxs-lookup"><span data-stu-id="72fb6-329">If you have the necessary Project Server permissions, you can also read data from the reporting tables by using OData queries.</span></span> <span data-ttu-id="72fb6-330">Il est fortement déconseillé aux développeurs d’accéder directement aux tables provisoires, publiées ou archivées par le biais de requêtes SQL Server dans la base de données Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-330">Developers are strongly discouraged from directly accessing the draft, published, or archive tables through SQL Server queries in the Project Server database.</span></span> <span data-ttu-id="72fb6-331">Apporter des modifications directes à une des tables de la base de données Project Server peut endommager l’intégrité référentielle et interférer avec l’accès de base de données par le biais du service Mise en file d’attente de Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-331">Making direct changes in any of the tables in the Project Server database can damage referential integrity and interfere with database access through the Project Server Queuing Service.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="72fb6-p157">Rien ne vous empêche d’utiliser l’accès direct à la base de données par programme pour mettre à jour les données. Vous devez être conscient que le cache Project Professionnel, les tables publiées et les tables de création de rapports reposent sur un protocole de synchronisation de cache qui peut être perturbé par la modification directe de données. Toutefois, si vous endommagez vos bases de données Project Server ou les caches côté client Project Professionnel suite à un accès direct pour modifier les données, notez que le support technique ne sera pas en mesure de vous aider.</span><span class="sxs-lookup"><span data-stu-id="72fb6-p157">There is nothing to actively prevent you from using direct programmatic database access to update data. You should be aware that the Project Professional cache, the published tables, and the reporting tables all rely on a cache synchronization protocol that can be disrupted by direct data editing. If you damage your Project Server database or corrupt Project Professional client-side caches by using direct access to change data, be warned that product support won't be able to help!</span></span> 
  
<span data-ttu-id="72fb6-335">Les applications qui accèdent directement aux vues et tables provisoires, publiées ou archivées dépendent aussi des schémas de base de données, ce qui peut changer dans les Service Packs ou versions ultérieures de Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-335">Applications that directly access the draft, published, or archive tables and views are also dependent on the database schemas, which can change in service packs or later versions of Project Server 2013.</span></span> <span data-ttu-id="72fb6-336">Les applications qui accèdent directement aux bases de données perdent également la sécurité Project Server intégrée, la logique métier commune, le suivi, les audits, la vérification des erreurs, la création de rapports, les flux de travail et d’autres fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="72fb6-336">Applications that directly access the databases also lose the built-in Project Server security, common business logic, tracking, audits, error checking, reporting, workflow, and other features.</span></span> <span data-ttu-id="72fb6-337">Vous devrez probablement réécrire ce type d’application après les mises à jour de Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-337">You would likely have to rewrite such an application after Project Server 2013 updates.</span></span> 
  
<span data-ttu-id="72fb6-338">Pour toutes ces raisons, Project Professionnel et Project Web App n’effectuent pas d’appels directs aux tables provisoires, publiées ou archivées. C’est la même chose pour les autres applications qui s’intègrent avec Project Server.</span><span class="sxs-lookup"><span data-stu-id="72fb6-338">For all of these reasons, Project Professional and Project Web App do not make direct calls to the draft, published, or archive tables; neither should any other application that integrates with Project Server.</span></span>
  
<span data-ttu-id="72fb6-339">Les schémas des tables provisoires, publiées et archivées ne sont pas documentés.</span><span class="sxs-lookup"><span data-stu-id="72fb6-339">The schemas for the draft, published, and archive tables are not documented.</span></span> <span data-ttu-id="72fb6-340">Vous pouvez utiliser les tables de création de rapports pour vous aider à générer des rapports. Par ailleurs, le schéma des tables et vues de création de rapports est documenté dans le téléchargement du kit de développement logiciel (SDK) Project 2013.</span><span class="sxs-lookup"><span data-stu-id="72fb6-340">You can use the reporting tables to help generate reports, and the schema for the reporting tables and views is documented in the Project 2013 SDK download.</span></span> <span data-ttu-id="72fb6-341">Pour le schéma OData des données de création de rapports, consultez la rubrique [ProjectData – Référence du service Project OData](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15)).</span><span class="sxs-lookup"><span data-stu-id="72fb6-341">For the OData schema of the reporting data, see [ProjectData - Project OData service reference](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15)).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="72fb6-342">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="72fb6-342">See also</span></span>

- [<span data-ttu-id="72fb6-343">Mises à jour pour les développeurs dans Project 2013</span><span class="sxs-lookup"><span data-stu-id="72fb6-343">Updates for developers in Project 2013</span></span>](updates-for-developers-in-project-2013.md)    
- [<span data-ttu-id="72fb6-344">Architecture Project Server 2013</span><span class="sxs-lookup"><span data-stu-id="72fb6-344">Project Server 2013 architecture</span></span>](project-server-2013-architecture.md)    
- [<span data-ttu-id="72fb6-345">Fonctionnalités de l’interface PSI</span><span class="sxs-lookup"><span data-stu-id="72fb6-345">What the PSI does and does not do</span></span>](what-the-psi-does-and-does-not-do.md)   
- [<span data-ttu-id="72fb6-346">Fonctionnalité du modèle CSOM</span><span class="sxs-lookup"><span data-stu-id="72fb6-346">What the CSOM does and does not do</span></span>](what-the-csom-does-and-does-not-do.md)    
- [<span data-ttu-id="72fb6-347">Modèle objet côté client (CSOM) pour Project 2013</span><span class="sxs-lookup"><span data-stu-id="72fb6-347">Client-side object model (CSOM) for Project 2013</span></span>](client-side-object-model-csom-for-project-2013.md)    
- [<span data-ttu-id="72fb6-348">Prise en main du développement de flux de travail Project Server</span><span class="sxs-lookup"><span data-stu-id="72fb6-348">Getting started developing Project Server workflows</span></span>](getting-started-developing-project-server-workflows.md)    
- [<span data-ttu-id="72fb6-349">Références de programmation Project 2013</span><span class="sxs-lookup"><span data-stu-id="72fb6-349">Project 2013 programming references</span></span>](project-2013-programming-references.md)    
- [<span data-ttu-id="72fb6-350">Vue d’ensemble de la référence Project PSI</span><span class="sxs-lookup"><span data-stu-id="72fb6-350">Project PSI reference overview</span></span>](project-psi-reference-overview.md)    
- <span data-ttu-id="72fb6-351">[Créer des actions personnalisées à déployer avec les applications pour SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins).</span><span class="sxs-lookup"><span data-stu-id="72fb6-351">[Create custom actions to deploy with apps for SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins)</span></span>    
- [<span data-ttu-id="72fb6-352">Présentation des tâches inactives dans Project 2010</span><span class="sxs-lookup"><span data-stu-id="72fb6-352">Introducing Inactive Tasks in Project 2010</span></span>](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx)    
- [<span data-ttu-id="72fb6-353">Project Server 2010 : Planification sur le web, l’interface PSI et Project Professionnel</span><span class="sxs-lookup"><span data-stu-id="72fb6-353">Project Server 2010: Scheduling on the Web, the PSI and Project Professional</span></span>](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/)

