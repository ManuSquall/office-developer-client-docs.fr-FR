---
title: Conditions préalables pour les exemples de code basés sur WCF
manager: soliver
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 60d2afc8-10b6-465d-8ce8-c073da6e5054
description: Découvrez des informations pour vous aider à créer des projets dans Visual Studio à l’aide des exemples de code WCF inclus dans les rubriques de référence psi (Project Server Interface).
ms.openlocfilehash: 2222e1b3651044c41f45e57481f80093aac67bdb
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32357155"
---
# <a name="prerequisites-for-wcf-based-code-samples-in-project"></a><span data-ttu-id="5503e-103">Conditions préalables pour les exemples de code basés sur WCF</span><span class="sxs-lookup"><span data-stu-id="5503e-103">Prerequisites for WCF-based code samples in Project</span></span>

<span data-ttu-id="5503e-104">Découvrez des informations pour vous aider à créer des projets dans Visual Studio à l’aide des exemples de code WCF inclus dans les rubriques de référence psi (Project Server Interface).</span><span class="sxs-lookup"><span data-stu-id="5503e-104">Learn information to help you create projects in Visual Studio by using the WCF-based code samples that are included in the Project Server Interface (PSI) reference topics.</span></span>
   
<span data-ttu-id="5503e-105">La plupart des exemples de code WCF inclus dans la bibliothèque de classes et la référence de [service web Project Server 2013](https://msdn.microsoft.com/library/ef1830e0-3c9a-4f98-aa0a-5556c298e7d1%28Office.15%29.aspx) ont été initialement créés pour la documentation du développeur Project 2010 et utilisent un format standard pour les services web WCF.</span><span class="sxs-lookup"><span data-stu-id="5503e-105">Many of the WCF-based code samples included in the [Project Server 2013 class library and web service reference](https://msdn.microsoft.com/library/ef1830e0-3c9a-4f98-aa0a-5556c298e7d1%28Office.15%29.aspx) were originally created for the Project 2010 developer documentation, and use a standard format for WCF web services.</span></span> <span data-ttu-id="5503e-106">Les exemples fonctionnent toujours dans Project Server 2013 et sont conçus pour être copiés dans une application console et exécutés en tant qu’unité complète.</span><span class="sxs-lookup"><span data-stu-id="5503e-106">The samples still work in Project Server 2013 and are designed to be copied into a console application and run as a complete unit.</span></span> <span data-ttu-id="5503e-107">Des exceptions sont notées dans l’exemple.</span><span class="sxs-lookup"><span data-stu-id="5503e-107">Exceptions are noted in the sample.</span></span> 
  
<span data-ttu-id="5503e-108">Les exemples de code de la documentation Project 2013 pour les développeurs qui restent inchangés par rapport aux exemples développés pour Office Project Server 2007 utilisent les services Web ASMX.</span><span class="sxs-lookup"><span data-stu-id="5503e-108">Code samples in the Project 2013 developer documentation that are unchanged from the samples developed for Office Project Server 2007 use ASMX Web services.</span></span> <span data-ttu-id="5503e-109">Les exemples ASMX peuvent également être adaptés pour utiliser les services WCF.</span><span class="sxs-lookup"><span data-stu-id="5503e-109">The ASMX-based samples can also be adapted to use WCF services.</span></span> <span data-ttu-id="5503e-110">Cet article montre comment utiliser les exemples avec les services WCF.</span><span class="sxs-lookup"><span data-stu-id="5503e-110">This article shows how to use the samples with WCF services.</span></span> <span data-ttu-id="5503e-111">Pour plus d’informations sur l’utilisation des exemples avec les services web ASMX, voir [Prerequisites for ASMX-based code samples in Project](prerequisites-for-asmx-based-code-samples-in-project.md).</span><span class="sxs-lookup"><span data-stu-id="5503e-111">For information about how to use the samples with ASMX web services, see [Prerequisites for ASMX-based code samples in Project](prerequisites-for-asmx-based-code-samples-in-project.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="5503e-112">Si le modèle objet côté client (CSOM) inclut les méthodes dont votre application a besoin, de nouvelles applications doivent être développées avec le modèle CSOM.</span><span class="sxs-lookup"><span data-stu-id="5503e-112">If the client-side object model (CSOM) includes the methods that your application requires, new applications should be developed with the CSOM.</span></span> <span data-ttu-id="5503e-113">Le CSOM permet aux applications de fonctionner avec Project Online ou une installation sur site de Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="5503e-113">The CSOM enables applications to work with Project Online or an on-premises installation of Project Server 2013.</span></span> <span data-ttu-id="5503e-114">Dans le cas contraire, si votre application utilise l’interface PSI, elle doit utiliser l’interface WCF, qui est la technologie recommandée pour les communications réseau.</span><span class="sxs-lookup"><span data-stu-id="5503e-114">Otherwise, if your application uses the PSI, it should use the WCF interface, which is the technology that we recommend for network communications.</span></span> <span data-ttu-id="5503e-115">Les applications qui utilisent l’interface ASMX ou l’interface WCF ne peuvent fonctionner que pour les installations sur site de Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="5503e-115">Applications that use the ASMX interface or the WCF interface can work only for on-premises installations of Project Server 2013.</span></span> 
>
> <span data-ttu-id="5503e-116">Pour plus d’informations sur le modèle CSOM, voir [Project Server 2013 architecture](project-server-2013-architecture.md) and [Client-side object model (CSOM) for Project 2013](client-side-object-model-csom-for-project-2013.md).</span><span class="sxs-lookup"><span data-stu-id="5503e-116">For more information about the CSOM, see [Project Server 2013 architecture](project-server-2013-architecture.md) and [Client-side object model (CSOM) for Project 2013](client-side-object-model-csom-for-project-2013.md).</span></span> 
  
<span data-ttu-id="5503e-117">Avant d’exécutez les exemples de code, vous devez configurer l’environnement de développement, configurer l’application, ajouter un fichier de configuration de service (ou configurer les services WCF par programme) et modifier les valeurs de constante génériques en fonction de votre environnement.</span><span class="sxs-lookup"><span data-stu-id="5503e-117">Before running the code samples, you must set up the development environment, configure the application, add a service configuration file (or configure the WCF services programmatically), and change generic constant values to match your environment.</span></span>
  
## <a name="setting-up-the-development-environment"></a><span data-ttu-id="5503e-118">Configuration de l'environnement de développement</span><span class="sxs-lookup"><span data-stu-id="5503e-118">Setting up the development environment</span></span>
<span data-ttu-id="5503e-119"><a name="pj15_PrerequisitesWCF_Setup"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-119"><a name="pj15_PrerequisitesWCF_Setup"> </a></span></span>

1. <span data-ttu-id="5503e-120">**Configurer un système de test Project Server.**</span><span class="sxs-lookup"><span data-stu-id="5503e-120">**Set up a test Project Server system.**</span></span>
    
    <span data-ttu-id="5503e-121">Utilisez un système de test Project server chaque fois que vous développez ou testez.</span><span class="sxs-lookup"><span data-stu-id="5503e-121">Use a test Project Server system whenever you are developing or testing.</span></span> <span data-ttu-id="5503e-122">Même lorsque votre code fonctionne parfaitement, l’interprojet des dépendances, des rapports ou d’autres facteurs environnementaux peut entraîner des conséquences inattendues.</span><span class="sxs-lookup"><span data-stu-id="5503e-122">Even when your code works perfectly, interproject dependencies, reporting, or other environmental factors can cause unintended consequences.</span></span> 
    
    > [!NOTE]
    > <span data-ttu-id="5503e-123">Vérifiez que vous êtes un utilisateur valide sur le serveur et que vous avez les autorisations suffisantes pour les appels PSI que votre application utilise.</span><span class="sxs-lookup"><span data-stu-id="5503e-123">Ensure that you are a valid user on the server, and check that you have sufficient permissions for the PSI calls that your application uses.</span></span> <span data-ttu-id="5503e-124">La rubrique de documentation pour les développeurs pour chaque méthode PSI inclut une table Project Server Permissions.</span><span class="sxs-lookup"><span data-stu-id="5503e-124">The developer documentation topic for each PSI method includes a Project Server Permissions table.</span></span> <span data-ttu-id="5503e-125">Par exemple, le [Project. La méthode QueueCreateProject](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueCreateProject.aspx) nécessite l’autorisation **NewProject** globale et **l’autorisation SaveProjectTemplate.**</span><span class="sxs-lookup"><span data-stu-id="5503e-125">For example, the [Project.QueueCreateProject](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueCreateProject.aspx) method requires the global **NewProject** permission and the **SaveProjectTemplate** permission.</span></span> 
  
    <span data-ttu-id="5503e-126">Dans certains cas, vous de devez peut-être déboguer à distance sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="5503e-126">In some cases, you may have to do remote debugging on the server.</span></span> <span data-ttu-id="5503e-127">Il se peut également que vous de dû configurer un programme de gestion d’événements en installant un assembly de ce dernier sur chaque ordinateur Project Server de la batterie de serveurs SharePoint, puis en configurant le handler d’événements pour l’instance Project Web App à l’aide de la page Project Server Paramètres de l’Paramètres d’application générale de l’Administration centrale de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5503e-127">You may also have to set up an event handler by installing an event handler assembly on each Project Server computer in the SharePoint farm, and then configuring the event handler for the Project Web App instance by using the Project Server Settings page in the General Application Settings of SharePoint Central Administration.</span></span>
    
2. <span data-ttu-id="5503e-128">**Configurer un ordinateur de développement.**</span><span class="sxs-lookup"><span data-stu-id="5503e-128">**Set up a development computer.**</span></span>
    
    <span data-ttu-id="5503e-129">Vous accédez généralement à l’interface PSI via un réseau.</span><span class="sxs-lookup"><span data-stu-id="5503e-129">You usually access the PSI through a network.</span></span> <span data-ttu-id="5503e-130">Les exemples de code sont conçus pour être exécutés sur un client distinct du serveur, sauf en cas de remarque.</span><span class="sxs-lookup"><span data-stu-id="5503e-130">The code samples are designed to be run on a client that is separate from the server, except where noted.</span></span>
    
    1. <span data-ttu-id="5503e-131">**Installez la version correcte de Visual Studio.**</span><span class="sxs-lookup"><span data-stu-id="5503e-131">**Install the correct version of Visual Studio.**</span></span> <span data-ttu-id="5503e-132">Sauf remarque, les exemples de code sont écrits dans Visual C#.</span><span class="sxs-lookup"><span data-stu-id="5503e-132">Except where noted, the code samples are written in Visual C#.</span></span> <span data-ttu-id="5503e-133">Elles peuvent être utilisées avec Visual Studio 2010 ou Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="5503e-133">They can be used with Visual Studio 2010 or Visual Studio 2012.</span></span> <span data-ttu-id="5503e-134">Assurez-vous que le Service Pack le plus récent est installé.</span><span class="sxs-lookup"><span data-stu-id="5503e-134">Ensure that you have the most recent service pack installed.</span></span> 
    
    2. <span data-ttu-id="5503e-135">**Copiez Project DLLs de serveur sur l’ordinateur de développement.**</span><span class="sxs-lookup"><span data-stu-id="5503e-135">**Copy Project Server DLLs to the development computer.**</span></span> <span data-ttu-id="5503e-136">Copiez les assemblys suivants à partir de `[Program Files]\Microsoft Office Servers\15.0\Bin` l’ordinateur Project Server vers l’ordinateur de développement :</span><span class="sxs-lookup"><span data-stu-id="5503e-136">Copy the following assemblies from  `[Program Files]\Microsoft Office Servers\15.0\Bin` on the Project Server computer to the development computer:</span></span> 
    
       - <span data-ttu-id="5503e-137">Microsoft.Office.Project.Server.Events.Receivers.dll</span><span class="sxs-lookup"><span data-stu-id="5503e-137">Microsoft.Office.Project.Server.Events.Receivers.dll</span></span>
    
       - <span data-ttu-id="5503e-138">Microsoft.Office.Project.Server.Library.dll</span><span class="sxs-lookup"><span data-stu-id="5503e-138">Microsoft.Office.Project.Server.Library.dll</span></span>
    
    3. <span data-ttu-id="5503e-139">Pour plus d’informations sur la compilation et l’utilisation de l’assembly de proxy ProjectServerServices.dll pour les services WCF dans l’interface PSI, voir Utilisation d’un assembly de proxy PSI et [descriptions IntelliSense.](#pj15_PrerequisitesWCF_BuildingProxy)</span><span class="sxs-lookup"><span data-stu-id="5503e-139">For information about how to compile and use the ProjectServerServices.dll proxy assembly for the WCF services in the PSI, see [Using a PSI proxy assembly and IntelliSense descriptions](#pj15_PrerequisitesWCF_BuildingProxy).</span></span>
    
3. <span data-ttu-id="5503e-140">**Installez les IntelliSense fichiers.**</span><span class="sxs-lookup"><span data-stu-id="5503e-140">**Install the IntelliSense files.**</span></span>
    
    <span data-ttu-id="5503e-141">Pour utiliser des descriptions IntelliSense pour les classes et les membres dans les assemblys Project Server, copiez les fichiers XML IntelliSense mis à jour à partir du téléchargement du SDK Project 2013 dans le même répertoire que les assemblys Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-141">To use IntelliSense descriptions for classes and members in Project Server assemblies, copy the updated IntelliSense XML files from the Project 2013 SDK download to the same directory where the Project Server assemblies are located.</span></span> <span data-ttu-id="5503e-142">Par exemple, copiez le fichier Microsoft.Office.Project.Server.Library.xml dans le répertoire où votre application définira une référence à l’assembly Microsoft.Office.Project.Server.Library.dll.</span><span class="sxs-lookup"><span data-stu-id="5503e-142">For example, copy the Microsoft.Office.Project.Server.Library.xml file to the directory where your application will set a reference to the Microsoft.Office.Project.Server.Library.dll assembly.</span></span>
    
    <span data-ttu-id="5503e-143">IntelliSense descriptions des services PSI nécessitent la création d’un assembly de proxy PSI à l’aide du script CompileWCFProxyAssembly.cmd dans le sous-dossier du téléchargement du `Documentation\IntelliSense\WCF` SDK Project 2013.</span><span class="sxs-lookup"><span data-stu-id="5503e-143">IntelliSense descriptions for the PSI services require that you create a PSI proxy assembly by using the CompileWCFProxyAssembly.cmd script in the  `Documentation\IntelliSense\WCF` subdirectory in the Project 2013 SDK download.</span></span> <span data-ttu-id="5503e-144">Le script crée l’assembly proxy basé sur WCF ProjectServerServices.dll proxy.</span><span class="sxs-lookup"><span data-stu-id="5503e-144">The script creates the WCF-based ProjectServerServices.dll proxy assembly.</span></span> <span data-ttu-id="5503e-145">Pour plus d’informations, voir le fichier [ReadMe_IntelliSense].mht dans le téléchargement du SDK.</span><span class="sxs-lookup"><span data-stu-id="5503e-145">For more information, see the [ReadMe_IntelliSense].mht file in the SDK download.</span></span> 
    
## <a name="creating-the-application-and-adding-a-service-reference"></a><span data-ttu-id="5503e-146">Création de l’application et ajout d’une référence de service</span><span class="sxs-lookup"><span data-stu-id="5503e-146">Creating the application and adding a service reference</span></span>
<span data-ttu-id="5503e-147"><a name="pj15_PrerequisitesWCF_Configure"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-147"><a name="pj15_PrerequisitesWCF_Configure"> </a></span></span>

1. <span data-ttu-id="5503e-148">**Créez une application console.**</span><span class="sxs-lookup"><span data-stu-id="5503e-148">**Create a console application.**</span></span>
    
    <span data-ttu-id="5503e-149">Lorsque vous créez une application console, dans la liste de la boîte de dialogue **Nouveau Project,** sélectionnez **.NET Framework 4**.</span><span class="sxs-lookup"><span data-stu-id="5503e-149">When you create a console application, in the drop-down list of the **New Project** dialog box, select **.NET Framework 4**.</span></span> <span data-ttu-id="5503e-150">Vous pouvez copier l’exemple de code PSI dans la nouvelle application.</span><span class="sxs-lookup"><span data-stu-id="5503e-150">You can copy the PSI example code into the new application.</span></span>
    
2. <span data-ttu-id="5503e-151">**Ajoutez les références requises pour WCF.**</span><span class="sxs-lookup"><span data-stu-id="5503e-151">**Add references required for WCF.**</span></span>
    
    <span data-ttu-id="5503e-152">Dans l’Explorateur de solutions, ajoutez une référence **à System.ServiceModel** (voir figure 1).</span><span class="sxs-lookup"><span data-stu-id="5503e-152">In Solution Explorer, add a reference to **System.ServiceModel** (see Figure 1).</span></span> <span data-ttu-id="5503e-153">Une application web utiliserait **System.ServiceModel.Web**.</span><span class="sxs-lookup"><span data-stu-id="5503e-153">A web application would use **System.ServiceModel.Web**.</span></span>
    
    <span data-ttu-id="5503e-154">Ajoutez également une référence **à System.Runtime.Serialization**.</span><span class="sxs-lookup"><span data-stu-id="5503e-154">Also add a reference to **System.Runtime.Serialization**.</span></span>
    
    <span data-ttu-id="5503e-155">**Figure 1. Ajout des références dans Visual Studio pour une application WCF**</span><span class="sxs-lookup"><span data-stu-id="5503e-155">**Figure 1. Adding the references in Visual Studio for a WCF-based application**</span></span>

    <span data-ttu-id="5503e-156">![Ajout de références pour WCF](media/pj15_PrerequisitesWCF_AddReference.gif "Ajout de références pour WCF")</span><span class="sxs-lookup"><span data-stu-id="5503e-156">![Adding references for WCF](media/pj15_PrerequisitesWCF_AddReference.gif "Adding references for WCF")</span></span>
  
3. <span data-ttu-id="5503e-157">**Copiez le code**.</span><span class="sxs-lookup"><span data-stu-id="5503e-157">**Copy the code**.</span></span>
    
    <span data-ttu-id="5503e-158">Copiez l’exemple de code complet dans le fichier Program.cs de l’application console.</span><span class="sxs-lookup"><span data-stu-id="5503e-158">Copy the complete code example into the Program.cs file of the console application.</span></span>
    
4. <span data-ttu-id="5503e-159">**Définissez l’espace de noms pour l’exemple d’application.**</span><span class="sxs-lookup"><span data-stu-id="5503e-159">**Set the namespace for the sample application.**</span></span>
    
    <span data-ttu-id="5503e-160">Vous pouvez modifier l’espace de noms répertorié en haut de l’exemple en espace de noms par défaut de l’application ou modifier l’espace de noms d’application par défaut pour qu’il corresponde à l’exemple.</span><span class="sxs-lookup"><span data-stu-id="5503e-160">You can either change the namespace listed at the top of the sample to the application default namespace, or change the default application namespace to match the sample.</span></span> <span data-ttu-id="5503e-161">Vous pouvez modifier l’espace de noms d’application par défaut en modifiant les propriétés de l’application.</span><span class="sxs-lookup"><span data-stu-id="5503e-161">You can change the default application namespace by changing the application properties.</span></span> 
    
    <span data-ttu-id="5503e-162">Par exemple, l’exemple de code [pour ReadResource](https://msdn.microsoft.com/library/WebSvcResource.Resource.ReadResource.aspx) possède l’espace de noms **Microsoft.SDK.Project. Samples.CreateResourceTest**.</span><span class="sxs-lookup"><span data-stu-id="5503e-162">For example, the code sample for [ReadResource](https://msdn.microsoft.com/library/WebSvcResource.Resource.ReadResource.aspx) has the namespace **Microsoft.SDK.Project.Samples.CreateResourceTest**.</span></span> <span data-ttu-id="5503e-163">Si le nom du projet Visual Studio est **ResourceTest,** copiez l’espace de noms à  partir du fichier Program.cs, puis ouvrez le volet Propriétés du projet (dans le menu **Project,** choisissez **Propriétés ResourceTest).**</span><span class="sxs-lookup"><span data-stu-id="5503e-163">If the name of the Visual Studio project is **ResourceTest**, copy the namespace from the Program.cs file, and then open the project **Properties** pane (on the **Project** menu, choose **ResourceTest Properties**).</span></span> <span data-ttu-id="5503e-164">Sous **l’onglet Application,** copiez l’espace de noms dans la **zone de texte Espace de noms** par défaut.</span><span class="sxs-lookup"><span data-stu-id="5503e-164">On the **Application** tab, copy the namespace into the **Default namespace** text box.</span></span> 
    
5. <span data-ttu-id="5503e-165">**Définissez les références de service.**</span><span class="sxs-lookup"><span data-stu-id="5503e-165">**Set the service references.**</span></span>
    
    <span data-ttu-id="5503e-166">De nombreux exemples nécessitent une référence à un ou plusieurs services PSI.</span><span class="sxs-lookup"><span data-stu-id="5503e-166">Many examples require a reference to one or more of the PSI services.</span></span> <span data-ttu-id="5503e-167">Ceux-ci sont répertoriés dans l’exemple lui-même ou dans les commentaires qui précèdent l’exemple.</span><span class="sxs-lookup"><span data-stu-id="5503e-167">These are listed in the sample itself or in comments that precede the sample.</span></span> <span data-ttu-id="5503e-168">Pour obtenir l’espace de noms correct des références de service, assurez-vous que vous définissez d’abord l’espace de noms d’application par défaut.</span><span class="sxs-lookup"><span data-stu-id="5503e-168">To get the correct namespace of the service references, ensure that you first set the default application namespace.</span></span>
    
    <span data-ttu-id="5503e-169">Il existe trois façons d’ajouter une référence de service WCF :</span><span class="sxs-lookup"><span data-stu-id="5503e-169">There are three ways to add a WCF service reference:</span></span>
    
    - <span data-ttu-id="5503e-170">Créez un assembly de proxy PSI ProjectServerServices.dll, puis définissez une référence à l’assembly.</span><span class="sxs-lookup"><span data-stu-id="5503e-170">Build a PSI proxy assembly named ProjectServerServices.dll, and then set a reference to the assembly.</span></span> <span data-ttu-id="5503e-171">Voir [l’utilisation d’un assembly de proxy PSI et IntelliSense descriptions.](#pj15_PrerequisitesWCF_BuildingProxy)</span><span class="sxs-lookup"><span data-stu-id="5503e-171">See [Using a PSI proxy assembly and IntelliSense descriptions](#pj15_PrerequisitesWCF_BuildingProxy).</span></span>
    
    - <span data-ttu-id="5503e-172">Ajoutez un fichier proxy à partir de la svcutil.exe à la solution Visual Studio’accès.</span><span class="sxs-lookup"><span data-stu-id="5503e-172">Add a proxy file from the svcutil.exe output to the Visual Studio solution.</span></span> <span data-ttu-id="5503e-173">Voir [Ajout d’un fichier proxy PSI.](#pj15_PrerequisitesWCF_AddingProxyFile)</span><span class="sxs-lookup"><span data-stu-id="5503e-173">See [Adding a PSI proxy file](#pj15_PrerequisitesWCF_AddingProxyFile).</span></span>
    
    - <span data-ttu-id="5503e-174">Ajoutez une référence de service à l’aide Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5503e-174">Add a service reference by using Visual Studio.</span></span> <span data-ttu-id="5503e-175">Voir [Ajout d’une référence de service.](#pj15_PrerequisitesWCF_AddingServiceReference)</span><span class="sxs-lookup"><span data-stu-id="5503e-175">See [Adding a service reference](#pj15_PrerequisitesWCF_AddingServiceReference).</span></span>
    
### <a name="using-a-psi-proxy-assembly-and-intellisense-descriptions"></a><span data-ttu-id="5503e-176">Utilisation d’un assembly de proxy PSI et de descriptions IntelliSense données</span><span class="sxs-lookup"><span data-stu-id="5503e-176">Using a PSI proxy assembly and IntelliSense descriptions</span></span>
<span data-ttu-id="5503e-177"><a name="pj15_PrerequisitesWCF_BuildingProxy"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-177"><a name="pj15_PrerequisitesWCF_BuildingProxy"> </a></span></span>

<span data-ttu-id="5503e-178">Vous pouvez utiliser un assembly proxy pour tous les services WCF publics dans l’interface PSI.</span><span class="sxs-lookup"><span data-stu-id="5503e-178">You can use a proxy assembly for all public WCF services in the PSI.</span></span> <span data-ttu-id="5503e-179">Compilez lProjectServerServices.dll assembly de proxy à l’aide du script dans le téléchargement du `Documentation\IntelliSense\WCF\CompileWCFProxyAssembly.cmd` SDK Project 2013, puis copiez l’assembly proxy sur votre ordinateur de développement.</span><span class="sxs-lookup"><span data-stu-id="5503e-179">Compile the ProjectServerServices.dll proxy assembly by using the  `Documentation\IntelliSense\WCF\CompileWCFProxyAssembly.cmd` script in the Project 2013 SDK download, and then copy the proxy assembly to your development computer.</span></span> <span data-ttu-id="5503e-180">Copiez ProjectServerServices.xml fichier de IntelliSense au même emplacement.</span><span class="sxs-lookup"><span data-stu-id="5503e-180">Copy the ProjectServerServices.xml file for IntelliSense to the same location.</span></span> <span data-ttu-id="5503e-181">Dans Visual Studio, définissez une référence à l’assembly ProjectServerServices.dll proxy.</span><span class="sxs-lookup"><span data-stu-id="5503e-181">In Visual Studio, set a reference to the ProjectServerServices.dll proxy assembly.</span></span> 
  
<span data-ttu-id="5503e-182">Pour les Service Packs et les mises à jour Project Server, vous pouvez mettre à jour les fichiers proxy sources et créer un assembly de proxy à l’aide du script GenWCFProxyAssembly.cmd dans le même dossier de téléchargement du SDK.</span><span class="sxs-lookup"><span data-stu-id="5503e-182">For Project Server service packs and updates, you can update the proxy source files and create a new proxy assembly by using the GenWCFProxyAssembly.cmd script in the same SDK download folder.</span></span> <span data-ttu-id="5503e-183">Pour obtenir un lien vers le téléchargement du SDK, voir [Project documentation du développeur 2013.](project-2013-developer-documentation.md)</span><span class="sxs-lookup"><span data-stu-id="5503e-183">For a link to the SDK download, see [Project 2013 developer documentation](project-2013-developer-documentation.md).</span></span> <span data-ttu-id="5503e-184">Pour plus d’informations, voir la section [Ajout d’une référence de service.](#pj15_PrerequisitesWCF_AddingServiceReference)</span><span class="sxs-lookup"><span data-stu-id="5503e-184">For more information, see the [Adding a service reference](#pj15_PrerequisitesWCF_AddingServiceReference) section.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="5503e-185">Lorsque vous extrayez les fichiers proxy sources du fichier Source.zip, les fichiers du dossier sont à jour à la date de publication du téléchargement du `Documentation\IntelliSense\WCF\Source` SDK Project 2013.</span><span class="sxs-lookup"><span data-stu-id="5503e-185">When you extract the proxy source files from the Source.zip file, the files in the  `Documentation\IntelliSense\WCF\Source` folder are current as of the publication date of the Project 2013 SDK download.</span></span> <span data-ttu-id="5503e-186">Pour générer des fichiers sources de proxy PSI mis à jour, exécutez le script GenASMXProxyAssembly.cmd sur l’ordinateur Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-186">To generate updated PSI proxy source files, run the GenASMXProxyAssembly.cmd script on the Project Server computer.</span></span> <span data-ttu-id="5503e-187">Pour plus d’informations, voir [Ajout d’une référence de service.](#pj15_PrerequisitesWCF_AddingServiceReference)</span><span class="sxs-lookup"><span data-stu-id="5503e-187">For more information, see [Adding a service reference](#pj15_PrerequisitesWCF_AddingServiceReference).</span></span> 
> 
> <span data-ttu-id="5503e-188">Les scripts du dossier  `Documentation\IntelliSense\ASMX` ne fonctionnent pas pour les applications WCF.</span><span class="sxs-lookup"><span data-stu-id="5503e-188">The scripts in the  `Documentation\IntelliSense\ASMX` folder do not work for WCF-based applications.</span></span> <span data-ttu-id="5503e-189">Le script GenASMXProxyAssembly.cmd appelle Wsdl.exe, qui génère des fichiers de code source pour les services ASMX.</span><span class="sxs-lookup"><span data-stu-id="5503e-189">The GenASMXProxyAssembly.cmd script calls Wsdl.exe, which generates source code files for the ASMX services.</span></span> <span data-ttu-id="5503e-190">Les fichiers proxy ASMX incluent différentes classes et propriétés.</span><span class="sxs-lookup"><span data-stu-id="5503e-190">The ASMX proxy files include different classes and properties.</span></span> <span data-ttu-id="5503e-191">Par exemple, le service web ressource basé sur ASMX inclut la classe **Resource,** tandis que le service de ressources WCF inclut l’interface **Resource,** l’interface **ResourceChannel** et la classe **ResourceClient.**</span><span class="sxs-lookup"><span data-stu-id="5503e-191">For example, the ASMX-based Resource web service includes the **Resource** class, whereas the WCF-based Resource service includes the **Resource** interface, the **ResourceChannel** interface, and the **ResourceClient** class.</span></span> 
  
<span data-ttu-id="5503e-192">Les espaces de noms arbitraires créés pour les services web ASMX et les services WCF sont identiques, de sorte que le fichier ProjectServerServices.xml pour IntelliSense fonctionne avec l’un ou l’autre assembly.</span><span class="sxs-lookup"><span data-stu-id="5503e-192">The arbitrary namespaces created for both the ASMX web services and the WCF services are the same, so that the ProjectServerServices.xml file for IntelliSense works with either assembly.</span></span> <span data-ttu-id="5503e-193">Par exemple, l’espace de noms du service ressource dans l’assembly de proxy WCF et dans l’assembly de proxy ASMX est **SvcResource**.</span><span class="sxs-lookup"><span data-stu-id="5503e-193">For example, the namespace of the Resource service in the WCF-based proxy assembly and in the ASMX-based proxy assembly is **SvcResource**.</span></span> <span data-ttu-id="5503e-194">Vous pouvez bien entendu modifier les noms des espaces de noms si vous vous assurez qu’ils correspondent dans l’assembly proxy et dans le fichier ProjectServerServices.xml IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="5503e-194">You can, of course, change the namespace names— if you ensure that they match in the proxy assembly and in the ProjectServerServices.xml IntelliSense file.</span></span>
  
<span data-ttu-id="5503e-195">Si un exemple de code utilise un nom différent pour un espace de noms de service PSI, par exemple **ProjectWebSvc**, pour que IntelliSense fonctionne, vous devez modifier l’exemple pour utiliser **SvcProject** afin que l’espace de noms corresponde à l’assembly de proxy.</span><span class="sxs-lookup"><span data-stu-id="5503e-195">If a code sample uses a different name for a PSI service namespace, for example **ProjectWebSvc**, for IntelliSense to work you must change the sample to use **SvcProject** so that the namespace matches the proxy assembly.</span></span> 
  
<span data-ttu-id="5503e-196">Les avantages de l’utilisation de l’assembly de proxy WCF sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="5503e-196">Advantages to using the WCF-based proxy assembly include the following:</span></span>
  
- <span data-ttu-id="5503e-197">Vous pouvez développer la plupart des solutions avec l’assembly proxy sur un autre ordinateur que l’ordinateur Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-197">You can develop most solutions with the proxy assembly on a different computer than the Project Server computer.</span></span> <span data-ttu-id="5503e-198">La définition d’une référence de service individuelle nécessite un développement sur Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-198">Setting an individual service reference requires development on the Project Server computer.</span></span>
    
- <span data-ttu-id="5503e-199">L’assembly de proxy inclut tous les espaces de noms de service PSI, vous n’avez donc pas besoin d’ajouter plusieurs fichiers proxy.</span><span class="sxs-lookup"><span data-stu-id="5503e-199">The proxy assembly includes all PSI service namespaces, so you do not have to add multiple proxy files.</span></span>
    
- <span data-ttu-id="5503e-200">Si vous ajoutez le fichier ProjectServerServices.xml au même répertoire où vous définissez une référence à l’assembly proxy ProjectServerServices.dll, vous pouvez obtenir des descriptions IntelliSense pour les classes et les membres PSI.</span><span class="sxs-lookup"><span data-stu-id="5503e-200">If you add the ProjectServerServices.xml file to the same directory where you set a reference to the ProjectServerServices.dll proxy assembly, you can get IntelliSense descriptions for the PSI classes and members.</span></span> <span data-ttu-id="5503e-201">Pour plus d’informations, voir le fichier [ReadMe_IntelliSense] dans le dossier du téléchargement du `Documentation\IntelliSense` SDK Project 2013.</span><span class="sxs-lookup"><span data-stu-id="5503e-201">For more information, see the [ReadMe_IntelliSense] file in the  `Documentation\IntelliSense` folder of the Project 2013 SDK download.</span></span> 
    
<span data-ttu-id="5503e-202">**Figure 2. Utilisation IntelliSense pour une méthode dans le service de ressources**</span><span class="sxs-lookup"><span data-stu-id="5503e-202">**Figure 2. Using IntelliSense for a method in the Resource service**</span></span>

<span data-ttu-id="5503e-203">![Utilisation d’Intellisense pour la méthode ReadResource à l’aide](media/pj15_PrerequisitesWCF_Intellisense.gif "d’Intellisense pour la méthode ReadResource")</span><span class="sxs-lookup"><span data-stu-id="5503e-203">![Using Intellisense for the ReadResource method](media/pj15_PrerequisitesWCF_Intellisense.gif "Using Intellisense for the ReadResource method")</span></span>
  
<span data-ttu-id="5503e-204">Les inconvénients de l’utilisation de l’assembly de proxy sont que la solution est plus grande et que vous devez distribuer et installer l’assembly de proxy avec la solution.</span><span class="sxs-lookup"><span data-stu-id="5503e-204">Disadvantages to using the proxy assembly are that the solution is larger and you must distribute and install the proxy assembly with the solution.</span></span> <span data-ttu-id="5503e-205">Vous devez également utiliser les mêmes espaces de noms que dans l’assembly de proxy et les fichiers IntelliSense, sauf si vous modifiez le script pour créer un assembly de proxy et modifier le fichier ProjectServerServices.xml IntelliSense afin d’utiliser différents espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="5503e-205">You must also use the same namespaces that are in the proxy assembly and IntelliSense files, unless you change the script to build a proxy assembly and change the ProjectServerServices.xml IntelliSense file to use different namespaces.</span></span>
  
### <a name="adding-a-psi-proxy-file"></a><span data-ttu-id="5503e-206">Ajout d’un fichier proxy PSI</span><span class="sxs-lookup"><span data-stu-id="5503e-206">Adding a PSI proxy file</span></span>
<span data-ttu-id="5503e-207"><a name="pj15_PrerequisitesWCF_AddingProxyFile"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-207"><a name="pj15_PrerequisitesWCF_AddingProxyFile"> </a></span></span>

<span data-ttu-id="5503e-208">Le Project SDK 2013 inclut les fichiers sources générés par la commande SvcUtil.exe pour l’assembly proxy.</span><span class="sxs-lookup"><span data-stu-id="5503e-208">The Project 2013 SDK download includes the source files that are generated by the SvcUtil.exe command for the proxy assembly.</span></span> <span data-ttu-id="5503e-209">Les fichiers sources sont dans le fichier Source.zip dans  `Documentation\IntelliSense\WCF` le sous-dossier.</span><span class="sxs-lookup"><span data-stu-id="5503e-209">The source files are in the Source.zip file in the  `Documentation\IntelliSense\WCF` subdirectory.</span></span> <span data-ttu-id="5503e-210">Au lieu de définir une référence à l’assembly proxy, vous pouvez ajouter un ou plusieurs des fichiers sources à une solution Visual Studio de proxy.</span><span class="sxs-lookup"><span data-stu-id="5503e-210">Instead of setting a reference to the proxy assembly, you can add one or more of the source files to a Visual Studio solution.</span></span> <span data-ttu-id="5503e-211">Par exemple, pour utiliser le service Project service et le service de ressources, ajoutez le wcf. Project.cs et wcf. Fichiers Resource.cs vers la solution.</span><span class="sxs-lookup"><span data-stu-id="5503e-211">For example, to use the Project service and the Resource service, add the wcf.Project.cs and wcf.Resource.cs files to the solution.</span></span> 
  
<span data-ttu-id="5503e-212">Dans WCF, la classe principale dans chaque service PSI est définie par une interface et implémentée dans une classe cliente pour l’accès aux membres.</span><span class="sxs-lookup"><span data-stu-id="5503e-212">In WCF, the primary class in each PSI service is defined by an interface and implemented in a client class for access to the members.</span></span> <span data-ttu-id="5503e-213">Par exemple, **l’interface SvcProject.Resource** est implémentée dans la **classe SvcProject.ResourceClient.**</span><span class="sxs-lookup"><span data-stu-id="5503e-213">For example, the **SvcProject.Resource** interface is implemented in the **SvcProject.ResourceClient** class.</span></span> <span data-ttu-id="5503e-214">Pour définir un **objet ResourceClient** en tant que variable de classe **nommée resourceClient,** par exemple, utilisez le code suivant.</span><span class="sxs-lookup"><span data-stu-id="5503e-214">To define a **ResourceClient** object as a class variable named **resourceClient**, for example, use the following code.</span></span> <span data-ttu-id="5503e-215">Dans l’exemple, la méthode **SetClientEndpoints** crée un objet **resourceClient** qui utilise le point de terminaison **basicHttp_Project,** qui est défini dans le fichier app.config.</span><span class="sxs-lookup"><span data-stu-id="5503e-215">In the example, the **SetClientEndpoints** method creates a **resourceClient** object that uses the **basicHttp_Project** endpoint, which is defined in the app.config file.</span></span> <span data-ttu-id="5503e-216">Pour plus d’informations sur le app.config, voir la section [Ajout d’un](#pj15_PrerequisitesWCF_AddConfig) fichier de configuration de service.</span><span class="sxs-lookup"><span data-stu-id="5503e-216">For more information about the app.config file, see the [Adding a service configuration file](#pj15_PrerequisitesWCF_AddConfig) section.</span></span> 
  
```cs
private static SvcResource.ResourceClient resourceClient;
. . .
private static void SetClientEndpoints()
{
  resourceClient = new SvcResource.ResourceClient("basicHttp_Resource");
  . . .
}
public void DisposeClients()
{
  resourceClient.Close();
  . . .
}
```

> [!NOTE]
> <span data-ttu-id="5503e-217">Que vous utilisez un assembly de proxy PSI ou que vous ajoutiez un fichier proxy pour une référence de service Project nommée **SvcResource,** vous utiliseriez le même code pour créer et éliminer un objet **resourceClient.**</span><span class="sxs-lookup"><span data-stu-id="5503e-217">Whether you use a PSI proxy assembly or add a proxy file for a Project service reference named **SvcResource**, you would use the same code to create and dispose a **resourceClient** object.</span></span> 
  
### <a name="adding-a-service-reference"></a><span data-ttu-id="5503e-218">Ajout d’une référence de service</span><span class="sxs-lookup"><span data-stu-id="5503e-218">Adding a service reference</span></span>
<span data-ttu-id="5503e-219"><a name="pj15_PrerequisitesWCF_AddingServiceReference"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-219"><a name="pj15_PrerequisitesWCF_AddingServiceReference"> </a></span></span>

<span data-ttu-id="5503e-220">Si vous n’utilisez pas l’assembly proxy WCF ou n’ajoutez pas de fichier proxy pour un service PSI, vous pouvez définir une ou plusieurs références de service individuelles directement dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5503e-220">If you do not use the WCF-based proxy assembly or add a proxy file for a PSI service, you can set one or more individual service references directly in Visual Studio.</span></span> <span data-ttu-id="5503e-221">Vous pouvez également utiliser l’étape 1 de la procédure suivante pour créer des fichiers proxy mis à jour, afin de préparer le script inclus dans le téléchargement du `Documentation\IntelliSense\WCF\GenWCFProxyAssembly.cmd` SDK Project 2013.</span><span class="sxs-lookup"><span data-stu-id="5503e-221">You can also use step 1 of the following procedure to create updated proxy files, to prepare for the  `Documentation\IntelliSense\WCF\GenWCFProxyAssembly.cmd` script that is included in the Project 2013 SDK download.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="5503e-222">Pour définir une référence de service, vous devez utiliser Visual Studio sur l’ordinateur Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-222">To set a service reference, you must use Visual Studio on the Project Server computer.</span></span> <span data-ttu-id="5503e-223">Nous vous recommandons d’utiliser l’assembly ProjectServerServices.dll proxy ou d’ajouter des fichiers proxy source, au lieu d’ajouter directement des références de service dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5503e-223">We recommend that you use the ProjectServerServices.dll proxy assembly or add proxy source files, instead of directly adding service references in Visual Studio.</span></span> 
  
<span data-ttu-id="5503e-224">Les étapes suivantes montrent comment définir une référence de service à l’aide de Visual Studio 2012 sur un ordinateur exécutant une installation de test de Project Server :</span><span class="sxs-lookup"><span data-stu-id="5503e-224">The following steps show how to set a service reference by using Visual Studio 2012 on a computer running a test installation of Project Server:</span></span>
  
1. <span data-ttu-id="5503e-225">Pour accéder aux services WCF principal, exécutez Visual Studio sur l’ordinateur Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-225">To get access to the back-end WCF services, run Visual Studio on the Project Server computer.</span></span>
    
2. <span data-ttu-id="5503e-226">Dans **l’Explorateur de** solutions, cliquez avec le bouton droit sur le dossier **Références,** puis choisissez **Ajouter une référence de service.**</span><span class="sxs-lookup"><span data-stu-id="5503e-226">In **Solution Explorer**, right-click the **References** folder, and then choose **Add Service Reference**.</span></span> 
    
3. <span data-ttu-id="5503e-227">Dans la boîte de dialogue  Ajouter une référence de **service,** dans la zone de texte Adresse, tapez https://localhost:32843/ _GUID_/psi/ServiceName .svc, puis appuyez sur **Entrée**. </span><span class="sxs-lookup"><span data-stu-id="5503e-227">In the **Add Service Reference** dialog box, in the **Address** text box, type https://localhost:32843/ _GUID_/psi/ _ServiceName_.svc, and then press **Enter**.</span></span> <span data-ttu-id="5503e-228">Remplacez _le GUID_ par le nom du répertoire virtuel de l’application de service Project Server, tel que 534c37eb00d74ccfadcecf9827e95239.</span><span class="sxs-lookup"><span data-stu-id="5503e-228">Replace  _GUID_ with the virtual directory name of the Project Server service application, such as 534c37eb00d74ccfadcecf9827e95239.</span></span> <span data-ttu-id="5503e-229">Remplacez  _ServiceName_ par le nom du service, tel que Resource (voir figure 3).</span><span class="sxs-lookup"><span data-stu-id="5503e-229">Replace  _ServiceName_ with the name of the service, such as Resource (see Figure 3).</span></span> 
    
   <span data-ttu-id="5503e-230">Vous pouvez obtenir le nom du répertoire virtuel Project Server Service de l’une des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="5503e-230">You can get the name of the Project Server Service virtual directory in one of the following ways:</span></span>
    
   - <span data-ttu-id="5503e-231">Ouvrez l SharePoint’application Administration centrale de 2013 dans votre navigateur.</span><span class="sxs-lookup"><span data-stu-id="5503e-231">Open the SharePoint 2013 Central Administration application in your browser.</span></span> <span data-ttu-id="5503e-232">Choisissez **Gérer les applications de service,** puis choisissez l Project de service PSI serveur que vous souhaitez.</span><span class="sxs-lookup"><span data-stu-id="5503e-232">Choose **Manage service applications**, and then choose the Project Server PSI Service application that you want.</span></span> <span data-ttu-id="5503e-233">Par exemple, choisissez **ProjectServerService**.</span><span class="sxs-lookup"><span data-stu-id="5503e-233">For example, choose **ProjectServerService**.</span></span> <span data-ttu-id="5503e-234">L’URL de la page Gérer Project Web App sites contient le nom du répertoire virtuel.</span><span class="sxs-lookup"><span data-stu-id="5503e-234">The URL of the Manage Project Web App Sites page contains the virtual directory name.</span></span> <span data-ttu-id="5503e-235">Par exemple, dans , le nom du répertoire virtuel est (le nom du répertoire ne  `https://ServerName:8080/_admin/pwa/managepwa.aspx?appid=534c37eb-00d7-4ccf-adce-cf9827e95239`  `534c37eb00d74ccfadcecf9827e95239` contient pas de tirets).</span><span class="sxs-lookup"><span data-stu-id="5503e-235">For example, in  `https://ServerName:8080/_admin/pwa/managepwa.aspx?appid=534c37eb-00d7-4ccf-adce-cf9827e95239`, the virtual directory name is  `534c37eb00d74ccfadcecf9827e95239` (the directory name contains no dashes).</span></span> 
    
   - <span data-ttu-id="5503e-236">Ouvrez **la boîte de Internet Information Services (IIS) Manager** sur l’ordinateur Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-236">Open the **Internet Information Services (IIS) Manager** dialog box on the Project Server computer.</span></span> <span data-ttu-id="5503e-237">Développez **le nœud SharePoint Services Web** dans le volet Connexions, puis développez les **répertoires virtuels** de service ci-dessous, jusqu’à ce que vous trouviez le répertoire qui inclut un dossier PSI.</span><span class="sxs-lookup"><span data-stu-id="5503e-237">Expand the **SharePoint Web Services** node in the **Connections** pane, and then expand the service virtual directories below that, until you find the directory that includes a PSI folder.</span></span> <span data-ttu-id="5503e-238">Sélectionnez le répertoire, choisissez **Advanced Paramètres** dans le volet **Actions,** puis copiez le nom du répertoire dans le **champ Chemin d’accès** virtuel.</span><span class="sxs-lookup"><span data-stu-id="5503e-238">Select the directory, choose **Advanced Settings** in the **Actions** pane, and then copy the directory name in the **Virtual Path** field.</span></span> 
    
      > [!NOTE]
      > <span data-ttu-id="5503e-239">Il peut y avoir plusieurs répertoires virtuels Project Server Service.</span><span class="sxs-lookup"><span data-stu-id="5503e-239">There can be more than one Project Server Service virtual directory.</span></span> <span data-ttu-id="5503e-240">Veillez à choisir le répertoire virtuel qui contient l’instance Project Web App que vous souhaitez.</span><span class="sxs-lookup"><span data-stu-id="5503e-240">Ensure that you choose the virtual directory that contains the Project Web App instance that you want.</span></span> 
  
   - <span data-ttu-id="5503e-241">Utilisez **l’cmdlet get-SPServiceApplication** dans Windows PowerShell installé avec SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="5503e-241">Use the **get-SPServiceApplication** cmdlet in Windows PowerShell that is installed with SharePoint 2013.</span></span> <span data-ttu-id="5503e-242">Dans le **menu** Démarrer de la barre des tâches, choisissez Tous les **programmes,** **Microsoft SharePoint Produits 2013,** puis choisissez **SharePoint 2013 Management Shell**.</span><span class="sxs-lookup"><span data-stu-id="5503e-242">On the taskbar **Start** menu, choose **All Programs**, choose **Microsoft SharePoint 2013 Products**, and then choose **SharePoint 2013 Management Shell**.</span></span> <span data-ttu-id="5503e-243">Voici la commande et les résultats dans la fenêtre **SharePoint 2013get- Management Shell** pour les applications de service définies (vos GUID seront différents).</span><span class="sxs-lookup"><span data-stu-id="5503e-243">Following is the command and the results in the **SharePoint 2013get- Management Shell** window for the defined service applications (your GUIDs will be different).</span></span> <span data-ttu-id="5503e-244">Copiez le GUID de l’application Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-244">Copy the GUID for the Project Server service application.</span></span> 
    
        ```powershell
            PS > get-SPServiceApplication
            DisplayName          TypeName             Id
            -----------          --------             --
            State Service        State Service        04041cfa-4ab3-4473-8bc8-3967b02eff39
            ProjectServerSer...  Project Server PS... 534c37eb-00d7-4ccf-adce-cf9827e95239
            Security Token Se... Security Token Se... 7243732e-edea-405d-8cc8-1716b99faef5
            Application Disco... Application Disco... 3bfbdeb0-bc20-4a21-801c-cc6f1ce6c643
            SharePoint Server... SharePoint Server... 09912f49-3b72-462f-a44c-6533b578286a  
        ```

      <span data-ttu-id="5503e-245">Si vous connaissez le nom complet de l’application Project Server Service, vous pouvez l’utiliser pour obtenir la valeur GUID, par exemple :</span><span class="sxs-lookup"><span data-stu-id="5503e-245">If you know the full name of the Project Server Service application, you can use it to get the GUID value, for example:</span></span>
    
        ```powershell
        PS > $projectService = "ProjectServerService"
        PS > (get-SPServiceApplication -Name $projectService).Id
        Guid
        ----
        534c37eb-00d7-4ccf-adce-cf9827e95239
       ```

      > [!NOTE]
      > <span data-ttu-id="5503e-246">Supprimez les tirets du GUID pour obtenir le nom du répertoire virtuel.</span><span class="sxs-lookup"><span data-stu-id="5503e-246">Remove the dashes in the GUID to get the virtual directory name.</span></span> 
  
   <span data-ttu-id="5503e-247">Les URL, telles que les URL, sont `https://localhost:32843/534c37eb00d74ccfadcecf9827e95239/PSI/Resource.svc` standard pour les services Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-247">URLs such as  `https://localhost:32843/534c37eb00d74ccfadcecf9827e95239/PSI/Resource.svc` are standard for Project Server services.</span></span> 
    
4. <span data-ttu-id="5503e-248">Une fois la référence de service résolue, tapez le nom de la référence dans la **zone de** texte Espace de noms.</span><span class="sxs-lookup"><span data-stu-id="5503e-248">After the service reference resolves, type the reference name in the **Namespace** text box.</span></span> <span data-ttu-id="5503e-249">Les exemples de code de la documentation Project 2013 du développeur utilisent le nom d’espace de noms **arbitraire Svc _ServiceName_**.</span><span class="sxs-lookup"><span data-stu-id="5503e-249">Code examples in the Project 2013 developer documentation use the arbitrary namespace name **Svc _ServiceName_**.</span></span> <span data-ttu-id="5503e-250">Par exemple, le service de ressources dans les exemples de code est nommé **SvcResource**.</span><span class="sxs-lookup"><span data-stu-id="5503e-250">For example, the Resource service in the code examples is named **SvcResource**.</span></span>
    
    <span data-ttu-id="5503e-251">**Figure 3. Ajout de la référence du service de ressources basé sur WCF**</span><span class="sxs-lookup"><span data-stu-id="5503e-251">**Figure 3. Adding the WCF-based Resource service reference**</span></span>

    <span data-ttu-id="5503e-252">![Ajout de la référence de service de]ressources WCF Ajout de la référence de service de ressources basée sur(media/pj15_PrerequisitesWCF_AddSvcReference.gif "WCF")</span><span class="sxs-lookup"><span data-stu-id="5503e-252">![Adding the WCF-based Resource service reference](media/pj15_PrerequisitesWCF_AddSvcReference.gif "Adding the WCF-based Resource service reference")</span></span>
  
5. <span data-ttu-id="5503e-253">Remplacez le fichier web.config temporaire dans l’annuaire Project Service par l’original (renommé web.config), puis réexécutez `iisreset` .</span><span class="sxs-lookup"><span data-stu-id="5503e-253">Replace the temporary web.config file in the Project Service directory with the original (renamed to web.config), and then rerun  `iisreset`.</span></span>
    
## <a name="setting-other-references"></a><span data-ttu-id="5503e-254">Définition d’autres références</span><span class="sxs-lookup"><span data-stu-id="5503e-254">Setting other references</span></span>
<span data-ttu-id="5503e-255"><a name="pj15_PrerequisitesWCF_OtherReferences"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-255"><a name="pj15_PrerequisitesWCF_OtherReferences"> </a></span></span>

<span data-ttu-id="5503e-256">Project Les applications serveur utilisent souvent d’autres services, tels SharePoint services web 2013.</span><span class="sxs-lookup"><span data-stu-id="5503e-256">Project Server applications often use other services, such as SharePoint 2013 web services.</span></span> <span data-ttu-id="5503e-257">Si d’autres services ou références sont requis, ils sont indiqués dans l’exemple de code.</span><span class="sxs-lookup"><span data-stu-id="5503e-257">If other services or references are required, they are noted in the code example.</span></span>
  
<span data-ttu-id="5503e-258">Les références locales pour l’exemple de code sont répertoriées à **l’aide** d’instructions en haut de l’exemple.</span><span class="sxs-lookup"><span data-stu-id="5503e-258">Local references for the code sample are listed in **using** statements at the top of the sample.</span></span> 
  
1. <span data-ttu-id="5503e-259">Dans **l’Explorateur de** solutions, cliquez avec le bouton droit sur le dossier **Références,** puis choisissez **Ajouter une référence.**</span><span class="sxs-lookup"><span data-stu-id="5503e-259">In **Solution Explorer**, right-click the **References** folder, and then choose **Add Reference**.</span></span>
    
2. <span data-ttu-id="5503e-260">**Sélectionnez** Parcourir, puis accédez à l’emplacement où vous avez stocké les DLL du serveur Project que vous avez copiées précédemment.</span><span class="sxs-lookup"><span data-stu-id="5503e-260">Choose **Browse**, and then browse to the location where you stored the Project Server DLLs that you copied previously.</span></span> <span data-ttu-id="5503e-261">Choisissez les DLLs de votre choix, puis **choisissez OK.**</span><span class="sxs-lookup"><span data-stu-id="5503e-261">Choose the DLLs that you want, and then choose **OK**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="5503e-262">Assurez-vous que les versions d’assembly sur votre ordinateur de développement correspondent exactement à celles de l’ordinateur Project Server cible.</span><span class="sxs-lookup"><span data-stu-id="5503e-262">Ensure that the assembly versions on your development computer exactly match those on the target Project Server computer.</span></span> 
  
## <a name="adding-a-service-configuration-file"></a><span data-ttu-id="5503e-263">Ajout d’un fichier de configuration de service</span><span class="sxs-lookup"><span data-stu-id="5503e-263">Adding a service configuration file</span></span>
<span data-ttu-id="5503e-264"><a name="pj15_PrerequisitesWCF_AddConfig"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-264"><a name="pj15_PrerequisitesWCF_AddConfig"> </a></span></span>

<span data-ttu-id="5503e-265">Si une application configure par programme les services WCF, elle n’utilise pas de fichier de configuration de service.</span><span class="sxs-lookup"><span data-stu-id="5503e-265">If an application programmatically configures the WCF services, it does not use a service configuration file.</span></span> <span data-ttu-id="5503e-266">Dans le cas contraire, une application Windows ou une application console utilise **l’élément system.serviceModel** dans un fichier app.config' une application web **inclut system.serviceModel** dans web.config. Pour plus d’informations sur l’utilisation d’un fichier app.config ou la configuration par programme des services WCF, voir [Walkthrough: Developing PSI applications using WCF](https://msdn.microsoft.com/library/65707234-c3da-44e4-8364-32a6be28f645%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="5503e-266">Otherwise, a Windows application or console application uses the **system.serviceModel** element in an app.config file; a web application includes **system.serviceModel** in web.config. For more information about using an app.config file or programmatically configuring the WCF services, see [Walkthrough: Developing PSI applications using WCF](https://msdn.microsoft.com/library/65707234-c3da-44e4-8364-32a6be28f645%28Office.15%29.aspx).</span></span>
  
<span data-ttu-id="5503e-267">Lorsqu’elle génère un fichier source de proxy de service, la commande SvcUtil.exe crée également un fichier output.config qui est la base de l’élément **system.serviceModel** par défaut dans un fichier app.config ou un fichier web.config.</span><span class="sxs-lookup"><span data-stu-id="5503e-267">When it generates a service proxy source file, the SvcUtil.exe command also creates an output.config file that is the basis for the default **system.serviceModel** element in an app.config file or web.config file.</span></span> <span data-ttu-id="5503e-268">Le Project SDK 2013 inclut un exemple output.config fichier dans `Documentation\IntelliSense\WCF\Source.zip` .</span><span class="sxs-lookup"><span data-stu-id="5503e-268">The Project 2013 SDK download includes a sample output.config file in  `Documentation\IntelliSense\WCF\Source.zip`.</span></span> <span data-ttu-id="5503e-269">Par exemple, le fichier output.config par défaut créé par SvcUtil.exe service de ressources inclut deux liaisons nommées **BasicHttpBinding_Resource** et **BasicHttpBinding_Resource1**.</span><span class="sxs-lookup"><span data-stu-id="5503e-269">For example, the default output.config file that SvcUtil.exe creates for the Resource service includes two bindings, named **BasicHttpBinding_Resource** and **BasicHttpBinding_Resource1**.</span></span> <span data-ttu-id="5503e-270">**L’élément client** inclut deux points de terminaison par défaut.</span><span class="sxs-lookup"><span data-stu-id="5503e-270">The **client** element includes two default endpoints.</span></span> <span data-ttu-id="5503e-271">Un point de terminaison est pour l’accès sécurisé à l’adresse HTTP sur le port 32843 et l’autre pour un accès normal sur le port 32843, comme suit :</span><span class="sxs-lookup"><span data-stu-id="5503e-271">One endpoint is for the secure access to the HTTP address on port 32843 and the other is for normal access on port 32843, as follows:</span></span> 
  
```XML
<client>
    <endpoint address="https://ServerName.domain:32843/GUID/PSI/Resource.svc/secure"
        binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_Resource"
        contract="SvcResource.Resource" name="BasicHttpBinding_Resource" />
address="https://ServerName.domain:32843/GUID/PSI/Resource.svc"
        binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_Resource1"
        contract="SvcResource.Resource" name="BasicHttpBinding_Resource1" />
</client>
```

<span data-ttu-id="5503e-272">La configuration du service PSI n’utilise pas les liaisons et points de terminaison par défaut.</span><span class="sxs-lookup"><span data-stu-id="5503e-272">PSI service configuration does not use the default bindings and endpoints.</span></span> <span data-ttu-id="5503e-273">Project Le serveur requiert que les applications accèdent aux services PSI par le biais de ProjectServer.svc frontal, qui agit en tant que routeur pour les appels aux services frontaux.</span><span class="sxs-lookup"><span data-stu-id="5503e-273">Project Server requires that applications access PSI services through the front-end ProjectServer.svc, which acts as a router for calls to the back-end services.</span></span> <span data-ttu-id="5503e-274">Pour créer le fichier app.config, faites les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="5503e-274">To create the app.config file, do the following steps:</span></span>
  
1. <span data-ttu-id="5503e-275">Si vous définissez une référence à l’assembly de proxy ProjectServerServices.dll ou ajoutez le fichier proxy source d’un service, l’application ne contient pas de app.config fichier.</span><span class="sxs-lookup"><span data-stu-id="5503e-275">If you set a reference to the ProjectServerServices.dll proxy assembly, or add the proxy source file for a service, the application does not contain an app.config file.</span></span> <span data-ttu-id="5503e-276">Ajoutez un nouvel élément au Visual Studio projet.</span><span class="sxs-lookup"><span data-stu-id="5503e-276">Add a new item to the Visual Studio project.</span></span> <span data-ttu-id="5503e-277">Dans la **boîte de dialogue Ajouter un nouvel** élément, choisissez le modèle de fichier de configuration de l’application, nommez-le app.config, puis choisissez **Ajouter**. </span><span class="sxs-lookup"><span data-stu-id="5503e-277">In the **Add New Item** dialog box, choose the **Application Configuration File** template, name it app.config, and then choose **Add**.</span></span>
    
2. <span data-ttu-id="5503e-278">Supprimez tout le texte app.config fichier, puis copiez le code suivant dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="5503e-278">Delete all text in the app.config file, and then copy the following code into the file.</span></span> <span data-ttu-id="5503e-279">Vous pouvez utiliser la même liaison, par exemple, pour chaque point de  `basicHttpConf` terminaison de service.</span><span class="sxs-lookup"><span data-stu-id="5503e-279">You can use the same binding, for example  `basicHttpConf`, for each service endpoint.</span></span> <span data-ttu-id="5503e-280">Si vous souhaitez utiliser plusieurs liaisons, par exemple, pour lier des protocoles HTTP et HTTPS, vous devez créer une liaison pour chaque protocole.</span><span class="sxs-lookup"><span data-stu-id="5503e-280">If you want to use more than one binding, for example, to bind both HTTP and HTTPS protocols, you must create a binding for each protocol.</span></span>
    
    ```XML
        <?xml version="1.0" encoding="utf-8" ?>
        <configuration>
            <system.serviceModel>
                <behaviors>
                    <endpointBehaviors>
                        <behavior name="basicHttpBehavior">
                            <clientCredentials>
                                <windows allowedImpersonationLevel="Impersonation" />
                            </clientCredentials>
                        </behavior>
                    </endpointBehaviors>
                </behaviors>
                <bindings>
                    <basicHttpBinding>
                        <binding name="basicHttpConf" sendTimeout="01:00:00" 
                            maxBufferSize="500000000" maxReceivedMessageSize="500000000">
                            <readerQuotas maxDepth="32" maxStringContentLength="8192" 
                                maxArrayLength="16384" maxBytesPerRead="4096" 
                                maxNameTableCharCount="500000000" />
                            <security mode="TransportCredentialOnly">
                                <transport clientCredentialType="Ntlm" realm="https://SecurityDomain" />
                            </security>
                        </binding>
                    </basicHttpBinding>
                </bindings>
                <client>
                    <endpoint address="https://ServerName/ProjectServerName/_vti_bin/PSI/ProjectServer.svc"
                        behaviorConfiguration="basicHttpBehavior" binding="basicHttpBinding"
                        bindingConfiguration="basicHttpConf" 
                        contract="SvcServiceName.ServiceName"
                        name="basicHttp_ServiceName" />
                </client>
            </system.serviceModel>
        </configuration>
    ```

3. <span data-ttu-id="5503e-281">Remplacez `ServerName/ProjectServerName` l’adresse du point de terminaison client par le nom de votre serveur et Project Web App instance.</span><span class="sxs-lookup"><span data-stu-id="5503e-281">Replace  `ServerName/ProjectServerName` in the client endpoint address with the name of your server and Project Web App instance.</span></span> 
    
4. <span data-ttu-id="5503e-282">Remplacez  `ServiceName` par le nom du service PSI, tel que Resource.</span><span class="sxs-lookup"><span data-stu-id="5503e-282">Replace  `ServiceName` with the name of the PSI service, such as Resource.</span></span> <span data-ttu-id="5503e-283">Veillez à remplacer les trois instances du nom du service, par exemple :</span><span class="sxs-lookup"><span data-stu-id="5503e-283">Ensure that you replace all three instances of the service name, for example:</span></span>
    
    ```XML
        <endpoint address="https://myserver/pwa/_vti_bin/PSI/ProjectServer.svc"
            behaviorConfiguration="basicHttpBehavior" binding="basicHttpBinding"
            bindingConfiguration="basicHttpConf" 
            contract="SvcResource.Resource"
            name="basicHttp_Resource" />
    ```

5. <span data-ttu-id="5503e-284">Pour utiliser plusieurs services PSI, créez un élément **de** point de terminaison pour chaque service et pour chaque élément **de** liaison utilisé par le service.</span><span class="sxs-lookup"><span data-stu-id="5503e-284">To use more than one PSI service, create one **endpoint** element for each service, and for each **binding** element that service uses.</span></span> <span data-ttu-id="5503e-285">Par exemple, les points de terminaison suivants configurent le client pour utiliser la liaison HTTP de base pour le service Project et le service QueueSystem.</span><span class="sxs-lookup"><span data-stu-id="5503e-285">For example, the following endpoints configure the client to use the basic HTTP binding for the Project service and the QueueSystem service.</span></span> 
    
    > [!NOTE]
    > <span data-ttu-id="5503e-286">Si vous exécutez une application et que vous obtenez une erreur qui vous dit que le serveur est trop occupé ou que la demande HTTP n’est pas autorisée, assurez-vous que les adresses de point de terminaison sont correctes dans le fichier app.config.</span><span class="sxs-lookup"><span data-stu-id="5503e-286">If you run an application and get an error that the server is too busy, or that the HTTP request is unauthorized, ensure that the endpoint addresses are correct in the app.config file.</span></span> 
  
    ```XML
        <client>
        <endpoint address="https://ServerName/pwa/_vti_bin/PSI/ProjectServer.svc"
            behaviorConfiguration="basicHttpBehavior" binding="basicHttpBinding"
            bindingConfiguration="basicHttpConf" 
            contract="SvcProject.Project"
            name="basicHttp_Project" />
        <endpoint address="https://ServerName/pwa/_vti_bin/PSI/ProjectServer.svc"
            behaviorConfiguration="basicHttpBehavior" binding="basicHttpBinding"
            bindingConfiguration="basicHttpConf" 
            contract="SvcQueueSystem.QueueSystem"
            name="basicHttp_QueueSystem" />
        </client>
    ```

<span data-ttu-id="5503e-287">Vous pouvez modifier un fichier app.config à l’aide de l’Éditeur de configuration de **service WCF** dans Visual Studio (dans le menu **Outils).**</span><span class="sxs-lookup"><span data-stu-id="5503e-287">You can edit an app.config file by using the **WCF Service Configuration Editor** in Visual Studio (on the **Tools** menu).</span></span> <span data-ttu-id="5503e-288">La figure 4 montre comment définir l’élément **contract** dans la boîte de dialogue **Microsoft Service Configuration Editor.**</span><span class="sxs-lookup"><span data-stu-id="5503e-288">Figure 4 shows how to set the **contract** element in the **Microsoft Service Configuration Editor** dialog box.</span></span> <span data-ttu-id="5503e-289">Si la solution utilise l’assembly de proxy PSI, ouvrez ProjectServerServices.dll dans le répertoire `bin\debug` de la solution Visual Studio psi.</span><span class="sxs-lookup"><span data-stu-id="5503e-289">If the solution is using the PSI proxy assembly, open ProjectServerServices.dll in the  `bin\debug` directory of the Visual Studio solution.</span></span> <span data-ttu-id="5503e-290">La **boîte de dialogue Explorateur de types** de contrat affiche tous les contrats de service WCF (voir figure 5).</span><span class="sxs-lookup"><span data-stu-id="5503e-290">The **Contract Type Browser** dialog box shows all of the WCF service contracts (see Figure 5).</span></span> 
  
<span data-ttu-id="5503e-291">**Figure 4. Utilisation de l’éditeur de configuration de service WCF**</span><span class="sxs-lookup"><span data-stu-id="5503e-291">**Figure 4. Using the WCF Service Configuration Editor**</span></span>

<span data-ttu-id="5503e-292">![Utilisation de l’éditeur de configuration]de service WCF(media/pj15_PrerequisitesWCF_ServiceConfigurationEditor.gif "à l’aide de l’éditeur de configuration de service WCF")</span><span class="sxs-lookup"><span data-stu-id="5503e-292">![Using the WCF Service Configuration Editor](media/pj15_PrerequisitesWCF_ServiceConfigurationEditor.gif "Using the WCF Service Configuration Editor")</span></span>
  
<span data-ttu-id="5503e-293">Si la solution utilise un fichier proxy de service, tel que wcfResource.cs, compilez l’application, puis ouvrez le fichier exécutable dans  `bin\debug` le répertoire.</span><span class="sxs-lookup"><span data-stu-id="5503e-293">If the solution is using a service proxy file, such as wcfResource.cs, compile the application and then open the executable file in the  `bin\debug` directory.</span></span> <span data-ttu-id="5503e-294">Pour plus d’informations sur la modification du fichier app.config, voir [Walkthrough: Developing PSI applications using WCF](https://msdn.microsoft.com/library/65707234-c3da-44e4-8364-32a6be28f645%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="5503e-294">For more information about editing the app.config file, see [Walkthrough: Developing PSI applications using WCF](https://msdn.microsoft.com/library/65707234-c3da-44e4-8364-32a6be28f645%28Office.15%29.aspx).</span></span>
  
<span data-ttu-id="5503e-295">**Figure 5. Utilisation de l’explorateur de types de contrat dans l’éditeur de configuration du service WCF**</span><span class="sxs-lookup"><span data-stu-id="5503e-295">**Figure 5. Using the Contract Type Browser in the WCF Service Configuration Editor**</span></span>

<span data-ttu-id="5503e-296">![Utilisation de l’explorateur de types de contrat]à(media/pj15_PrerequisitesWCF_ContractTypeBrowser.gif "l’aide de l’explorateur de types de contrat")</span><span class="sxs-lookup"><span data-stu-id="5503e-296">![Using the Contract Type Browser](media/pj15_PrerequisitesWCF_ContractTypeBrowser.gif "Using the Contract Type Browser")</span></span>
  
## <a name="using-multiple-authentication"></a><span data-ttu-id="5503e-297">Utilisation de l’authentification multiple</span><span class="sxs-lookup"><span data-stu-id="5503e-297">Using multiple authentication</span></span>
<span data-ttu-id="5503e-298"><a name="pj15_PrerequisitesWCF_ClaimsMultiAuth"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-298"><a name="pj15_PrerequisitesWCF_ClaimsMultiAuth"> </a></span></span>

<span data-ttu-id="5503e-299">L’authentification des utilisateurs Project Server locaux, que ce soit par l’authentification Windows ou l’authentification par formulaires, est effectuée par le biais du traitement des revendications dans SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5503e-299">Authentication of on-premises Project Server users, whether by Windows authentication or Forms authentication, is done through claims processing in SharePoint.</span></span> <span data-ttu-id="5503e-300">L’authentification multiple signifie que l’application web sur laquelle Project Web App est mise en service prend en charge l Windows’authentification basée sur les formulaires et l’authentification basée sur les formulaires.</span><span class="sxs-lookup"><span data-stu-id="5503e-300">Multiple authentication means that the web application on which Project Web App is provisioned supports both Windows authentication and Forms-based authentication.</span></span> <span data-ttu-id="5503e-301">Si tel est le cas, tout appel à un service WCF qui utilise l’authentification Windows échoue avec l’erreur suivante, car le processus de revendications ne peut pas déterminer le type d’utilisateur à authentifier :</span><span class="sxs-lookup"><span data-stu-id="5503e-301">If that is the case, any call to a WCF service that uses Windows authentication will fail with the following error, because the claims process cannot determine which type of user to authenticate:</span></span>
  
`The server was unable to process the request due to an internal error. For more information about the error, either turn on Include ExceptionDetailInFaults (either from ServiceBehaviorAttribute or from the <serviceDebug> configuration behavior) on the server in order to send the exception information back to the client, or turn on tracing as per the Microsoft .NET Framework 3.0 SDK documentation and inspect the server trace logs.`

<span data-ttu-id="5503e-302">Pour résoudre le problème de WCF, tous les appels aux méthodes PSI doivent se trouver dans un **OperationContextScope** défini pour chaque service PSI.</span><span class="sxs-lookup"><span data-stu-id="5503e-302">To fix the problem for WCF, all calls to PSI methods should be within an **OperationContextScope** that is defined for each PSI service.</span></span> <span data-ttu-id="5503e-303">N’imbriez pas d’étendues pour plusieurs services ; par exemple, lors de l’utilisation d’appels aux services Project ressources et de gestion, chaque ensemble d’appels doit se trouver dans sa propre portée.</span><span class="sxs-lookup"><span data-stu-id="5503e-303">Do not nest scopes for multiple services; for example, when using calls to the Resource and Project services, each set of calls should be within its own scope.</span></span> 
  
<span data-ttu-id="5503e-304">Dans l’exemple suivant, la **méthode DisableFormsAuth** peut être appelée à partir de chaque section **OperationContextScope** d’une application.</span><span class="sxs-lookup"><span data-stu-id="5503e-304">In the following example, the **DisableFormsAuth** method can be called from every **OperationContextScope** section in an application.</span></span> <span data-ttu-id="5503e-305">La méthode supprime toute valeur d’en-tête qui désactivait précédemment l’authentification par formulaires, afin que l’authentification par formulaires puisse continuer si le paramètre  _isWindowsAuth_ est **false**.</span><span class="sxs-lookup"><span data-stu-id="5503e-305">The method removes any header value that previously disabled Forms authentication, so that Forms authentication can proceed if the  _isWindowsAuth_ parameter is **false**.</span></span> <span data-ttu-id="5503e-306">Si  _isWindowsAuth_ est **vrai,** la **méthode DisableFormsAuth** désactive l’authentification par formulaires.</span><span class="sxs-lookup"><span data-stu-id="5503e-306">If  _isWindowsAuth_ is **true**, the **DisableFormsAuth** method disables Forms authentication.</span></span> 
  
<span data-ttu-id="5503e-307">Dans la **méthode WcfSample,** l’objet **projectClient** est une instance de la classe PSI **SvcProject.ProjectClient.**</span><span class="sxs-lookup"><span data-stu-id="5503e-307">In the **WcfSample** method, the **projectClient** object is an instance of the PSI **SvcProject.ProjectClient** class.</span></span> 
  
```cs
// Class variable that determines whether to disable Forms authentication.
private bool isWindowsUser = true;
public void DisableFormsAuth(bool isWindowsAuth)
{
    WebOperationContext.Current.OutgoingRequest.Headers.Remove(
        "X-FORMS_BASED_AUTH_ACCEPTED");
    if (isWindowsAuth)
    {
        // Disable Forms authentication, to enable Windows authentication.
        WebOperationContext.Current.OutgoingRequest.Headers.Add(
            "X-FORMS_BASED_AUTH_ACCEPTED", "f");
    }
}
private void WcfSample()
{
    // Limit the scope of WCF calls to the client channel. 
    using (OperationContextScope scope = new OperationContextScope(projectClient.InnerChannel))
    {
        // Add a web request header to enable Windows authentication in 
        // multiple authentication installations.
        DisableFormsAuth(isWindowsUser);
        // Add calls to the projectClient methods here:
        // . . .
    }
}
```

> [!NOTE]
> <span data-ttu-id="5503e-308">La réalisation d’appels PSI dans **un OperationContextScope** est requise uniquement pour les applications qui s’exécutent dans un environnement d’authentification multiple.</span><span class="sxs-lookup"><span data-stu-id="5503e-308">Making PSI calls within an **OperationContextScope** is required only for applications that run in a multiple authentication environment.</span></span> <span data-ttu-id="5503e-309">Si Project Server utilise uniquement l’authentification Windows, il n’est pas nécessaire de définir une étendue et d’ajouter un en-tête de demande web qui désactive l’authentification par formulaires.</span><span class="sxs-lookup"><span data-stu-id="5503e-309">If Project Server uses only Windows authentication, it is not necessary to set a scope and add a web request header that disables Forms authentication.</span></span> 
> 
> <span data-ttu-id="5503e-310">Le correctif d’une application ASMX est différent.</span><span class="sxs-lookup"><span data-stu-id="5503e-310">The fix for an ASMX-based application is different.</span></span> <span data-ttu-id="5503e-311">Pour plus d’informations, voir la section Utilisation de *l’authentification* multiple dans [Prerequisites for ASMX-based code samples in Project](prerequisites-for-asmx-based-code-samples-in-project.md).</span><span class="sxs-lookup"><span data-stu-id="5503e-311">For more information, see the  *Using multiple-authentication*  section in [Prerequisites for ASMX-based code samples in Project](prerequisites-for-asmx-based-code-samples-in-project.md).</span></span> 
  
## <a name="changing-values-of-generic-constants"></a><span data-ttu-id="5503e-312">Modification des valeurs des constantes génériques</span><span class="sxs-lookup"><span data-stu-id="5503e-312">Changing values of generic constants</span></span>
<span data-ttu-id="5503e-313"><a name="pj15_PrerequisitesWCF_ChangeValues"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-313"><a name="pj15_PrerequisitesWCF_ChangeValues"> </a></span></span>

<span data-ttu-id="5503e-314">La plupart des exemples ont une ou plusieurs variables que vous devez mettre à jour pour que l’exemple fonctionne correctement dans votre environnement.</span><span class="sxs-lookup"><span data-stu-id="5503e-314">Most samples have one or more variables that you must update for the sample to work properly in your environment.</span></span> <span data-ttu-id="5503e-315">Dans l’exemple suivant, si SSL est installé, utilisez le protocole HTTPS au lieu du protocole HTTP.</span><span class="sxs-lookup"><span data-stu-id="5503e-315">In the following example, if you have SSL installed, use the HTTPS protocol instead of the HTTP protocol.</span></span> <span data-ttu-id="5503e-316">Remplacez  _ServerName_ par le nom du serveur que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="5503e-316">Replace  _ServerName_ with the name of the server that you are using.</span></span> <span data-ttu-id="5503e-317">Remplacez _ProjectServerName_ par le nom du répertoire virtuel de votre site de serveur de projet, tel que PWA.</span><span class="sxs-lookup"><span data-stu-id="5503e-317">Replace  _ProjectServerName_ with the virtual directory name of your project server site, such as PWA.</span></span> 
  
```cs
const string PROJECT_SERVER_URI = "https://ServerName/ProjectServerName/";
```

<span data-ttu-id="5503e-318">Toutes les autres variables que vous devez modifier sont notées en haut de l’exemple de code.</span><span class="sxs-lookup"><span data-stu-id="5503e-318">Any other variables that you must change are noted at the top of the code example.</span></span>
  
## <a name="verifying-the-results"></a><span data-ttu-id="5503e-319">Vérification des résultats</span><span class="sxs-lookup"><span data-stu-id="5503e-319">Verifying the results</span></span>
<span data-ttu-id="5503e-320"><a name="pj15_PrerequisitesWCF_Verify"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-320"><a name="pj15_PrerequisitesWCF_Verify"> </a></span></span>

<span data-ttu-id="5503e-321">L’obtention et l’interprétation des résultats à partir d’un exemple de code ne sont pas toujours simples.</span><span class="sxs-lookup"><span data-stu-id="5503e-321">Getting and interpreting results from a code sample is not always straightforward.</span></span> <span data-ttu-id="5503e-322">Par exemple, si vous créez un projet, vous devez le publier pour qu’il puisse apparaître sur la page centre Project dans Project Web App.</span><span class="sxs-lookup"><span data-stu-id="5503e-322">For example, if you create a project, you must publish the project before it can appear on the Project Center page in Project Web App.</span></span>
  
<span data-ttu-id="5503e-323">Vous pouvez vérifier les résultats des exemples de code de plusieurs manières, par exemple :</span><span class="sxs-lookup"><span data-stu-id="5503e-323">You can verify code sample results in several ways, for example:</span></span>
  
- <span data-ttu-id="5503e-324">Utilisez le client Project Professionnel 2013 pour ouvrir le projet à partir de l’ordinateur Project Server et afficher les éléments que vous souhaitez.</span><span class="sxs-lookup"><span data-stu-id="5503e-324">Use the Project Professional 2013 client to open the project from the Project Server computer, and view the items that you want.</span></span>
    
- <span data-ttu-id="5503e-325">Afficher les projets publiés sur la page Project centre de Project Web App ( `https://ServerName/ProjectServerName/projects.aspx` ).</span><span class="sxs-lookup"><span data-stu-id="5503e-325">View published projects on the Project Center page of Project Web App ( `https://ServerName/ProjectServerName/projects.aspx`).</span></span>
    
- <span data-ttu-id="5503e-326">Affichez le journal de file d’attente Project Web App.</span><span class="sxs-lookup"><span data-stu-id="5503e-326">View the Queue log in Project Web App.</span></span> <span data-ttu-id="5503e-327">Ouvrez la page Paramètres serveur (sélectionnez l’icône **Paramètres** dans le  coin supérieur droit), puis choisissez Mes travaux en file d’attente sous la section **Paramètres** personnel ( `https://ServerName/ProjectServerName/MyJobs.aspx` ).</span><span class="sxs-lookup"><span data-stu-id="5503e-327">Open the Server Settings page (choose the **Settings** icon in the top-right corner), and then choose **My Queued Jobs** under the **Personal Settings** section (  `https://ServerName/ProjectServerName/MyJobs.aspx`).</span></span> <span data-ttu-id="5503e-328">Dans la **liste de** listes de listes listes, vous pouvez trier en fonction de l’état du travail.</span><span class="sxs-lookup"><span data-stu-id="5503e-328">In the **View** drop-down list, you can sort by the job status.</span></span> <span data-ttu-id="5503e-329">L’état par défaut **est En cours et Travaux en échec de la semaine dernière.**</span><span class="sxs-lookup"><span data-stu-id="5503e-329">The default status is **In Progress and Failed Jobs in the Past Week**.</span></span> 
    
- <span data-ttu-id="5503e-330">Utilisez la page Serveur Paramètres dans Project Web App ( ) pour gérer tous les travaux en file d’attente et supprimer ou forcer l’enregistrement des objets `https://ServerName/ProjectServerName/_layouts/15/pwa/admin/admin.aspx` d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="5503e-330">Use the Server Settings page in Project Web App ( `https://ServerName/ProjectServerName/_layouts/15/pwa/admin/admin.aspx`) to manage all queue jobs and delete or force check-in enterprise objects.</span></span> <span data-ttu-id="5503e-331">Vous devez avoir des autorisations administratives pour accéder à ces liens sur la page Paramètres serveur.</span><span class="sxs-lookup"><span data-stu-id="5503e-331">You must have administrative permissions to access those links on the Server Settings page.</span></span>
    
- <span data-ttu-id="5503e-332">Utilisez **Microsoft SQL Server Management Studio** pour exécuter une requête sur une table d’une base de données Project Server.</span><span class="sxs-lookup"><span data-stu-id="5503e-332">Use **Microsoft SQL Server Management Studio** to run a query on a table of a Project Server database.</span></span> <span data-ttu-id="5503e-333">Par exemple, utilisez la requête suivante pour sélectionner les 200 premières lignes du tableau MSP_WORKFLOW_STAGE_PDPS afin d’afficher des informations sur les pages de détails de projet (PDP) dans les étapes du flux de travail.</span><span class="sxs-lookup"><span data-stu-id="5503e-333">For example, use the following query to select the top 200 rows of the MSP_WORKFLOW_STAGE_PDPS table to show information about the project detail pages (PDPs) in workflow stages.</span></span> 
    
```sql
        SELECT TOP 200 [STAGE_UID]
                ,[PDP_UID]
                ,[PDP_NAME]
                ,[PDP_POSITION]
                ,[PDP_ID]
                ,[PDP_STAGE_DESCRIPTION]
                ,[PDP_REQUIRES_ATTENTION]
        FROM [ProjectService].[pub].[MSP_WORKFLOW_STAGE_PDPS]
```

## <a name="cleaning-up"></a><span data-ttu-id="5503e-334">Nettoyage</span><span class="sxs-lookup"><span data-stu-id="5503e-334">Cleaning up</span></span>
<span data-ttu-id="5503e-335"><a name="pj15_PrerequisitesWCF_Cleanup"> </a></span><span class="sxs-lookup"><span data-stu-id="5503e-335"><a name="pj15_PrerequisitesWCF_Cleanup"> </a></span></span>

<span data-ttu-id="5503e-336">Après avoir testé certains exemples de code, certains objets et paramètres d’entreprise doivent être supprimés ou réinitialisés.</span><span class="sxs-lookup"><span data-stu-id="5503e-336">After you test some code samples, there are enterprise objects and settings that should be deleted or reset.</span></span> <span data-ttu-id="5503e-337">Vous pouvez utiliser la page Serveur Paramètres dans Project Web App pour gérer les données d’entreprise ( `https://ServerName/ProjectServerName/_layouts/15/pwa/admin/admin.aspx` ).</span><span class="sxs-lookup"><span data-stu-id="5503e-337">You can use the Server Settings page in Project Web App to manage enterprise data ( `https://ServerName/ProjectServerName/_layouts/15/pwa/admin/admin.aspx`).</span></span> <span data-ttu-id="5503e-338">Les liens de la page Paramètres serveur vous permettent de supprimer les anciens éléments, de forcer l’enregistrement des projets, de gérer la file d’attente des travaux pour tous les utilisateurs et d’effectuer d’autres tâches administratives.</span><span class="sxs-lookup"><span data-stu-id="5503e-338">Links on the Server Settings page enable you to delete old items, force check-in projects, manage the job queue for all users, and perform other administrative tasks.</span></span>
  
<span data-ttu-id="5503e-339">Voici quelques-uns des liens sur la page Serveur Paramètres à utiliser pour les activités de nettoyage classiques après l’exécution d’exemples de code :</span><span class="sxs-lookup"><span data-stu-id="5503e-339">Following are some of the links on the Server Settings page to use for typical cleanup activities after running code samples:</span></span>
  
- <span data-ttu-id="5503e-340">**Champs personnalisés d’entreprise et tables de choix**</span><span class="sxs-lookup"><span data-stu-id="5503e-340">**Enterprise Custom Fields and Lookup Tables**</span></span>
    
- <span data-ttu-id="5503e-341">**Gérer les travaux en file d’attente**</span><span class="sxs-lookup"><span data-stu-id="5503e-341">**Manage Queue Jobs**</span></span>
    
- <span data-ttu-id="5503e-342">**Supprimer des objets d’entreprise**</span><span class="sxs-lookup"><span data-stu-id="5503e-342">**Delete Enterprise Objects**</span></span>
    
- <span data-ttu-id="5503e-343">**Forcer l’Enterprise objets**</span><span class="sxs-lookup"><span data-stu-id="5503e-343">**Force Check-in Enterprise Objects**</span></span>
    
- <span data-ttu-id="5503e-344">**Types de projets d’entreprise**</span><span class="sxs-lookup"><span data-stu-id="5503e-344">**Enterprise Project Types**</span></span>
    
- <span data-ttu-id="5503e-345">**Phases du flux de travail**</span><span class="sxs-lookup"><span data-stu-id="5503e-345">**Workflow Phases**</span></span>
    
- <span data-ttu-id="5503e-346">**Étapes du flux de travail**</span><span class="sxs-lookup"><span data-stu-id="5503e-346">**Workflow Stages**</span></span>
    
- <span data-ttu-id="5503e-347">**Pages de détails de projet**</span><span class="sxs-lookup"><span data-stu-id="5503e-347">**Project Detail Pages**</span></span>
    
- <span data-ttu-id="5503e-348">**Périodes de rapports de temps**</span><span class="sxs-lookup"><span data-stu-id="5503e-348">**Time Reporting Periods**</span></span>
    
- <span data-ttu-id="5503e-349">**Paramètres et valeurs par défaut de la feuille de temps**</span><span class="sxs-lookup"><span data-stu-id="5503e-349">**Timesheet Settings and Defaults**</span></span>
    
- <span data-ttu-id="5503e-350">**Classifications des lignes**</span><span class="sxs-lookup"><span data-stu-id="5503e-350">**Line Classifications**</span></span>
    
<span data-ttu-id="5503e-351">Les paramètres supplémentaires sont gérés par SharePoint Server 2013 pour chaque instance Project Web App, plutôt que par une page Project Web App Server Paramètres spécifique.</span><span class="sxs-lookup"><span data-stu-id="5503e-351">Additional settings are managed by SharePoint Server 2013 for each Project Web App instance, rather than by a specific Project Web App Server Settings page.</span></span> <span data-ttu-id="5503e-352">In the SharePoint Central Administration application, choose **General Application Paramètres,** choose **Manage** under Project **Server Paramètres**, and then choose the Project Web App instance in the drop-down list on the Server Paramètres page.</span><span class="sxs-lookup"><span data-stu-id="5503e-352">In the SharePoint Central Administration application, choose **General Application Settings**, choose **Manage** under **Project Server Settings**, and then choose the Project Web App instance in the drop-down list on the Server Settings page.</span></span> <span data-ttu-id="5503e-353">Par exemple, sélectionnez **Les handlers** d’événements côté serveur pour ajouter ou supprimer des handlers d’événements pour l’instance Project Web App sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="5503e-353">For example, choose **Server Side Event Handlers** to add or delete event handlers for the selected Project Web App instance.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="5503e-354">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="5503e-354">See also</span></span>

- [<span data-ttu-id="5503e-355">Conditions préalables pour les exemples de code basés sur ASMX</span><span class="sxs-lookup"><span data-stu-id="5503e-355">Prerequisites for ASMX-based code samples in Project</span></span>](prerequisites-for-asmx-based-code-samples-in-project.md)   
- [<span data-ttu-id="5503e-356">Walkthrough: Developing PSI applications using WCF</span><span class="sxs-lookup"><span data-stu-id="5503e-356">Walkthrough: Developing PSI applications using WCF</span></span>](https://msdn.microsoft.com/library/65707234-c3da-44e4-8364-32a6be28f645%28Office.15%29.aspx)   
- [<span data-ttu-id="5503e-357">Utiliser l’emprunt d’identité avec WCF</span><span class="sxs-lookup"><span data-stu-id="5503e-357">Use Impersonation with WCF</span></span>](https://msdn.microsoft.com/library/e3597901-2f02-44a2-8076-d32aae540b38%28Office.15%29.aspx)  
- [<span data-ttu-id="5503e-358">Vue d’ensemble de la référence Project PSI</span><span class="sxs-lookup"><span data-stu-id="5503e-358">Project PSI reference overview</span></span>](project-psi-reference-overview.md) 
- [<span data-ttu-id="5503e-359">Centre de développement SharePoint</span><span class="sxs-lookup"><span data-stu-id="5503e-359">SharePoint Developer Center</span></span>](https://msdn.microsoft.com/sharepoint/default.aspx)
    

