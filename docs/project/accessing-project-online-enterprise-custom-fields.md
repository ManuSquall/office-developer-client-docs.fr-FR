---
title: Accès aux champs personnalisés d’entreprise Project Online
manager: soliver
ms.date: 11/08/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 25509631-fa14-49d8-b594-cfacf5355c38
description: 'Project Online est un service Office 365 les entreprises peuvent étendre pour répondre aux besoins de l’entreprise. Une zone d’extension est des champs personnalisés d’entreprise (ECFs). ECFs sont des champs de valeur typée qui peuvent être ajoutés à des projets, des ressources et des tâches. Le tableau suivant répertorie les ECFs associer à des projets, des ressources et des tâches et fournit un exemple d’une valeur d’une instance de ce ECF :'
ms.openlocfilehash: d6c8f97ffc887b33e5d81af8e463cf10502845dd
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19787798"
---
# <a name="accessing-project-online-enterprise-custom-fields"></a><span data-ttu-id="1d7fe-106">Accès aux champs personnalisés d’entreprise Project Online</span><span class="sxs-lookup"><span data-stu-id="1d7fe-106">Accessing Project Online enterprise custom fields</span></span>

<span data-ttu-id="1d7fe-107">Project Online est un service Office 365 les entreprises peuvent étendre pour répondre aux besoins de l’entreprise.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-107">Project Online is an Office 365 service that companies can extend to meet business needs.</span></span> <span data-ttu-id="1d7fe-108">Une zone d’extension est des champs personnalisés d’entreprise (ECFs).</span><span class="sxs-lookup"><span data-stu-id="1d7fe-108">One extension area is Enterprise Custom Fields (ECFs).</span></span> <span data-ttu-id="1d7fe-109">ECFs sont des champs de valeur typée qui peuvent être ajoutés à des projets, des ressources et des tâches.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-109">ECFs are typed value fields that can be added to projects, resources, and tasks.</span></span> <span data-ttu-id="1d7fe-110">Le tableau suivant répertorie les ECFs associer à des projets, des ressources et des tâches et fournit un exemple d’une valeur d’une instance de ce ECF :</span><span class="sxs-lookup"><span data-stu-id="1d7fe-110">The following table lists ECFs that associate with projects, resources, and tasks, and provides an example of a value for an instance of that ECF:</span></span>
  
|<span data-ttu-id="1d7fe-111">Nom ECF</span><span class="sxs-lookup"><span data-stu-id="1d7fe-111">ECF Name</span></span>|<span data-ttu-id="1d7fe-112">Type ECF</span><span class="sxs-lookup"><span data-stu-id="1d7fe-112">ECF Type</span></span>|<span data-ttu-id="1d7fe-113">Association</span><span class="sxs-lookup"><span data-stu-id="1d7fe-113">Association</span></span>|<span data-ttu-id="1d7fe-114">Exemple de valeur</span><span class="sxs-lookup"><span data-stu-id="1d7fe-114">Example Value</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="1d7fe-115">Justification</span><span class="sxs-lookup"><span data-stu-id="1d7fe-115">Justification</span></span>  <br/> |<span data-ttu-id="1d7fe-116">TEXT</span><span class="sxs-lookup"><span data-stu-id="1d7fe-116">TEXT</span></span>  <br/> |<span data-ttu-id="1d7fe-117">Project</span><span class="sxs-lookup"><span data-stu-id="1d7fe-117">Project</span></span>  <br/> |<span data-ttu-id="1d7fe-118">Un utilisateur final peut enregistrer les statistiques essentielles et des données d’intégrité, avec des résultats qui comprennent une évaluation de l’intégrité et d’une action personnalisée plan vers une meilleure santé.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-118">An end user can record vital statistics and health data, with results that include a health evaluation and an individualized action plan towards better health.</span></span>  <br/> |
|<span data-ttu-id="1d7fe-119">Évaluation des risques</span><span class="sxs-lookup"><span data-stu-id="1d7fe-119">Risk Rating</span></span>  <br/> |<span data-ttu-id="1d7fe-120">TEXT</span><span class="sxs-lookup"><span data-stu-id="1d7fe-120">TEXT</span></span>  <br/> |<span data-ttu-id="1d7fe-121">Project</span><span class="sxs-lookup"><span data-stu-id="1d7fe-121">Project</span></span>  <br/> |<span data-ttu-id="1d7fe-122">Low</span><span class="sxs-lookup"><span data-stu-id="1d7fe-122">Low</span></span>  <br/> |
|<span data-ttu-id="1d7fe-123">RETOUR SUR INVESTISSEMENT</span><span class="sxs-lookup"><span data-stu-id="1d7fe-123">ROI</span></span>  <br/> |<span data-ttu-id="1d7fe-124">NOMBRE</span><span class="sxs-lookup"><span data-stu-id="1d7fe-124">NUMBER</span></span>  <br/> |<span data-ttu-id="1d7fe-125">Project</span><span class="sxs-lookup"><span data-stu-id="1d7fe-125">Project</span></span>  <br/> |<span data-ttu-id="1d7fe-126">2,10</span><span class="sxs-lookup"><span data-stu-id="1d7fe-126">2.10</span></span>  <br/> |
|<span data-ttu-id="1d7fe-127">Coût total</span><span class="sxs-lookup"><span data-stu-id="1d7fe-127">Total Cost</span></span>  <br/> |<span data-ttu-id="1d7fe-128">COÛT</span><span class="sxs-lookup"><span data-stu-id="1d7fe-128">COST</span></span>  <br/> |<span data-ttu-id="1d7fe-129">Project</span><span class="sxs-lookup"><span data-stu-id="1d7fe-129">Project</span></span>  <br/> |<span data-ttu-id="1d7fe-130">$1,031,514</span><span class="sxs-lookup"><span data-stu-id="1d7fe-130">$1,031,514</span></span>  <br/> |
|<span data-ttu-id="1d7fe-131">Lancement de l’équipe</span><span class="sxs-lookup"><span data-stu-id="1d7fe-131">Launch Team</span></span>  <br/> |<span data-ttu-id="1d7fe-132">TEXT</span><span class="sxs-lookup"><span data-stu-id="1d7fe-132">TEXT</span></span>  <br/> |<span data-ttu-id="1d7fe-133">Ressources</span><span class="sxs-lookup"><span data-stu-id="1d7fe-133">Resources</span></span>  <br/> |<span data-ttu-id="1d7fe-134">Oui</span><span class="sxs-lookup"><span data-stu-id="1d7fe-134">Yes</span></span>  <br/> |
|<span data-ttu-id="1d7fe-135">Rôle de position</span><span class="sxs-lookup"><span data-stu-id="1d7fe-135">Position Role</span></span>  <br/> |<span data-ttu-id="1d7fe-136">TEXT</span><span class="sxs-lookup"><span data-stu-id="1d7fe-136">TEXT</span></span>  <br/> |<span data-ttu-id="1d7fe-137">Ressources</span><span class="sxs-lookup"><span data-stu-id="1d7fe-137">Resources</span></span>  <br/> |<span data-ttu-id="1d7fe-138">Testeur</span><span class="sxs-lookup"><span data-stu-id="1d7fe-138">Tester</span></span>  <br/> |
|<span data-ttu-id="1d7fe-139">État de l’indicateur</span><span class="sxs-lookup"><span data-stu-id="1d7fe-139">Flag Status</span></span>  <br/> |<span data-ttu-id="1d7fe-140">INDICATEUR</span><span class="sxs-lookup"><span data-stu-id="1d7fe-140">FLAG</span></span>  <br/> |<span data-ttu-id="1d7fe-141">Tâche</span><span class="sxs-lookup"><span data-stu-id="1d7fe-141">Task</span></span>  <br/> |<span data-ttu-id="1d7fe-142">Non</span><span class="sxs-lookup"><span data-stu-id="1d7fe-142">No</span></span>  <br/> |
|<span data-ttu-id="1d7fe-143">Santé</span><span class="sxs-lookup"><span data-stu-id="1d7fe-143">Health</span></span>  <br/> |<span data-ttu-id="1d7fe-144">TEXT</span><span class="sxs-lookup"><span data-stu-id="1d7fe-144">TEXT</span></span>  <br/> |<span data-ttu-id="1d7fe-145">Tâche</span><span class="sxs-lookup"><span data-stu-id="1d7fe-145">Task</span></span>  <br/> |<span data-ttu-id="1d7fe-146">Non spécifié</span><span class="sxs-lookup"><span data-stu-id="1d7fe-146">Not specified</span></span>  <br/> |
   
<span data-ttu-id="1d7fe-147">ECFs sont définies au niveau de l’instance Project Web Application (PWA), externe à partir de n’importe quel projet, ressource ou tâche.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-147">ECFs are defined at the Project Web Application (PWA) instance, external from any project, resource, or task.</span></span> <span data-ttu-id="1d7fe-148">Ils peuvent encore associés à un projet, la ressource ou la tâche.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-148">Yet, they can become associated with a project, resource, or task.</span></span> <span data-ttu-id="1d7fe-149">Cet article fournit un aperçu des champs personnalisés à l’aide d’un exemple d’application d’introduction et se concentre sur la récupération des valeurs ECF.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-149">This article provides an introductory look at custom fields using a sample application and focuses on retrieving ECF values.</span></span> 
  
<span data-ttu-id="1d7fe-150">Vous pouvez télécharger l’exemple complet à https://github.com/OfficeDev/Project-CSOM-Read-Enterprise-CustomFields.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-150">You can download the complete sample at https://github.com/OfficeDev/Project-CSOM-Read-Enterprise-CustomFields.</span></span>
  
<span data-ttu-id="1d7fe-151">En outre, Project Online prend en charge les champs personnalisés locaux en tant qu’en lecture seule des entités spécifiques pour le projet spécifique, la ressource ou la tâche.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-151">Additionally, Project Online supports local custom fields as read-only entities specific to the specific project, resource, or task.</span></span> <span data-ttu-id="1d7fe-152">Pour plus d’informations sur les champs personnalisés locaux, consultez l’exemple https://github.com/OfficeDev/Project-CSOM-Read-Local-CustomFields\.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-152">For more information on local custom fields, see the sample https://github.com/OfficeDev/Project-CSOM-Read-Local-CustomFields\.</span></span>
  
## <a name="background-materials"></a><span data-ttu-id="1d7fe-153">Documents d’arrière-plan</span><span class="sxs-lookup"><span data-stu-id="1d7fe-153">Background materials</span></span>

<span data-ttu-id="1d7fe-154">Un article précédent, le [développement d’une application Project Online à l’aide du modèle objet côté client](developing-a-project-online-application-using-the-client-side-object-model.md), fournit d’arrière-plan et l’orientation initiale pour le développement d’applications à l’aide de CSOM.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-154">A previous article, [Developing a Project Online application using the client-side object model](developing-a-project-online-application-using-the-client-side-object-model.md), provides background and the initial orientation for developing applications using CSOM.</span></span> <span data-ttu-id="1d7fe-155">Consultez cet article pour les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="1d7fe-155">Refer to this article for the following items:</span></span>
  
- <span data-ttu-id="1d7fe-156">Informations générales sur Project, éditions autonomes et en nuage</span><span class="sxs-lookup"><span data-stu-id="1d7fe-156">Background information about Project, stand-alone and cloud-based editions</span></span> 
    
- <span data-ttu-id="1d7fe-157">Environnement de développement (éditions de Visual Studio et les bibliothèques de logiciels)</span><span class="sxs-lookup"><span data-stu-id="1d7fe-157">Development environment (Visual Studio editions and software libraries)</span></span>
    
- <span data-ttu-id="1d7fe-158">Programme d’installation de Visual Studio project pour une application .NET à l’aide de la bibliothèque de CSOM</span><span class="sxs-lookup"><span data-stu-id="1d7fe-158">Visual Studio project setup for a .NET application using the CSOM library</span></span>
    
- <span data-ttu-id="1d7fe-159">Connexion au service Project Online</span><span class="sxs-lookup"><span data-stu-id="1d7fe-159">Connecting to the Project Online service</span></span>
    
## <a name="preliminaries-class-level-declarations"></a><span data-ttu-id="1d7fe-160">Étapes préliminaires (déclarations au niveau de la classe)</span><span class="sxs-lookup"><span data-stu-id="1d7fe-160">Preliminaries (class-level declarations)</span></span>

<span data-ttu-id="1d7fe-161">La classe pour cette application définit deux éléments de données : le contexte du projet et le dictionnaire pwaECF.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-161">The class for this application defines two data items: the project context and the pwaECF dictionary.</span></span>
  
<span data-ttu-id="1d7fe-162">L’objet de contexte de projet fait partie du modèle de projet et connecte l’application et l’instance de PWA.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-162">The project context object is part of the Project CSOM, and connects the application and the PWA instance.</span></span> <span data-ttu-id="1d7fe-163">Toutes les demandes au service utilisent le contexte du projet.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-163">All requests to the service use the project context.</span></span>
  
```cs
private static ProjectContext projContext = 
     new ProjectContext("https://Contoso216.sharepoint.com/sites/pwa");

```

<span data-ttu-id="1d7fe-164">Le contexte nécessite que le point de terminaison de connexion pour créer une instance d’une application.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-164">The context needs the connection endpoint to create an instance in an application.</span></span> <span data-ttu-id="1d7fe-165">Le point de terminaison de connexion est l’URL de votre instance de PWA.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-165">The connection endpoint is the URL of your PWA instance.</span></span> 
  
<span data-ttu-id="1d7fe-166">Le dictionnaire pwaECF stocke le projet ECFs définis au niveau de PWA.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-166">The pwaECF dictionary stores the project ECFs defined at the PWA level.</span></span> <span data-ttu-id="1d7fe-167">Le dictionnaire utilise la ECF. InternalName en tant que la clé et de l’objet CustomField comme valeur.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-167">The dictionary uses the ECF.InternalName as the key, and the CustomField object as the value.</span></span> <span data-ttu-id="1d7fe-168">Le dictionnaire est renseigné dans la méthode ListPWACustomFields et ensuite utilisé comme une référence dans la méthode Main.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-168">The dictionary is populated in the ListPWACustomFields method, and then used as a reference in the Main method.</span></span> 
  
```cs
    //Dictionary of ECFs
        static Dictionary<String, CustomField> pwaECF = new Dictionary<string, CustomField>();

```

## <a name="main-method"></a><span data-ttu-id="1d7fe-169">Méthode principale</span><span class="sxs-lookup"><span data-stu-id="1d7fe-169">Main method</span></span>

<span data-ttu-id="1d7fe-170">La méthode Main gère le flux de l’application.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-170">The Main method manages the application flow.</span></span> <span data-ttu-id="1d7fe-171">Comme avec d’autres applications qui utilisent le Project Online CSOM principal initialise le contexte du projet.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-171">As with other applications that use the Project Online CSOM, Main initializes the project context.</span></span> 
  
1. <span data-ttu-id="1d7fe-172">Récupérer et répertorier les ECFs dans l’instance de PWA Project Online.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-172">Retrieve and list the ECFs in the Project Online PWA.</span></span>
    
   <span data-ttu-id="1d7fe-173">Cette fonctionnalité est implémentée dans la méthode ListPWACustomFields.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-173">This functionality is implemented in the ListPWACustomFields method.</span></span>
    
2. <span data-ttu-id="1d7fe-174">Récupérer les projets avec des champs personnalisés et les champs non personnalisés.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-174">Retrieve projects with custom fields and non-custom fields.</span></span>
    
   <span data-ttu-id="1d7fe-175">Lors de l’extraction des projets avec ECFs, la demande de requête au service Project Online doit inclure les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="1d7fe-175">When retrieving projects with ECFs, the query request to the Project Online service needs to include the following items:</span></span> 
    
   - <span data-ttu-id="1d7fe-176">**IncludeCustomFields** &ndash; Cet élément demande le service pour retourner une collection de PublishedProjects dont chaque projet publié inclut une extension qui prend en charge les champs personnalisés.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-176">**IncludeCustomFields** &ndash; This item requests the service to return a collection of PublishedProjects where each published project includes an extension that supports custom fields.</span></span> <span data-ttu-id="1d7fe-177">Sauf si cet élément est spécifié, Project Online retourne des objets PublishedProject qui ne contiennent pas de données de champ personnalisé.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-177">Unless this item is specified, Project Online returns PublishedProject objects that do not include Custom Field data.</span></span>
    
   - <span data-ttu-id="1d7fe-178">**IncludeCustomFields.CustomFields** &ndash; cet élément demande le service pour remplir les objets PublishedProject avec des données CustomFields.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-178">**IncludeCustomFields.CustomFields** &ndash; This item requests the service to populate the PublishedProject objects with CustomFields data.</span></span>
    
   <span data-ttu-id="1d7fe-179">La requête suivante spécifie l’Id de projet ainsi que le nom, ainsi que l’extension de l’objet pour les champs personnalisés et les valeurs de champ personnalisé.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-179">The following request specifies the project Id and Name, as well as the object extension for custom fields and the custom field values.</span></span>
    
   ```cs
        var projBlk = projContext.LoadQuery(
        projContext.Projects.Include(
            p => p.Id, 
            p => p.Name,
            p => p.IncludeCustomFields,
            p => p.IncludeCustomFields.CustomFields
        ));
    
   ```

3. <span data-ttu-id="1d7fe-180">Examiner chaque projet.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-180">Examine each project.</span></span>
    
   <span data-ttu-id="1d7fe-181">Les objets de projet utilisées dans cette application sont le type PublishedProject, car les valeurs sont récupérées et affichées.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-181">The project objects used in this application are the PublishedProject type because the values are retrieved and displayed.</span></span> 
    
   <span data-ttu-id="1d7fe-182">Si vous devez mettre à jour les valeurs de données dans un ou plusieurs projets, le projet en cours de la mise à jour doit être extrait et l’application doit utiliser un objet DraftProject pour récupérer les valeurs et mettre à jour le projet.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-182">If you need to update data values in one or more projects, the project undergoing the update would be checked out and the application would use a DraftProject object to retrieve the values and update the project.</span></span>
    
4. <span data-ttu-id="1d7fe-183">Accès aux entrées ECF pour un projet</span><span class="sxs-lookup"><span data-stu-id="1d7fe-183">Accessing the ECF entries for a project</span></span>
    
   <span data-ttu-id="1d7fe-184">Chaque instance ECF sépare le reste des informations ECF la valeur du champ.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-184">Each ECF instance separates the field value from the rest of the ECF information.</span></span> <span data-ttu-id="1d7fe-185">La valeur du champ est stockée dans le cadre d’une paire clé/valeur.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-185">The field value is stored as part of a key/value pair.</span></span> <span data-ttu-id="1d7fe-186">Le reste des informations est stocké dans un objet CustomField.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-186">The rest of the information is stored in a CustomField object.</span></span>
    
   <span data-ttu-id="1d7fe-187">Accès aux valeurs ECF dans un projet se compose de deux parties :</span><span class="sxs-lookup"><span data-stu-id="1d7fe-187">Accessing ECF values in a project consists of two parts:</span></span>
    
   - <span data-ttu-id="1d7fe-188">Parcourir la collection CustomFields</span><span class="sxs-lookup"><span data-stu-id="1d7fe-188">Cycling through the CustomFields collection</span></span>
    
   - <span data-ttu-id="1d7fe-189">Accès à l’entrée appropriée à l’aide de deux constructions.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-189">Accessing the proper entry using two constructs.</span></span>
    
   <span data-ttu-id="1d7fe-190">Chaque projet stocke les entrées ECF associées à deux endroits, une collection CustomFields énumérable et et les valeurs de champ dans le cadre de paires clé/valeur.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-190">Each project stores associated ECF entries in two places, a CustomFields collection that is enumerable and and the field values as part of key/value pairs.</span></span> <span data-ttu-id="1d7fe-191">Dans les paires clé/valeur, internalName est la clé et la valeur du champ est la valeur.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-191">In the key/value pairs, the internalName is the key and the field value is the value.</span></span> <span data-ttu-id="1d7fe-192">Utilisation d’un dictionnaire pour maintenir et accéder aux valeurs de champ.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-192">Use a dictionary to hold and access the field values.</span></span> 
    
   <span data-ttu-id="1d7fe-193">Les propriétés ECF, autre que les valeurs de champ, sont stockées dans les objets CustomField, un seul objet par projet.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-193">The ECF properties, other than the field values, are stored in CustomField objects, one object per project.</span></span> <span data-ttu-id="1d7fe-194">Une collection CustomFields permet d’accéder aux ECFs associés à un projet individuel.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-194">Use a CustomFields collection to access the ECFs associated with an individual project.</span></span> 
    
5. <span data-ttu-id="1d7fe-195">Chaque projet stocke les ECFs associés à une collection où chaque entrée ECF se compose d’une clé--le nom interne de l’ECF--et un objet qui conserve la valeur de l’ECF.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-195">Each project stores the associated ECFs in a collection where each ECF entry consists of a key--the internal name of the ECF--and an object that holds the value of the ECF.</span></span> <span data-ttu-id="1d7fe-196">Transfert de la collection à un dictionnaire pour accéder aux entrées individuelles.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-196">Transfer the collection to a dictionary to access individual entries.</span></span> <span data-ttu-id="1d7fe-197">La déclaration suivante.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-197">The declaration follows.</span></span>
    
   ```cs
    Dictionary<string, object> projDict = pubProj.IncludeCustomFields.FieldValues;
    
   ```

   <span data-ttu-id="1d7fe-198">La valeur dans une entrée de dictionnaire correspond au type de données de l’ECF.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-198">The value in a dictionary entry corresponds to the data type of the ECF.</span></span> <span data-ttu-id="1d7fe-199">L’objet pour chaque ECF correspond à l’un des différents types de.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-199">The object for each ECF maps to one of a variety of types.</span></span> <span data-ttu-id="1d7fe-200">La plupart des ECFs utilisent les types simples qui entrent dans les variables standards.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-200">Most ECFs use simple types that fit into standard variables.</span></span> <span data-ttu-id="1d7fe-201">Le fragment suivant montre que le traitement minimal est impliqué pour plusieurs types de :</span><span class="sxs-lookup"><span data-stu-id="1d7fe-201">The following fragment shows that minimal processing is involved for several types:</span></span>
    
   ```cs
    switch (cf.FieldType)
    {
        case CustomFieldType.COST:
            decimal costValue = (decimal)oVal;
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                costValue.ToString("C"));
            break;
        case CustomFieldType.DATE:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.FINISHDATE:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.DURATION:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.FLAG:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.NUMBER:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
    
   ```

   <span data-ttu-id="1d7fe-202">La table de choix de valeurs de texte, toutefois, requiert un traitement supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-202">The lookup table of TEXT values, however, requires additional processing.</span></span> <span data-ttu-id="1d7fe-203">L’application extrait la table de choix approprié du service et renvoie l’instance ECF (avec des valeurs uniques ou multiples) en parcourant la table de choix.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-203">The application retrieves the appropriate lookup table from the service, and outputs the ECF instance (with single or multiple values) by traversing the lookup table.</span></span> <span data-ttu-id="1d7fe-204">Le fragment de code suivant illustre le traitement de texte ECFs, y compris ceux avec des valeurs simples et ceux qui utilisent des tables de choix :</span><span class="sxs-lookup"><span data-stu-id="1d7fe-204">The following code fragment shows processing of TEXT ECFs, including those with simple values and those using lookup tables:</span></span> 
    
   ```cs
    case CustomFieldType.TEXT:
        if (!cf.LookupTable.ServerObjectIsNull.HasValue ||
            (cf.LookupTable.ServerObjectIsNull.HasValue && 
            cf.LookupTable.ServerObjectIsNull.Value))
        { //No lookup table
            Console.WriteLine("\tFieldType:\t{0}\n\tText:\t{1}", cf.FieldType, 
                oVal.ToString());
        }
        else
        { //Lookup table
            Console.WriteLine("\tFieldType:\t{0} - using Lookup Table", cf.FieldType);
            String[] entries = (String[])oVal;
            foreach (String entry in entries)
            {
                var luEntry = projContext.LoadQuery(cf.LookupTable.Entries
                    .Where(e => e.InternalName == entry));
                projContext.ExecuteQuery();
                Console.WriteLine("\tLookup Value:\t{0}", luEntry.First().FullValue);  
            }
        }
        break;
    
   ```

   <span data-ttu-id="1d7fe-205">Cette application renvoie simplement la valeur (s) ; Toutefois, il est possible d’obtenir davantage de signification dans les valeurs de données.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-205">This application simply outputs the value(s); however, it is possible to get more meaning from the data value(s).</span></span>
    
## <a name="listpwacustomfields"></a><span data-ttu-id="1d7fe-206">ListPWACustomFields</span><span class="sxs-lookup"><span data-stu-id="1d7fe-206">ListPWACustomFields</span></span>

<span data-ttu-id="1d7fe-207">La méthode ListPWACustomFields récupère et répertorie les ECFs associés aux projets.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-207">The ListPWACustomFields method retrieves and lists the ECFs associated with projects.</span></span> <span data-ttu-id="1d7fe-208">Cette méthode répertorie les ECFs inscrits sur l’instance de PWA qui peut être associé à des projets individuels.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-208">This method lists the ECFs registered on the PWA instance that can be associated with individual projects.</span></span> <span data-ttu-id="1d7fe-209">Le point d’entrée pour accéder aux ECFs utilise l’élément CustomFields du contexte du projet, comme illustré à la demande de requête suivante :</span><span class="sxs-lookup"><span data-stu-id="1d7fe-209">The entry point for accessing the ECFs uses the CustomFields element of the project context, as in the following query request:</span></span>
  
```cs
// Project ECFs
    var allECFields = 
            projContext.LoadQuery(projContext.CustomFields.Include(
            qp => qp.InternalName,
            qp => qp.Name
        ));
    projContext.ExecuteQuery();

```

<span data-ttu-id="1d7fe-210">La méthode ne vérifie pas si un projet utilise un ECF spécifique.</span><span class="sxs-lookup"><span data-stu-id="1d7fe-210">The method does not check to see whether a project uses a specific ECF.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="1d7fe-211">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1d7fe-211">See also</span></span>

- [<span data-ttu-id="1d7fe-212">Portail de développement Project</span><span class="sxs-lookup"><span data-stu-id="1d7fe-212">Project Development Portal</span></span>](http://dev.office.com/project.aspx)
- [<span data-ttu-id="1d7fe-213">Vue d’ensemble : Tables de choix et champs personnalisés d’entreprise</span><span class="sxs-lookup"><span data-stu-id="1d7fe-213">Overview: Enterprise custom fields and lookup tables</span></span>](https://support.office.com/en-us/article/overview-enterprise-custom-fields-and-lookup-tables-f99db553-0b33-4648-93c0-f6a74637d790?ui=en-us&rs=en-us&ad=us)
- <span data-ttu-id="1d7fe-214">[Local et champs personnalisés d’entreprise](https://msdn.microsoft.com/en-us/library/office/ms447495(v=office.14).aspx)</span><span class="sxs-lookup"><span data-stu-id="1d7fe-214">[Local and Enterprise Custom Fields](https://msdn.microsoft.com/en-us/library/office/ms447495(v=office.14).aspx)</span></span>
- [<span data-ttu-id="1d7fe-215">Ajouter ou modifier des champs personnalisés d’entreprise dans Project Server 2013</span><span class="sxs-lookup"><span data-stu-id="1d7fe-215">Add or edit enterprise custom fields in Project Server 2013</span></span>](https://docs.microsoft.com/en-us/project/add-or-edit-enterprise-custom-fields-in-project-server)
    

