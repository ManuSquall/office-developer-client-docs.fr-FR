---
title: Accès aux champs personnalisés d’entreprise Project Online
manager: soliver
ms.date: 11/08/2016
ms.audience: Developer
ms.assetid: 25509631-fa14-49d8-b594-cfacf5355c38
description: 'Project Online est un service Office 365 que les entreprises peuvent étendre afin de répondre à leurs besoins. Une zone d’extension est constituée par les champs personnalisés d’entreprise. Les champs personnalisés d’entreprise sont des champs où des valeurs sont saisies et qui peuvent être ajoutés à des projets, ressources et tâches. Le tableau suivant répertorie les champs personnalisés d’entreprise qui sont associés à des projets, ressources et tâches, et fournit un exemple de valeur pour une instance de ce champ personnalisé d’entreprise :'
localization_priority: Priority
ms.openlocfilehash: 9f754f1446890ae021bf6f7000ffba11e2a2df33
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/17/2019
ms.locfileid: "28708304"
---
# <a name="accessing-project-online-enterprise-custom-fields"></a><span data-ttu-id="acf62-106">Accès aux champs personnalisés d’entreprise Project Online</span><span class="sxs-lookup"><span data-stu-id="acf62-106">Accessing Project Online enterprise custom fields</span></span>

<span data-ttu-id="acf62-107">Project Online est un service Office 365 que les entreprises peuvent étendre afin de répondre à leurs besoins.</span><span class="sxs-lookup"><span data-stu-id="acf62-107">Project Online is an Office 365 service that companies can extend to meet business needs.</span></span> <span data-ttu-id="acf62-108">Une zone d’extension est constituée par les champs personnalisés d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="acf62-108">One extension area is Enterprise Custom Fields (ECFs).</span></span> <span data-ttu-id="acf62-109">Les champs personnalisés d’entreprise sont des champs où des valeurs sont saisies et qui peuvent être ajoutés à des projets, ressources et tâches.</span><span class="sxs-lookup"><span data-stu-id="acf62-109">ECFs are typed value fields that can be added to projects, resources, and tasks.</span></span> <span data-ttu-id="acf62-110">Le tableau suivant répertorie les champs personnalisés d’entreprise qui sont associés à des projets, ressources et tâches, et fournit un exemple de valeur pour une instance de ce champ personnalisé d’entreprise :</span><span class="sxs-lookup"><span data-stu-id="acf62-110">The following table lists ECFs that associate with projects, resources, and tasks, and provides an example of a value for an instance of that ECF:</span></span>
  
|<span data-ttu-id="acf62-111">Nom du champ personnalisé d’entreprise</span><span class="sxs-lookup"><span data-stu-id="acf62-111">ECF Name</span></span>|<span data-ttu-id="acf62-112">Type de champ personnalisé d’entreprise</span><span class="sxs-lookup"><span data-stu-id="acf62-112">ECF Type</span></span>|<span data-ttu-id="acf62-113">Association</span><span class="sxs-lookup"><span data-stu-id="acf62-113">Association</span></span>|<span data-ttu-id="acf62-114">Exemple de valeur</span><span class="sxs-lookup"><span data-stu-id="acf62-114">Example Value</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="acf62-115">Justification</span><span class="sxs-lookup"><span data-stu-id="acf62-115">Justification</span></span>  <br/> |<span data-ttu-id="acf62-116">TEXT</span><span class="sxs-lookup"><span data-stu-id="acf62-116">TEXT</span></span>  <br/> |<span data-ttu-id="acf62-117">Projet</span><span class="sxs-lookup"><span data-stu-id="acf62-117">Project</span></span>  <br/> |<span data-ttu-id="acf62-118">Un utilisateur final peut enregistrer des statistiques vitales et des données de santé, avec des résultats qui incluent une évaluation de santé et un plan d’action individualisé vers une meilleure santé.</span><span class="sxs-lookup"><span data-stu-id="acf62-118">An end user can record vital statistics and health data, with results that include a health evaluation and an individualized action plan towards better health.</span></span>  <br/> |
|<span data-ttu-id="acf62-119">Évaluation du risque</span><span class="sxs-lookup"><span data-stu-id="acf62-119">Risk Rating</span></span>  <br/> |<span data-ttu-id="acf62-120">TEXT</span><span class="sxs-lookup"><span data-stu-id="acf62-120">TEXT</span></span>  <br/> |<span data-ttu-id="acf62-121">Projet</span><span class="sxs-lookup"><span data-stu-id="acf62-121">Project</span></span>  <br/> |<span data-ttu-id="acf62-122">Faible</span><span class="sxs-lookup"><span data-stu-id="acf62-122">Low</span></span>  <br/> |
|<span data-ttu-id="acf62-123">RETOUR SUR INVESTISSEMENT</span><span class="sxs-lookup"><span data-stu-id="acf62-123">ROI</span></span>  <br/> |<span data-ttu-id="acf62-124">NUMBER</span><span class="sxs-lookup"><span data-stu-id="acf62-124">Number()</span></span>  <br/> |<span data-ttu-id="acf62-125">Projet</span><span class="sxs-lookup"><span data-stu-id="acf62-125">Project</span></span>  <br/> |<span data-ttu-id="acf62-126">2,10</span><span class="sxs-lookup"><span data-stu-id="acf62-126">2.10</span></span>  <br/> |
|<span data-ttu-id="acf62-127">Coût total</span><span class="sxs-lookup"><span data-stu-id="acf62-127">Total Cost</span></span>  <br/> |<span data-ttu-id="acf62-128">COST</span><span class="sxs-lookup"><span data-stu-id="acf62-128">Cost</span></span>  <br/> |<span data-ttu-id="acf62-129">Projet</span><span class="sxs-lookup"><span data-stu-id="acf62-129">Project</span></span>  <br/> |<span data-ttu-id="acf62-130">1 031 514 $</span><span class="sxs-lookup"><span data-stu-id="acf62-130">$1,031,514</span></span>  <br/> |
|<span data-ttu-id="acf62-131">Équipe de lancement</span><span class="sxs-lookup"><span data-stu-id="acf62-131">Launch Team</span></span>  <br/> |<span data-ttu-id="acf62-132">TEXT</span><span class="sxs-lookup"><span data-stu-id="acf62-132">TEXT</span></span>  <br/> |<span data-ttu-id="acf62-133">Ressources</span><span class="sxs-lookup"><span data-stu-id="acf62-133">Resources</span></span>  <br/> |<span data-ttu-id="acf62-134">Oui</span><span class="sxs-lookup"><span data-stu-id="acf62-134">Yes</span></span>  <br/> |
|<span data-ttu-id="acf62-135">Rôle</span><span class="sxs-lookup"><span data-stu-id="acf62-135">Position Role</span></span>  <br/> |<span data-ttu-id="acf62-136">TEXT</span><span class="sxs-lookup"><span data-stu-id="acf62-136">TEXT</span></span>  <br/> |<span data-ttu-id="acf62-137">Ressources</span><span class="sxs-lookup"><span data-stu-id="acf62-137">Resources</span></span>  <br/> |<span data-ttu-id="acf62-138">Testeur</span><span class="sxs-lookup"><span data-stu-id="acf62-138">Tester</span></span>  <br/> |
|<span data-ttu-id="acf62-139">État de l’indicateur</span><span class="sxs-lookup"><span data-stu-id="acf62-139">Flag Status</span></span>  <br/> |<span data-ttu-id="acf62-140">FLAG</span><span class="sxs-lookup"><span data-stu-id="acf62-140">Flag</span></span>  <br/> |<span data-ttu-id="acf62-141">Tâche</span><span class="sxs-lookup"><span data-stu-id="acf62-141">Task</span></span>  <br/> |<span data-ttu-id="acf62-142">Non</span><span class="sxs-lookup"><span data-stu-id="acf62-142">No</span></span>  <br/> |
|<span data-ttu-id="acf62-143">Intégrité</span><span class="sxs-lookup"><span data-stu-id="acf62-143">Health</span></span>  <br/> |<span data-ttu-id="acf62-144">TEXT</span><span class="sxs-lookup"><span data-stu-id="acf62-144">TEXT</span></span>  <br/> |<span data-ttu-id="acf62-145">Tâche</span><span class="sxs-lookup"><span data-stu-id="acf62-145">Task</span></span>  <br/> |<span data-ttu-id="acf62-146">Non précisé</span><span class="sxs-lookup"><span data-stu-id="acf62-146">Not specified</span></span>  <br/> |
   
<span data-ttu-id="acf62-147">Les champs personnalisés d’entreprise sont définis au niveau de l’instance Project Web Application (PWA), qui ne fait pas partie d’un projet, d’une ressource ni d’une tâche.</span><span class="sxs-lookup"><span data-stu-id="acf62-147">ECFs are defined at the Project Web Application (PWA) instance, external from any project, resource, or task.</span></span> <span data-ttu-id="acf62-148">Pourtant, ils peuvent être associés à un projet, une ressource ou une tâche.</span><span class="sxs-lookup"><span data-stu-id="acf62-148">Yet, they can become associated with a project, resource, or task.</span></span> <span data-ttu-id="acf62-149">Cet article donne une vue d’ensemble des champs personnalisés à l’aide d’un exemple d’application et porte notamment sur l’extraction de valeurs de champs personnalisés d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="acf62-149">This article provides an introductory look at custom fields using a sample application and focuses on retrieving ECF values.</span></span> 
  
<span data-ttu-id="acf62-150">Vous pouvez télécharger l’exemple complet dans https://github.com/OfficeDev/Project-CSOM-Read-Enterprise-CustomFields.</span><span class="sxs-lookup"><span data-stu-id="acf62-150">You can download the completed sample at https://github.com/OfficeDev/Project-CSOM-Read-Enterprise-CustomFields.</span></span>
  
<span data-ttu-id="acf62-151">En outre, Project Online prend en charge les champs personnalisés locaux comme des entités en lecture seule propres au projet, à la ressource ou à la tâche donnée.</span><span class="sxs-lookup"><span data-stu-id="acf62-151">Additionally, Project Online supports local custom fields as read-only entities specific to the specific project, resource, or task.</span></span> <span data-ttu-id="acf62-152">Pour plus d’informations sur les champs personnalisés locaux, consultez l’exemple en accédant à https://github.com/OfficeDev/Project-CSOM-Read-Local-CustomFields\.</span><span class="sxs-lookup"><span data-stu-id="acf62-152">For more information on local custom fields, see the sample https://github.com/OfficeDev/Project-CSOM-Read-Local-CustomFields\.</span></span>
  
## <a name="background-materials"></a><span data-ttu-id="acf62-153">Documents de référence</span><span class="sxs-lookup"><span data-stu-id="acf62-153">Background materials</span></span>

<span data-ttu-id="acf62-154">Un article précédent relatif au [développement d’une application Project Online à l’aide du modèle objet côté client](developing-a-project-online-application-using-the-client-side-object-model.md) fournit des informations de base et l’orientation initiale pour le développement d’applications à l’aide du modèle objet côté client (CSOM).</span><span class="sxs-lookup"><span data-stu-id="acf62-154">A previous article, [Developing a Project Online application using the client-side object model](developing-a-project-online-application-using-the-client-side-object-model.md), provides background and the initial orientation for developing applications using CSOM.</span></span> <span data-ttu-id="acf62-155">Consultez cet article pour les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="acf62-155">Refer to this article for the following items:</span></span>
  
- <span data-ttu-id="acf62-156">Informations de base sur Project, éditions autonomes et basées sur le cloud</span><span class="sxs-lookup"><span data-stu-id="acf62-156">Background information about Project, stand-alone and cloud-based editions</span></span> 
    
- <span data-ttu-id="acf62-157">Environnement de développement (éditions Visual Studio et bibliothèques de logiciels)</span><span class="sxs-lookup"><span data-stu-id="acf62-157">Development environment (Visual Studio editions and software libraries)</span></span>
    
- <span data-ttu-id="acf62-158">Configuration du projet Visual Studio pour une application .NET à l’aide de la bibliothèque CSOM</span><span class="sxs-lookup"><span data-stu-id="acf62-158">Visual Studio project setup for a .NET application using the CSOM library</span></span>
    
- <span data-ttu-id="acf62-159">Connexion au service Project Online</span><span class="sxs-lookup"><span data-stu-id="acf62-159">Connecting to the Project Online service</span></span>
    
## <a name="preliminaries-class-level-declarations"></a><span data-ttu-id="acf62-160">Déclarations préliminaires (déclarations au niveau de la classe)</span><span class="sxs-lookup"><span data-stu-id="acf62-160">Preliminaries (class-level declarations)</span></span>

<span data-ttu-id="acf62-161">La classe pour cette application définit deux éléments de données : le contexte du projet et le dictionnaire pwaECF.</span><span class="sxs-lookup"><span data-stu-id="acf62-161">The class for this application defines two data items: the project context and the pwaECF dictionary.</span></span>
  
<span data-ttu-id="acf62-162">L’objet du contexte du projet fait partie du CSOM du projet et connecte l’application et l’instance PWA.</span><span class="sxs-lookup"><span data-stu-id="acf62-162">The project context object is part of the Project CSOM, and connects the application and the PWA instance.</span></span> <span data-ttu-id="acf62-163">Toutes les demandes au service utilisent le contexte du projet.</span><span class="sxs-lookup"><span data-stu-id="acf62-163">All requests to the service use the project context.</span></span>
  
```cs
private static ProjectContext projContext = 
     new ProjectContext("https://Contoso216.sharepoint.com/sites/pwa");

```

<span data-ttu-id="acf62-164">Le contexte exige que le point de terminaison de connexion crée une instance dans une application.</span><span class="sxs-lookup"><span data-stu-id="acf62-164">The context needs the connection endpoint to create an instance in an application.</span></span> <span data-ttu-id="acf62-165">Le point de terminaison de connexion est l’URL de votre instance PWA.</span><span class="sxs-lookup"><span data-stu-id="acf62-165">The connection endpoint is the URL of your PWA instance.</span></span> 
  
<span data-ttu-id="acf62-166">Le dictionnaire pwaECF stocke les champs personnalisés d’entreprise du projet définis au niveau de l’instance PWA.</span><span class="sxs-lookup"><span data-stu-id="acf62-166">The pwaECF dictionary stores the project ECFs defined at the PWA level.</span></span> <span data-ttu-id="acf62-167">Le dictionnaire utilise l’élément ECF.InternalName comme clé et l’objet CustomField comme valeur.</span><span class="sxs-lookup"><span data-stu-id="acf62-167">The dictionary uses the ECF.InternalName as the key, and the CustomField object as the value.</span></span> <span data-ttu-id="acf62-168">Le dictionnaire est renseigné dans la méthode ListPWACustomFields, puis utilisé comme référence dans la méthode Main.</span><span class="sxs-lookup"><span data-stu-id="acf62-168">The dictionary is populated in the ListPWACustomFields method, and then used as a reference in the Main method.</span></span> 
  
```cs
    //Dictionary of ECFs
        static Dictionary<String, CustomField> pwaECF = new Dictionary<string, CustomField>();

```

## <a name="main-method"></a><span data-ttu-id="acf62-169">Méthode Main</span><span class="sxs-lookup"><span data-stu-id="acf62-169">Main method</span></span>

<span data-ttu-id="acf62-170">La méthode Main gère le flux de l’application.</span><span class="sxs-lookup"><span data-stu-id="acf62-170">The Main method manages the application flow.</span></span> <span data-ttu-id="acf62-171">Comme avec d’autres applications qui utilisent le CSOM Project Online, Main initialise le contexte du projet.</span><span class="sxs-lookup"><span data-stu-id="acf62-171">As with other applications that use the Project Online CSOM, Main initializes the project context.</span></span> 
  
1. <span data-ttu-id="acf62-172">Récupérer et répertorier les champs personnalisés d’entreprise dans l’instance PWA Project Online.</span><span class="sxs-lookup"><span data-stu-id="acf62-172">Retrieve and list the ECFs in the Project Online PWA.</span></span>
    
   <span data-ttu-id="acf62-173">Cette fonctionnalité est implémentée dans la méthode ListPWACustomFields.</span><span class="sxs-lookup"><span data-stu-id="acf62-173">This functionality is implemented in the ListPWACustomFields method.</span></span>
    
2. <span data-ttu-id="acf62-174">Récupérer les projets avec des champs personnalisés et des champs non personnalisés.</span><span class="sxs-lookup"><span data-stu-id="acf62-174">Retrieve projects with custom fields and non-custom fields.</span></span>
    
   <span data-ttu-id="acf62-175">Lors de la récupération des projets avec des champs personnalisés d’entreprise, la demande de requête au service Project Online doit inclure les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="acf62-175">When retrieving projects with ECFs, the query request to the Project Online service needs to include the following items:</span></span> 
    
   - <span data-ttu-id="acf62-176">**IncludeCustomFields** &ndash; Cet élément demande au service de renvoyer une collection d’objets PublishedProject où chaque projet publié comporte une extension qui prend en charge les champs personnalisés.</span><span class="sxs-lookup"><span data-stu-id="acf62-176">**IncludeCustomFields** &ndash; This item requests the service to return a collection of PublishedProjects where each published project includes an extension that supports custom fields.</span></span> <span data-ttu-id="acf62-177">Sauf si cet élément est spécifié, Project Online renvoie les objets PublishedProject qui ne comprennent pas de données de champs personnalisés.</span><span class="sxs-lookup"><span data-stu-id="acf62-177">Unless this item is specified, Project Online returns PublishedProject objects that do not include Custom Field data.</span></span>
    
   - <span data-ttu-id="acf62-178">**IncludeCustomFields.CustomFields** &ndash; Cet élément demande au service de renseigner les objets PublishedProject avec des données CustomFields.</span><span class="sxs-lookup"><span data-stu-id="acf62-178">**IncludeCustomFields.CustomFields** &ndash; This item requests the service to populate the PublishedProject objects with CustomFields data.</span></span>
    
   <span data-ttu-id="acf62-179">La demande suivante spécifie le nom et l’ID du projet, ainsi que l’extension de l’objet pour les champs personnalisés et les valeurs de champ personnalisé.</span><span class="sxs-lookup"><span data-stu-id="acf62-179">The following request specifies the project Id and Name, as well as the object extension for custom fields and the custom field values.</span></span>
    
   ```cs
        var projBlk = projContext.LoadQuery(
        projContext.Projects.Include(
            p => p.Id, 
            p => p.Name,
            p => p.IncludeCustomFields,
            p => p.IncludeCustomFields.CustomFields
        ));
    
   ```

3. <span data-ttu-id="acf62-180">Examiner chaque projet.</span><span class="sxs-lookup"><span data-stu-id="acf62-180">Examine each project.</span></span>
    
   <span data-ttu-id="acf62-181">Les objets du projet utilisés dans cette application sont le type PublishedProject, car les valeurs sont récupérées et affichées.</span><span class="sxs-lookup"><span data-stu-id="acf62-181">The project objects used in this application are the PublishedProject type because the values are retrieved and displayed.</span></span> 
    
   <span data-ttu-id="acf62-182">Si vous devez mettre à jour des valeurs de données dans un ou plusieurs projets, le projet en cours de mise à jour sera extrait et l’application utilisera un objet DraftProject pour récupérer les valeurs et mettre à jour le projet.</span><span class="sxs-lookup"><span data-stu-id="acf62-182">If you need to update data values in one or more projects, the project undergoing the update would be checked out and the application would use a DraftProject object to retrieve the values and update the project.</span></span>
    
4. <span data-ttu-id="acf62-183">Accéder aux entrées de champs personnalisés d’entreprise pour un projet</span><span class="sxs-lookup"><span data-stu-id="acf62-183">Accessing the ECF entries for a project</span></span>
    
   <span data-ttu-id="acf62-184">Chaque instance de champ personnalisé d’entreprise sépare la valeur du champ du reste des informations de champ personnalisé d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="acf62-184">Each ECF instance separates the field value from the rest of the ECF information.</span></span> <span data-ttu-id="acf62-185">La valeur du champ est stockée dans le cadre d’une paire clé/valeur.</span><span class="sxs-lookup"><span data-stu-id="acf62-185">The field value is stored as part of a key/value pair.</span></span> <span data-ttu-id="acf62-186">Le reste des informations est stocké dans un objet CustomField.</span><span class="sxs-lookup"><span data-stu-id="acf62-186">The rest of the information is stored in a CustomField object.</span></span>
    
   <span data-ttu-id="acf62-187">L’accès aux valeurs de champ personnalisé d’entreprise dans un projet est constitué de deux parties :</span><span class="sxs-lookup"><span data-stu-id="acf62-187">Accessing ECF values in a project consists of two parts:</span></span>
    
   - <span data-ttu-id="acf62-188">Parcourir la collection CustomFields</span><span class="sxs-lookup"><span data-stu-id="acf62-188">Cycling through the CustomFields collection</span></span>
    
   - <span data-ttu-id="acf62-189">Accéder à l’entrée appropriée en utilisant deux constructions.</span><span class="sxs-lookup"><span data-stu-id="acf62-189">Accessing the proper entry using two constructs.</span></span>
    
   <span data-ttu-id="acf62-190">Chaque projet stocke les entrées de champ personnalisé d’entreprise associées à deux endroits : une collection CustomFields énumérable et les valeurs du champ dans le cadre de paires clé/valeur.</span><span class="sxs-lookup"><span data-stu-id="acf62-190">Each project stores associated ECF entries in two places, a CustomFields collection that is enumerable and and the field values as part of key/value pairs.</span></span> <span data-ttu-id="acf62-191">Dans les paires clé/valeur, internalName est la clé et la valeur du champ est la valeur.</span><span class="sxs-lookup"><span data-stu-id="acf62-191">In the key/value pairs, the internalName is the key and the field value is the value.</span></span> <span data-ttu-id="acf62-192">Utilisez un dictionnaire pour conserver les valeurs du champ et y accéder.</span><span class="sxs-lookup"><span data-stu-id="acf62-192">Use a dictionary to hold and access the field values.</span></span> 
    
   <span data-ttu-id="acf62-193">Les propriétés de champ personnalisé d’entreprise autres que les valeurs du champ sont stockées dans des objets CustomField (un objet par projet).</span><span class="sxs-lookup"><span data-stu-id="acf62-193">The ECF properties, other than the field values, are stored in CustomField objects, one object per project.</span></span> <span data-ttu-id="acf62-194">Utilisez une collection CustomFields pour accéder aux champs personnalisés d’entreprise associés à un projet individuel.</span><span class="sxs-lookup"><span data-stu-id="acf62-194">Use a CustomFields collection to access the ECFs associated with an individual project.</span></span> 
    
5. <span data-ttu-id="acf62-195">Chaque projet stocke les champs personnalisés d’entreprise associés dans une collection où chaque champ personnalisé d’entreprise est constitué d’une clé (le nom interne du champ personnalisé d’entreprise) et d’un objet qui conserve la valeur du champ personnalisé d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="acf62-195">Each project stores the associated ECFs in a collection where each ECF entry consists of a key--the internal name of the ECF--and an object that holds the value of the ECF.</span></span> <span data-ttu-id="acf62-196">Transférez la collection vers un dictionnaire pour accéder à des entrées individuelles.</span><span class="sxs-lookup"><span data-stu-id="acf62-196">Transfer the collection to a dictionary to access individual entries.</span></span> <span data-ttu-id="acf62-197">La déclaration suit.</span><span class="sxs-lookup"><span data-stu-id="acf62-197">The declaration follows.</span></span>
    
   ```cs
    Dictionary<string, object> projDict = pubProj.IncludeCustomFields.FieldValues;
    
   ```

   <span data-ttu-id="acf62-198">La valeur dans une entrée de dictionnaire correspond au type de données du champ personnalisé d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="acf62-198">The value in a dictionary entry corresponds to the data type of the ECF.</span></span> <span data-ttu-id="acf62-199">L’objet pour chaque champ personnalisé d’entreprise effectue un mappage vers un type parmi d’autres.</span><span class="sxs-lookup"><span data-stu-id="acf62-199">The object for each ECF maps to one of a variety of types.</span></span> <span data-ttu-id="acf62-200">La plupart des champs personnalisés d’entreprise utilisent des types simples qui s’intègrent dans des variables standard.</span><span class="sxs-lookup"><span data-stu-id="acf62-200">Most ECFs use simple types that fit into standard variables.</span></span> <span data-ttu-id="acf62-201">Le fragment suivant montre qu’un traitement minimal est impliqué pour plusieurs types :</span><span class="sxs-lookup"><span data-stu-id="acf62-201">The following fragment shows that minimal processing is involved for several types:</span></span>
    
   ```cs
    switch (cf.FieldType)
    {
        case CustomFieldType.COST:
            decimal costValue = (decimal)oVal;
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                costValue.ToString("C"));
            break;
        case CustomFieldType.DATE:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.FINISHDATE:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.DURATION:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.FLAG:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.NUMBER:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
    
   ```

   <span data-ttu-id="acf62-202">Toutefois, la table de choix des valeurs TEXT requiert un traitement supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="acf62-202">The lookup table of TEXT values, however, requires additional processing.</span></span> <span data-ttu-id="acf62-203">L’application récupère la table de choix appropriée du service et génère l’instance de champ personnalisé d’entreprise (avec une ou plusieurs valeurs) en navigant dans la table de choix.</span><span class="sxs-lookup"><span data-stu-id="acf62-203">The application retrieves the appropriate lookup table from the service, and outputs the ECF instance (with single or multiple values) by traversing the lookup table.</span></span> <span data-ttu-id="acf62-204">Le fragment de code suivant montre un traitement de champs personnalisés d’entreprise TEXT, y compris ceux ayant des valeurs simples et ceux utilisant des tables de choix :</span><span class="sxs-lookup"><span data-stu-id="acf62-204">The following code fragment shows processing of TEXT ECFs, including those with simple values and those using lookup tables:</span></span> 
    
   ```cs
    case CustomFieldType.TEXT:
        if (!cf.LookupTable.ServerObjectIsNull.HasValue ||
            (cf.LookupTable.ServerObjectIsNull.HasValue && 
            cf.LookupTable.ServerObjectIsNull.Value))
        { //No lookup table
            Console.WriteLine("\tFieldType:\t{0}\n\tText:\t{1}", cf.FieldType, 
                oVal.ToString());
        }
        else
        { //Lookup table
            Console.WriteLine("\tFieldType:\t{0} - using Lookup Table", cf.FieldType);
            String[] entries = (String[])oVal;
            foreach (String entry in entries)
            {
                var luEntry = projContext.LoadQuery(cf.LookupTable.Entries
                    .Where(e => e.InternalName == entry));
                projContext.ExecuteQuery();
                Console.WriteLine("\tLookup Value:\t{0}", luEntry.First().FullValue);  
            }
        }
        break;
    
   ```

   <span data-ttu-id="acf62-205">Cette application génère simplement les valeurs. Toutefois, il est possible de savoir plus en détail ce que les valeurs de données signifient.</span><span class="sxs-lookup"><span data-stu-id="acf62-205">This application simply outputs the value(s); however, it is possible to get more meaning from the data value(s).</span></span>
    
## <a name="listpwacustomfields"></a><span data-ttu-id="acf62-206">ListPWACustomFields</span><span class="sxs-lookup"><span data-stu-id="acf62-206">ListPWACustomFields</span></span>

<span data-ttu-id="acf62-207">La méthode ListPWACustomFields récupère et répertorie les champs personnalisés d’entreprise associés à des projets.</span><span class="sxs-lookup"><span data-stu-id="acf62-207">The ListPWACustomFields method retrieves and lists the ECFs associated with projects.</span></span> <span data-ttu-id="acf62-208">Cette méthode répertorie les champs personnalisés d’entreprise inscrits sur l’instance PWA qui peuvent être associés à des projets individuels.</span><span class="sxs-lookup"><span data-stu-id="acf62-208">This method lists the ECFs registered on the PWA instance that can be associated with individual projects.</span></span> <span data-ttu-id="acf62-209">Le point d’entrée pour accéder aux champs personnalisés d’entreprise utilise l’élément CustomFields du contexte du projet, comme dans la demande de requête suivante :</span><span class="sxs-lookup"><span data-stu-id="acf62-209">The entry point for accessing the ECFs uses the CustomFields element of the project context, as in the following query request:</span></span>
  
```cs
// Project ECFs
    var allECFields = 
            projContext.LoadQuery(projContext.CustomFields.Include(
            qp => qp.InternalName,
            qp => qp.Name
        ));
    projContext.ExecuteQuery();

```

<span data-ttu-id="acf62-210">La méthode ne vérifie pas si un projet utilise un champ personnalisé d’entreprise spécifique.</span><span class="sxs-lookup"><span data-stu-id="acf62-210">The method does not check to see whether a project uses a specific ECF.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="acf62-211">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="acf62-211">See also</span></span>

- [<span data-ttu-id="acf62-212">Portail de développement Project</span><span class="sxs-lookup"><span data-stu-id="acf62-212">Project Development Portal</span></span>](https://developer.microsoft.com/fr-FR/project)
- <span data-ttu-id="acf62-213">
  [Vue d’ensemble : champs personnalisés d’entreprise et tables de choix](https://support.office.com/en-us/article/overview-enterprise-custom-fields-and-lookup-tables-f99db553-0b33-4648-93c0-f6a74637d790?ui=en-us&rs=en-us&ad=us)</span><span class="sxs-lookup"><span data-stu-id="acf62-213">[Overview: Enterprise custom fields and lookup tables](https://support.office.com/en-us/article/overview-enterprise-custom-fields-and-lookup-tables-f99db553-0b33-4648-93c0-f6a74637d790?ui=en-us&rs=en-us&ad=us)</span></span>
- <span data-ttu-id="acf62-214">[Champs personnalisés locaux et d’entreprise](https://msdn.microsoft.com/library/office/ms447495(v=office.14).aspx)</span><span class="sxs-lookup"><span data-stu-id="acf62-214">[Local and Enterprise Custom Fields](https://msdn.microsoft.com/library/office/ms447495(v=office.14).aspx)</span></span>
- [<span data-ttu-id="acf62-215">Ajouter ou modifier des champs personnalisés d’entreprise dans Project Server 2013</span><span class="sxs-lookup"><span data-stu-id="acf62-215">Add or edit enterprise custom fields in Project Server 2013</span></span>](https://docs.microsoft.com/project/add-or-edit-enterprise-custom-fields-in-project-server)
    

