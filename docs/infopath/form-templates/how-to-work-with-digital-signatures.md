---
title: Utilisation de Signatures numériques
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- digital signatures [infopath 2007],InfoPath 2007, digital signatures
localization_priority: Normal
ms.assetid: fd13fb71-aecf-47bb-8a6b-db70bd90ceeb
description: Le modèle objet de l'espace de noms Microsoft.Office.InfoPath fournit les fonctionnalités d'utilisation des signatures numériques par programmation.
ms.openlocfilehash: 1277998edf4feb94da40d82372fd4d96fedf2d54
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/21/2018
ms.locfileid: "19782415"
---
# <a name="work-with-digital-signatures"></a><span data-ttu-id="a3be7-104">Utilisation de Signatures numériques</span><span class="sxs-lookup"><span data-stu-id="a3be7-104">Work with Digital Signatures</span></span>

<span data-ttu-id="a3be7-105">Le modèle objet de l'espace de noms [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) fournit les fonctionnalités d'utilisation des signatures numériques par programmation.</span><span class="sxs-lookup"><span data-stu-id="a3be7-105">The object model of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace provides features for working with digital signatures programmatically.</span></span> 
  
## <a name="digital-signature-features"></a><span data-ttu-id="a3be7-106">Fonctionnalités de signature numérique</span><span class="sxs-lookup"><span data-stu-id="a3be7-106">Digital Signature Features</span></span>

<span data-ttu-id="a3be7-107">Les fonctionnalités de signature numérique fournies par InfoPath vous permettent d'effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="a3be7-107">The digital signatures features provided by InfoPath enable you to:</span></span> 
  
- <span data-ttu-id="a3be7-108">activer les signatures pour l'ensemble du formulaire ou pour des jeux de données spécifiques à signer séparément dans le formulaire ;</span><span class="sxs-lookup"><span data-stu-id="a3be7-108">Enable signatures for the entire form, or for specific sets of data in the form that can be signed separately.</span></span>
    
- <span data-ttu-id="a3be7-p101">préciser, pour chaque jeu de données pouvant être signé, si une ou plusieurs signatures sont autorisées et quelles seront leurs relations. Par exemple, vous pouvez spécifier s'il s'agit de co-signatures parallèles ou si chaque nouvelle signature contre-signe toutes les signatures précédentes ;</span><span class="sxs-lookup"><span data-stu-id="a3be7-p101">Specify, for each set of data that can be signed, whether a single signature or multiple signatures are allowed and what their relationship will be. For example, you can specify whether they are parallel co-signatures or whether each new signature countersigns all the earlier signatures.</span></span>
    
- <span data-ttu-id="a3be7-111">définir un message à présenter aux utilisateurs du formulaire lorsqu'ils signent le formulaire ;</span><span class="sxs-lookup"><span data-stu-id="a3be7-111">Specify a message to be shown to form users as they sign the form.</span></span>
    
- <span data-ttu-id="a3be7-112">insérer et afficher une signature dans le document ;</span><span class="sxs-lookup"><span data-stu-id="a3be7-112">Insert and see a signature in the document.</span></span> 
    
- <span data-ttu-id="a3be7-p102">afficher des informations vérifiables de non-répudiation ajoutées à chaque signature pour une plus grande sécurité. Ces informations supplémentaires, qui comprennent une vue du formulaire tel qu'il est présenté à chaque signataire, font partie de la signature et ne peuvent pas en être supprimées sans annuler la signature. Vous pouvez à tout moment revoir ces données en cliquant sur la signature dans le formulaire pour afficher la boîte de dialogue **Vérifier la signature numérique**;</span><span class="sxs-lookup"><span data-stu-id="a3be7-p102">View verifiable non-repudiation information that has been added to each signature for increased security. This additional information, which includes a view of the form as it was presented to each signer, is part of the signature and cannot be removed without invalidating the signature. At any time, you can recall this data by clicking on the signature in the form to display the **Verify Digital Signature** dialog box.</span></span> 
    
- <span data-ttu-id="a3be7-p103">tirer parti d'un modèle objet permettant l'utilisation de signatures numériques et ajouter des informations personnalisées au bloc de signatures dans les formulaires entièrement fiables via un modèle objet de signature numérique.</span><span class="sxs-lookup"><span data-stu-id="a3be7-p103">Take advantage of an object model for working with digital signatures. Add custom information to the signature block in fully trusted forms through the digital signature object model.</span></span> 
    
## <a name="overview-of-the-digital-signatures-object-model"></a><span data-ttu-id="a3be7-118">Présentation du modèle objet de signatures numériques</span><span class="sxs-lookup"><span data-stu-id="a3be7-118">Overview of the Digital Signatures Object Model</span></span>

### <a name="the-sign-event"></a><span data-ttu-id="a3be7-119">Événement Signature (Sign)</span><span class="sxs-lookup"><span data-stu-id="a3be7-119">The Sign Event</span></span>

<span data-ttu-id="a3be7-120">Le modèle objet des signatures numériques fournit l'événement qui suit.</span><span class="sxs-lookup"><span data-stu-id="a3be7-120">The object model for digital signatures provides the following event.</span></span>
  
|<span data-ttu-id="a3be7-121">**Nom**</span><span class="sxs-lookup"><span data-stu-id="a3be7-121">**Name**</span></span>|<span data-ttu-id="a3be7-122">**Description**</span><span class="sxs-lookup"><span data-stu-id="a3be7-122">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="a3be7-123">Connexion</span><span class="sxs-lookup"><span data-stu-id="a3be7-123">Sign</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) <br/> |<span data-ttu-id="a3be7-124">Se produit une fois qu'un ensemble de données a été sélectionné pour la signature.</span><span class="sxs-lookup"><span data-stu-id="a3be7-124">Occurs after a set of data has been selected to sign.</span></span>  <br/> <span data-ttu-id="a3be7-p104">Vous pouvez utiliser cet événement pour manipuler les données stockées dans la signature numérique. Par exemple, vous pouvez ajouter les données d'un serveur d'horodatage fiable ou une contre-signature côté serveur de la transaction. Vous pouvez également utiliser cet événement pour bloquer la signature si l'utilisateur actuel n'est pas membre d'un groupe spécifique.</span><span class="sxs-lookup"><span data-stu-id="a3be7-p104">You can use this event to manipulate the data stored within the digital signature. For example, you can add data from a trusted timestamp server, or add a server-side countersignature of the transaction. You can also use this event to block signing if the current user is not a member of a particular group.</span></span>  <br/> |
   
### <a name="the-signeventargs-object"></a><span data-ttu-id="a3be7-128">Objet SignEventArgs</span><span class="sxs-lookup"><span data-stu-id="a3be7-128">The SignEventArgs Object</span></span>

<span data-ttu-id="a3be7-129">Un gestionnaire d'événements pour l'événement [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) peut fonctionner avec l'objet d'événement [SignEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.aspx) qui offre les propriétés suivantes.</span><span class="sxs-lookup"><span data-stu-id="a3be7-129">An event handler for the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event can work with the [SignEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.aspx) event object, which provides the following properties.</span></span> 
  
|<span data-ttu-id="a3be7-130">**Nom**</span><span class="sxs-lookup"><span data-stu-id="a3be7-130">**Name**</span></span>|<span data-ttu-id="a3be7-131">**Description**</span><span class="sxs-lookup"><span data-stu-id="a3be7-131">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="a3be7-132">SignedDataBlock</span><span class="sxs-lookup"><span data-stu-id="a3be7-132">SignedDataBlock</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.SignedDataBlock.aspx) <br/> |<span data-ttu-id="a3be7-133">Obtient l’ensemble de données qui a déclenché l’événement de [connexion](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a3be7-133">Gets the set of data that raised the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event.</span></span>  <br/> |
|[<span data-ttu-id="a3be7-134">SignatureWizard</span><span class="sxs-lookup"><span data-stu-id="a3be7-134">SignatureWizard</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.SignatureWizard.aspx) <br/> |<span data-ttu-id="a3be7-135">Obtient ou définit l’affichage de la boîte de dialogue **Signatures numériques** .</span><span class="sxs-lookup"><span data-stu-id="a3be7-135">Gets or sets whether to display the **Digital Signatures** dialog box.</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="a3be7-p105">[!REMARQUE] Dans le modèle objet de code managé [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) livré avec InfoPath 2003, l'objet d'événement [SignEvent](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEvent.aspx) pour l'événement [OnSign](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2.OnSign.aspx) fournit une propriété **XDocument** qui permet d'accéder à l'objet **XDocument** du formulaire associé à l'événement. Ceci n'est pas nécessaire avec les modèles de formulaires créés avec InfoPath Forms Services ou InfoPath à l'aide du modèle objet [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) car les membres du modèle objet de la classe [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) sont accessibles dans le code du formulaire à l'aide du mot clé **this** (C#) ou **Me** (Visual Basic). Par exemple, pour accéder à la propriété [Signed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) de la classe [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) afin de déterminer si un formulaire est signé, vous pouvez taper  `this.Signed` ou  `Me.Signed.`</span><span class="sxs-lookup"><span data-stu-id="a3be7-p105">In the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) managed code object model that shipped with InfoPath 2003, the [SignEvent](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEvent.aspx) event object for the [OnSign](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2.OnSign.aspx) event provides an **XDocument** property for accessing the **XDocument** object of the form associated with the event. This is not necessary with form templates created with InfoPath Forms Services or InfoPath using the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) object model because the object model members of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class can be accessed in form code using the **this** (C#) or **Me** (Visual Basic) keyword. For example, to access the [Signed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class to determine if a form is signed, you can type either  `this.Signed` or  `Me.Signed.`</span></span>
  
### <a name="collections-and-objects"></a><span data-ttu-id="a3be7-139">Collections et objets</span><span class="sxs-lookup"><span data-stu-id="a3be7-139">Collections and Objects</span></span>

<span data-ttu-id="a3be7-140">Le modèle objet des signatures numériques fournit les collections suivantes.</span><span class="sxs-lookup"><span data-stu-id="a3be7-140">The object model for digital signatures provides the following collections.</span></span>
  
|<span data-ttu-id="a3be7-141">**Nom**</span><span class="sxs-lookup"><span data-stu-id="a3be7-141">**Name**</span></span>|<span data-ttu-id="a3be7-142">**Description**</span><span class="sxs-lookup"><span data-stu-id="a3be7-142">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="a3be7-143">SignedDataBlockCollection</span><span class="sxs-lookup"><span data-stu-id="a3be7-143">SignedDataBlockCollection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) <br/> |<span data-ttu-id="a3be7-144">Collection d’objets [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) du modèle de formulaire tel que défini au moment du design dans InfoPath en mode Création.</span><span class="sxs-lookup"><span data-stu-id="a3be7-144">The collection of the [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) objects in the form template as defined at design time in InfoPath design mode.</span></span>  <br/> <span data-ttu-id="a3be7-145">La collection [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) implémente des propriétés qui peuvent servir à accéder aux objets [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) associés au formulaire.</span><span class="sxs-lookup"><span data-stu-id="a3be7-145">The [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) collection implements properties that can be used to access the [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) objects associated with a form.</span></span> <span data-ttu-id="a3be7-146">L’objet [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) associé à un formulaire est accessible via la propriété [SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) de la classe [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a3be7-146">The [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) object associated with a form is accessible through the [SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class.</span></span>  <br/> |
|[<span data-ttu-id="a3be7-147">SignatureCollection</span><span class="sxs-lookup"><span data-stu-id="a3be7-147">SignatureCollection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) <br/> |<span data-ttu-id="a3be7-148">Contient une collection d’objets [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) pour chaque objet [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) sous la forme.</span><span class="sxs-lookup"><span data-stu-id="a3be7-148">Contains a collection of [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) objects for each [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object in the form.</span></span>  <br/> <span data-ttu-id="a3be7-149">La classe [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) implémente des propriétés et une méthode qui peut être utilisée pour accéder aux objets [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) associés à un formulaire et pour créer une signature.</span><span class="sxs-lookup"><span data-stu-id="a3be7-149">The [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) class implements properties and a method that can be used to access a form's associated [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) objects and to create a signature.</span></span> <span data-ttu-id="a3be7-150">L’objet [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) associé à un [objet SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) est accessible à l’aide de la propriété [Signatures](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Signatures.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a3be7-150">The [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) object associated with a [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) is accessible using the [Signatures](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Signatures.aspx) property.</span></span>  <br/> <span data-ttu-id="a3be7-151">Lorsque vous utilisez la méthode [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) de la classe [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) , gardez à l’esprit que la signature n’est pas écrite jusqu'à ce que la [connexion](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) est appelée sur l’objet [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a3be7-151">When you use the [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) method of the [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) class, keep in mind that the signature is not written until the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) method is called on the [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) object.</span></span> <span data-ttu-id="a3be7-152">Ces méthodes peuvent être appelées uniquement à partir du Gestionnaire d’événements de **connexion** d’un modèle de formulaire entièrement fiable.</span><span class="sxs-lookup"><span data-stu-id="a3be7-152">These methods can be called only from the **Sign** event handler of a fully trusted form template.</span></span>  <br/> |
   
<span data-ttu-id="a3be7-153">Le modèle objet des signatures numériques fournit les objets suivants.</span><span class="sxs-lookup"><span data-stu-id="a3be7-153">The object model for digital signatures provides the following objects.</span></span>
  
|<span data-ttu-id="a3be7-154">**Nom**</span><span class="sxs-lookup"><span data-stu-id="a3be7-154">**Name**</span></span>|<span data-ttu-id="a3be7-155">**Description**</span><span class="sxs-lookup"><span data-stu-id="a3be7-155">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="a3be7-156">SignedDataBlock</span><span class="sxs-lookup"><span data-stu-id="a3be7-156">SignedDataBlock</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) <br/> |<span data-ttu-id="a3be7-157">Représente un jeu de données signables dans un formulaire.</span><span class="sxs-lookup"><span data-stu-id="a3be7-157">Represents a set of signable data in a form.</span></span> <span data-ttu-id="a3be7-158">L’objet [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) fournit un nombre de propriétés et une méthode qui peut être utilisée pour interagir avec un jeu de données signables.</span><span class="sxs-lookup"><span data-stu-id="a3be7-158">The [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object provides a number of properties and one method that can be used to programmatically interact with a set of signable data.</span></span>  <br/> |
|[<span data-ttu-id="a3be7-159">Signature</span><span class="sxs-lookup"><span data-stu-id="a3be7-159">Signature</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) <br/> |<span data-ttu-id="a3be7-160">Représente une signature numérique a été ajoutée à un formulaire ou d’un jeu de données signables dans un formulaire.</span><span class="sxs-lookup"><span data-stu-id="a3be7-160">Represents a digital signature that has been added to a form or set of signable data in a form.</span></span> <span data-ttu-id="a3be7-161">L’objet [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) implémente des propriétés qui peuvent être utilisées pour récupérer des informations sur la signature numérique et la méthode [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) pour écrire le bloc de signature numérique XML et de sa valeur de hachage de chiffrement de l’informatique sociale.</span><span class="sxs-lookup"><span data-stu-id="a3be7-161">The [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) object implements properties that can be used to retrieve information about the digital signature, and the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) method for writing the XML digital signature block and computing its cryptographic hash value.</span></span>  <br/> |
|[<span data-ttu-id="a3be7-162">Certificat</span><span class="sxs-lookup"><span data-stu-id="a3be7-162">Certificate</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Certificate.aspx) <br/> |<span data-ttu-id="a3be7-163">Représente le certificat numérique X.509 utilisé pour créer la signature.</span><span class="sxs-lookup"><span data-stu-id="a3be7-163">Represents the X.509 digital certificate that has been used to create the signature.</span></span>  <br/> |
   
## <a name="working-with-digital-signatures-programmatically"></a><span data-ttu-id="a3be7-164">Utilisation de signatures numériques par programme</span><span class="sxs-lookup"><span data-stu-id="a3be7-164">Working with Digital Signatures Programmatically</span></span>

<span data-ttu-id="a3be7-p111">Le modèle objet de l'espace de noms [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) fournit les membres qui permettent d'interagir avec les signatures numériques par programmation. Plus spécifiquement, les formulaires entièrement fiables peuvent ajouter des informations personnalisées au bloc de signature avant sa validation, selon la séquence suivante :</span><span class="sxs-lookup"><span data-stu-id="a3be7-p111">The object model of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace provides members for interacting with digital signatures programmatically. In particular, fully-trusted forms can add custom information to the signature block before it is committed, according to the following timeline:</span></span> 
  
1. <span data-ttu-id="a3be7-167">L'utilisateur choisit d'ajouter une signature numérique à un formulaire.</span><span class="sxs-lookup"><span data-stu-id="a3be7-167">User chooses to add a digital signature to a form.</span></span>
    
2. <span data-ttu-id="a3be7-168">La boîte de dialogue **Signatures numériques** s'affiche, l'utilisateur clique sur **Ajouter**, puis il sélectionne les données à signer.</span><span class="sxs-lookup"><span data-stu-id="a3be7-168">The **Digital Signatures** dialog box is displayed, the user clicks **Add**, and then selects the data to sign.</span></span>
    
3. <span data-ttu-id="a3be7-169">L'événement [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) des données sélectionnées, représentées par l'objet [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) , est déclenché et la méthode [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) de l'objet [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) et la méthode [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) de la collection [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) s'exécutent.</span><span class="sxs-lookup"><span data-stu-id="a3be7-169">The [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event for the selected data represented by the [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object is raised, and the [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) method of [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object and the [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) method of the [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) collection are executed.</span></span> 
    
4. <span data-ttu-id="a3be7-170">Les actions personnalisées facultatives sont exécutées.</span><span class="sxs-lookup"><span data-stu-id="a3be7-170">Any optional custom actions are executed.</span></span>
    
5. <span data-ttu-id="a3be7-171">La méthode [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) de l'objet [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) s'exécute.</span><span class="sxs-lookup"><span data-stu-id="a3be7-171">The [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) method of the [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) object is executed.</span></span> 
    
6. <span data-ttu-id="a3be7-172">La boîte de dialogue **Signature** s'affiche pour vous permettre d'entrer un nom (ou de sélectionner une image de signature), de sélectionner un certificat de signature et d'entrer des commentaires.</span><span class="sxs-lookup"><span data-stu-id="a3be7-172">The **Sign** dialog box is displayed for typing a name (or selecting a signature image), selecting a certificate to sign with, and to enter comments.</span></span> 
    
7. <span data-ttu-id="a3be7-173">Lorsque vous cliquez sur le bouton **Signer**, la signature est ajoutée à la collection de signatures du formulaire et les informations de non-répudiation sont capturées et enregistrées avec la signature (qui peut être affichée plus tard en cliquant sur **Afficher le formulaire signé** dans la boîte de dialogue **Signatures numériques**, puis en cliquant sur **Voir les informations complémentaires rassemblées sur les signatures**).</span><span class="sxs-lookup"><span data-stu-id="a3be7-173">When the **Sign** button is clicked, the signature is added to the collection of signatures for the form and the non-repudiation information is captured and saved with the signature (which can be viewed later by clicking **View Signed Form** on the **Digital Signatures** dialog box, and then clicking **See the additional signing information that was collected**).</span></span>
    
<span data-ttu-id="a3be7-174">L'exemple suivant appelle la méthode [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) lorsque l'utilisateur signe les données sélectionnées et contre-signe la signature avec une valeur d'horodatage récupérée à partir d'un service d'horodatage approuvé.</span><span class="sxs-lookup"><span data-stu-id="a3be7-174">The following example invokes the [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) method when the user signs the selected data and countersigns the signature with a timestamp value retrieved from a trusted timestamp service.</span></span> 
  
```cs
public void FormEvents_Sign(object sender, SignEventArgs e)
{
   // Add a new Signature object to the SignedDataBlockCollection.
   Signature thisSignature = 
      e.SignedDataBlock.Signatures.CreateSignature();
   // Write the XML digital signature block and compute hash
   // for signed data.
   thisSignature.Sign();
   // Countersign the signature with a trusted timestamp.
   // Get the XML node storing the signature block.
   XPathNavigator oNodeSig = thisSignature.SignatureBlockXmlNode;
   XPathNavigator oNodeSigValue = 
      oNodeSig.SelectSingleNode(
      ".//*[local-name(.)='signatureValue']");
   // Get timestamp from a trusted timestamp service (fictitious).
   MyTrustedTimeStampService s = new MyTrustedTimeStampService();
   string strVerifiedTimeStamp = s.AddTimeStamp(oNodeSigValue.Value);
   // Add the value returned from the timestamp service to the 
   // unsigned part of the signature block.
   XPathNavigator oNodeObj = 
      oNodeSig.SelectSingleNode(".//*[local-name(.)='Object']");
   XPathNavigator oNode = oNodeObj.Clone();
   oNode.SetValue(strVerifiedTimeStamp);
   oNodeObj.MoveToParent();
   oNodeObj.AppendChild(oNode);
   e.SignatureWizard = false;
}
```

```vb
Public Sub FormEvents_Sign(ByVal sender As Object, _
   ByVal e As SignEventArgs)
   ' Add a new Signature object to the SignedDataBlockCollection.
   Dim thisSignature As Signature = 
      e.SignedDataBlock.Signatures.CreateSignature
   ' Write the XML digital signature block and compute hash
   ' for signed data.
   thisSignature.Sign()
   ' Countersign the signature with a trusted timestamp.
   ' Get the XML node storing the signature block
   Dim oNodeSig As XPathNavigator  = _
      thisSignature.SignatureBlockXmlNode
   Dim oNodeSigValue As XPathNavigator  = _
      oNodeSig.SelectSingleNode(_
      ".//*[local-name(.)='signatureValue']")
   ' Get timestamp from a trusted timestamp service (fictitious).
   Dim s As MyTrustedTimeStampService = New MyTrustedTimeStampService()
   Dim strVerifiedTimeStamp As String  = _
      s.AddTimeStamp(oNodeSigValue.Value)
   ' Add the value returned from the timestamp service to the 
   ' unsigned part of the signature block.
   Dim oNodeObj As XPathNavigator  = 
      oNodeSig.SelectSingleNode(".//*[local-name(.)='Object']")
   Dim oNode As XPathNavigator  = oNodeObj.Clone()
   oNode.SetValue(strVerifiedTimeStamp)
   oNodeObj.MoveToParent()
   oNodeObj.AppendChild(oNode)
   e.SignatureWizard = False
```


