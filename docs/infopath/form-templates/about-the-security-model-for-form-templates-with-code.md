---
title: À propos du modèle de sécurité pour les modèles de formulaires avec code
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2007, security,code access security [InfoPath 2007],security [InfoPath 2007], security model for managed code,security [InfoPath 2007], levels,CAS [InfoPath 2007],InfoPath 2003-compatible form templates, security,permissions [InfoPath 2007]
localization_priority: Normal
ms.assetid: 5e1c1c72-f98d-4871-9c57-82c315277aa1
description: Les modèles de formulaires InfoPath avec code managé prennent en charge les mêmes niveaux de sécurité que le script exécuté dans les modèles de formulaires non managés, ainsi que les fonctionnalité supplémentaires de sécurité d'accès au code qui s'appliquent au code managé exécuté sous le Common Language Runtime (CLR) de .NET Framework.
ms.openlocfilehash: 97f0239a5bd6699b539ddaebf4d1d2ed7d1394db
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436145"
---
# <a name="about-the-security-model-for-form-templates-with-code"></a><span data-ttu-id="29f8c-104">À propos du modèle de sécurité pour les modèles de formulaires avec code</span><span class="sxs-lookup"><span data-stu-id="29f8c-104">About the Security Model for Form Templates with Code</span></span>

<span data-ttu-id="29f8c-105">Les modèles de formulaires InfoPath avec code managé prennent en charge les mêmes niveaux de sécurité que le script exécuté dans les modèles de formulaires non managés, ainsi que les fonctionnalité supplémentaires de sécurité d'accès au code qui s'appliquent au code managé exécuté sous le Common Language Runtime (CLR) de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="29f8c-105">InfoPath managed code form templates support the same security levels as script running in unmanaged form templates, and they also support additional code access security features that apply to managed code running under the common language runtime (CLR) of the .NET Framework.</span></span>
  
## <a name="infopath-managed-object-model-security-levels"></a><span data-ttu-id="29f8c-106">Niveaux de sécurité du modèle objet managé d'InfoPath</span><span class="sxs-lookup"><span data-stu-id="29f8c-106">InfoPath Managed Object Model Security Levels</span></span>

<span data-ttu-id="29f8c-107">Le tableau suivant décrit la relation entre les niveaux de sécurité pour les membres du modèle objet de script et le jeu d'autorisations correspondant exigé à chaque niveau lorsque le membre du modèle objet est utilisé dans un modèle de formulaire avec code managé.</span><span class="sxs-lookup"><span data-stu-id="29f8c-107">The following table describes the relationship between the security levels for script object model members and the corresponding permission set that is demanded for each level when the object model member is used in a managed code form template.</span></span>
  
|<span data-ttu-id="29f8c-108">**Niveau de sécurité du modèle objet**</span><span class="sxs-lookup"><span data-stu-id="29f8c-108">**Object Model Security Level**</span></span>|<span data-ttu-id="29f8c-109">**Description**</span><span class="sxs-lookup"><span data-stu-id="29f8c-109">**Description**</span></span>|<span data-ttu-id="29f8c-110">**Jeu d'autorisations exigé**</span><span class="sxs-lookup"><span data-stu-id="29f8c-110">**Permission Set Demanded**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="29f8c-111">0</span><span class="sxs-lookup"><span data-stu-id="29f8c-111">0</span></span>  <br/> |<span data-ttu-id="29f8c-112">Accessible sans restrictions.</span><span class="sxs-lookup"><span data-stu-id="29f8c-112">Can be accessed without restrictions.</span></span>  <br/> |<span data-ttu-id="29f8c-113">Aucun</span><span class="sxs-lookup"><span data-stu-id="29f8c-113">None</span></span>  <br/> |
|<span data-ttu-id="29f8c-114">2</span><span class="sxs-lookup"><span data-stu-id="29f8c-114">2</span></span>  <br/> |<span data-ttu-id="29f8c-115">Accessible uniquement par les formulaires qui s'exécutent dans le même domaine que le formulaire ouvert ou par les formulaires qui disposent d'autorisations indépendantes des domaines.</span><span class="sxs-lookup"><span data-stu-id="29f8c-115">Can be accessed only by forms running in the same domain as the currently open form, or by forms that have been granted cross-domain permissions.</span></span>  <br/> |<span data-ttu-id="29f8c-116">Aucun</span><span class="sxs-lookup"><span data-stu-id="29f8c-116">None</span></span>  <br/> |
|<span data-ttu-id="29f8c-117">3</span><span class="sxs-lookup"><span data-stu-id="29f8c-117">3</span></span>  <br/> |<span data-ttu-id="29f8c-118">Accessible uniquement par les formulaires disposant d'une autorisation totale.</span><span class="sxs-lookup"><span data-stu-id="29f8c-118">Can be accessed only by fully trusted forms.</span></span>  <br/> |<span data-ttu-id="29f8c-119">FullTrust</span><span class="sxs-lookup"><span data-stu-id="29f8c-119">FullTrust</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="29f8c-120">Le niveau de sécurité « 1 » n'est pas utilisé par le serveur COM d'InfoPath actuel et est réservé pour un usage ultérieur.</span><span class="sxs-lookup"><span data-stu-id="29f8c-120">The security level "1" is not used by the current InfoPath COM server and is reserved for future use.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="29f8c-121">[!IMPORTANTE] Bien que les niveaux 0 et 2 du modèle objet n'exigent aucun jeu d'autorisations parce qu'ils contiennent du code managé, ils se comportent tel que cela est défini pour le niveau de sécurité d'accès au domaine Domaine, décrit dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="29f8c-121">Even though object model levels 0 and 2 do not demand any permission set, because they contain managed code, they behave as defined for the Domain domain access security level that is described in the following section.</span></span> 
  
<span data-ttu-id="29f8c-122">Le niveau de sécurité de chaque membre du modèle objet exposé par les assemblys Microsoft.Office.InfoPath et Microsoft.Office.Interop.InfoPath.SemiTrust est spécifié dans la section Remarques de la rubrique qui documente ce membre dans les espaces de noms [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) et [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) .</span><span class="sxs-lookup"><span data-stu-id="29f8c-122">The security level of each object model member exposed by the Microsoft.Office.InfoPath and Microsoft.Office.Interop.InfoPath.SemiTrust assemblies is specified in the Remarks section of the topic that documents that member in the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) and [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespaces.</span></span> 
  
## <a name="infopath-domain-access-security-levels"></a><span data-ttu-id="29f8c-123">Niveaux de sécurité d'accès au domaine InfoPath</span><span class="sxs-lookup"><span data-stu-id="29f8c-123">InfoPath Domain Access Security Levels</span></span>

<span data-ttu-id="29f8c-p101">Avec les niveaux de sécurité du modèle objet appliqués par le serveur COM exposé par l'application InfoPath, InfoPath définit trois niveaux de sécurité qui sont appliqués en fonction de l'emplacement du modèle de formulaire, de la manière dont le formulaire est déployé et de la configuration des paramètres en mode Création. Ces trois niveaux de sécurité sont définis dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p101">In conjunction with the object model security levels that are enforced by the COM server exposed by the InfoPath application, InfoPath defines three security levels that are applied depending on where the form template is located, how the form is deployed, and settings configured in design mode. These three security levels are defined in the following table.</span></span>
  
|<span data-ttu-id="29f8c-126">**Niveau de sécurité d'accès au domaine**</span><span class="sxs-lookup"><span data-stu-id="29f8c-126">**Domain Access Security Level**</span></span>|<span data-ttu-id="29f8c-127">**Description**</span><span class="sxs-lookup"><span data-stu-id="29f8c-127">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="29f8c-128">Restreint</span><span class="sxs-lookup"><span data-stu-id="29f8c-128">Restricted</span></span>  <br/> |<span data-ttu-id="29f8c-129">N'autorise aucune communication en dehors du modèle de formulaire.</span><span class="sxs-lookup"><span data-stu-id="29f8c-129">Does not permit any communication outside of the form template.</span></span> <span data-ttu-id="29f8c-130">Ce niveau de sécurité permet d'éviter que les formulaires dangereux transmettent des données de votre ordinateur à un utilisateur malintentionné.</span><span class="sxs-lookup"><span data-stu-id="29f8c-130">This security level is intended to prevent harmful forms from transmitting any data from your computer to a malicious attacker.</span></span> <span data-ttu-id="29f8c-131">Lors de l’exécution dans ce mode de sécurité, les fonctionnalités suivantes ne fonctionneront pas : volet Des tâches personnalisé, Connexions de données (à l’exception de l’envoi de courrier électronique), contrôles ActiveX, code de formulaire avec code géré, rôles et flux de travail.</span><span class="sxs-lookup"><span data-stu-id="29f8c-131">When running in this security mode, the following features will not work: Custom Task Pane, Data Connections (except email submit), ActiveX controls, managed code form code, Roles, and Workflow.</span></span> <span data-ttu-id="29f8c-132">Les modèles de formulaire avec code managé ne peuvent pas s'exécuter dans le domaine restreint.</span><span class="sxs-lookup"><span data-stu-id="29f8c-132">Managed code form templates cannot run in the Restricted domain.</span></span> <span data-ttu-id="29f8c-133">Lorsqu'un modèle de formulaire avec code managé est configuré avec l'option **Déterminer automatiquement le niveau de sécurité** dans la catégorie **Sécurité et approbation** de la boîte de dialogue **Options de formulaire**, il exige toujours au moins le niveau d'accès de sécurité Domaine pour exécuter le code.</span><span class="sxs-lookup"><span data-stu-id="29f8c-133">When a managed code form template is set to the **Automatically determine security level** setting in the **Security and Trust** category of the **Form Options** dialog box, the form template will always require at least the Domain security access level to run code.</span></span>  <br/><br/><span data-ttu-id="29f8c-134">**IMPORTANT :** l’assembly de code géré créé pour un modèle de formulaire avec code géré ne se charge pas et ne s’exécute pas lorsqu’un formulaire est ouvert à partir d’un domaine restreint, par exemple, à partir d’un formulaire InfoPath envoyé en tant que pièce jointe d’un e-mail.</span><span class="sxs-lookup"><span data-stu-id="29f8c-134">**IMPORTANT**: The managed code assembly created for a managed code form template will not load and run when a form is opened from a Restricted domain, for example, from an InfoPath form sent as an email attachment.</span></span> <span data-ttu-id="29f8c-135">Tout modèle de formulaire que vous souhaitez déployer en tant que pièce jointe doit omettre les fonctionnalités répertoriées ci-dessus, et si le modèle de formulaire contient du code de formulaire, il doit être implémenté dans JScript ou VBScript et ne doit utiliser que les membres du modèle objet avec le niveau de sécurité 0 (zéro).</span><span class="sxs-lookup"><span data-stu-id="29f8c-135">Any form template you wish to deploy as an email attachment must omit the features listed above, and if the form template contains form code, form code must be implemented in JScript or VBScript, and must only utilize object model members with a security level of 0 (zero).</span></span>           |
|<span data-ttu-id="29f8c-136">Domaine</span><span class="sxs-lookup"><span data-stu-id="29f8c-136">Domain</span></span>  <br/> |<span data-ttu-id="29f8c-p104">Restreint un formulaire en fonction de son emplacement dans une des zones de sécurité définies par Microsoft Internet Explorer. Par exemple, si le formulaire se trouve sur l'intranet local, il peut communiquer avec d'autres données à l'intérieur de son domaine, mais il n'est pas autorisé à récupérer des données provenant d'autres domaines. La présence dans une zone de sécurité Microsoft Internet Explorer détermine également si les contrôles ActiveX marqués comme n'étant pas sûrs pour les scripts sont autorisés à s'exécuter.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p104">Restricts a form based on its location in one of the security zones defined by Microsoft Internet Explorer. For example, if the form is located in the Local Intranet zone, it is allowed to communicate with other data inside its own domain but it is not permitted to retrieve data from other domains. The location in a Microsoft Internet Explorer security zone also determines whether ActiveX controls that are marked as unsafe for scripting will be allowed to run.</span></span>  <br/> |
|<span data-ttu-id="29f8c-140">Confiance totale</span><span class="sxs-lookup"><span data-stu-id="29f8c-140">Full Trust</span></span>  <br/> |<span data-ttu-id="29f8c-p105">Vous permet d'exécuter un formulaire avec autorisation totale sur l'ordinateur sur lequel le formulaire va être utilisé. Ce niveau de sécurité peut uniquement être utilisé lorsque vous travaillez avec un formulaire signé numériquement avec une signature qui correspond à un éditeur racine approuvé sur votre ordinateur ou lorsque vous créez un programme d'installation qui installe le formulaire et définit l'attribut **requireFullTrust** de l'élément **xDocumentClass** sur « yes » dans le fichier de définition du formulaire. Avec ce paramètre, votre formulaire peut accéder à des appels du modèle objet qui nécessitent le niveau de sécurité 3 du modèle objet, par exemple les propriétés et les méthodes qui accèdent au système de fichiers, et vous pouvez désactiver certaines invites de sécurité qui apparaissent lorsque vous vous trouvez à un niveau de sécurité plus restrictif. </span><span class="sxs-lookup"><span data-stu-id="29f8c-p105">Allows you to run a form with full trust on the computer where the form will be used. This security level can only be used when working with a form that is digitally signed with a signature that matches a trusted root publisher on your computer, or by creating an installation program that installs the form and sets the **requireFullTrust** attribute of the **xDocumentClass** element to "yes" in the form definition file (.xsf). By using this setting, your form can access object model calls that require object model security level 3, such as properties and methods that access the file system, and you can disable certain security prompts that appear when running at a more restrictive security level.  </span></span><br/> |
   
<span data-ttu-id="29f8c-144">Par défaut, un formulaire InfoPath est configuré pour sélectionner automatiquement le niveau de sécurité Restreint ou Domaine en fonction des fonctionnalités utilisées dans le modèle de formulaire et de l’endroit et de la façon dont le modèle de formulaire est déployé.</span><span class="sxs-lookup"><span data-stu-id="29f8c-144">By default, an InfoPath form is configured to select automatically either the Restricted or Domain security level depending on the features that are being used in the form template, and where and how the form template is deployed.</span></span> <span data-ttu-id="29f8c-145">Par exemple, un modèle de formulaire déployé en tant que pièce jointe est automatiquement configuré au niveau de sécurité Restreint.</span><span class="sxs-lookup"><span data-stu-id="29f8c-145">For example, a form template deployed as an email attachment is automatically configured to the Restricted security level.</span></span> <span data-ttu-id="29f8c-146">Le paramètre de sécurité est toujours aussi restrictif que possible, en commençant par Restreint, pour garantir un niveau de protection plus élevé pour vous et vos données.</span><span class="sxs-lookup"><span data-stu-id="29f8c-146">The security setting is always as restrictive as possible, starting at Restricted, to ensure a greater level of protection for you and your data.</span></span> <span data-ttu-id="29f8c-147">Lorsqu’un modèle de formulaire qui contient du code géré est définie pour sélectionner automatiquement le niveau de sécurité, le modèle de formulaire requiert toujours au moins le niveau d’accès de sécurité Domaine pour que le code puisse s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="29f8c-147">When a form template that contains managed code is set to automatically select the security level, the form template will always require at least the Domain security access level before code can run.</span></span> <span data-ttu-id="29f8c-148">Vous pouvez remplacer manuellement ce paramètre au moment de la conception pour sélectionner un niveau de sécurité plus approprié pour le formulaire à l’aide de la procédure suivante.</span><span class="sxs-lookup"><span data-stu-id="29f8c-148">You can manually override this setting at design time to select a level of security that is more appropriate for the form by using the following procedure.</span></span> 
  
### <a name="specify-a-forms-security-level"></a><span data-ttu-id="29f8c-149">Définition du niveau de sécurité d'un formulaire</span><span class="sxs-lookup"><span data-stu-id="29f8c-149">Specify a form's security level</span></span>

1. <span data-ttu-id="29f8c-150">Ouvrez le formulaire dans le concepteur de formulaires InfoPath, cliquez sur l’onglet **Fichier**, cliquez sur **Informations**, puis cliquez sur **Options de formulaire**.</span><span class="sxs-lookup"><span data-stu-id="29f8c-150">Open the form in the InfoPath form designer, click the **File** tab, click **Info**, and then click **Form Options**.</span></span>
    
2. <span data-ttu-id="29f8c-151">Dans la boîte de dialogue **Options de formulaire**, cliquez sur **Sécurité et approbation**.</span><span class="sxs-lookup"><span data-stu-id="29f8c-151">In the **Form Options** dialog box, click the **Security and Trust** category.</span></span> 
    
3. <span data-ttu-id="29f8c-152">Désactivez la case à cocher **Déterminer automatiquement le niveau de sécurité (recommandé)**.</span><span class="sxs-lookup"><span data-stu-id="29f8c-152">Clear the **Automatically determine security level (recommended)** check box.</span></span> 
    
4. <span data-ttu-id="29f8c-153">Sélectionnez le niveau de sécurité souhaité.</span><span class="sxs-lookup"><span data-stu-id="29f8c-153">Select the desired security level.</span></span>
    
> [!NOTE] 
> - <span data-ttu-id="29f8c-154">Si vous choisissez le niveau de sécurité **Restreint** pour un modèle de formulaire avec code managé, le code du formulaire n'est pas chargé pas et ne s'exécute pas, quels que soient les membres du modèle objet utilisés dans le code du formulaire.</span><span class="sxs-lookup"><span data-stu-id="29f8c-154">If you the select the **Restricted** security level for a managed code form template, the code behind the form will not load and run regardless of which object model members are used in the form code.</span></span> <span data-ttu-id="29f8c-155">Ce niveau de sécurité est principalement conçu pour les formulaires InfoPath déployés à l’aide de la messagerie électronique.</span><span class="sxs-lookup"><span data-stu-id="29f8c-155">This security level is primarily designed for InfoPath forms that are deployed using email.</span></span>     
> - <span data-ttu-id="29f8c-156">Si vous sélectionnez le niveau de sécurité **Autorisation totale**, vous devez signer numériquement le formulaire ou l'installer et l'inscrire.</span><span class="sxs-lookup"><span data-stu-id="29f8c-156">If you select the **Full Trust** security level, you need to digitally sign or install and register the form.</span></span> <span data-ttu-id="29f8c-157">Pour plus d’informations, voir [Déployer des modèles de formulaire InfoPath avec code.](how-to-deploy-infopath-form-templates-with-code.md)</span><span class="sxs-lookup"><span data-stu-id="29f8c-157">For more information, see [Deploy InfoPath Form Templates with Code](how-to-deploy-infopath-form-templates-with-code.md).</span></span>
    
<span data-ttu-id="29f8c-p109">Le tableau suivant récapitule le modèle de sécurité d'InfoPath. La première colonne présente le niveau spécifié pour le formulaire ou le niveau requis. Les deuxième et troisième colonnes spécifient si l'emplacement du formulaire dispose d'un identificateur URN ou URL. Les autres colonnes spécifient les éléments autorisés à s'exécuter. Pour plus d'informations sur les scénarios de déploiement et les jeux d'autorisations pour les modèles de formulaires avec code managé, voir la section « Fonctionnalités de sécurité de l'accès au code du Common Language Runtime » plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p109">The following table summarizes the InfoPath security model. The first column lists the level specified for or required by the form. The second and third columns specify whether the form has a URN or URL identifier for its location. The remaining columns specify what is allowed to run. For more information on deployment scenarios and permission sets for managed code form templates, see the "Common Language Runtime Code Access Security Features" section later in this topic.</span></span>
  
|<span data-ttu-id="29f8c-163">**Niveau requis par le formulaire**</span><span class="sxs-lookup"><span data-stu-id="29f8c-163">**Level Required by form**</span></span>|<span data-ttu-id="29f8c-164">**Possède un identificateur URN.**</span><span class="sxs-lookup"><span data-stu-id="29f8c-164">**Has URN Identifier**</span></span>|<span data-ttu-id="29f8c-165">**Possède un identificateur URL.**</span><span class="sxs-lookup"><span data-stu-id="29f8c-165">**Has URL Identifier**</span></span>|<span data-ttu-id="29f8c-166">**ActiveX non sécurisé pour l’écriture de scripts**</span><span class="sxs-lookup"><span data-stu-id="29f8c-166">**ActiveX marked unsafe for scripting**</span></span>|<span data-ttu-id="29f8c-167">**Accès entre domaines**</span><span class="sxs-lookup"><span data-stu-id="29f8c-167">**Cross-Domain Access**</span></span>|<span data-ttu-id="29f8c-168">**Code managé**</span><span class="sxs-lookup"><span data-stu-id="29f8c-168">**Managed code**</span></span>|<span data-ttu-id="29f8c-169">**Sécurité du modèle objet**</span><span class="sxs-lookup"><span data-stu-id="29f8c-169">**Object Model Security**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="29f8c-170">Restreint</span><span class="sxs-lookup"><span data-stu-id="29f8c-170">Restricted</span></span>  <br/> ||<span data-ttu-id="29f8c-171">X</span><span class="sxs-lookup"><span data-stu-id="29f8c-171">X</span></span>  <br/> |<span data-ttu-id="29f8c-172">Pas de ActiveX</span><span class="sxs-lookup"><span data-stu-id="29f8c-172">No ActiveX at all</span></span>  <br/> |<span data-ttu-id="29f8c-173">Échec</span><span class="sxs-lookup"><span data-stu-id="29f8c-173">Fail</span></span>  <br/> |<span data-ttu-id="29f8c-174">Le formulaire se charge, mais le code managé ne s'exécute pas.</span><span class="sxs-lookup"><span data-stu-id="29f8c-174">Form loads, but managed code won't run</span></span>  <br/> |<span data-ttu-id="29f8c-175">0</span><span class="sxs-lookup"><span data-stu-id="29f8c-175">0</span></span>  <br/> |
|<span data-ttu-id="29f8c-176">Domaine (Zone **Sites sensibles** d'Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="29f8c-176">Domain (Internet Explorer **Restricted sites** zone)</span></span>  <br/> |<span data-ttu-id="29f8c-177">Ne s'exécute pas du tout.</span><span class="sxs-lookup"><span data-stu-id="29f8c-177">Won't run at all</span></span>  <br/> |<span data-ttu-id="29f8c-178">Ne s'exécute pas du tout.</span><span class="sxs-lookup"><span data-stu-id="29f8c-178">Won't run at all</span></span>  <br/> |<span data-ttu-id="29f8c-179">Ne s'exécute pas du tout.</span><span class="sxs-lookup"><span data-stu-id="29f8c-179">Won't run at all</span></span>  <br/> |<span data-ttu-id="29f8c-180">Ne s'exécute pas du tout.</span><span class="sxs-lookup"><span data-stu-id="29f8c-180">Won't run at all</span></span>  <br/> |<span data-ttu-id="29f8c-181">Ne s'exécute pas du tout.</span><span class="sxs-lookup"><span data-stu-id="29f8c-181">Won't run at all</span></span>  <br/> |<span data-ttu-id="29f8c-182">Ne s'exécute pas du tout.</span><span class="sxs-lookup"><span data-stu-id="29f8c-182">Won't run at all</span></span>  <br/> |
|<span data-ttu-id="29f8c-183">Domaine (Zone **Internet** d'Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="29f8c-183">Domain (Internet Explorer **Internet** zone)</span></span>  <br/> |<span data-ttu-id="29f8c-184">X</span><span class="sxs-lookup"><span data-stu-id="29f8c-184">X</span></span>  <br/> ||<span data-ttu-id="29f8c-185">Échec</span><span class="sxs-lookup"><span data-stu-id="29f8c-185">Fail</span></span>  <br/> |<span data-ttu-id="29f8c-186">Échec</span><span class="sxs-lookup"><span data-stu-id="29f8c-186">Fail</span></span>  <br/> |<span data-ttu-id="29f8c-187">Ne s'exécute pas du tout.</span><span class="sxs-lookup"><span data-stu-id="29f8c-187">Won't run at all</span></span>  <br/> |<span data-ttu-id="29f8c-188">0</span><span class="sxs-lookup"><span data-stu-id="29f8c-188">0</span></span>  <br/> |
|<span data-ttu-id="29f8c-189">Domaine (Zone **Intranet local** d'Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="29f8c-189">Domain (Internet Explorer **Local intranet** zone)</span></span>  <br/> |<span data-ttu-id="29f8c-190">X</span><span class="sxs-lookup"><span data-stu-id="29f8c-190">X</span></span>  <br/> ||<span data-ttu-id="29f8c-191">Échec</span><span class="sxs-lookup"><span data-stu-id="29f8c-191">Fail</span></span>  <br/> |<span data-ttu-id="29f8c-192">Invite</span><span class="sxs-lookup"><span data-stu-id="29f8c-192">Prompt</span></span>  <br/> |<span data-ttu-id="29f8c-193">Le code managé s'exécute avec les autorisations de l'**intranet local**.</span><span class="sxs-lookup"><span data-stu-id="29f8c-193">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="29f8c-194">2</span><span class="sxs-lookup"><span data-stu-id="29f8c-194">2</span></span>  <br/> |
|<span data-ttu-id="29f8c-195">Domaine (Zone **Sites de confiance** d'Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="29f8c-195">Domain (Internet Explorer **Trusted sites** zone)</span></span>  <br/> |<span data-ttu-id="29f8c-196">X</span><span class="sxs-lookup"><span data-stu-id="29f8c-196">X</span></span>  <br/> ||<span data-ttu-id="29f8c-197">Invite</span><span class="sxs-lookup"><span data-stu-id="29f8c-197">Prompt</span></span>  <br/> |<span data-ttu-id="29f8c-198">OK</span><span class="sxs-lookup"><span data-stu-id="29f8c-198">OK</span></span>  <br/> |<span data-ttu-id="29f8c-p110">Le code managé s'exécute avec les autorisations d'**Internet**. L'accès entre domaines est autorisé. Remarque : bien que le formulaire se trouve dans la zone **Sites de confiance**, les autorisations de la zone **Internet** s'appliquent.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p110">Managed code runs with **Internet** permissions. Cross-domain access is allowed. Note that even though the form is in the **Trusted sites** zone, **Internet** zone permissions are applied.  </span></span><br/> |<span data-ttu-id="29f8c-202">2</span><span class="sxs-lookup"><span data-stu-id="29f8c-202">2</span></span>  <br/> |
|<span data-ttu-id="29f8c-203">Domaine (Zone **Ordinateur local** d'Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="29f8c-203">Domain (Internet Explorer **Local computer** zone)</span></span>  <br/> |<span data-ttu-id="29f8c-204">X</span><span class="sxs-lookup"><span data-stu-id="29f8c-204">X</span></span>  <br/> |<span data-ttu-id="29f8c-205">X</span><span class="sxs-lookup"><span data-stu-id="29f8c-205">X</span></span>  <br/> |<span data-ttu-id="29f8c-206">Invite</span><span class="sxs-lookup"><span data-stu-id="29f8c-206">Prompt</span></span>  <br/> |<span data-ttu-id="29f8c-207">Échec</span><span class="sxs-lookup"><span data-stu-id="29f8c-207">Fail</span></span>  <br/> |<span data-ttu-id="29f8c-208">Le code managé s'exécute avec les autorisations de l'**intranet local**.</span><span class="sxs-lookup"><span data-stu-id="29f8c-208">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="29f8c-209">2</span><span class="sxs-lookup"><span data-stu-id="29f8c-209">2</span></span>  <br/> |
|<span data-ttu-id="29f8c-210">Autorisation totale</span><span class="sxs-lookup"><span data-stu-id="29f8c-210">Full Trust</span></span>  <br/> |<span data-ttu-id="29f8c-211">X</span><span class="sxs-lookup"><span data-stu-id="29f8c-211">X</span></span>  <br/> |<span data-ttu-id="29f8c-212">X</span><span class="sxs-lookup"><span data-stu-id="29f8c-212">X</span></span>  <br/> |<span data-ttu-id="29f8c-213">OK</span><span class="sxs-lookup"><span data-stu-id="29f8c-213">OK</span></span>  <br/> |<span data-ttu-id="29f8c-214">OK</span><span class="sxs-lookup"><span data-stu-id="29f8c-214">OK</span></span>  <br/> |<span data-ttu-id="29f8c-215">Autorisation totale</span><span class="sxs-lookup"><span data-stu-id="29f8c-215">Full Trust</span></span>  <br/> |<span data-ttu-id="29f8c-216">3</span><span class="sxs-lookup"><span data-stu-id="29f8c-216">3</span></span>  <br/> |
   
> [!IMPORTANT]
> <span data-ttu-id="29f8c-p111">Les descriptions ci-dessus dans les colonnes « ActiveX marqué comme non sûr pour les scripts » et « Accès entre domaines » utilisent les paramètres de sécurité par défaut de Microsoft Internet Explorer. Si un utilisateur modifie ses paramètres de sécurité, le comportement d'InfoPath est modifié en conséquence. Par exemple, si la zone **Intranet local**, **Accès aux sources de données sur plusieurs domaines** est définie sur l'option **Activer**, les utilisateurs ne peuvent pas autoriser un accès entre les domaines, tel que décrit dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p111">The descriptions above in the "ActiveX marked unsafe for scripting" and "Cross-Domain Access" columns assume the default security settings for Microsoft Internet Explorer. If a user changes their security settings, InfoPath will behave accordingly. For example, if in the **Local intranet** zone, **Access data sources across domains** is set to **Enable**, then users will not be prompted to allow cross-domain access as described in the table.</span></span> 
  
## <a name="common-language-runtime-code-access-security-features"></a><span data-ttu-id="29f8c-220">Fonctionnalités de sécurité de l'accès au code du Common Language Runtime</span><span class="sxs-lookup"><span data-stu-id="29f8c-220">Common Language Runtime Code Access Security Features</span></span>

<span data-ttu-id="29f8c-221">Lors de la compilation d'un modèle de formulaire InfoPath avec code managé, un assembly privé avec code managé contenant l'implémentation de la logique du code de formulaire est créé.</span><span class="sxs-lookup"><span data-stu-id="29f8c-221">When an InfoPath managed code form template is compiled, a private managed code assembly is created that contains the implementation of the form code logic.</span></span>
  
<span data-ttu-id="29f8c-p112">Dans .NET Framework, par défaut, un assembly de code managé dispose des autorisations totales lorsqu'il s'exécute sur l'ordinateur local, et il ne dispose pas de ces autorisations lorsqu'il s'exécute sur l'intranet. Pour un contrôle plus précis de la stratégie de sécurité, et pour offrir la possibilité d'exécuter des modèles de formulaires InfoPath avec code managé comme formulaires disposant d'une autorisation totale depuis l'intranet, InfoPath implémente l'architecture de sécurité suivante.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p112">In the .NET Framework, by default, a managed code assembly has Full Trust permissions when running on the local machine, and is not granted Full Trust permissions when running on the Intranet. To provide more fine-grained control over security policy, and to provide the option to run InfoPath managed code form templates as fully trusted forms from the Intranet, InfoPath implements the following security architecture.</span></span>
  
- <span data-ttu-id="29f8c-224">L'application InfoPath héberge le CLR (Common Language Runtime) de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="29f8c-224">The InfoPath application hosts the .NET Framework common language runtime (CLR).</span></span>
    
- <span data-ttu-id="29f8c-225">Dans le CLR d'InfoPath, chaque modèle de formulaire avec code managé s'exécute dans un domaine d'application distinct. Cet environnement permet l'isolement, le déchargement et les limites de sécurité nécessaires à l'exécution du code managé.</span><span class="sxs-lookup"><span data-stu-id="29f8c-225">Within the CLR hosted by InfoPath, each managed code form template runs in a separate application domain, which is an environment that provides isolation, unloading, and security boundaries for executing managed code.</span></span>
    
- <span data-ttu-id="29f8c-226">InfoPath définit une stratégie de sécurité par défaut sur le domaine de l'application en fonction du niveau d'autorisation associé au modèle de formulaire et à l'URL de son emplacement.</span><span class="sxs-lookup"><span data-stu-id="29f8c-226">InfoPath sets a default security policy on the application domain depending on the level of trust associated with the form template and the URL of its location.</span></span>
    
- <span data-ttu-id="29f8c-p113">Par défaut, un modèle de formulaire avec code managé qui s'exécute sur l'ordinateur local (groupe de codes de la zone Poste de travail) obtient un jeu d'autorisations inférieur à l'Autorisation totale. Pour obtenir les autorisations totales, le formulaire doit être inscrit ou signé numériquement par un certificat approuvé.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p113">By default, a managed code form template running on the local computer (the My Computer Zone code group) gets a lower level of permissions than Full Trust (Local Intranet Zone permissions). To have Full Trust permissions, the form must be registered or digitally signed with a trusted certificate.</span></span>
    
<span data-ttu-id="29f8c-p114">La stratégie de sécurité par défaut définie pour le domaine d'application d'un modèle de formulaire avec code managé assure l'application des niveaux de sécurité d'accès au domaine InfoPath, ainsi que des restrictions de sécurité .NET supplémentaires. Pour une plus grande souplesse, le système de sécurité d'InfoPath reconnaît un groupe de codes de sécurité d'accès au code .NET appelé « Modèles de formulaires InfoPath ». Si ce groupe de code est présent sur l'ordinateur de l'utilisateur, sa configuration de sécurité, ainsi que celle de tous ses groupes de codes enfants, est appliquée au domaine de l'application.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p114">The default security policy set for the application domain of a managed code form template ensures that the InfoPath domain access security levels as well as any additional .NET security restrictions are enforced. To provide additional flexibility, the InfoPath security system recognizes a .NET code access security code group named "InfoPath Form Templates". If this code group is present on a user's computer, its security configuration, and those of any child code groups within it will be applied to the application domain.</span></span>
  
> [!IMPORTANT] 
> - <span data-ttu-id="29f8c-p115">Le groupe de codes Modèles de formulaires InfoPath s'applique uniquement à l'assembly du code de formulaire managé. Ainsi, si vous accordez le jeu d'autorisations Autorisation totale au code de formulaire InfoPath avec code managé mais que vous n'avez pas installé et inscrit (ou signé numériquement) le formulaire lui-même (ce qui attribue l'autorisation totale à tout le modèle de formulaire), les appels effectués dans le code du formulaire à des membres du modèle objet du niveau de sécurité 3 échouent toujours.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p115">The InfoPath Form Templates code group applies only to the managed code form code assembly itself. As a result, if you grant the Full Trust permission set to InfoPath managed code form code, but you have not installed and registered (or digitally signed) the form template itself (which makes the entire form template fully trusted), calls in the form code to security level 3 object model members will still fail.</span></span>   
> - <span data-ttu-id="29f8c-234">Si vous faites référence à un assembly configuré avec un jeu d'autorisations restreint à l'aide de Hash, Strong Name ou Publisher, ou que vous chargez explicitement un assembly (Assembly.Load) afin de déterminer son appartenance à un projet de modèle de formulaire, l'assembly est malgré tout chargé et exécuté par le modèle de formulaire.</span><span class="sxs-lookup"><span data-stu-id="29f8c-234">If you reference or explicitly load (Assembly.Load) an assembly that is configured with a restricted permission set using Hash, Strong Name, or Publisher evidence to determine its membership condition in a form template project, the assembly will nonetheless be loaded and executed by the form template.</span></span>
    
<span data-ttu-id="29f8c-235">Pour plus d’informations sur la création et la configuration du groupe de codes Modèles de formulaire InfoPath, voir Configurer la sécurité Paramètres pour les modèles de formulaire [avec code.](how-to-configure-security-settings-for-form-templates-with-code.md)</span><span class="sxs-lookup"><span data-stu-id="29f8c-235">For information on how to create and configure the InfoPath Form Templates code group, see [Configure Security Settings for Form Templates with Code](how-to-configure-security-settings-for-form-templates-with-code.md).</span></span>
  
<span data-ttu-id="29f8c-236">Le tableau suivant récapitule les scénarios de déploiement et les jeux d'autorisations qui s'appliquent aux modèles de formulaires avec code managé.</span><span class="sxs-lookup"><span data-stu-id="29f8c-236">The following table summarizes the deployment scenarios and permission sets that apply to managed code form templates.</span></span>
  
|<span data-ttu-id="29f8c-237">**Scénario de déploiement**</span><span class="sxs-lookup"><span data-stu-id="29f8c-237">**Deployment Scenario**</span></span>|<span data-ttu-id="29f8c-238">**Jeu d'autorisations**</span><span class="sxs-lookup"><span data-stu-id="29f8c-238">**Permission Set**</span></span>|<span data-ttu-id="29f8c-239">**Notes**</span><span class="sxs-lookup"><span data-stu-id="29f8c-239">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="29f8c-240">Le modèle de formulaire est publié sur l'ordinateur local et le développeur utilise Visual Studio pour écrire et déboguer le code du formulaire.</span><span class="sxs-lookup"><span data-stu-id="29f8c-240">The form template is published on the local computer, and the developer is using Visual Studio to write and debug form code.</span></span>  <br/> |<span data-ttu-id="29f8c-241">Jeu d'autorisations intranet local</span><span class="sxs-lookup"><span data-stu-id="29f8c-241">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="29f8c-242">Les assemblys installés dans le Global Assembly Cache (GAC) et marqués avec l'attribut **AllowPartiallyTrustedCallersAttribute** disposent du jeu Autorisation totale.</span><span class="sxs-lookup"><span data-stu-id="29f8c-242">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="29f8c-243">Par défaut, les modèles de formulaires exécutés depuis l'ordinateur local n'obtiennent pas le jeu Autorisation totale.</span><span class="sxs-lookup"><span data-stu-id="29f8c-243">By default, form templates running from the local computer are not granted the Full Trust permission set.</span></span> <span data-ttu-id="29f8c-244">Lors du développement de modèles de formulaire qui utilisent des fonctionnalités et des appels aux membres du modèle objet qui nécessitent des autorisations de confiance totale, vous pouvez utiliser la procédure décrite dans les modèles de formulaires d’aperçu et de [débogage](how-to-preview-and-debug-form-templates-that-require-full-trust.md)qui nécessitent une confiance totale.</span><span class="sxs-lookup"><span data-stu-id="29f8c-244">While developing form templates that use features and calls to object model members that require Full Trust permissions, you can use the procedure described in [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>  <br/> |
|<span data-ttu-id="29f8c-245">Le modèle de formulaire est publié sur l'ordinateur local et fait référence à un assembly personnalisé qui exige le jeu d'autorisations Autorisation totale sur l'ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="29f8c-245">The form template is published on the local computer and references a custom assembly that requests the Full Trust permission set on the local computer.</span></span>  <br/> |<span data-ttu-id="29f8c-246">Jeu d'autorisations intranet local</span><span class="sxs-lookup"><span data-stu-id="29f8c-246">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="29f8c-p117">Les assemblys installés dans le Global Assembly Cache (GAC) et marqués avec l'attribut **AllowPartiallyTrustedCallersAttribute** disposent du jeu Autorisation totale. L'assembly personnalisé obtient le jeu d'autorisations Intranet local.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p117">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set. The custom assembly is granted the Local Intranet permission set.  </span></span><br/> |<span data-ttu-id="29f8c-p118">Pour référencer des assemblys externes et les utiliser dans le code du modèle de formulaire, le développeur doit utiliser le groupe de codes Modèles de formulaires InfoPath pour accorder l'Autorisation totale (ou le jeu d'autorisations approprié) à l'assembly externe référencé dans le code du modèle de formulaire. InfoPath prend aucune décision quant aux assemblys externes autres que ceux installés dans le Global Assembly Cache (GAC). Le développeur doit accorder de manière explicite les autorisations nécessaires à l'aide du groupe de codes Modèles de formulaires InfoPath, même si l'assembly dispose déjà d'autorisations accordées dans le cadre du groupe de codes de la Zone Poste de travail.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p118">To reference external assemblies for use in the form template's code, the developer must use the InfoPath Form Templates code group to grant Full Trust (or the appropriate permission set) to the external assembly referenced in the form template's code. InfoPath does not make any assumptions about external assemblies other than those installed in the Global Assembly Cache (GAC). The developer must explicitly grant the assembly the necessary permissions using the InfoPath Form Templates code group even if the assembly is already trusted though permissions granted in the My_Computer_Zone code group.</span></span>  <br/> |
|<span data-ttu-id="29f8c-252">Le modèle de formulaire est publié dans un emplacement partagé sur l'intranet local, par exemple un partage de fichiers, une bibliothèque de formulaires SharePoint ou un serveur Web.</span><span class="sxs-lookup"><span data-stu-id="29f8c-252">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server.</span></span>  <br/> |<span data-ttu-id="29f8c-253">Jeu d'autorisations Intranet local</span><span class="sxs-lookup"><span data-stu-id="29f8c-253">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="29f8c-254">Les assemblys installés dans le Global Assembly Cache (GAC) et marqués avec l'attribut **AllowPartiallyTrustedCallersAttribute** disposent du jeu Autorisation totale.</span><span class="sxs-lookup"><span data-stu-id="29f8c-254">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> ||
|<span data-ttu-id="29f8c-255">Le modèle de formulaire est publié dans un emplacement partagé sur l'intranet local, par exemple un partage de fichiers, une bibliothèque de formulaires SharePoint ou un serveur Web désigné comme étant un site approuvé par Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="29f8c-255">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server that is designated as a Trusted site in Internet Explorer.</span></span>  <br/> |<span data-ttu-id="29f8c-256">Jeu d'autorisations Internet</span><span class="sxs-lookup"><span data-stu-id="29f8c-256">Internet permission set.</span></span>  <br/> <span data-ttu-id="29f8c-257">Les assemblys signés par Microsoft et ECMA obtiennent le jeu Autorisation totale.</span><span class="sxs-lookup"><span data-stu-id="29f8c-257">Assemblies signed by Microsoft and ECMA are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="29f8c-p119">La sécurité d'accès au code du CLR accorde uniquement le jeu d'autorisations Internet aux sites conçus comme Sites de confiance dans Internet Explorer. InfoPath respecte cette règle. Notez que ceci diffère d'un modèle de formulaire InfoPath qui utilise un script comme code, qui obtient un jeu d'autorisations plus élevé lorsqu'il est publié dans une zone Sites de confiance. </span><span class="sxs-lookup"><span data-stu-id="29f8c-p119">CLR code access security grants only the Internet permission set to sites that are designated as Trusted sites in Internet Explorer. InfoPath respects this policy. Note that this is unlike an InfoPath form template that uses script for form code, which receives a higher level of permissions when published in a Trusted sites zone.</span></span>  <br/> |
|<span data-ttu-id="29f8c-261">Le modèle de formulaire est téléchargé ou copié depuis un emplacement Internet.</span><span class="sxs-lookup"><span data-stu-id="29f8c-261">The form template is downloaded or copied from an Internet location.</span></span>  <br/> |<span data-ttu-id="29f8c-p120">Aucun par défaut. L'assembly de code managé du modèle de formulaire ne se charge pas et ne s'exécute pas.</span><span class="sxs-lookup"><span data-stu-id="29f8c-p120">By default, none. The managed code assembly for the form template is not loaded and does not run.</span></span>  <br/> ||
   
## <a name="see-also"></a><span data-ttu-id="29f8c-264">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="29f8c-264">See also</span></span>

- [<span data-ttu-id="29f8c-265">Configurer l’Paramètres sécurité pour les modèles de formulaires avec code</span><span class="sxs-lookup"><span data-stu-id="29f8c-265">Configure Security Settings for Form Templates with Code</span></span>](how-to-configure-security-settings-for-form-templates-with-code.md)
- [<span data-ttu-id="29f8c-266">Afficher un aperçu et déboguer des modèles de formulaire exigeant l'autorisation totale</span><span class="sxs-lookup"><span data-stu-id="29f8c-266">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)

