---
title: À propos de la prise en charge InfoPath pour les technologies XML
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 074181a2-3a75-824c-049d-549aabff0f9f
description: Microsoft InfoPath est un outil hybride qui combine le meilleur d’une expérience d’édition de documents traditionnelle, telle qu’un traitement de texte ou une application de messagerie, avec les fonctionnalités rigoureuses de capture de données d’un package de formulaires. Cet article décrit les problèmes qu'InfoPath est censé résoudre, et détaille les principes de conception et les standards XML que cette solution utilise.
ms.openlocfilehash: 20831635fba8d76b9d6b45f42a5308ab7236db20
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33407227"
---
# <a name="about-infopath-support-for-xml-technologies"></a><span data-ttu-id="a9992-104">À propos de la prise en charge InfoPath pour les technologies XML</span><span class="sxs-lookup"><span data-stu-id="a9992-104">About InfoPath Support for XML Technologies</span></span>

<span data-ttu-id="a9992-105">Microsoft InfoPath est un outil hybride qui combine le meilleur d’une expérience d’édition de documents traditionnelle, telle qu’un traitement de texte ou une application de messagerie, avec les fonctionnalités rigoureuses de capture de données d’un package de formulaires.</span><span class="sxs-lookup"><span data-stu-id="a9992-105">Microsoft InfoPath is a hybrid tool that combines the best of a traditional document editing experience, such as a word processor or email application, with the rigorous data-capture capabilities of a forms package.</span></span> <span data-ttu-id="a9992-106">Cet article décrit les problèmes qu'InfoPath est censé résoudre, et détaille les principes de conception et les standards XML que cette solution utilise.</span><span class="sxs-lookup"><span data-stu-id="a9992-106">This article describes the problems InfoPath is designed to address and explains the design principles and XML industry standards used to solve these problems.</span></span>
  
## <a name="introduction"></a><span data-ttu-id="a9992-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="a9992-107">Introduction</span></span>

<span data-ttu-id="a9992-p103">InfoPath est un outil de création XML de haut niveau qui permet à tous les utilisateurs finaux de créer des documents XML appartenant à un schéma XML personnalisé. Lorsque l'utilisateur édite un document XML, les modifications apportées au document sont contrôlées par le schéma XML.</span><span class="sxs-lookup"><span data-stu-id="a9992-p103">InfoPath is a high-level XML authoring tool that enables ordinary end-users to create XML documents that belong to a custom-defined XML schema. When the user edits an XML document, modifications to the document are controlled by the XML schema.</span></span>
  
<span data-ttu-id="a9992-p104">L'utilisateur interagit avec le document XML par le biais d'une vue enrichie et mise en forme, affichée en appliquant une feuille de style XSLT au document. Les nœuds terminaux et les valeurs d'attribut du document XML sont affichés sous forme de champ (par exemple une zone de texte ou une case à cocher) et les hiérarchies de nœuds sont rendues sous forme de groupes de champs.</span><span class="sxs-lookup"><span data-stu-id="a9992-p104">The user interacts with the XML document through a rich, formatted view that is displayed by applying an XSLT style sheet to the document. A leaf node or attribute value from the XML document is displayed as a field, such as a text box or check box, whereas a hierarchy of nodes is rendered as a group of fields.</span></span>
  
<span data-ttu-id="a9992-p105">InfoPath permet d'éditer les données XML de façon validée et structurée, en affichant les actions d'édition valides pour le champ ou le groupe de champs sélectionné. L'édition structurée offre aux utilisateurs la possibilité d'ajouter et de supprimer des éléments et attributs XML valides par le biais de groupes de champs affichés dans des vues dynamiques enrichies, sans afficher ces éléments et attributs.</span><span class="sxs-lookup"><span data-stu-id="a9992-p105">InfoPath enables validated, structured editing of XML data by showing the editing actions that are valid for the field or field group that is currently selected. This structured editing enables the user to add and remove valid XML elements and attributes by working with groups of fields displayed in rich dynamic views, without seeing the elements and attributes.</span></span>
  
<span data-ttu-id="a9992-p106">En matière de collecte de données, InfoPath résout un problème impossible à résoudre avant la naissance du langage XML : en fournissant des formulaires évolutifs, capables d'accueillir d'autres groupes de champs utilisant le modèle de données hiérarchique du langage XML, InfoPath associe l'immense flexibilité des applications de traitement de texte aux fonctions rigoureuses de validation offertes par les applications de gestion de formulaires. Les transformations XSLT complexes font partie intégrante de cette solution, qui offre des vues dynamiques et simples d'utilisation des données XML.</span><span class="sxs-lookup"><span data-stu-id="a9992-p106">InfoPath solves a problem in the area of data gathering that could not be solved before the advent of XML: by providing forms that can grow by adding groups of fields that use the hierarchical data model of XML, InfoPath adds the flexibility of word processor documents to the rigorous validation features of a forms application. Complex XSLT transformations are an integral part of this solution that provides dynamic, easy-to-use views of the XML data.</span></span>
  
## <a name="limitations-of-traditional-forms-and-documents-for-gathering-data"></a><span data-ttu-id="a9992-116">Limites des formulaires et documents conventionnels en matière de collecte de données</span><span class="sxs-lookup"><span data-stu-id="a9992-116">Limitations of Traditional Forms and Documents for Gathering Data</span></span>

<span data-ttu-id="a9992-117">Lors de la collecte de données d’entreprise, les utilisateurs souhaitent en général bénéficier d’une flexibilité plus importante que celle offerte par les formulaires statiques, tout en profitant de fonctions d’édition structurée et de validation plus sophistiquées que celles proposées par les applications de traitement de texte.</span><span class="sxs-lookup"><span data-stu-id="a9992-117">When gathering corporate data, users often want more flexibility than static forms provide, but more structured editing and validation than word processor documents provide.</span></span>
  
<span data-ttu-id="a9992-p107">Les formulaires conventionnels sont statiques et limités en longueur. Le nombre de lignes extensibles est fixe et ils ne peuvent pas être étendus pendant le remplissage du formulaire. En outre, leur utilisation est complexe, car ils ne disposent pas de fonctions d'édition enrichie. Bien souvent, l'utilisateur doit fournir toutes les informations simultanément.</span><span class="sxs-lookup"><span data-stu-id="a9992-p107">Traditional forms are static and limited in length. They have a fixed number of repeating rows, and cannot be extended when the form is being filled out. Traditional forms are difficult to use because they do not have rich editing features. Often, the user must provide all the information in one pass.</span></span>
  
<span data-ttu-id="a9992-p108">De leur côté, les documents conventionnels créés à l'aide d'une application de traitement de texte permettent à l'utilisateur d'ajouter et de supprimer du contenu à sa guise, mais ils lui laissent presque trop de marge de manœuvre, dans le sens où il n'est pas obligé de saisir des informations complètes, structurées et valides. Les champs définis dans le document font rarement l'objet d'une véritable validation des valeurs et des types de données. Les libellés associés aux données des champs sont insuffisants pour permettre de faire facilement référence aux données et de les réutiliser automatiquement. Au lieu d'être structuré, le format des données est libre. Enfin, vous ne pouvez pas regrouper des informations, par exemple appliquer un libellé « Adresse » à un groupe associé aux champs « Rue », « Ville » et « État ».</span><span class="sxs-lookup"><span data-stu-id="a9992-p108">On the other hand, traditional documents created by using a word processor enable the user to freely add and remove content, but provide little guidance about how to enter complete, structured, and valid information; any fields that are defined in the document have minimal or no validation of data values and data types. Data in the fields is not properly labeled to enable easy referencing and automatic reuse. The data is free-form rather than structured; you cannot group information, such as applying an "Address" label to a group of "Street", "City", and "State" fields.</span></span>
  
<span data-ttu-id="a9992-p109">Des outils d’édition aussi flexibles que structurés s’avèrent donc nécessaires. Cependant, avant l’arrivée du langage XML, ce type de technologie n’était pas disponible. Entre temps, les développeurs ont été amenés à créer des applications personnalisées nécessitant un codage sophistiqué. Ces applications sont coûteuses et difficiles à modifier, et la validation nécessite un codage personnalisé. Il est bien souvent nécessaire de former les utilisateurs finaux et il s’avère difficile de réutiliser les données obtenues dans d’autres processus d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="a9992-p109">Thus there is a need for such flexible yet structured editing, but because this kind of technology was not available before the advent of XML, developers have had to create custom applications, which require extensive coding. Custom applications are expensive and difficult to modify, and require custom coding for validation. Custom applications often require end-user training, and it is difficult to reuse the resulting data for other business processes.</span></span>
  
## <a name="providing-structured-editing-by-displaying-xml-data-as-field-groups"></a><span data-ttu-id="a9992-127">Accès à l’édition structurée grâce à l’affichage de données XML sous forme de groupes de champs</span><span class="sxs-lookup"><span data-stu-id="a9992-127">Providing Structured Editing by Displaying XML Data as Field Groups</span></span>

<span data-ttu-id="a9992-p110">Sur le plan de la conception technique, l'une des principales difficultés fut de trouver comment créer une interface simple d'utilisation permettant d'ajouter et de supprimer des éléments et attributs XML sans les afficher, tout en conservant une arborescence DOM conforme au schéma XML personnalisé défini. Une telle interface utilisateur devait donc permettre d'éditer facilement l'arborescence DOM, notamment en insérant des sous-arborescences facultatives, en remplaçant les sous-arborescences disponibles et en étendant les sous-arborescences existantes.</span><span class="sxs-lookup"><span data-stu-id="a9992-p110">An important technical design problem that had to be solved was how to provide an easy user interface for adding and removing XML elements and attributes, without showing the elements and attributes, but keeping the DOM tree valid according to the custom-defined XML schema. The user interface needed to provide a natural way to edit the DOM tree that includes inserting optional subtrees, replacing choices of subtrees, and extending existing subtrees.</span></span>
  
<span data-ttu-id="a9992-p111">Pour fournir une interface simple d'utilisation, une sous-arborescence DOM s'affiche sous la forme d'un groupe de champs (ou section). Un groupe de champs est un groupe de contrôles d'interface utilisateur (zones de texte, listes déroulantes, etc.) qui joue le rôle d'interface simple permettant à l'utilisateur de visualiser et d'éditer des données XML hiérarchiques. À l'instar des sous-arborescences DOM, qui peuvent contenir d'autres sous-arborescences et être facultatives ou extensibles, un groupe de champs peut contenir d'autres groupes de champs et être facultatif ou extensible. Une sous-arborescence est ajoutée à l'arborescence DOM lorsque l'utilisateur survole un groupe de champs à l'aide du pointeur de la souris, clique sur le menu déroulant qui s'affiche sur le groupe de champs, puis sélectionne **Insérer \<nom du groupe de champs\>**.</span><span class="sxs-lookup"><span data-stu-id="a9992-p111">To provide this easy user interface, a DOM subtree is displayed as a field group, or section. A field group is a group of UI controls, such as text boxes and drop-down lists, and serves as an easy user interface that enables the user to visualize and edit hierarchical XML data. A field group can contain other field groups and can be optional or repeating, just as a DOM subtree can contain other subtrees and can be optional or repeating. A subtree is added to the DOM tree when the user rests the mouse pointer over a field group, clicks the drop-down menu that appears on the field group, and then selects **Insert \<field group name\>**.</span></span>
  
<span data-ttu-id="a9992-p112">InfoPath permet d'éditer les données XML de façon structurée en utilisant le schéma XML spécifié pour encadrer et guider l'édition. Le schéma détermine notamment si les commandes **Insérer** et **Supprimer** doivent ou non s'afficher dans le menu déroulant d'un groupe de champs. Ce schéma est également utilisé pour la validation. Pour permettre l'édition d'un document XML pour lequel il n'existe pas de schéma, InfoPath peut générer un schéma à partir du document XML.</span><span class="sxs-lookup"><span data-stu-id="a9992-p112">InfoPath provides this structured editing of XML data by using the specified XML schema to constrain and guide editing. The schema controls whether the **Insert** and **Remove** commands appear on the drop-down menu for a field group. The schema is also used for validation. To enable editing of an XML document for which there is no XML schema, InfoPath can generate a schema from the XML document.</span></span> 
  
## <a name="providing-easy-to-use-views-of-xml-data-by-using-xslt-transformations"></a><span data-ttu-id="a9992-138">Accès à des vues de données XML simples d’utilisation à l’aide de transformations XSLT</span><span class="sxs-lookup"><span data-stu-id="a9992-138">Providing Easy-to-Use Views of XML Data by Using XSLT Transformations</span></span>

<span data-ttu-id="a9992-p113">Une des autres difficultés techniques à résoudre consistait à trouver un moyen d'organiser le contenu des vues de l'interface utilisateur sans forcément reprendre la structure des données XML. Pour présenter les données de façon claire pour l'utilisateur et lui permettre de les lire et de les éditer facilement, le concepteur doit pouvoir afficher les données dans un ordre différent de celui dans lequel elles apparaissent dans l'arborescence de données DOM, ignorer certaines données figurant dans une vue, réorganiser des nœuds d'arborescence de données adjacents dans des vues séparées et regrouper dans une même vue des données issues de différentes sections de l'arborescence.</span><span class="sxs-lookup"><span data-stu-id="a9992-p113">Another technical design challenge that needed to be solved was how to enable the content of the UI views to be organized very differently than the structure of the XML data. To present the data in a way that makes the most sense for the user and enables the user to easily read and edit the data, the designer must be able to display data in a different sequence than in the DOM data tree, omit some data from a view, reorganize adjacent data tree nodes into separate views, and collect data from different parts of the data tree into a single view.</span></span>
  
<span data-ttu-id="a9992-p114">L'ordre et la structure du contenu des vues doivent par conséquent être indépendants de l'ordre et de la structure des nœuds de l'arborescence DOM. Cette indépendance structurelle en termes de présentation et de données nécessite une liaison ou un mappage complexe et dynamique entre les champs groupés dans les vues et les nœuds de l'arborescence DOM.</span><span class="sxs-lookup"><span data-stu-id="a9992-p114">The order and structure of the content of the views must therefore be independent of the order and structure of the DOM tree nodes. This structural independence of presentation and data requires a complex, dynamic binding or mapping between the grouped fields in the views and the nodes in the DOM tree.</span></span>
  
<span data-ttu-id="a9992-p115">Pour créer ce mappage complexe entre les vues et les données, InfoPath s'appuie de façon importante sur le langage XSLT (XSL Transformations). XSLT est un puissant langage de feuille de style qui prend en charge les transformations XSLT complexes et les vues enrichies, et qui permet de présenter le contenu de façon dynamique et flexible. Un fichier XSLT distinct est associé à chaque vue. L'utilisation de feuilles de style est désormais une approche courante et bien établie dans les outils de création SGML et XML, et XSLT est le standard W3C des feuilles de style utilisées dans le cadre de ces transformations complexes.</span><span class="sxs-lookup"><span data-stu-id="a9992-p115">To provide this complex mapping between views and data, InfoPath uses XSL Transformations (XSLT) extensively. XSLT is a powerful style sheet language that supports complex XSLT transformations and supports rich views with dynamic, flexible presentation of content. One XSLT file is used for each view. By using a style sheet is a common, well-established design approach in SGML and XML authoring tools, and XSLT is the W3C standard for stylesheets that are used for this kind of complex transformation.</span></span>
  
<span data-ttu-id="a9992-p116">Pour éviter d'exécuter entièrement la transformation XSLT chaque fois que l'utilisateur modifie la structure d'une sous-arborescence du DOM, des algorithmes déterminent quelle partie de la vue doit être actualisée. Ainsi, seule la partie concernée de la feuille de style XSLT est appliquée et la partie en question est actualisée dans la vue.</span><span class="sxs-lookup"><span data-stu-id="a9992-p116">To avoid running the whole XSLT transformation every time that the user modifies the structure of a subtree in the DOM, algorithms are used to determine which part of the view must be refreshed. Then only the relevant part of the XSLT style sheet is applied, and the affected part of the view is refreshed.</span></span>
  
## <a name="how-xml-standards-are-used-when-editing-a-form"></a><span data-ttu-id="a9992-149">Utilisation des standards XML lors de l’édition d’un formulaire</span><span class="sxs-lookup"><span data-stu-id="a9992-149">How XML Standards Are Used When Editing a Form</span></span>

<span data-ttu-id="a9992-150">InfoPath s'appuie entièrement sur les standards XML suivants :</span><span class="sxs-lookup"><span data-stu-id="a9992-150">InfoPath is built from the ground up on XML standards that includes the following:</span></span>
  
- <span data-ttu-id="a9992-151">Extensible Markup Language (XML) 1.0 Second Edition</span><span class="sxs-lookup"><span data-stu-id="a9992-151">Extensible Markup Language (XML) 1.0 Second Edition</span></span>
    
- <span data-ttu-id="a9992-152">Namespaces in XML</span><span class="sxs-lookup"><span data-stu-id="a9992-152">Namespaces in XML</span></span>
    
- <span data-ttu-id="a9992-153">XML Path Language (XPath) 1.0</span><span class="sxs-lookup"><span data-stu-id="a9992-153">XML Path Language (XPath) 1.0</span></span>
    
- <span data-ttu-id="a9992-154">XML Schema (XSD) 1.0 Part 1: Structures, and Part 2: Datatypes</span><span class="sxs-lookup"><span data-stu-id="a9992-154">XML Schema (XSD) 1.0 Part 1: Structures, and Part 2: Datatypes</span></span>
    
- <span data-ttu-id="a9992-155">Extensible Stylesheet Language Transformations (XSLT) 1.0</span><span class="sxs-lookup"><span data-stu-id="a9992-155">Extensible Stylesheet Language Transformations (XSLT) 1.0</span></span>
    
- <span data-ttu-id="a9992-156">Extensible Hypertext Markup Language (XHTML) 1.0</span><span class="sxs-lookup"><span data-stu-id="a9992-156">Extensible Hypertext Markup Language (XHTML) 1.0</span></span>
    
- <span data-ttu-id="a9992-157">Cascading Style Sheets (CSS)</span><span class="sxs-lookup"><span data-stu-id="a9992-157">Cascading Style Sheets (CSS)</span></span>
    
- <span data-ttu-id="a9992-158">Document Object Model (DOM) 1.0</span><span class="sxs-lookup"><span data-stu-id="a9992-158">Document Object Model (DOM) 1.0</span></span>
    
- <span data-ttu-id="a9992-159">XML Digital Signatures (XML DSig)</span><span class="sxs-lookup"><span data-stu-id="a9992-159">XML Digital Signatures (XML DSig)</span></span>
    
- <span data-ttu-id="a9992-160">Simple Object Access Protocol (SOAP) 1.1</span><span class="sxs-lookup"><span data-stu-id="a9992-160">Simple Object Access Protocol (SOAP) 1.1</span></span>
    
- <span data-ttu-id="a9992-161">Web Services Description Language (WSDL) 1.1</span><span class="sxs-lookup"><span data-stu-id="a9992-161">Web Services Description Language (WSDL) 1.1</span></span>
    
- <span data-ttu-id="a9992-162">Universal Description, Discovery, and Integration (UDDI) 1.0</span><span class="sxs-lookup"><span data-stu-id="a9992-162">Universal Description, Discovery, and Integration (UDDI) 1.0</span></span>
    
<span data-ttu-id="a9992-p117">Par exemple, InfoPath exploite et génère des fichiers XML, XSLT et XSD standard réutilisables dans différents processus d'entreprise. InfoPath utilise MSXML, SOAP Toolkit et l'espace de noms .NET System.XML pour prendre en charge ces standards, et prend intégralement en charge les services Web XML.</span><span class="sxs-lookup"><span data-stu-id="a9992-p117">For example, InfoPath uses and generates standard XML, XSLT, and XSD files that can be reused in various business processes. InfoPath uses MSXML, the SOAP Toolkit, and the .NET System.XML namespace to support these standards, and provides full integrated support for XML Web services.</span></span>
  
<span data-ttu-id="a9992-p118">La figure 1 illustre le menu déroulant contextuel d'un groupe de champs **customer**, qui permet à l'utilisateur d'ajouter un autre groupe de champs **customer**, de supprimer ce groupe de champs **customer**, d'insérer une ligne **item** dans la table des achats de ce groupe de champs, ou encore d'insérer un groupe de champs **actions** facultatif au sein de ce groupe de champs. Le lien **Cliquez ici** offre un autre moyen d'insérer le groupe de champs **actions**. Un menu déroulant raccourci s'affiche sur chaque ligne d'achat.</span><span class="sxs-lookup"><span data-stu-id="a9992-p118">Figure 1 shows the context-sensitive drop-down menu for a **customer** field group, which enables the user to add another **customer** field group, remove this **customer** field group, insert an **item** row in the table of purchase items in this field group, or insert an optional **actions** field group within this field group. The **Click here** link provides another way to insert the **actions** field group. A shorter drop-down menu appears on each purchase-item row.</span></span> 
  
1. <span data-ttu-id="a9992-p119">Dans InfoPath, l'utilisateur crée un document XML à partir d'un modèle de formulaire InfoPath ou ouvre un document XML existant basé sur un modèle de formulaire. Le document XML, qui peut utiliser des espaces de noms XML, est un fichier de données XML contenant une référence au modèle de formulaire.</span><span class="sxs-lookup"><span data-stu-id="a9992-p119">In InfoPath, the user creates a new XML document based on an InfoPath form template, or opens an existing XML document that is based on a form template. The XML document is an XML data file that contains a reference to the form template and can use XML namespaces.</span></span> 
    
    <span data-ttu-id="a9992-p120">Un modèle de formulaire est un ensemble de fichiers permettant d'éditer des documents XML de façon structurée, conformément à un schéma XML personnalisé. Les fichiers composant ce modèle de formulaire peuvent être regroupés sous forme de fichiers individuels dans un dossier standard ou sous forme de fichiers stockés dans un dossier CAB. Dans les deux cas, il s'agit de fichiers XML standard et de fichiers de prise en charge facultatifs (assemblys de code managé, par exemple).</span><span class="sxs-lookup"><span data-stu-id="a9992-p120">A form template is the set of files that provide structured editing of XML documents that comply with a particular custom-defined XML schema. The files that make up the form template may be packaged as individual files inside a ordinary folder or as files residing in a cabinet folder. In either case, the files are standard XML files and optional supporting files such as managed code assemblies.</span></span>
    
2. <span data-ttu-id="a9992-173">Si le document XML est signé numériquement par le biais d'une signature XML, InfoPath vérifie que le fichier XML est cohérent avant de l'ouvrir.</span><span class="sxs-lookup"><span data-stu-id="a9992-173">If the XML document is digitally signed using XML Signature, InfoPath confirms that the XML file is consistent before it opens it.</span></span>
    
3. <span data-ttu-id="a9992-174">InfoPath crée une arborescence de données DOM du document XML en mémoire.</span><span class="sxs-lookup"><span data-stu-id="a9992-174">InfoPath creates a DOM data tree of the XML document in-memory.</span></span>
    
4. <span data-ttu-id="a9992-p121">Les transformations XSLT sont appliquées à l'arborescence DOM et génèrent des vues présentant de façon adaptée le document à l'utilisateur. Les éléments figurant au début du document XML peuvent très bien être affichés en bas de la vue et dans un autre ordre dans une autre vue. Les vues se composent de conteneurs d'interface utilisateur, par exemple de sections contenant du texte et des contrôles (zones de texte, zones de texte enrichies, sélecteurs de dates, listes déroulantes, etc.). Les conteneurs peuvent en outre contenir d'autres conteneurs.</span><span class="sxs-lookup"><span data-stu-id="a9992-p121">XSLT transformations are applied to the DOM tree, producing views that show an appropriate presentation of the document to the user. Elements at the beginning of the XML document could be displayed at the bottom of the view and also in a different arrangement in another view. The views consist of UI containers such as sections that contain text and controls, such as text boxes, rich text boxes, date pickers, and drop-down lists. Containers can also contain other containers.</span></span>
    
5. <span data-ttu-id="a9992-179">La transformation XSLT produit une sortie XHTML et une feuille de style CSS est ensuite utilisée pour contrôler la présentation du contenu XHTML.</span><span class="sxs-lookup"><span data-stu-id="a9992-179">The XSLT transformation produces XHTML as output, and then a CSS is used to control the presentation of the XHTML.</span></span>
    
6. <span data-ttu-id="a9992-p122">Si le schéma XML autorise l'ajout de nœuds à un nœud de l'arborescence de données, le champ ou le groupe de champs mappé au nœud dispose d'un menu déroulant qui permet à l'utilisateur d'ajouter ou de supprimer des groupes de champs. L'utilisateur édite le document en y ajoutant un groupe de champs extensible ou facultatif, en y saisissant une valeur, en y sélectionnant une option ou encore en y saisissant du texte enrichi. Si un nœud de schéma XML est associé au schéma XHTML, InfoPath présente une interface utilisateur permettant de créer du texte enrichi. Lorsque l'utilisateur saisit du texte enrichi, le contenu XHTML est créé en tant que sous-arborescence du DOM.</span><span class="sxs-lookup"><span data-stu-id="a9992-p122">If the XML schema allows adding nodes to a node of the data tree, the field or field group that is mapped to the node has a drop-down menu that enables the user to add or remove field groups. The user edits the document by adding a repeating or optional field group, entering a value, selecting an option, or entering rich text. If an XML schema node is associated with the schema for XHTML, InfoPath presents a UI for creating rich text. When the user enters rich text, XHTML content is created as a subtree in the DOM.</span></span>
    
7. <span data-ttu-id="a9992-p123">La validité de l'arborescence DOM est assurée en permanence. Lorsque l'utilisateur édite le document XML, les modifications sont validées par rapport au schéma XML associé. Les tentatives de modification de la structure du DOM et des valeurs du nœud terminal sont validées par rapport au schéma XML, afin de garantir la validité des types et valeurs de données. Si les tentatives de modification ne sont pas valides, une boîte de dialogue de validation s'affiche et les modifications ne sont pas appliquées à l'arborescence DOM. Si les modifications sont valides, l'arborescence DOM est mise à jour.</span><span class="sxs-lookup"><span data-stu-id="a9992-p123">The DOM tree is always kept valid. As the user edits the XML document, the edits are validated against the associated XML schema. The attempted changes to the DOM structure and leaf node values are validated against the XML schema to ensure that their data types and values are valid. If the attempted changes are invalid, a validation dialog box opens, and the changes are not applied to the DOM tree. If the changes are valid, the DOM tree is updated.</span></span>
    
8. <span data-ttu-id="a9992-189">La partie modifiée de la vue est actualisée et seules les parties requises de la feuille de style XSLT sont appliquées à l'arborescence DOM.</span><span class="sxs-lookup"><span data-stu-id="a9992-189">The changed part of the view is refreshed, by applying only the required parts of the XSLT style sheet to the DOM tree.</span></span>
    
9. <span data-ttu-id="a9992-p124">L'utilisateur peut enregistrer le document XML ou le transmettre par le biais du protocole HTTP standard ou du protocole SOAP. En revanche, il n'est pas autorisé à transmettre le document s'il n'est pas conforme au schéma XML.</span><span class="sxs-lookup"><span data-stu-id="a9992-p124">The user can save the XML document or submit the XML document by using plain HTTP or SOAP. The user is not allowed to submit the document unless it is valid according to the XML schema.</span></span>
    
## <a name="how-xml-standards-are-used-when-designing-a-form"></a><span data-ttu-id="a9992-192">Utilisation des standards XML lors de la conception d’un formulaire</span><span class="sxs-lookup"><span data-stu-id="a9992-192">How XML Standards Are Used When Designing a Form</span></span>

<span data-ttu-id="a9992-p125">Vous pouvez concevoir un formulaire à partir d'un schéma XML existant, en vous connectant à un service Web XML ou à une base de données et en obtenant son schéma XML, ou encore en générant automatiquement un schéma à partir d'un nouveau formulaire ou d'un fichier de données XML. Ces différents scénarios sont décrits dans les procédures ci-dessous. La figure 3 illustre l'interface utilisateur de base permettant de concevoir un modèle de formulaire.</span><span class="sxs-lookup"><span data-stu-id="a9992-p125">You can design a form by starting with an existing XML schema, by connecting to an XML Web service or database and obtaining its XML schema, or by automatically generating a schema from a new form or from an XML data file. These scenarios are described in the following procedures. Figure 3 shows the basic user interface for designing a form template.</span></span>
  
1. <span data-ttu-id="a9992-p126">Créez un formulaire dans InfoPath Designer en sélectionnant le modèle de formulaire **Fichier ou schéma XML**, puis sélectionnez un fichier de schéma XML existant comme source de données. Celui-ci est chargé dans le volet Office et affiché en tant que contrôle d'arborescence.</span><span class="sxs-lookup"><span data-stu-id="a9992-p126">Create a new form in the InfoPath Designer by selecting the **XML or Schema** form template, and then select an existing XML schema file as the data source. The XML schema is loaded into the task pane and shown as a tree control.</span></span> 
    
2. <span data-ttu-id="a9992-p127">Utilisez les outils de conception pour définir la présentation des contrôles de l'interface utilisateur, tels que les lignes et le style d'arrière-plan, dans une ou plusieurs vues. Cette opération génère une partie des éléments XSLT. Les vues XSLT et le schéma XML sont automatiquement associés au modèle de formulaire.</span><span class="sxs-lookup"><span data-stu-id="a9992-p127">Use the design layout tools to lay out the UI controls, such as rows and the background design, in one or more views. This generates some of the XSLT elements. The XSLT views and the XML schema are automatically associated with the form template.</span></span>
    
3. <span data-ttu-id="a9992-p128">Mappez les éléments du schéma XML aux contrôles d'interface utilisateur figurant dans les vues à l'aide d'opérations de glisser-déplacer. InfoPath vous aide à choisir les contrôles adaptés aux éléments du schéma XML, en fonction du type d'élément de schéma. Par exemple, si le type de données XML est date, InfoPath suggère un contrôle de sélecteur de dates. En fonction des choix disponibles dans le schéma XML, InfoPath insère des groupes de champs facultatifs ou extensibles. Le fait de mapper les éléments du schéma XML aux contrôles d'interface utilisateur génère la structure XSLT.</span><span class="sxs-lookup"><span data-stu-id="a9992-p128">Map the XML schema elements to the UI controls in the views by using drag-and-drop. InfoPath helps you choose appropriate controls for the XML schema elements, based on the kind of the schema elements. For example, if the XML data type is date, InfoPath suggests a date picker control. Based on choices in the XML schema, InfoPath can insert groups of optional or repeating fields. Mapping the XML schema elements to the UI controls generates the XSLT structure.</span></span>
    
4. <span data-ttu-id="a9992-p129">Enregistrez le modèle de formulaire. Vous pouvez enregistrer les fichiers qui composent ce modèle sous forme de fichiers individuels dans un dossier standard ou sous forme de fichiers stockés dans un dossier CAB. Dans les deux cas, il s'agit de fichiers XML standard. L'utilisateur peut dès à présent utiliser le modèle de formulaire.</span><span class="sxs-lookup"><span data-stu-id="a9992-p129">Save the form template. You can save the files that make up the form template as individual files in a regular folder or as files inside a cabinet folder. In either case, the files are standard XML files. The form template is now ready for the user to use.</span></span>
    
<span data-ttu-id="a9992-p130">Un modèle de formulaire contient toutes les informations sémantiques permettant l'édition structurée d'un formulaire ouvert dans InfoPath. Il inclut un fichier manifeste, les fichiers XSLT définissant les vues, les informations nécessaires pour valider les données, ainsi qu'un ID de ressource facultatif pour un service Web XML.</span><span class="sxs-lookup"><span data-stu-id="a9992-p130">A form template contains all the semantic information that is needed to provide structured editing when a form is opened in InfoPath. A form template includes a manifest file, the XSLT files that define the views, the information that is needed to validate data, and an optional resource identifier for an XML Web service.</span></span>
  
<span data-ttu-id="a9992-p131">Le manifeste, également appelé fichier de définition de formulaire, est le noyau commun et le point d'entrée de tous les fichiers composant le modèle de formulaire. Le manifeste contient des références aux autres fichiers du modèle de formulaire, ainsi que les informations nécessaires pour valider les données et permettre l'édition structurée. Les informations de validation du schéma XML sont adaptées à l'interface utilisateur obtenue et ajoutées au fichier manifeste. Par exemple, si le schéma autorise l'insertion de plusieurs éléments facultatifs dans une sous-arborescence spécifique, vous pouvez concevoir l'interface utilisateur de telle sorte que plusieurs éléments facultatifs soient ajoutés lorsque l'utilisateur réalise une opération dans l'interface. Cette personnalisation est indispensable pour faciliter le travail de l'utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="a9992-p131">The manifest, or form definition file , is the common hub and entry point for all of the files that are required by the form template. The manifest contains references to the other files in the form template, and contains the information that is needed to validate data and provide structured editing. The XML schema validation information is customized for the resulting user interface and added to the manifest file. For example, if the schema allows inserting multiple optional elements in a specific subtree, you can design the UI so that multiple optional elements are added when the user performs a single UI operation. This customization is important for providing a great user experience for the ordinary user.</span></span> 
  
<span data-ttu-id="a9992-p132">Vous pouvez également concevoir un formulaire en utilisant un service Web XML existant pour créer le schéma XML. Pour ce faire, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="a9992-p132">You can also design a form by using an existing XML Web service to provide the XML schema. To do this:</span></span>
  
1. <span data-ttu-id="a9992-219">Utilisez un service UDDI pour rechercher les services Web concernés.</span><span class="sxs-lookup"><span data-stu-id="a9992-219">Use UDDI to locate relevant Web services.</span></span>
    
2. <span data-ttu-id="a9992-p133">Sélectionnez le service Web à utiliser. InfoPath lit le fichier WSDL associé au service Web et identifie le schéma XML à utiliser.</span><span class="sxs-lookup"><span data-stu-id="a9992-p133">Select the Web service to use. InfoPath reads the WSDL file associated with the Web service and identifies the XML schema to be used.</span></span>
    
3. <span data-ttu-id="a9992-222">Ouvrez le schéma XML pour le charger.</span><span class="sxs-lookup"><span data-stu-id="a9992-222">Open the XML schema to load it.</span></span>
    
4. <span data-ttu-id="a9992-223">Configurez la disposition des contrôles d'interface utilisateur et associez-les aux éléments et attributs du schéma XML.</span><span class="sxs-lookup"><span data-stu-id="a9992-223">Lay out the UI controls and associate them with XML schema elements and attributes.</span></span>
    
5. <span data-ttu-id="a9992-224">Définissez le mode de transmission du document XML au service Web utilisant SOAP.</span><span class="sxs-lookup"><span data-stu-id="a9992-224">Define how to submit the XML document to the Web service that uses SOAP.</span></span>
    
<span data-ttu-id="a9992-225">Si vous souhaitez concevoir intégralement un nouveau formulaire et générer automatiquement le schéma XML, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="a9992-225">If you want to design a form from scratch and automatically generate the XML schema:</span></span>
  
1. <span data-ttu-id="a9992-226">Dans l'onglet **Fichier**, sélectionnez le modèle de formulaire **Formulaire vierge** ou **Formulaire vierge (InfoPath Filler)**, puis cliquez sur **Créer un formulaire**.</span><span class="sxs-lookup"><span data-stu-id="a9992-226">On the **File** tab, select either the **Blank Form** or **Blank Form (InfoPath Filler)** form template, and then click **Design Form**.</span></span>
    
2. <span data-ttu-id="a9992-p134">Dans l'onglet **Accueil**, cliquez sur la flèche en bas à droite du groupe **Commandes** pour afficher le volet Office **Commandes** et vérifiez que la case à cocher **Créer automatiquement la source de données** est activée. Cette case à cocher est activée par défaut.</span><span class="sxs-lookup"><span data-stu-id="a9992-p134">On the **Home** tab, click the arrow in the lower-right corner of the **Controls** group to display the **Controls** task pane, and then make sure that the **Automatically create the data source** check box is selected. (By default, this check box is selected.)</span></span> 
    
3. <span data-ttu-id="a9992-p135">Configurez la disposition des contrôles d'interface utilisateur. À mesure que vous configurez leur disposition, InfoPath crée automatiquement le schéma XML et mappe ses éléments et attributs aux contrôles d'interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a9992-p135">Lay out the UI controls. As you lay them out, InfoPath automatically creates the XML schema and maps its elements and attributes to the UI controls.</span></span>
    
<span data-ttu-id="a9992-231">Pour concevoir un formulaire à partir d'un fichier de données XML bien formé, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="a9992-231">To design a form by starting with any well-formed XML data file:</span></span>
  
1. <span data-ttu-id="a9992-232">Dans l'onglet **Fichier**, sélectionnez le modèle de formulaire **Fichier ou schéma XML**, puis cliquez sur **Créer un formulaire**.</span><span class="sxs-lookup"><span data-stu-id="a9992-232">On the **File** tab, select the **XML or Schema** form template, and then click **Design Form**.</span></span>
    
2. <span data-ttu-id="a9992-p136">Dans l' **Assistant Source de données**, puis sélectionnez le fichier XML comme source de données. Un schéma XML basé sur le fichier de données XML est créé automatiquement.</span><span class="sxs-lookup"><span data-stu-id="a9992-p136">In the **Data Source Wizard**, select the XML file that you want to use as the data source. An XML schema is automatically created, based on the XML data file.</span></span>
    
3. <span data-ttu-id="a9992-235">Configurez la disposition des contrôles d'interface utilisateur comme indiqué ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="a9992-235">Lay out the UI controls as described earlier in this section.</span></span>
    
## <a name="designed-as-an-ideal-client-for-web-services"></a><span data-ttu-id="a9992-236">Le client idéal des services Web</span><span class="sxs-lookup"><span data-stu-id="a9992-236">Designed as an Ideal Client for Web Services</span></span>

<span data-ttu-id="a9992-p137">Les services Web sont désormais pris en charge par de nombreux acteurs du monde informatique. Bon nombre de systèmes principaux ou intermédiaires peuvent être configurés pour communiquer par le biais de standards de services Web tels que SOAP, UDDI et WSDL. Ainsi, de nombreux systèmes de bases de données ou de flux de travail, et de nombreuses solutions ERP (Enterprise Resource Planning) et CRM (Customer Relationship Management), mais aussi d'autres types de systèmes, sont désormais compatibles avec les services Web. InfoPath est devenue l'interface utilisateur idéale pour l'affichage et l'édition des données XML transmises par le biais de services Web. La figure 4 illustre le concept de prise en charge intégrée des services Web XML.</span><span class="sxs-lookup"><span data-stu-id="a9992-p137">Broad industry-wide support for Web services is becoming available. Many back-end and middle-tier systems can be configured to communicate by using Web services standards such as SOAP, UDDI, and WSDL. These Web services-enabled systems include databases, workflow systems, enterprise resource planning (ERP), customer relationship management (CRM), and other systems. Now, InfoPath provides an ideal UI to view and edit the XML data that is being sent through Web services. Figure 4 shows the integrated support for XML Web services.</span></span>
  
<span data-ttu-id="a9992-p138">InfoPath s'intègre parfaitement à la souplesse du modèle des services Web, dans lequel les données transitent entre des ordinateurs sous la forme de documents XML intégraux. Ce modèle de communication plutôt sommaire est bien adapté à la nature asynchrone du Web. En tant qu'outil de création de documents XML de haut niveau, InfoPath prend en charge le codage SOAP document/littéral en lieu et place du codage SOAP RPC (Remote Procedure Call). InfoPath est ainsi un client idéal pour les services Web, car il peut lire en mode natif le schéma XML spécifié dans un message SOAP, puis créer une interface utilisateur à partir de ce schéma. Les utilisateurs finaux peuvent par conséquent afficher et éditer les documents XML générés ou reçus par le service Web correspondant. InfoPath prend également en charge les DataSets ADO.NET avec suivi des modifications.</span><span class="sxs-lookup"><span data-stu-id="a9992-p138">InfoPath fits well with the loosely coupled model of Web services, in which data is sent between computers as complete XML documents. This coarse-grained communication model fits well with the asynchronous nature of the Web. As a high-level authoring tool for XML documents, InfoPath supports the document/literal SOAP encoding instead of Remote Procedure Call (RPC) SOAP encoding. InfoPath is an ideal client for Web services, because it can natively read the XML schema specified in a SOAP message and then create a UI based on the schema, which enables users to easily view and edit XML documents that are generated or received by the corresponding Web service. InfoPath also provides support for ADO.NET DataSets that includes change-tracking.</span></span>
  
## <a name="terminology"></a><span data-ttu-id="a9992-247">Terminologie</span><span class="sxs-lookup"><span data-stu-id="a9992-247">Terminology</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="a9992-248">**Groupe de champs :**</span><span class="sxs-lookup"><span data-stu-id="a9992-248">**field group:**</span></span> <br/> |<span data-ttu-id="a9992-p139">Section, section extensible, section facultative ou tableau extensible. Les sections et les tableaux extensibles sont des contrôles de formulaire contenant d’autres contrôles et qui s’étendent en fonction des besoins. Les utilisateurs peuvent insérer plusieurs sections ou lignes lorsqu’ils remplissent le formulaire.</span><span class="sxs-lookup"><span data-stu-id="a9992-p139">A section, repeating section, optional section, or repeating table. Sections and repeating tables are controls on a form that contain other controls and that repeat as needed. Users can insert multiple sections or rows when filling out the form.</span></span>  <br/> |
|<span data-ttu-id="a9992-252">**Arborescence DOM :**</span><span class="sxs-lookup"><span data-stu-id="a9992-252">**DOM tree:**</span></span> <br/> |<span data-ttu-id="a9992-253">Structure de la source de données du formulaire.</span><span class="sxs-lookup"><span data-stu-id="a9992-253">The structure of the data source of the form.</span></span> <span data-ttu-id="a9992-254">En particulier, la collection de champs et de groupes qui définissent et stockent les données d’un formulaire InfoPath.</span><span class="sxs-lookup"><span data-stu-id="a9992-254">In particular, the collection of fields and groups that define and store the data for an InfoPath form.</span></span>  <br/> |
   
## <a name="conclusion"></a><span data-ttu-id="a9992-255">Conclusion</span><span class="sxs-lookup"><span data-stu-id="a9992-255">Conclusion</span></span>

<span data-ttu-id="a9992-p141">InfoPath utilise des standards XML ouverts pour offrir aux utilisateurs des fonctions d'édition XML aussi flexibles que structurées en vue de collecter des données. Pour que cette interface utilisateur soit simple d'utilisation et permette d'afficher et d'éditer les données hiérarchiques XML, les groupes de champs imbriqués contenant des contrôles d'interface utilisateur sont mappés à l'arborescence DOM. Les transformations XSLT permettent d'organiser le contenu des vues de l'interface utilisateur différemment de la structure des données XML.</span><span class="sxs-lookup"><span data-stu-id="a9992-p141">InfoPath uses open XML standards to provide users with flexible yet structured XML editing for data gathering. To provide an easy user interface for visualizing and editing hierarchical XML data, nested field groups that contains UI controls are mapped to the DOM tree. XSLT transformations enable the content of the UI views to be organized differently than the structure of the XML data.</span></span>
  
<span data-ttu-id="a9992-p142">InfoPath offre plus de flexibilité que les formulaires statiques, tout en proposant des fonctions d'édition et de validation plus structurées que celles des applications de traitement de texte. Au final, l'utilisateur dispose d'un outil hybride qui associe les meilleures fonctions conventionnelles d'édition de documents aux fonctions rigoureuses de collecte de données des outils de gestion de formulaires. N'importe quel utilisateur peut ainsi créer des documents XML valides appartenant à un schéma XML personnalisé. La prise en charge intégrée des services Web permet de définir facilement des vues afin d'éditer des documents XML conformes à un schéma de services Web.</span><span class="sxs-lookup"><span data-stu-id="a9992-p142">InfoPath provides more flexibility than static forms, with more structured editing and validation than word processor documents. The result is a hybrid tool that combines the best of a traditional document editing experience with the rigorous data-capture capabilities of a forms package, which enables ordinary users to create valid XML documents that belong to a custom-defined XML schema. Integrated support for Web services enables easily defining views for editing XML documents that comply with a Web services schema.</span></span>
  

