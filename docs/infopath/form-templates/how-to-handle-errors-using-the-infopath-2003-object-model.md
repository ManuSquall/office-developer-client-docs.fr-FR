---
title: Gérer les erreurs à l’aide du modèle objet InfoPath 2003
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, handling errors,InfoPath 2003-compatible form templates, error handling,form templates [InfoPath 2007], error handling,error handling [InfoPath 2007], InfoPath 2003-compatible form templates
localization_priority: Normal
ms.assetid: eeb05205-d6f4-4931-b9a9-55a663bb1a25
description: Lors de la création d'applications personnalisées, les développeurs doivent mettre en place une gestion des erreurs impliquant l'écriture de code de programmation qui leur permette de déceler les erreurs générées par l'application ou de créer et de générer des erreurs personnalisées. Le modèle objet compatible avec InfoPath 2003 prend en charge la gestion des erreurs à travers l'utilisation de l'objet ErrorObject en association avec la collection ErrorsCollection .
ms.openlocfilehash: 93991e33d8867f89454bec08b41ba83e98ab0a17
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439477"
---
# <a name="handle-errors-using-the-infopath-2003-object-model"></a><span data-ttu-id="17e82-105">Gérer les erreurs à l’aide du modèle objet InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="17e82-105">Handle Errors Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="17e82-p102">Lors de la création d'applications personnalisées, les développeurs doivent mettre en place une gestion des erreurs impliquant l'écriture de code de programmation qui leur permette de déceler les erreurs générées par l'application ou de créer et de générer des erreurs personnalisées. Le modèle objet compatible avec InfoPath 2003 prend en charge la gestion des erreurs à travers l'utilisation de l'objet [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) en association avec la collection [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="17e82-p102">When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors. The InfoPath 2003-compatible object model supports error handling through the use of the [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) object in association with the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
<span data-ttu-id="17e82-108">Dans InfoPath, une erreur se produit lorsque des données entrées dans un formulaire échouent à la validation du schéma XML, lorsqu'une contrainte de validation personnalisée échoue, lorsqu'une erreur est générée par la méthode [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) de l'objet [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) , ou lorsqu'une erreur est générée via la méthode [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) de la collection [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="17e82-108">In InfoPath, errors can occur when data entered into a form fails XML schema validation, when a custom validation constraint fails, when an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) method of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object, or when an error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method of the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
## <a name="overview-of-the-errorscollection-collection"></a><span data-ttu-id="17e82-109">Vue d'ensemble de la collection ErrorsCollection</span><span class="sxs-lookup"><span data-stu-id="17e82-109">Overview of the ErrorsCollection Collection</span></span>

<span data-ttu-id="17e82-110">La collection **ErrorsCollection** fournit aux développeurs les méthodes et les propriétés suivantes pour gérer les objets **ErrorObject** que contient la collection.</span><span class="sxs-lookup"><span data-stu-id="17e82-110">The **ErrorsCollection** collection provides the following methods and properties, which form developers can use to manage the **ErrorObject** objects that the collection contains.</span></span> 
  
|<span data-ttu-id="17e82-111">**Name**</span><span class="sxs-lookup"><span data-stu-id="17e82-111">**Name**</span></span>|<span data-ttu-id="17e82-112">**Description**</span><span class="sxs-lookup"><span data-stu-id="17e82-112">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="17e82-113">Méthode[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx)</span><span class="sxs-lookup"><span data-stu-id="17e82-113">[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method</span></span>  <br/> |<span data-ttu-id="17e82-114">Crée un objet **ErrorObject** et l'ajoute à la collection.</span><span class="sxs-lookup"><span data-stu-id="17e82-114">Creates an **ErrorObject** object and adds it to the collection.</span></span>  <br/> |
|<span data-ttu-id="17e82-115">Méthode [Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx)</span><span class="sxs-lookup"><span data-stu-id="17e82-115">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx) method</span></span>  <br/> |<span data-ttu-id="17e82-116">Supprime tous les objets **ErrorObject** associés au nœud XML et au nom de la condition spécifiés, sauf pour les erreurs personnalisées ajoutées à l'aide de la méthode **ReportError**.</span><span class="sxs-lookup"><span data-stu-id="17e82-116">Deletes all **ErrorObject** objects associated with the specified XML node and condition name, except for custom errors added using the **ReportError** method.</span></span>  <br/> |
|<span data-ttu-id="17e82-117">[DeleteAll,](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx) méthode</span><span class="sxs-lookup"><span data-stu-id="17e82-117">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx) method</span></span>  <br/> |<span data-ttu-id="17e82-118">Supprime tous les objets **ErrorObject** contenus dans la collection.</span><span class="sxs-lookup"><span data-stu-id="17e82-118">Deletes all **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="17e82-119">Propriété [Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx)</span><span class="sxs-lookup"><span data-stu-id="17e82-119">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="17e82-120">Récupère le nombre d'objets **ErrorObject** contenus dans la collection.</span><span class="sxs-lookup"><span data-stu-id="17e82-120">Gets a count of the number of **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="17e82-121">Propriété [Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="17e82-121">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="17e82-122">Récupère une référence à un objet **ErrorObject** en fonction du numéro d'index spécifié.</span><span class="sxs-lookup"><span data-stu-id="17e82-122">Gets a reference to an **ErrorObject** object based on the specified index number.</span></span>  <br/> |
   
## <a name="overview-of-the-errorobject-object"></a><span data-ttu-id="17e82-123">Vue d'ensemble de l'objet ErrorObject</span><span class="sxs-lookup"><span data-stu-id="17e82-123">Overview of the ErrorObject Object</span></span>

<span data-ttu-id="17e82-124">L'objet **ErrorObject** fournit les propriétés suivantes, que les développeurs de formulaires peuvent utiliser pour accéder aux informations relatives à l'erreur qui vient de se produire.</span><span class="sxs-lookup"><span data-stu-id="17e82-124">The **ErrorObject** object provides the following properties, which form developers can use to access information about the error that was raised.</span></span> 
  
|<span data-ttu-id="17e82-125">**Name**</span><span class="sxs-lookup"><span data-stu-id="17e82-125">**Name**</span></span>|<span data-ttu-id="17e82-126">**Description**</span><span class="sxs-lookup"><span data-stu-id="17e82-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="17e82-127">[ConditionName,](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) propriété</span><span class="sxs-lookup"><span data-stu-id="17e82-127">[ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) property</span></span>  <br/> |<span data-ttu-id="17e82-128">Récupère le nom de l'erreur ou renvoie **null**, en fonction du type de l'objet **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="17e82-128">Gets the name of the error condition, or returns **null**, depending on the type of **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="17e82-129">[Propriété DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx)</span><span class="sxs-lookup"><span data-stu-id="17e82-129">[DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="17e82-130">Récupère ou définit le message d'erreur détaillé de l'objet **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="17e82-130">Gets or sets the detailed error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="17e82-131">[ErrorCode,](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) propriété</span><span class="sxs-lookup"><span data-stu-id="17e82-131">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) property</span></span>  <br/> |<span data-ttu-id="17e82-132">Récupère ou définit le code d'erreur de l'objet **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="17e82-132">Gets or sets the error code of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="17e82-133">[Node,](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) propriété</span><span class="sxs-lookup"><span data-stu-id="17e82-133">[Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) property</span></span>  <br/> |<span data-ttu-id="17e82-134">Récupère une référence au nœud XML associé à l'objet **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="17e82-134">Gets a reference to the XML node associated with the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="17e82-135">[Propriété ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx)</span><span class="sxs-lookup"><span data-stu-id="17e82-135">[ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="17e82-136">Récupère ou définit le message d'erreur court de l'objet **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="17e82-136">Gets or sets the short error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="17e82-137">[ErrorType,](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) propriété</span><span class="sxs-lookup"><span data-stu-id="17e82-137">[ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) property</span></span>  <br/> |<span data-ttu-id="17e82-138">Récupère le type de l'objet **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="17e82-138">Gets the type of the **ErrorObject** object.</span></span>  <br/> |
   
## <a name="using-the-errorscollection-and-errorobject"></a><span data-ttu-id="17e82-139">Utilisation de ErrorsCollection et ErrorObject</span><span class="sxs-lookup"><span data-stu-id="17e82-139">Using the ErrorsCollection and ErrorObject</span></span>

<span data-ttu-id="17e82-p103">La collection **ErrorsCollection** est accessible via la propriété [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) de l'objet [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) . La collection **ErrorsCollection** est associée au document XML sous-jacent du formulaire de sorte que lorsqu'une erreur se produit, elle se produit dans le document XML. L'exemple qui suit démontre comment une boucle Visual C# **foreach** peut être utilisée pour vérifier la présence d'erreur dans le document XML sous-jacent d'un formulaire. S'il existe des erreurs, la fonction crée une boucle autour d'elles et, à l'aide de la propriété **ShortErrorMessage** de l'objet **ErrorObject**, affiche un message pour l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="17e82-p103">The **ErrorsCollection** collection is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) property of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object. The **ErrorsCollection** collection is associated with a form's underlying XML document so that when an error occurs, it occurs within the XML document. The following example demonstrates how a Visual C# **foreach** loop can be used to check the errors that may exist in a form's underlying XML document. If there are errors, the function loops through each of them, and, using the **ShortErrorMessage** property of the **ErrorObject** object, displays a message box to the user.</span></span> 
  
```cs
public void CheckErrors(IXMLDOMNode xmlNode)
{
   foreach(ErrorObject err in thisXDocument.Errors)
   {
      if(xmlNode==err.Node)
         thisXDocument.UI.Alert("The following error has occured: "
             + err.ShortErrorMessage + ".");
   }
}
```

<span data-ttu-id="17e82-p104">La fonction précédente peut être appelée à partir d'un des gestionnaires d'événements de validation des données du formulaire. Par exemple, lorsqu'il est utilisé dans le gestionnaire d'événements [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) d'un champ du formulaire, l'appel à la fonction transmet l'argument du nœud XML à l'aide de la propriété [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) de l'objet [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) comme suit :</span><span class="sxs-lookup"><span data-stu-id="17e82-p104">The preceding function could be called from one of the form's data validation event handlers. For example, when used in the [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) event handler for a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) property of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object as follows.</span></span> 
  
```cs
CheckErrors(e.Site);
```

<span data-ttu-id="17e82-p105">En plus de gérer les erreurs générées par InfoPath, les développeurs de formulaires peuvent générer des erreurs personnalisées grâce à la méthode **ReportError** de l'objet **DataDOMEventObject** ou à la méthode **Add** de la collection **ErrorsCollection**. Pour plus d'informations sur l'utilisation des méthodes **ReportError** ou **Add**, cliquez sur celles-ci au début de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="17e82-p105">In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the **ReportError** method of the **DataDOMEventObject** object, or by using the **Add** method of the **ErrorsCollection** collection. For information about using the **ReportError** or **Add** methods, click the methods at the beginning of this topic.</span></span> 
  
## <a name="handling-managed-code-exceptions"></a><span data-ttu-id="17e82-148">Gestion des exceptions de code managé</span><span class="sxs-lookup"><span data-stu-id="17e82-148">Handling Managed-Code Exceptions</span></span>

<span data-ttu-id="17e82-149">Vous pouvez utiliser la gestion d'exceptions try-catch pour gérer les exceptions qui apparaissent dans le modèle de formulaire avec code managé tel qu'illustré par l'exemple de code ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="17e82-149">You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.</span></span>
  
```cs
DataAdapters dataAdapters;
dataAdapters = thisXDocument.DataAdapters; 
XMLFileAdapterObject queryXMLFile = 
   (XMLFileAdapterObject)dataAdapters["form1"];
// Perform the query.
try
{
   queryXMLFile.Query();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to query.\n\n" + ex.Message);
}
// Perform the submit.
try
{
   queryXMLFile.Submit();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to submit.\n\n" + ex.Message);
}
```

<span data-ttu-id="17e82-150">Si vous n'utilisez pas la gestion d'exceptions try-catch dans le code du formulaire, InfoPath affiche des informations sur les exceptions non gérées dans la boîte de dialogue d'erreurs d'InfoPath lors du débogage et de l'aperçu.</span><span class="sxs-lookup"><span data-stu-id="17e82-150">If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing.</span></span> 
  

