---
title: Intégration d'un formulaire InfoPath à une base de données Microsoft Access
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5ec9a9c0-b348-4a31-b377-e95db2f92455
description: Microsoft InfoPath permet l'utilisation d'une base de données Microsoft Access 2010 comme source de données principale pour un formulaire, ou comme source de données secondaire pour un formulaire ou un contrôle. Cet article explique comment utiliser une base de données Access 2010 comme source de données.
ms.openlocfilehash: dbc39e0d0908214904d77b8955f3d231f0bfb20b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33423110"
---
# <a name="integrate-an-infopath-form-with-a-microsoft-access-database"></a><span data-ttu-id="a0d1a-104">Intégration d'un formulaire InfoPath à une base de données Microsoft Access</span><span class="sxs-lookup"><span data-stu-id="a0d1a-104">Integrate an InfoPath Form with a Microsoft Access Database</span></span>

<span data-ttu-id="a0d1a-p102">Microsoft InfoPath permet l'utilisation d'une base de données Microsoft Access 2010 comme source de données principale pour un formulaire, ou comme source de données secondaire pour un formulaire ou un contrôle. Cet article explique comment utiliser une base de données Access 2010 comme source de données.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p102">Microsoft InfoPath supports using a Microsoft Access 2010 database as the primary data source for a form, or as a secondary data source for a form or control. This article explains how to use an Access 2010 database as a data source.</span></span>
  
## <a name="using-a-microsoft-access-database-as-a-data-source"></a><span data-ttu-id="a0d1a-107">Utilisation d'une base de données Microsoft Access en tant que source de données</span><span class="sxs-lookup"><span data-stu-id="a0d1a-107">Using a Microsoft Access Database as a Data Source</span></span>

### <a name="setting-up-a-microsoft-access-database-as-a-forms-primary-data-source"></a><span data-ttu-id="a0d1a-108">Configuration d'une base de données Microsoft Access en tant que source de données principale de formulaire</span><span class="sxs-lookup"><span data-stu-id="a0d1a-108">Setting Up a Microsoft Access Database as a Form's Primary Data Source</span></span>

<span data-ttu-id="a0d1a-p103">Les connexions de base de données sont établies dans InfoPath à l'aide de l' **Assistant Connexion de données**. Pour ouvrir cet assistant, sélectionnez **Base de données** dans la section **Modèles de formulaires avancés** de l'onglet **Nouveau** de Microsoft Office Backstage, puis cliquez sur **Modifier ce formulaire**.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p103">Database connections are established in InfoPath by using the **Data Connection Wizard**. This wizard is opened by selecting **Database** in the **Advanced Form Templates** section on the **New** tab of the Microsoft Office Backstage, and then clicking pressing **Design This Form**.</span></span>
  
<span data-ttu-id="a0d1a-111">Cliquer sur **Sélectionner la base de données** vous permet de choisir une source de données existante ou de vous connecter directement à un fichier de base de données spécifique.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-111">By clicking **Select Database**, you can choose an existing data source or connect directly to a specific database file.</span></span>
  
<span data-ttu-id="a0d1a-p104">Lorsque vous avez sélectionné une base de données, l'assistant vous invite à sélectionner une table dans la base de données à utiliser comme source de données pour le formulaire. À mesure que vous ajoutez des tables, les relations qui les lient s'établissent et l'assistant affiche les tables et leurs relations hiérarchiques dans la liste **Structure de la source de données**. Si vous activez la case à cocher **Afficher les colonnes de la table**, l'assistant affiche les noms des champs de chaque table dans la liste Structure de la source de données ; utilisez les cases à cocher en regard de chaque nom de champ pour spécifier son inclusion dans l'instruction SQL que l'assistant construit.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p104">After you select a database, the wizard prompts you to select a table from the database to use as the data source for the form. As you add tables, their relationships to each other are established, and the wizard displays the tables and their hierarchical relationships in the **Data source structure** list. If you select the **Show table columns** check box, the wizard displays the field names of each table in the Data source structure list; you use the check boxes next to each field name to specify whether a field is included in the SQL statement that the wizard constructs.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a0d1a-115">[!REMARQUE] Les champs de clé primaires sont toujours sélectionnés et ne peuvent pas être supprimés.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-115">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="a0d1a-p105">Lorsque les tables, les relations et les champs ont été spécifiés à l'aide de l' **Assistant Connexion de données**, vous pouvez cliquer sur **Modifier SQL** pour afficher l'instruction SQL qui sera utilisée pour établir la source de données pour le formulaire. Dans la boîte de dialogue **Modifier SQL**, vous pouvez cliquer sur **Tester l'instruction SQL** pour vérifier que InfoPath sera en mesure de créer la source de données à partir des informations fournies. Vous pouvez également utiliser la boîte de dialogue **Modifier SQL** pour modifier l'instruction SQL de sorte de créer des requêtes complexes.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p105">When the tables, relationships, and fields have been specified using the **Data Connection Wizard**, you can click **Edit SQL** to view the SQL statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a0d1a-p106">[!REMARQUE] Les instructions SQL utilisées par InfoPath sont des requêtes de mise en forme des données. Les requêtes de mise en forme des données permettent de construire des relations hiérarchiques entre deux entités logiques ou plus au sein d'une requête. Il est possible d'utiliser des instructions SQL JOIN mais cela n'est pas recommandé car cette méthode désactive l'envoi du formulaire. Pour plus d'informations sur les requêtes de mise en forme des données, consultez la documentation MSDN (Microsoft Developer Network).</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p106">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
<span data-ttu-id="a0d1a-p107">La dernière page de l' **Assistant Connexion de données** affiche un résumé sur la source de données, indiquant notamment le nom et l'emplacement du fichier de la source de données, le nom de la table parent primaire, le nombre de tables utilisées et l'état d'envoi. L'état d'envoi vous indique si l'instruction SQL générée permettra d'envoyer les données à la source.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p107">The last page of the **Data Connection Wizard** displays summary information about the data source, including the name and file location of the data source, the name of the primary parent table, the number of tables used, and the submit status. The submit status tells you whether the generated SQL statement will allow for successful submission of data to the data source.</span></span> 
  
### <a name="setting-up-a-microsoft-access-database-as-a-secondary-data-source"></a><span data-ttu-id="a0d1a-125">Configuration d'une base de données Microsoft Access en tant que source de données secondaire</span><span class="sxs-lookup"><span data-stu-id="a0d1a-125">Setting up a Microsoft Access Database as a Secondary Data Source</span></span>

<span data-ttu-id="a0d1a-p108">Les sources de données secondaires peuvent par exemple fournir les entrées d'une zone de liste ou d'une liste déroulante, mais vous pouvez aussi écrire du code afin d'insérer des données en provenance d'une source de données secondaire dans votre formulaire. Pour utiliser des sources de données secondaires avec votre formulaire, cliquez sur **Connexions de données** dans l'onglet **Données** lors de la conception d'un formulaire.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p108">Secondary data sources can be used to provide the entries for a list box or drop-down list box, or you can write code to add data from a secondary data source to your form. To work with secondary data sources in your form, click **Data Connections** on the **Data** tab when designing a form.</span></span> 
  
<span data-ttu-id="a0d1a-p109">Au démarrage de l' **Assistant Connexion de données**, vous êtes invité à spécifier la réception de données à utiliser dans vote formulaire, ou l'envoi de données dans le formulaire. Choisissez **Réception des données**, puis cliquez sur **Suivant**. Pour créer une source de données secondaire à partir d'une base de données, activez **Base de données (Microsoft SQL Server ou Microsoft Office Access uniquement)**. Dans la page suivante de l'assistant, cliquez sur **Sélectionner une base de données** pour choisir une source de données existantes ou vous connecter directement à un fichier de base de données spécifique.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p109">When you start the **Data Connection Wizard**, you are prompted to select whether to receive data to use in the form, or to submit data in the form. Choose **Receive data**, and then click **Next**. To create a secondary data source from a database, select **Database (Microsoft SQL Server or Microsoft Office Access only)**. On the next page of the wizard, click **Select Database** to choose an existing data source or connect directly to a specific database file.</span></span> 
  
<span data-ttu-id="a0d1a-p110">Lorsque vous avez sélectionné une base de données, l'assistant vous invite à sélectionner une table ou une requête dans la base de données à utiliser comme source de données pour le formulaire. Vous devez sélectionner une table ou une requête pour commencer, mais vous pouvez en sélectionner d'autres ultérieurement si vous souhaitez les inclure. Lorsque vous avez sélectionné une table ou une requête, l'assistant vous permet de sélectionner les champs à utiliser dans la liste **Structure de la source de données**. Par défaut, tous les champs de la table sont sélectionnés, mais vous pouvez supprimer ceux qui ne sont pas nécessaires à votre formulaire. Vous pouvez également déterminer la manière avec laquelle les enregistrements renvoyés de la table sont triés, et si les enregistrements multiples sont autorisés. Pour ce faire, cliquez sur **Modifier la table**, puis sélectionnez jusqu'à trois critères de tri dans la boîte de dialogue **Ordre de tri**. Lorsque vous êtes satisfait, cliquez sur **Terminer**.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p110">After you select a database, the wizard prompts you to select a table or query from the database to use as the data source for the form. You must select one table or query to begin with, but you can select additional tables later if you want to include them. After you've selected a table or query, the wizard allows you to select the fields you want to use in the **Data source structure** list. By default, all the fields of the table are selected, but you can remove fields if they aren't necessary for your form. You can also control how the records returned from the table are sorted, and whether multiple records are allowed. To do so, click **Modify Table**, and then select up to three sorting criteria in the **Sort Order** dialog box. When you're satisfied, click **Finish**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="a0d1a-139">[!REMARQUE] Les champs de clé primaires sont toujours sélectionnés et ne peuvent pas être supprimés.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-139">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="a0d1a-p111">InfoPath vous permet également de récupérer des données dans plusieurs tables ou requêtes à la fois. Lorsque vous récupérez des données provenant de tables ou requêtes multiples, vous devez pouvoir établir une relation entre toutes les tables ou les requêtes associées à la table ou à la requête d'origine que vous avez sélectionnée dans l' **Assistant Connexion de données**. Par exemple, si vous récupérez des données depuis la table Clients de la base de données Northwind, vous pouvez ajouter la table Commandes pour y récupérer des données sur toutes les commandes associées à tel client, et ajouter la table Détails commandes pour y récupérer les détails de chaque commande.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p111">InfoPath also enables you to retrieve data from multiple tables or queries at the same time. When you retrieve data from multiple tables or queries, you must be able to establish a relationship between all of the tables or queries involved with the original table or query you selected in the **Data Connection Wizard**. For example, if you were retrieving data from the Customers table of the Northwind database, you could add the Orders table to retrieve data about all the orders for that customer, and you could add the Order Details table to retrieve the details of each order.</span></span>
  
<span data-ttu-id="a0d1a-p112">Pour ajouter une table supplémentaire à la source de données, sélectionnez la table à laquelle vous voulez ajouter une table enfant dans la liste **Structure de la source de données**, puis cliquez sur **Ajouter une table**. Sélectionnez la table ou la requête que vous souhaitez ajouter, puis cliquez sur **Suivant**. InfoPath vous invite à sélectionner la ou les relations à utiliser. Si des champs des deux tables portent le même nom, InfoPath ajoute automatiquement ces champs en tant que relation, mais si tel n'est pas le cas, ou si vous préférez utiliser une relation personnalisée, vous pouvez cliquer sur **Ajouter une relation** pour spécifier quels champs correspondent aux champs de la table enfant. Vous pouvez également supprimer des relations existantes en cliquant sur **Supprimer la relation** dans la boîte de dialogue **Modifier la relation**.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p112">To add an additional table to the data source, select the table you want to add a child table to in the **Data source structure** list, and then click **Add Table**. Select the table or query you want to add, and then click **Next**. InfoPath prompts you to select the relationship or relationships you want to use. If fields in the two tables have the same name, InfoPath automatically adds those fields as a relationship, but if not, or if you want to use a custom relationship, you can click **Add Relationship** to specify which fields in the parent table correspond to fields in the child table. You can also remove existing relationships by clicking **Remove Relationship** in the **Edit Relationship** dialog box.</span></span> 
  
<span data-ttu-id="a0d1a-p113">Lorsque vous êtes satisfait des relations définies, cliquez sur **Terminer**. À l'instar de la table principale, vous pouvez spécifier quels champs sont renvoyés depuis la table enfant. Toutefois, vous ne pouvez pas utiliser le bouton **Modifier la table** pour changer l'ordre dans lequel sont renvoyés les enregistrements.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p113">When you're satisfied with the relationships, click **Finish**. As with the main table, you can specify which fields are returned from the child table. You cannot, however, use the **Modify Table** button to edit the order in which the records are returned.</span></span> 
  
<span data-ttu-id="a0d1a-p114">Lorsque les tables, les relations et les champs ont été spécifiés, vous pouvez cliquer sur **Modifier SQL** pour afficher l'instruction de requête SQL qui sera utilisée pour établir la source de données pour le formulaire. Dans la boîte de dialogue **Modifier SQL**, vous pouvez cliquer **Tester l'instruction SQL** pour vérifier que InfoPath sera en mesure de créer la source de données à partir des informations fournies. Vous pouvez également utiliser la boîte de dialogue **Modifier SQL** pour modifier l'instruction SQL de sorte de créer des requêtes complexes.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p114">When the tables, relationships, and fields have been specified, you can click **Edit SQL** to view the SQL query statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a0d1a-p115">[!REMARQUE] Les instructions SQL utilisées par InfoPath sont des requêtes de mise en forme des données. Les requêtes de mise en forme des données permettent de construire des relations hiérarchiques entre deux entités logiques ou plus au sein d'une requête. Il est possible d'utiliser des instructions SQL JOIN mais cela n'est pas recommandé, car cette méthode désactive l'envoi du formulaire. Pour plus d'informations sur les requêtes de mise en forme des données, consultez la documentation MSDN (Microsoft Developer Network).</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p115">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
## <a name="enabling-form-submission"></a><span data-ttu-id="a0d1a-158">Activation de l'envoi de formulaire</span><span class="sxs-lookup"><span data-stu-id="a0d1a-158">Enabling Form Submission</span></span>

<span data-ttu-id="a0d1a-p116">En plus de recevoir des données en provenance d'une base de données Access, InfoPath peut envoyer des données nouvelles ou en renvoyer des modifiées à la base de données. Lorsque vous utilisez la commande **Envoyer** dans l'onglet **Accueil** ou le Microsoft Office Backstage pour envoyer les modifications à la base de données, InfoPath utilise ActiveX Data Objects (ADO) pour mettre à jour les enregistrements dans la base de données. L'envoi de formulaire est activé lorsque toutes les conditions suivantes sont remplies :</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p116">In addition to receiving data from an Access database, InfoPath can submit new or changed data back to the database. When you use the **Submit** command on the **Home** tab or the Microsoft Office Backstage to submit changes to the database, InfoPath uses ActiveX Data Objects (ADO) to update the records in the database. Form submission is enabled when all of the following conditions are met:</span></span> 
  
- <span data-ttu-id="a0d1a-162">Il doit y avoir une colonne de base pour chaque colonne utilisée dans la requête du formulaire.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-162">There must be a base column for every column that is used in the form's query.</span></span>
    
- <span data-ttu-id="a0d1a-163">Une colonne de table ne peut pas apparaître plusieurs fois dans la requête.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-163">A table column may not appear multiple times in the entire query.</span></span>
    
- <span data-ttu-id="a0d1a-164">Une clé primaire, une contrainte unique ou un index unique doit être disponible pour chaque table d'une clause SELECT qui est utilisée dans la requête du formulaire.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-164">A primary key, unique constraint, or unique index must be available for every table in a SELECT clause that is used in the form's query.</span></span>
    
- <span data-ttu-id="a0d1a-165">Une table ne peut pas être incluse plusieurs fois dans la requête du formulaire.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-165">A table cannot be included multiple times in the form's query.</span></span>
    
- <span data-ttu-id="a0d1a-166">Les relations entre tables parent et enfant doivent inclure toutes les colonnes de clé primaires présentes dans la table parent.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-166">Relationships between parent and child tables must include all primary key columns from the parent table.</span></span>
    
- <span data-ttu-id="a0d1a-167">Il ne peut y avoir qu'une seule table de base pour toutes les colonnes d'une clause SELECT qui est utilisée dans la requête du formulaire.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-167">There can only be one base table for all columns in a SELECT clause that is used in the form's query.</span></span>
    
<span data-ttu-id="a0d1a-p117">Certaines circonstances empêchent InfoPath d'envoyer les modifications apportées aux formulaires à une base de données. Par exemple, si vous créez un formulaire qui trace les données depuis une requête plutôt qu'une table, ou si vous personnalisez l'instruction SQL qui est utilisée par InfoPath de sorte d'inclure une instruction JOIN, InfoPath sera incapable d'envoyer les modifications. Autre circonstance susceptible d'empêcher InfoPath d'envoyer les modifications : vous ajoutez dans le formulaire des tables ayant des relations plusieurs-à-un avec leur table parent. Dans les situations où InfoPath est incapable d'envoyer les modifications à la base de données, le champ **État de l'envoi**, à la dernière page de l' **Assistant Connexion de données** affichera la raison de cette empêchement.</span><span class="sxs-lookup"><span data-stu-id="a0d1a-p117">There are some circumstances under which InfoPath cannot submit form changes to a database. For example, if you create a form that draws data from a query instead of a table, or if you customize the SQL statement that is used by InfoPath to include a JOIN statement, InfoPath will be unable to submit changes. Another circumstance that would prevent InfoPath from submitting changes is if you were to add tables to the form that have a many-to-one relationship with their parent table. In situations where InfoPath will be unable to submit changes to the database, the **Submit status** field on the last page of the **Data Connection Wizard** will display the reason for the limitation.</span></span> 
  

