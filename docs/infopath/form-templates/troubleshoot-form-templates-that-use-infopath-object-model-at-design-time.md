---
title: Résoudre les problèmes des modèles de formulaires qui utilisent le modèle objet InfoPath au moment du design
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, troubleshooting at design time,troubleshooting form templates [InfoPath 2007], design time
localization_priority: Normal
ms.assetid: 4179b235-e21d-4c37-ae2b-ad01388296ec
description: Les sections suivantes décrivent les scénarios de dépannage usuels que vous pouvez rencontrer lors de la conception et du débogage des modèles de formulaires avec code managé qui utilisent le modèle objet compatible InfoPath 2003 fourni par l'espace de noms Microsoft.Office.Interop.InfoPath.SemiTrust.
ms.openlocfilehash: af71c8058744561a4c8ee0870fb37054e9979751
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19782462"
---
# <a name="troubleshoot-form-templates-that-use-the-infopath-object-model-at-design-time"></a><span data-ttu-id="440ae-104">Résoudre les problèmes des modèles de formulaires qui utilisent le modèle objet InfoPath au moment du design</span><span class="sxs-lookup"><span data-stu-id="440ae-104">Troubleshoot form templates that use the InfoPath object model at design time</span></span>

<span data-ttu-id="440ae-105">Les sections suivantes décrivent les scénarios de dépannage usuels que vous pouvez rencontrer lors de la conception et du débogage des modèles de formulaires avec code managé qui utilisent le modèle objet compatible InfoPath 2003 fourni par l'espace de noms **Microsoft.Office.Interop.InfoPath.SemiTrust**.</span><span class="sxs-lookup"><span data-stu-id="440ae-105">The following sections describe common troubleshooting scenarios you may encounter while designing and debugging managed code form templates that use the InfoPath 2003-compatible object model provided by the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace.</span></span> 
  
## <a name="cannot-preview-or-debug-form-templates-that-use-calls-to-object-model-security-level-3-methods-and-properties"></a><span data-ttu-id="440ae-106">Impossible d'afficher l'aperçu ou de déboguer les modèles de formulaires qui utilisent des appels à des méthodes et des propriétés du niveau de sécurité 3 du modèle objet</span><span class="sxs-lookup"><span data-stu-id="440ae-106">Cannot Preview or Debug Form Templates That Use Calls to Object Model Security Level 3 Methods and Properties</span></span>

<span data-ttu-id="440ae-107">Si vous essayez de déboguer ou d'afficher un projet avec code managé qui contient du code faisant appel à des membres du modèle objet qui nécessitent une confiance totale, InfoPath affiche le message d'erreur « Une exception de sécurité non gérée s'est produite dans le code du formulaire » et le formulaire ne s'ouvre pas.</span><span class="sxs-lookup"><span data-stu-id="440ae-107">If you attempt to debug or preview a managed-code project that contains code that invokes object model members that require full trust, InfoPath will display the error message "An unhandled security exception has occurred in the form's code" and the form will not open.</span></span> <span data-ttu-id="440ae-108">Pour autoriser le débogage ou l'aperçu de la logique métier dans le modèle de formulaire, vous devez définir le niveau de sécurité **Confiance totale** et signer numériquement le modèle de formulaire.</span><span class="sxs-lookup"><span data-stu-id="440ae-108">To allow business logic in the form template to be debugged or previewed, you must set the security level to **Full Trust** and digitally sign the form template.</span></span> <span data-ttu-id="440ae-109">Pour plus d’informations sur la procédure à suivre, voir [prévisualiser et déboguer les modèles de formulaires qui nécessitent une confiance totale](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span><span class="sxs-lookup"><span data-stu-id="440ae-109">For details on how to do this, see [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>
  
## <a name="cannot-update-xpath-expressions-in-event-handlers-if-the-matchpath-parameter-value-was-deleted-manually"></a><span data-ttu-id="440ae-110">Impossible de mettre à jour les expressions XPath dans les gestionnaires d'événements si la valeur du paramètre MatchPath a été supprimée manuellement</span><span class="sxs-lookup"><span data-stu-id="440ae-110">Cannot Update XPath Expressions in Event Handlers If the MatchPath Parameter Value Was Deleted Manually</span></span>

<span data-ttu-id="440ae-111">Si vous ajoutez un gestionnaire d'événements à un groupe ou un champ, puis que vous modifiez par la suite le schéma de la source de données dans le volet Office **Champs** et que cette modification affecte le champ ou le groupe (par exemple en le renommant ou en le déplaçant), un message s'affiche vous demandant si vous souhaitez mettre à jour les expressions XPath dans le code de votre formulaire.</span><span class="sxs-lookup"><span data-stu-id="440ae-111">If you add an event handler to a field or group and later change the schema of the data source in the InfoPath **Fields** task pane in a way that affects that field or group (for example, by renaming or moving it), a message will be displayed asking if you want to update the XPath expressions in your form's code.</span></span> <span data-ttu-id="440ae-112">Les expressions XPath auxquelles ce message fait référence sont les valeurs spécifiées dans le paramètre [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) de l'attribut [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) qui sont utilisées pour associer le gestionnaire d'événements à un champ ou un groupe dans la source de données de votre formulaire.</span><span class="sxs-lookup"><span data-stu-id="440ae-112">The XPath expressions referred to in this message are the values specified in the [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) parameter of the [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) attribute, which are used to associate the event handler with a field or group in your form's data source.</span></span> <span data-ttu-id="440ae-113">Aucune autre expression XPath dans votre code n'est mise à jour.</span><span class="sxs-lookup"><span data-stu-id="440ae-113">No other XPath expressions in your code will be updated.</span></span> <span data-ttu-id="440ae-114">L'algorithme de mise à jour des expressions XPath dépend d'une valeur présente dans le paramètre **MatchPath** des attributs **InfoPathEventHandler** appliqués au code de votre formulaire.</span><span class="sxs-lookup"><span data-stu-id="440ae-114">The algorithm for updating the XPath expressions depends on a value being present in the **MatchPath** parameter of the **InfoPathEventHandler** attributes that are applied in your form code.</span></span> <span data-ttu-id="440ae-115">Si vous supprimez manuellement ces valeurs avant de répondre à l'invite de mise à jour des expressions XPath, InfoPath ne peut pas mettre à jour automatiquement les expressions XPath.</span><span class="sxs-lookup"><span data-stu-id="440ae-115">If you manually deleted these values before responding to the prompt to update XPath expressions, InfoPath will not be able to update the XPath expressions automatically.</span></span> <span data-ttu-id="440ae-116">Pour plus d’informations, voir [Ajouter un gestionnaire d’événement à l’aide du modèle objet InfoPath 2003](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="440ae-116">For more information, see [Add an Event Handler Using the InfoPath 2003 Object Model](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="cannot-call-members-of-the-infopath-2003-compatible-object-model-on-a-separate-thread"></a><span data-ttu-id="440ae-117">Impossible d'appeler les membres du modèle objet compatible InfoPath 2003 dans un thread distinct</span><span class="sxs-lookup"><span data-stu-id="440ae-117">Cannot Call Members of the InfoPath 2003 Compatible Object Model on a Separate Thread</span></span>

<span data-ttu-id="440ae-p103">Le modèle objet compatible InfoPath 2003 ne prend pas en charge les appels dans un thread distinct. Par exemple, le code suivant qui appelle la fonction LaunchOMFunction, qui appelle à son tour les membres du modèle objet InfoPath, ne s'exécute pas.</span><span class="sxs-lookup"><span data-stu-id="440ae-p103">The InfoPath 2003-compatible object model does not support calls on a separate thread. For example, the following code, which calls a function named LaunchOMFunction that calls members of the InfoPath object model, will not run.</span></span> 
  
```cs
Thread th = new Thread(new ThreadStart(LaunchOMFunction));
th.Start();
```

<span data-ttu-id="440ae-p104">Si nécessaire, il existe un moyen de contourner cette limitation. Pour plus d'information, voir [Prise en charge du threading dans les projets InfoPath à l'aide du modèle de projet InfoPath 2003](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="440ae-p104">When necessary, there is a way to work around this limitation. For information, see [Threading Support in InfoPath Projects Using the InfoPath 2003 Object Model](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="omitting-optional-parameters-causes-a-build-error-in-visual-basic-and-visual-c"></a><span data-ttu-id="440ae-122">L'omission de paramètres crée une erreur de génération dans Visual Basic et Visual C#.</span><span class="sxs-lookup"><span data-stu-id="440ae-122">Omitting Optional Parameters Causes a Build Error in Visual Basic and Visual C#</span></span>

<span data-ttu-id="440ae-p105">Si un membre du modèle objet InfoPath contient un paramètre facultatif et que vous ne spécifiez pas de valeur pour ce paramètre, vous devez transmettre le champ **Type.Missing** pour ce paramètre à la place. La non-transmission du champ **Type.Missing** lorsqu'une valeur réelle est omise provoque une erreur de génération. Ceci se produit aussi bien pour le code écrit en Visual Basic ou en Visual C#. Pour plus d'informations et d'exemples, voir la section « Transmission de paramètres facultatifs à des membres du modèle objet InfoPath » dans la rubrique [Modèles objet compatibles avec InfoPath 2003](infopath-2003-compatible-object-models.md).</span><span class="sxs-lookup"><span data-stu-id="440ae-p105">If an InfoPath object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter instead. Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error. This is true for code written in both Visual Basic and Visual C#. For more information and examples see the "Passing Optional Parameters to InfoPath Object Model Members" section in the [InfoPath 2003 Compatible Object Models](infopath-2003-compatible-object-models.md) topic.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="440ae-127">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="440ae-127">See also</span></span>

- [<span data-ttu-id="440ae-128">Sur le modèle de sécurité pour les modèles de formulaires avec Code</span><span class="sxs-lookup"><span data-stu-id="440ae-128">About the Security Model for Form Templates with Code</span></span>](about-the-security-model-for-form-templates-with-code.md)
- [<span data-ttu-id="440ae-129">Déployer des modèles de formulaire InfoPath avec Code</span><span class="sxs-lookup"><span data-stu-id="440ae-129">Deploy InfoPath Form Templates with Code</span></span>](how-to-deploy-infopath-form-templates-with-code.md)
- [<span data-ttu-id="440ae-130">Gestion des erreurs à l’aide du modèle objet InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="440ae-130">Handle Errors Using the InfoPath 2003 Object Model</span></span>](how-to-handle-errors-using-the-infopath-2003-object-model.md)
- [<span data-ttu-id="440ae-131">Afficher un aperçu et déboguer les modèles de formulaires nécessitant la confiance totale</span><span class="sxs-lookup"><span data-stu-id="440ae-131">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)
- [<span data-ttu-id="440ae-132">Débogage de projets InfoPath à l’aide du modèle objet InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="440ae-132">Debug InfoPath Projects Using the InfoPath 2003 Object Model</span></span>](how-to-debug-infopath-projects-using-the-infopath-2003-object-model.md)

