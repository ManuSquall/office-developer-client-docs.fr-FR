---
title: Utiliser les membres du modèle objet SharePoint
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 8cbafca3-7831-4231-8e61-38330b5ad61b
description: avant de pouvoir programmer en faisant référence aux membres du modèle objet de SharePoint à partir du code exécuté dans un modèle de formulaire InfoPath, vous devez référencer l'assembly Microsoft.SharePoint.dll dans le projet Visual Studio 2012 de votre formulaire. Pour cela, vous devez avoir accès au système de fichiers d'une copie de Microsoft SharePoint Server 2010 ou à un serveur Microsoft SharePoint Foundation 2010 afin de pouvoir obtenir une copie de l'assembly Microsoft.SharePoint.dll.
ms.openlocfilehash: e29725450a6a1bdcba99215e337493f8686491e3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33431658"
---
# <a name="use-sharepoint-object-model-members"></a><span data-ttu-id="b4803-104">Utiliser les membres du modèle objet SharePoint</span><span class="sxs-lookup"><span data-stu-id="b4803-104">Use SharePoint Object Model Members</span></span>

<span data-ttu-id="b4803-p102">avant de pouvoir programmer en faisant référence aux membres du modèle objet de SharePoint à partir du code exécuté dans un modèle de formulaire InfoPath, vous devez référencer l'assembly Microsoft.SharePoint.dll dans le projet Visual Studio 2012 de votre formulaire. Pour cela, vous devez avoir accès au système de fichiers d'une copie de Microsoft SharePoint Server 2010 ou à un serveur Microsoft SharePoint Foundation 2010 afin de pouvoir obtenir une copie de l'assembly Microsoft.SharePoint.dll.</span><span class="sxs-lookup"><span data-stu-id="b4803-p102">Before you can program against members of the SharePoint object model from code running in an InfoPath form template, you must reference the Microsoft.SharePoint.dll assembly in the Visual Studio 2012 project for your form. To do that, you must have access to the file system of a licensed copy of Microsoft SharePoint Server 2010 or a server that is running Microsoft SharePoint Foundation 2010 so that you can obtain a copy of the Microsoft.SharePoint.dll assembly.</span></span> 
  
<span data-ttu-id="b4803-p103">En outre, votre modèle de formulaire doit être déployé sur le serveur en tant que solution sandbox ou solution approuvée par l'administrateur. Pour plus d'informations sur ces options de déploiement, voir [Publication de formulaires avec code](publishing-forms-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="b4803-p103">Additionally, your form template must be deployed to the server as either a sandboxed or administrator-approved solution. For more information about these deployment options, see [Publishing Forms with Code](publishing-forms-with-code.md).</span></span>
  
## <a name="add-and-reference-the-microsoftsharepoint-assembly-from-an-infopath-form-template"></a><span data-ttu-id="b4803-109">Ajouter l’assembly Microsoft.SharePoint et le référencer depuis un modèle de formulaire InfoPath</span><span class="sxs-lookup"><span data-stu-id="b4803-109">Add and Reference the Microsoft.SharePoint Assembly from an InfoPath Form Template</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b4803-p104">[!IMPORTANTE] Pour éviter un conflit avec la manière dont le projet InfoPath gère les fichiers ajoutés au fichier de modèle du formulaire, ne copiez aucun des assemblys que vous souhaitez référencer dans le dossier du niveau le plus élevé du projet de modèle de formulaire. Par défaut, le chemin est au format < *lecteur*  >:\Utilisateurs\  *NomUtilisateur*  \Documents\Projets InfoPath\  *NomProjet* > Si vous souhaitez déplacer des assemblys auxquels vous faites référence depuis le dossier du projet, vous devez créer un sous-dossier dans le dossier principal du projet  *ProjectName*  , puis copier et référencer les assemblys depuis ce dossier. Cependant, la création d'un sous-dossier pour les assemblys référencés n'est pas nécessaire. Tant qu'un assembly référencé ne se trouve pas dans le dossier de niveau supérieur du projet, le projet InfoPath copie l'assembly dans le fichier de modèle de formulaire (.xsn) lorsque le projet est compilé et publié.</span><span class="sxs-lookup"><span data-stu-id="b4803-p104">To avoid a conflict with how the InfoPath project system manages files that are added to the form template file, do not copy any assemblies that you want to reference into the top-level folder of a form template project. By default, this will be a path in the following format: < *drive*  >:\Users\  *UserName*  \Documents\InfoPath Projects\  *ProjectName* > If you do want to move assemblies that you reference to a location within the project folder, you must create a subfolder under the main  *ProjectName*  project folder, and then copy and reference assemblies from that subfolder. However, be aware that creating a subfolder for referenced assemblies is not necessary. As long as a referenced assembly is not located within the project's top-level folder, the InfoPath project system will copy the assembly into the form template file (.xsn) when the project is compiled and published.</span></span> 
  
<span data-ttu-id="b4803-114">Par défaut, Microsoft.SharePoint.Server.dll est installé dans C:\Program Files\Common Files\Microsoft Shared\Web Server\Extensions\14\ISAPI dans le système de fichiers SharePoint Server 2010 ou sur un serveur SharePoint Foundation 2010.</span><span class="sxs-lookup"><span data-stu-id="b4803-114">By default, Microsoft.SharePoint.Server.dll is installed in C:\Program Files\Common Files\Microsoft Shared\Web Server\Extensions\14\ISAPI in the file system of SharePoint Server 2010 or a server that is running SharePoint Foundation 2010.</span></span>
  
### <a name="to-reference-the-microsoftsharepoint-assembly-from-an-infopath-forms-code-project"></a><span data-ttu-id="b4803-115">Pour faire référence à l’assembly Microsoft.SharePoint depuis le projet de code d’un formulaire InfoPath</span><span class="sxs-lookup"><span data-stu-id="b4803-115">To reference the Microsoft.SharePoint assembly from an InfoPath form's code project</span></span>

1. <span data-ttu-id="b4803-116">Copiez l'assembly Microsoft.SharePoint.Server.dll depuis le serveur vers un dossier local ou accédez-y depuis un dossier partagé.</span><span class="sxs-lookup"><span data-stu-id="b4803-116">Copy the Microsoft.SharePoint.Server.dll assembly from the server to a local folder, or get access to the assembly from a shared folder.</span></span>
    
2. <span data-ttu-id="b4803-117">Ouvrez le projet de modèle de formulaire dans Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="b4803-117">Open the form template project in Visual Studio 2012.</span></span>
    
3. <span data-ttu-id="b4803-118">Dans le menu **Projet**, cliquez sur **Ajouter une référence**.</span><span class="sxs-lookup"><span data-stu-id="b4803-118">On the **Project** menu, click **Add Reference**.</span></span>
    
4. <span data-ttu-id="b4803-119">Cliquez sur l'onglet **Parcourir**, recherchez l'assembly, puis cliquez sur **OK** pour ajouter la référence.</span><span class="sxs-lookup"><span data-stu-id="b4803-119">Click the **Browse** tab, locate and specify the assembly, and then click **OK** to add the reference.</span></span> 
    
<span data-ttu-id="b4803-p105">Vous pouvez maintenant écrire du code faisant référence aux membres du modèle objet de SharePoint à partir du code de votre formulaire. Pour simplifier le référencement des membres de l'espace de noms Microsoft.SharePoint, ajoutez  `using Microsoft.SharePoint;` ou  `Imports Microsoft.SharePoint` aux directives au début de votre fichier de code. Pour consulter un exemple de l'utilisation des membres du modèle objet de SharePoint dans un formulaire InfoPath, voir « Exemple 2 : gestion des fournisseurs dans une liste SharePoint » dans [Exemples de solutions en bac à sable (sandbox)](sample-sandboxed-solutions.md).</span><span class="sxs-lookup"><span data-stu-id="b4803-p105">Now you can write code against members of the SharePoint object model from your form code. To make it easier to reference members of the Microsoft.SharePoint namespace, add  `using Microsoft.SharePoint;` or  `Imports Microsoft.SharePoint` to the directives at the beginning of your code file. For an example that shows how to use members of the SharePoint object model in an InfoPath form, see "Example 2: Managing Vendors in a SharePoint List" in [Sample Sandboxed Solutions](sample-sandboxed-solutions.md).</span></span>

