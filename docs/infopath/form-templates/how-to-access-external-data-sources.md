---
title: Accès aux Sources de données externes
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
keywords:
- data connection classes [infopath 2007],secondary data sources [InfoPath 2007],data [InfoPath 2007], secondary,DataSource class [InfoPath 2007],accessing external data sources [InfoPath 2007],DataSourceCollection class [InfoPath 2007],DataConnectionCollection class [InfoPath 2007],DataConnection class [InfoPath 2007],InfoPath 2007, accessing external data,data [InfoPath 2007], external sources
localization_priority: Normal
ms.assetid: db7c2521-a1ad-4802-b398-79575d3d310a
description: Lorsque vous travaillez avec un modèle de formulaire InfoPath, vous pouvez écrire du code pour accéder aux sources de données secondaires du formulaire et manipuler les données qu'elles contiennent.
ms.openlocfilehash: e26708e0033bbfe4110ac522dd1e0a0dd037c31e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19782362"
---
# <a name="access-external-data-sources"></a><span data-ttu-id="6c35f-104">Accès aux Sources de données externes</span><span class="sxs-lookup"><span data-stu-id="6c35f-104">Access External Data Sources</span></span>

<span data-ttu-id="6c35f-105">Lorsque vous travaillez avec un modèle de formulaire InfoPath, vous pouvez écrire du code pour accéder aux sources de données secondaires du formulaire et manipuler les données qu'elles contiennent.</span><span class="sxs-lookup"><span data-stu-id="6c35f-105">When working with an InfoPath form template, you can write code to access the form's secondary data sources and manipulate the data that they contain.</span></span> 
  
<span data-ttu-id="6c35f-p101">Chaque source de données secondaire est représentée par un objet instancié à l'aide de la classe [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) et correspond à des données stockées, obtenues à partir d'une source de données externe, par exemple une base de données ou une requête d'un service Web. Ces sources de données sont désignées comme sources secondaires car lorsque l'utilisateur enregistre un formulaire InfoPath, il enregistre uniquement les données de la source de données principale et non les données des sources de données secondaires. La connexion à une source de données est représentée par un objet instancié à l'aide d'une des classes de « connexion de données » telles que la classe [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) , qui représente une connexion de données à un service Web XML.</span><span class="sxs-lookup"><span data-stu-id="6c35f-p101">Each secondary data source is represented by an object instantiated using the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class, and corresponds to stored data, obtained from some external source of data, such as a database or a Web Service query. These data sources are referred to as secondary because when the user saves an InfoPath form, the user is saving the data only in the main (or primary) data source, not the data in the secondary data sources. The connection to a data source is represented by an object instantiated using one of the "data connection" classes, such as the [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class, which represents a data connection to an XML Web Service.</span></span> 
  
<span data-ttu-id="6c35f-109">L'objet instancié [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) représente le stockage de données XML renvoyées par une connexion de données (à partir d'une requête de base de données ou de service Web), et la classe de « connexion de données » représente la connexion de données elle-même (telle que définie et nommée au moyen de la commande **Connexions de données** dans l'onglet **Données**).</span><span class="sxs-lookup"><span data-stu-id="6c35f-109">The instantiated [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) object represents the storage of XML data returned by a data connection (from a database or Web Service query), and the "data connection" class represents the data connection itself (as defined and named using the **Data Connections** command on the **Data** tab).</span></span> 
  
<span data-ttu-id="6c35f-110">Le modèle objet d'InfoPath prend en charge l'accès aux sources de données secondaires d'un formulaire grâce à l'utilisation de la classe [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) en association avec la classe [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6c35f-110">The InfoPath object model supports access to a form's secondary data sources through the use of the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class in association with the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class.</span></span> 
  
<span data-ttu-id="6c35f-111">Le modèle objet d'InfoPath fournit également un ensemble de classes de connexion de données contenant des informations relatives aux connexions de données utilisées par le formulaire.</span><span class="sxs-lookup"><span data-stu-id="6c35f-111">The InfoPath object model also provides a set of data connection classes, containing information about the data connections used by the form.</span></span>
  
> [!NOTE]
> <span data-ttu-id="6c35f-112">[!REMARQUE] Dans Microsoft InfoPath 2003, une connexion de données est appelée adaptateur de données.</span><span class="sxs-lookup"><span data-stu-id="6c35f-112">In Microsoft InfoPath 2003, a data connection is referred to as a data adapter.</span></span> 
  
<span data-ttu-id="6c35f-p102">Il existe deux types de connexions de données : les connexions de requête permettent de récupérer les données qui sont ensuite stockées dans une source de données secondaire. Les connexions d'envoi sont utilisées pour envoyer des données, par exemple à une base de données ou à un site Web. Les données envoyées sont copiées depuis la source de données principale ou la source de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="6c35f-p102">Data connections are of two kinds: Query connections are used to obtain the data that is then stored in a secondary data source. Submit connections are used to submit data, to a database or Web service, for example. The submitted data is copied from the main or secondary data sources.</span></span> 
  
## <a name="overview-of-the-datasourcecollection-class"></a><span data-ttu-id="6c35f-116">Présentation de la classe DataSourceCollection</span><span class="sxs-lookup"><span data-stu-id="6c35f-116">Overview of the DataSourceCollection Class</span></span>

<span data-ttu-id="6c35f-117">La classe [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) fournit aux développeurs les méthodes et propriétés suivantes pour gérer les instances d'objets [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) que contient le formulaire.</span><span class="sxs-lookup"><span data-stu-id="6c35f-117">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following properties and methods, which form developers can use to manage the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) object instances that the form contains.</span></span> 
  
|<span data-ttu-id="6c35f-118">**Nom**</span><span class="sxs-lookup"><span data-stu-id="6c35f-118">**Name**</span></span>|<span data-ttu-id="6c35f-119">**Description**</span><span class="sxs-lookup"><span data-stu-id="6c35f-119">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c35f-120">Propriété [Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-120">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="6c35f-121">Renvoie le nombre d’instances d’objets **DataSource** de la collection.</span><span class="sxs-lookup"><span data-stu-id="6c35f-121">Returns a count of the number of **DataSource** object instances contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="6c35f-122">Méthode [GetEnumerator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-122">[GetEnumerator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx) method</span></span>  <br/> |<span data-ttu-id="6c35f-123">Renvoie un **IEnumerator** qui peut servir à parcourir la collection.</span><span class="sxs-lookup"><span data-stu-id="6c35f-123">Returns an **IEnumerator** that can be used to iterate through the collection.</span></span>  <br/> |
|<span data-ttu-id="6c35f-124">Propriété [Item [Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-124">[Item[Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="6c35f-125">Renvoie une référence à l’objet **DataSource** spécifié par valeur d’index.</span><span class="sxs-lookup"><span data-stu-id="6c35f-125">Returns a reference to the specified **DataSource** object by index value.</span></span>  <br/> |
|<span data-ttu-id="6c35f-126">Propriété [Item [String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-126">[Item[String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="6c35f-127">Renvoie une référence à l’objet **DataSource** spécifié par nom.</span><span class="sxs-lookup"><span data-stu-id="6c35f-127">Returns a reference to the specified **DataSource** object by name.</span></span>  <br/> |
   
## <a name="overview-of-the-datasource-class"></a><span data-ttu-id="6c35f-128">Présentation de la classe DataSource</span><span class="sxs-lookup"><span data-stu-id="6c35f-128">Overview of the DataSource Class</span></span>

<span data-ttu-id="6c35f-129">La classe [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) offre aux développeurs de formulaires les méthodes et les propriétés ci-dessous pour interagir avec une source de données secondaire InfoPath.</span><span class="sxs-lookup"><span data-stu-id="6c35f-129">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following method and properties, which form developers can use to interact with an InfoPath secondary data source.</span></span> 
  
|<span data-ttu-id="6c35f-130">**Nom**</span><span class="sxs-lookup"><span data-stu-id="6c35f-130">**Name**</span></span>|<span data-ttu-id="6c35f-131">**Description**</span><span class="sxs-lookup"><span data-stu-id="6c35f-131">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c35f-132">Méthode [CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-132">[CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) method</span></span>  <br/> |<span data-ttu-id="6c35f-133">Renvoie un objet [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) d’accès et de modification de la source de données</span><span class="sxs-lookup"><span data-stu-id="6c35f-133">Returns an [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) object for accessing and editing the data source</span></span>  <br/> |
|<span data-ttu-id="6c35f-134">Propriété [QueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-134">[QueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx) property</span></span>  <br/> |<span data-ttu-id="6c35f-135">Obtient une référence à l'objet de connexion de données associé. </span><span class="sxs-lookup"><span data-stu-id="6c35f-135">Gets a reference to the associated data connection object.</span></span>  <br/> <span data-ttu-id="6c35f-136">Pour exécuter la requête sur la connexion de données et insérer les données renvoyées au format XML dans le nœud XML associé à l’objet **source de données** , utilisez la méthode [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) de l’objet de connexion de données associée.</span><span class="sxs-lookup"><span data-stu-id="6c35f-136">To execute the query on the data connection and insert the returned data as XML into the XML node associated with the **DataSource** object, use the [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) method of the associated data connection object.</span></span>  <br/> |
|<span data-ttu-id="6c35f-137">Propriété [Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-137">[Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx) property</span></span>  <br/> |<span data-ttu-id="6c35f-138">Obtient le nom de l’objet **DataSource** .</span><span class="sxs-lookup"><span data-stu-id="6c35f-138">Gets the name of the **DataSource** object.</span></span>  <br/> |
|<span data-ttu-id="6c35f-139">Propriété [en lecture seule](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-139">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx) property</span></span>  <br/> |<span data-ttu-id="6c35f-140">Obtient une valeur qui indique si la source de données est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="6c35f-140">Gets a value that indicates whether the data source is in a read-only state</span></span>  <br/> |
|<span data-ttu-id="6c35f-141">Méthode [GetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-141">[GetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="6c35f-142">Obtient la valeur d’une propriété nommée pour le nœud XML spécifié, lequel doit être un nœud **non-attribut** dans la source de données principale.</span><span class="sxs-lookup"><span data-stu-id="6c35f-142">Gets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
|<span data-ttu-id="6c35f-143">Méthode [SetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-143">[SetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="6c35f-144">Définit la valeur d’une propriété nommée pour le nœud XML spécifié, lequel doit être un nœud **non-attribut** dans la source de données principale.</span><span class="sxs-lookup"><span data-stu-id="6c35f-144">Sets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
   
## <a name="overview-of-the-data-connection-classes"></a><span data-ttu-id="6c35f-145">Présentation des classes de connexion de données</span><span class="sxs-lookup"><span data-stu-id="6c35f-145">Overview of the Data Connection Classes</span></span>

<span data-ttu-id="6c35f-p103">Les classes conçues pour accéder aux connexions de données fournissent plusieurs propriétés et méthodes permettant d'échanger des données via des connexions avec des sources de données externes. La connexion de données associée à un objet **DataSource** dépend du type de connexion de données externe. InfoPath implémente les classes suivantes pour accéder aux connexions de données :</span><span class="sxs-lookup"><span data-stu-id="6c35f-p103">The classes for accessing data connections provide different properties and methods that retrieve and submit data through connections to external data sources; the data connection that is associated with a **DataSource** object is dependent on the type of external data connection. InfoPath implements the following classes for accessing data connections.</span></span> 
  
|<span data-ttu-id="6c35f-148">**Nom**</span><span class="sxs-lookup"><span data-stu-id="6c35f-148">**Name**</span></span>|<span data-ttu-id="6c35f-149">**Description**</span><span class="sxs-lookup"><span data-stu-id="6c35f-149">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c35f-150">Classe [AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-150">[AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="6c35f-151">Interroge une source de données ADO/OLEDB ; limité à Microsoft Access et Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6c35f-151">Queries an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="6c35f-152">Classe [AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-152">[AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="6c35f-153">Envoie à une source de données ADO/OLEDB ; limité à Microsoft Access et Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6c35f-153">Submits to an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="6c35f-154">Classe [SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-154">[SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="6c35f-155">Interroge une liste ou une bibliothèque de documents SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6c35f-155">Queries a SharePoint list or document library.</span></span>  <br/> |
|[<span data-ttu-id="6c35f-156">SharePointListRWSubmitConnection</span><span class="sxs-lookup"><span data-stu-id="6c35f-156">SharePointListRWSubmitConnection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWSubmitConnection.aspx) <br/> |<span data-ttu-id="6c35f-157">Envoie à une liste ou une bibliothèque de documents SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6c35f-157">Submits to a SharePoint list or document library.</span></span>  <br/> |
|<span data-ttu-id="6c35f-158">Classe [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-158">[WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="6c35f-159">Établit une connexion à un service Web XML.</span><span class="sxs-lookup"><span data-stu-id="6c35f-159">Connects to an XML Web service.</span></span>  <br/> |
|<span data-ttu-id="6c35f-160">Classe [FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-160">[FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="6c35f-161">Interroge un fichier XML.</span><span class="sxs-lookup"><span data-stu-id="6c35f-161">Queries an XML file.</span></span>  <br/> |
|<span data-ttu-id="6c35f-162">Classe [FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-162">[FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="6c35f-163">Envoie à un fichier XML.</span><span class="sxs-lookup"><span data-stu-id="6c35f-163">Submits to an XML file.</span></span>  <br/> |
|<span data-ttu-id="6c35f-164">Classe [EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-164">[EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="6c35f-165">Envoie un formulaire en tant que pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="6c35f-165">Submits a form as an attachment in email.</span></span>  <br/> |
|<span data-ttu-id="6c35f-166">Classe [BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-166">[BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="6c35f-167">Interroge une liste externe sur un serveur exécutant SharePoint Foundation 2010 ou SharePoint Server 2010.</span><span class="sxs-lookup"><span data-stu-id="6c35f-167">Queries an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
|<span data-ttu-id="6c35f-168">Classe [BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c35f-168">[BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="6c35f-169">Envoie à une liste externe sur un serveur exécutant SharePoint Foundation 2010 ou SharePoint Server 2010.</span><span class="sxs-lookup"><span data-stu-id="6c35f-169">Submits to an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
   
## <a name="using-the-datasourcecollection-and-the-datasource-classes"></a><span data-ttu-id="6c35f-170">Utilisation des classes DataSourceCollection et DataSource</span><span class="sxs-lookup"><span data-stu-id="6c35f-170">Using the DataSourceCollection and the DataSource Classes</span></span>

<span data-ttu-id="6c35f-p104">L'objet **DataSourceCollection** qui représente la collection de sources de données associées à un modèle de formulaire est accessible par le biais de la propriété [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) de la classe [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) . Si, par exemple, vous créez une source de données secondaire nommée Employés qui extrait des données de la table Employees dans la base de données Les comptoirs, vous pouvez utiliser l'objet **DataSourceCollection** pour définir une référence à un objet **DataSource** qui représente les données extraites.</span><span class="sxs-lookup"><span data-stu-id="6c35f-p104">The **DataSourceCollection** object that represents the collection of data sources associated with a form template is accessed through the [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class. For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataSourceCollection** object to set a reference to a **DataSource** object that represents the retrieved data.</span></span> 
  
<span data-ttu-id="6c35f-p105">Dans l'exemple de code suivant, le nom de la source de données secondaires est transmis à la propriété d'accès de la classe **DataSourceCollection**, qui renvoie une référence à l'objet **DataSource** qui représente les données extraites de la table Employés. Le nœud XML qui stocke les données extraites à partir de la source de données secondaire s'affiche dans une zone de message au moyen de la méthode **CreateNavigator** de la classe **DataSource** pour accéder à la propriété **InnerXml** de la classe **XPathNavigator**.</span><span class="sxs-lookup"><span data-stu-id="6c35f-p105">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataSourceCollection** class, which returns a reference to the **DataSource** object that represents the retrieved Employees table data. The XML node that stores the retrieved data from the secondary data source is displayed in a message box using the **CreateNavigator** method of the **DataSource** class to access the **InnerXml** property of the **XPathNavigator** class.</span></span> 
  
```cs
// Instantiate a variable to access the specified data source
// from the DataSourceCollection of the form.
DataSource myDataSource = 
   this.DataSources["Employees"];
// Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " +
   myDataSource.CreateNavigator().InnerXml.ToString());
```

```vb
' Instantiate a variable to access the specified data source
' from the DataSourceCollection of the form.
Dim myDataSource As DataSource = _
   Me.DataSources("Employees")
' Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " &amp; _
   myDataSource.CreateNavigator().InnerXml.ToString())
```

<span data-ttu-id="6c35f-175">Pour manipuler les données figurant dans une source de données secondaire, utilisez la méthode **CreateNavigator** de la classe **DataSource** pour renvoyer une référence à un objet **XPathNavigator** positionné au niveau du nœud où sont stockées les données secondaires.</span><span class="sxs-lookup"><span data-stu-id="6c35f-175">To manipulate the data that is contained in a secondary data source, use the **CreateNavigator** method of the **DataSource** class to return a reference to an **XPathNavigator** object positioned at the node where the secondary data is stored.</span></span> <span data-ttu-id="6c35f-176">Vous pouvez utiliser les propriétés et méthodes de la classe **XPathNavigator** pour manipuler les données.</span><span class="sxs-lookup"><span data-stu-id="6c35f-176">You can use the properties or methods of the **XPathNavigator** class to manipulate the data.</span></span> <span data-ttu-id="6c35f-177">Pour plus d’informations, voir [utiliser les Classes XPathNavigator et XPathNodeIterator](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span><span class="sxs-lookup"><span data-stu-id="6c35f-177">For more information, see [Work with the XPathNavigator and XPathNodeIterator Classes](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span></span>
  
## <a name="using-the-dataconnectioncollection-and-the-dataconnection-classes"></a><span data-ttu-id="6c35f-178">Utilisation des classes DataConnectionCollection et DataConnection</span><span class="sxs-lookup"><span data-stu-id="6c35f-178">Using the DataConnectionCollection and the DataConnection Classes</span></span>

<span data-ttu-id="6c35f-p107">L'objet [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) qui représente la collection de connexions de données associées à un modèle de formulaire est accessible par le biais de la propriété [DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) de la classe **XmlForm**. Si, par exemple, vous créez une source de données secondaire nommée Employés qui extrait les données de la table Employés dans la base de données Les comptoirs, vous pouvez utiliser l'objet **DataConnectionCollection** associé au modèle de formulaire pour définir une référence à **DataConnection** qui représente la connexion à la base de données.</span><span class="sxs-lookup"><span data-stu-id="6c35f-p107">The [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) object that represents the collection of data connections associated with a form template is accessed through the [DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) property of the **XmlForm** class. For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataConnectionCollection** object associated with the form template to set a reference to the **DataConnection** that represents the connection to the database.</span></span> 
  
<span data-ttu-id="6c35f-p108">Dans l'exemple de code qui suit, le nom de la source de données secondaire est transmis à la propriété d'accès de la classe **DataConnectionCollection**, qui, dans ce cas, renvoie une référence à l'objet **ADOQueryConnection** qui représente la connexion à la base de données Les comptoirs. Pour que cet exemple fonctionne correctement, vous devez forcer la conversion de façon explicite de l'objet renvoyé au type **ADOQueryConnection**. La propriété [Connection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) de l'interface **ADOAdapterObject** permet d'afficher la chaîne de connexion ADO dans une boîte de message.</span><span class="sxs-lookup"><span data-stu-id="6c35f-p108">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataConnectionCollection** class, which, in this case, returns a reference to the **ADOQueryConnection** object that represents the connection to the Northwind database. For this to work properly, you must explicitly cast the object being returned to the **ADOQueryConnection** type. The [Connection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) property of the **ADOAdapterObject** interface is used to display the ADO connection string in a message box.</span></span> 
  
```cs
// Instantiate a variable to access the specified data connection
// from the DataConnectionCollection of the form. 
// You must cast to the specific data connection type
// (ADOQueryConnection) before you can access the data connection.
ADOQueryConnection myADOConnection = 
   (ADOQueryConnection)this.DataConnections["Employees"];
// Display the connection information for the data connection.
MessageBox.Show("Connection string: " + myADOConnection.Connection);
```

```vb
' Instantiate a variable to access the specified data connection
' from the DataConnectionCollection of the form. 
' You must cast to the specific data connection type
' (ADOQueryConnection) before you can access the data connection.
Dim myADOConnection As ADOQueryConnection = _
   DirectCast(Me.DataConnections("Employees"), ADOQueryConnection)
' Display the connection information for the data connection.
MessageBox.Show("Connection string: " &amp; myADOConnection.Connection)
```

## <a name="see-also"></a><span data-ttu-id="6c35f-184">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6c35f-184">See also</span></span>



[<span data-ttu-id="6c35f-185">Création de modèles de formulaires InfoPath fonctionnant avec InfoPath Forms Services</span><span class="sxs-lookup"><span data-stu-id="6c35f-185">Creating InfoPath Form Templates That Work With InfoPath Forms Services</span></span>](creating-infopath-form-templates-that-work-with-infopath-forms-services.md)

