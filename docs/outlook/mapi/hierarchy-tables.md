---
title: Tables de hiérarchies
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b8aa6b36-d6e5-4e1f-8ac5-5d6a78a70bf8
description: Dernière modification le 09 mars 2015
ms.openlocfilehash: d135e0c224866cd2a675df2ef9ec1b206f3169ab
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22580753"
---
# <a name="hierarchy-tables"></a><span data-ttu-id="6b110-103">Tables de hiérarchies</span><span class="sxs-lookup"><span data-stu-id="6b110-103">Hierarchy Tables</span></span>

  
  
<span data-ttu-id="6b110-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="6b110-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="6b110-105">Une table de hiérarchie contient des informations sur les dossiers dans une banque de messages ou les conteneurs dans un conteneur de carnet d’adresses.</span><span class="sxs-lookup"><span data-stu-id="6b110-105">A hierarchy table contains information about the folders in a message store or the containers in an address book container.</span></span> <span data-ttu-id="6b110-106">Chaque ligne d’une table de hiérarchie contient un ensemble de colonnes avec des informations sur un dossier ou le conteneur de carnet d’adresses.</span><span class="sxs-lookup"><span data-stu-id="6b110-106">Each row of a hierarchy table contains a set of columns with information about one folder or address book container.</span></span> <span data-ttu-id="6b110-107">Tables de hiérarchie sont principalement utilisés par les clients et implémentés par les fournisseurs de banque de message pour afficher une arborescence de dossiers et les sous-dossiers et par les fournisseurs de carnet d’adresses pour afficher une arborescence de conteneurs dans le carnet d’adresses.</span><span class="sxs-lookup"><span data-stu-id="6b110-107">Hierarchy tables are primarily used by clients and implemented by message store providers to show a tree of folders and subfolders and implemented by address book providers to show a tree of containers in the address book.</span></span> <span data-ttu-id="6b110-108">Conteneurs qui ne peut pas contenir les sous-conteneurs, comme indiqué par l’absence de l’indicateur AB_SUBCONTAINERS dans leur propriété **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)), n’implémentent pas une table de hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="6b110-108">Containers that cannot hold subcontainers, as indicated by the absence of the AB_SUBCONTAINERS flag in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property, do not implement a hierarchy table.</span></span>
  
<span data-ttu-id="6b110-109">Une table de hiérarchie est accessible en appelant :</span><span class="sxs-lookup"><span data-stu-id="6b110-109">A hierarchy table can be accessed by calling:</span></span>
  
- <span data-ttu-id="6b110-110">[IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md).</span><span class="sxs-lookup"><span data-stu-id="6b110-110">[IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md).</span></span>
    
    - <span data-ttu-id="6b110-111">Ou -</span><span class="sxs-lookup"><span data-stu-id="6b110-111">Or -</span></span>
    
- <span data-ttu-id="6b110-112">[IMAPIProp::OpenProperty](imapiprop-openproperty.md) en passant **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)), ainsi que la balise de propriété IID_IMAPITable en tant que l’identificateur d’interface.</span><span class="sxs-lookup"><span data-stu-id="6b110-112">[IMAPIProp::OpenProperty](imapiprop-openproperty.md) passing **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span>
    
<span data-ttu-id="6b110-113">Conteneurs et dossiers doivent prendre en charge les deux méthodes pour récupérer les propriétés du tableau.</span><span class="sxs-lookup"><span data-stu-id="6b110-113">Containers and folders must support both techniques for retrieving table properties.</span></span> <span data-ttu-id="6b110-114">N’est pas acceptable pour les fournisseurs de service prendre en charge qu’une seule manière d’accéder à ces tables, car les clients s’attendent à avoir le choix.</span><span class="sxs-lookup"><span data-stu-id="6b110-114">It is unacceptable for service providers to support only one way to access these tables because clients expect to have the choice.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="6b110-115">Fournisseurs de magasins ne sont pas garantis de respecter l’ordre de tri spécifié pour les tables de hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="6b110-115">Store providers are not guaranteed to honor the sort order set specified for hierarchy tables.</span></span> 
  
<span data-ttu-id="6b110-116">L’appel vers **IMAPIProp::OpenProperty** implique l’accès à la table de hiérarchie en ouvrant sa propriété correspondante, **PR_CONTAINER_HIERARCHY**.</span><span class="sxs-lookup"><span data-stu-id="6b110-116">The call to **IMAPIProp::OpenProperty** involves accessing the hierarchy table by opening its corresponding property, **PR_CONTAINER_HIERARCHY**.</span></span> <span data-ttu-id="6b110-117">Bien que **PR_CONTAINER_HIERARCHY** ne peut pas être récupéré à un dossier ou du conteneur [IMAPIProp::GetProps](imapiprop-getprops.md) , il est inclus dans le tableau de balise de propriété qui est retourné par la méthode [IMAPIProp::GetPropList](imapiprop-getproplist.md) .</span><span class="sxs-lookup"><span data-stu-id="6b110-117">Although **PR_CONTAINER_HIERARCHY** cannot be retrieved through a folder or container's [IMAPIProp::GetProps](imapiprop-getprops.md) method, it is included in the property tag array that is returned by the [IMAPIProp::GetPropList](imapiprop-getproplist.md) method.</span></span> 
  
 <span data-ttu-id="6b110-118">**PR_CONTAINER_HIERARCHY** peut également servir à inclure ou exclure d’une table de hiérarchie à partir d’une opération de copie.</span><span class="sxs-lookup"><span data-stu-id="6b110-118">**PR_CONTAINER_HIERARCHY** can also be used to include or exclude a hierarchy table from a copy operation.</span></span> <span data-ttu-id="6b110-119">Si un client spécifie **PR_CONTAINER_HIERARCHY** dans le paramètre *lpExcludeProps* pour [IMAPIProp::CopyTo](imapiprop-copyto.md) dans une opération de copie, le nouveau dossier ou le conteneur ne prendra pas en charge la table de hiérarchie du dossier d’origine ou du conteneur.</span><span class="sxs-lookup"><span data-stu-id="6b110-119">If a client specifies **PR_CONTAINER_HIERARCHY** in the  *lpExcludeProps*  parameter for [IMAPIProp::CopyTo](imapiprop-copyto.md) in a copy operation, the new folder or container will not support the hierarchy table of the original folder or container.</span></span> 
  
<span data-ttu-id="6b110-120">Les propriétés suivantes constituent la colonne dans une table de hiérarchie requise :</span><span class="sxs-lookup"><span data-stu-id="6b110-120">The following properties make up the required column set in a hierarchy table:</span></span>
  
|||
|:-----|:-----|
|<span data-ttu-id="6b110-121">**PR_COMMENT** ([PidTagComment](pidtagcomment-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-121">**PR_COMMENT** ([PidTagComment](pidtagcomment-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="6b110-122">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-122">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6b110-123">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-123">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="6b110-124">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-124">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6b110-125">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-125">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="6b110-126">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-126">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6b110-127">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-127">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="6b110-128">**PR_STATUS** ([PidTagStatus](pidtagstatus-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-128">**PR_STATUS** ([PidTagStatus](pidtagstatus-canonical-property.md))</span></span>  <br/> |
   
 <span data-ttu-id="6b110-129">**PR_DISPLAY_NAME** contient le nom pour le conteneur ou le dossier qui doit apparaître dans l’affichage de la hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="6b110-129">**PR_DISPLAY_NAME** contains the name for the container or folder that should appear in the display of the hierarchy.</span></span> 
  
 <span data-ttu-id="6b110-130">**PR_ENTRYID** est l’identificateur d’entrée associé à ce conteneur ou d’un dossier.</span><span class="sxs-lookup"><span data-stu-id="6b110-130">**PR_ENTRYID** is the entry identifier associated with this container or folder.</span></span> <span data-ttu-id="6b110-131">Il est supposé être un identificateur d’entrée à long terme.</span><span class="sxs-lookup"><span data-stu-id="6b110-131">It is expected to be a long-term entry identifier.</span></span> <span data-ttu-id="6b110-132">Clients et MAPI peuvent passer cet identificateur d’entrée à **OpenEntry** pour ouvrir le conteneur ou le dossier et afficher son contenu en appelant [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span><span class="sxs-lookup"><span data-stu-id="6b110-132">Clients and MAPI can pass this entry identifier to **OpenEntry** to open the container or folder and view its contents by calling [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span></span> 
  
 <span data-ttu-id="6b110-133">**PR_DEPTH** est une valeur numérique qui indique le niveau de retrait de ce conteneur ou d’un dossier à zéro en cours de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="6b110-133">**PR_DEPTH** is a numeric value that indicates the level of indentation for this container or folder with zero being the top level.</span></span> <span data-ttu-id="6b110-134">Plus la profondeur de la hiérarchie d’un conteneur ou un dossier se trouve, plus la valeur de sa propriété **PR_DEPTH** .</span><span class="sxs-lookup"><span data-stu-id="6b110-134">The deeper in the hierarchy a container or folder resides, the higher the value for its **PR_DEPTH** property.</span></span> <span data-ttu-id="6b110-135">Clients utilisent la propriété **PR_DEPTH** pour afficher une table de hiérarchie appropriée afin que les utilisateurs peuvent voir clairement les relations parent-enfant.</span><span class="sxs-lookup"><span data-stu-id="6b110-135">Clients use the **PR_DEPTH** property to display a hierarchy table appropriately so that users can clearly see parent and child relationships.</span></span> <span data-ttu-id="6b110-136">Profondeur de conteneur ou de dossier est toujours par rapport au conteneur ou l’implémentation de la table de hiérarchie de dossier.</span><span class="sxs-lookup"><span data-stu-id="6b110-136">Container or folder depth is always relative to the container or folder implementing the hierarchy table.</span></span> 
  
 <span data-ttu-id="6b110-137">**PR_OBJECT_TYPE** est toujours définie sur MAPI_ABCONT pour les tables de hiérarchie adresse livre et MAPI_FOLDER pour les tables de hiérarchie de dossier.</span><span class="sxs-lookup"><span data-stu-id="6b110-137">**PR_OBJECT_TYPE** is always set to MAPI_ABCONT for address book hierarchy tables and MAPI_FOLDER for folder hierarchy tables.</span></span> 
  
 <span data-ttu-id="6b110-138">**PR_DISPLAY_TYPE** est une valeur numérique qui se rapporte à la façon dont un conteneur ou un dossier s’affiche dans la table de hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="6b110-138">**PR_DISPLAY_TYPE** is a numeric value that relates to how a container or folder is displayed in the hierarchy table.</span></span> <span data-ttu-id="6b110-139">Il est principalement utilisé à des fins d’affichage, pour différencier visuellement les types de conteneurs ou de dossiers.</span><span class="sxs-lookup"><span data-stu-id="6b110-139">It is mainly used for display purposes, to differentiate visually between types of containers or folders.</span></span> <span data-ttu-id="6b110-140">Message de stocker et adresses fournisseurs livre utiliser des icônes pour les types d’affichage différents.</span><span class="sxs-lookup"><span data-stu-id="6b110-140">Many message store and address book providers use icons for the different display types.</span></span> <span data-ttu-id="6b110-141">Il est le fournisseur peut fournir ces icônes ; MAPI ne fournit pas de valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="6b110-141">It is up to the provider to supply these icons; MAPI does not supply defaults.</span></span> 
  
<span data-ttu-id="6b110-142">MAPI définit plusieurs valeurs pour **PR_DISPLAY_TYPE**certains qui sont valides pour les dossiers et d’autres personnes qui sont utilisés avec les tables de hiérarchie de conteneurs de carnet d’adresses.</span><span class="sxs-lookup"><span data-stu-id="6b110-142">MAPI defines many values for **PR_DISPLAY_TYPE**, some that are valid for folders and others that are used with the hierarchy tables of address book containers.</span></span> <span data-ttu-id="6b110-143">En règle générale, **PR_DISPLAY_TYPE d’un dossier** a la valeur DT_FOLDER pour indiquer une icône de dossier par défaut, pour indiquer une icône qui représente un lien vers un autre dossier DT_FOLDER_LINK ou DT_FOLDER_SPECIAL pour indiquer l’icône qui est spécifique à l’application.</span><span class="sxs-lookup"><span data-stu-id="6b110-143">Typically, a folder's **PR_DISPLAY_TYPE** is set to DT_FOLDER to indicate a default folder icon, DT_FOLDER_LINK to indicate an icon that represents a link to another folder, or DT_FOLDER_SPECIAL to indicate an icon that is application-specific.</span></span> <span data-ttu-id="6b110-144">DT_FOLDER_LINK est utilisé avec les dossiers de résultats de recherche.</span><span class="sxs-lookup"><span data-stu-id="6b110-144">DT_FOLDER_LINK is used with search-results folders.</span></span> 
  
<span data-ttu-id="6b110-145">Outre ces colonnes obligatoires, tables de hiérarchie livre adresse doivent inclure la propriété **PR_CONTAINER_FLAGS** .</span><span class="sxs-lookup"><span data-stu-id="6b110-145">In addition to these required columns, address book hierarchy tables must include the **PR_CONTAINER_FLAGS** property.</span></span> <span data-ttu-id="6b110-146">**PR_CONTAINER_FLAGS** indique divers attributs sur un conteneur dans la hiérarchie et est utilisé pour distinguer un conteneur d’un autre.</span><span class="sxs-lookup"><span data-stu-id="6b110-146">**PR_CONTAINER_FLAGS** indicates various attributes about a container in the hierarchy and is used to distinguish one container from another.</span></span> 
  
<span data-ttu-id="6b110-147">Propriété facultative pour les tables de hiérarchie adresse téléchargeable est la propriété **PR_AB_PROVIDER_ID** ([PidTagAbProviderId](pidtagabproviderid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="6b110-147">An optional property for address book hierarchy tables is the **PR_AB_PROVIDER_ID** ([PidTagAbProviderId](pidtagabproviderid-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="6b110-148">Tables de hiérarchie de message-store incluent ces propriétés dans leur ensemble de colonnes requises :</span><span class="sxs-lookup"><span data-stu-id="6b110-148">Message-store hierarchy tables include these properties in their required column set:</span></span>
  
- <span data-ttu-id="6b110-149">**PR_FOLDER_TYPE** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-149">**PR_FOLDER_TYPE** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))</span></span>
    
- <span data-ttu-id="6b110-150">**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-150">**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))</span></span>
    
- <span data-ttu-id="6b110-151">**PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-151">**PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>
    
- <span data-ttu-id="6b110-152">**PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6b110-152">**PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md))</span></span>
    
<span data-ttu-id="6b110-153">Fournisseurs de carnet d’adresses doivent prendre en charge les méthodes **IMAPITable** suivantes dans leurs implémentations de table de hiérarchie car ils sont requis par le carnet d’adresses intégré de MAPI :</span><span class="sxs-lookup"><span data-stu-id="6b110-153">Address book providers must support the following **IMAPITable** methods in their hierarchy table implementations because they are required by the MAPI integrated address book:</span></span> 
  
|||
|:-----|:-----|
|[<span data-ttu-id="6b110-154">IMAPITable::QueryColumns</span><span class="sxs-lookup"><span data-stu-id="6b110-154">IMAPITable::QueryColumns</span></span>](imapitable-querycolumns.md) <br/> |[<span data-ttu-id="6b110-155">IMAPITable::QueryPosition</span><span class="sxs-lookup"><span data-stu-id="6b110-155">IMAPITable::QueryPosition</span></span>](imapitable-queryposition.md) <br/> |
|[<span data-ttu-id="6b110-156">IMAPITable::SeekRow</span><span class="sxs-lookup"><span data-stu-id="6b110-156">IMAPITable::SeekRow</span></span>](imapitable-seekrow.md) <br/> |[<span data-ttu-id="6b110-157">IMAPITable::SeekRowApprox</span><span class="sxs-lookup"><span data-stu-id="6b110-157">IMAPITable::SeekRowApprox</span></span>](imapitable-seekrowapprox.md) <br/> |
|[<span data-ttu-id="6b110-158">IMAPITable::FindRow</span><span class="sxs-lookup"><span data-stu-id="6b110-158">IMAPITable::FindRow</span></span>](imapitable-findrow.md) <br/> |[<span data-ttu-id="6b110-159">IMAPITable::Restrict</span><span class="sxs-lookup"><span data-stu-id="6b110-159">IMAPITable::Restrict</span></span>](imapitable-restrict.md) <br/> |
|[<span data-ttu-id="6b110-160">IMAPITable::CreateBookmark</span><span class="sxs-lookup"><span data-stu-id="6b110-160">IMAPITable::CreateBookmark</span></span>](imapitable-createbookmark.md) <br/> |[<span data-ttu-id="6b110-161">IMAPITable::FreeBookmark</span><span class="sxs-lookup"><span data-stu-id="6b110-161">IMAPITable::FreeBookmark</span></span>](imapitable-freebookmark.md) <br/> |
|[<span data-ttu-id="6b110-162">IMAPITable::QueryRows</span><span class="sxs-lookup"><span data-stu-id="6b110-162">IMAPITable::QueryRows</span></span>](imapitable-queryrows.md) <br/> | <br/> |
   
## <a name="see-also"></a><span data-ttu-id="6b110-163">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6b110-163">See also</span></span>



[<span data-ttu-id="6b110-164">Tables MAPI</span><span class="sxs-lookup"><span data-stu-id="6b110-164">MAPI Tables</span></span>](mapi-tables.md)

