---
title: Identificateurs d’entrée ponctuelle
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 741d21ae-f14a-4b7f-80aa-91d0f0ff3f34
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: abe52cb45e13e6713d28fffe379e245e2483bffa
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33411042"
---
# <a name="one-off-entry-identifiers"></a><span data-ttu-id="9b32d-103">Identificateurs d’entrée ponctuelle</span><span class="sxs-lookup"><span data-stu-id="9b32d-103">One-off entry identifiers</span></span>
  
<span data-ttu-id="9b32d-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="9b32d-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="9b32d-105">Les identificateurs d'entrée uniques sont créés par MAPI dans la méthode **IAddrBook:: CreateOneOff** et par les composants qui n'ont pas accès au sous-système MAPI, tels que les composants de passerelle.</span><span class="sxs-lookup"><span data-stu-id="9b32d-105">One-off entry identifiers are created by MAPI in the **IAddrBook::CreateOneOff** method and by components that do not have access to the MAPI subsystem, such as gateway components.</span></span> <span data-ttu-id="9b32d-106">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="9b32d-106">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span></span> <span data-ttu-id="9b32d-107">L'illustration suivante montre le format d'un identificateur d'entrée unique.</span><span class="sxs-lookup"><span data-stu-id="9b32d-107">The following illustration shows the format of a one-off entry identifier.</span></span>
  
<span data-ttu-id="9b32d-108">**Format d’identificateur d’entrée unique**</span><span class="sxs-lookup"><span data-stu-id="9b32d-108">**One-off entry identifier format**</span></span>
  
<span data-ttu-id="9b32d-109">![Format d'identificateur d'entrée unique] (media/amapi_69.gif "Format d'identificateur d'entrée unique")</span><span class="sxs-lookup"><span data-stu-id="9b32d-109">![One-off entry identifier format](media/amapi_69.gif "One-off entry identifier format")</span></span>
  
<span data-ttu-id="9b32d-110">Le premier champ est une structure [MAPIUID](mapiuid.md) spéciale qui identifie l'identificateur d'entrée comme représentant un destinataire personnalisé.</span><span class="sxs-lookup"><span data-stu-id="9b32d-110">The first field is a special [MAPIUID](mapiuid.md) structure that identifies the entry identifier as representing a custom recipient.</span></span> <span data-ttu-id="9b32d-111">Cette structure **MAPIUID** doit être définie sur la constante MAPI_ONE_OFF_UID.</span><span class="sxs-lookup"><span data-stu-id="9b32d-111">This **MAPIUID** structure must be set to the constant MAPI_ONE_OFF_UID.</span></span> <span data-ttu-id="9b32d-112">MAPI_ONE_OFF_UID est défini dans le fichier d'en-tête MAPIDEFS. H.</span><span class="sxs-lookup"><span data-stu-id="9b32d-112">MAPI_ONE_OFF_UID is defined in the header file MAPIDEFS.H.</span></span> 
  
<span data-ttu-id="9b32d-113">Les champs version et Flags sont des mots 16 bits dans l'ordre d'octet Intel.</span><span class="sxs-lookup"><span data-stu-id="9b32d-113">The version and flags fields are 16-bit words in Intel byte order.</span></span> <span data-ttu-id="9b32d-114">Le champ version doit avoir la valeur zéro.</span><span class="sxs-lookup"><span data-stu-id="9b32d-114">The version field must be set to zero.</span></span> <span data-ttu-id="9b32d-115">Le champ Flags peut avoir les valeurs suivantes:</span><span class="sxs-lookup"><span data-stu-id="9b32d-115">The flags field can be set to the following values:</span></span>
  
<span data-ttu-id="9b32d-116">MAPI_ONE_OFF_NO_RICH_INFO</span><span class="sxs-lookup"><span data-stu-id="9b32d-116">MAPI_ONE_OFF_NO_RICH_INFO</span></span>
  
<span data-ttu-id="9b32d-117">MAPI_ONE_OFF_UNICODE</span><span class="sxs-lookup"><span data-stu-id="9b32d-117">MAPI_ONE_OFF_UNICODE</span></span>
  
<span data-ttu-id="9b32d-118">L'indicateur MAPI_ONE_OFF_NO_RICH_INFO est défini si un destinataire ne doit pas recevoir de contenu de message au format TNEF (Transport Neutral Encapsulation Format).</span><span class="sxs-lookup"><span data-stu-id="9b32d-118">The MAPI_ONE_OFF_NO_RICH_INFO flag is set if a recipient should not receive message content in the Transport Neutral Encapsulation Format (TNEF).</span></span> <span data-ttu-id="9b32d-119">Cet indicateur est défini lorsqu'MAPI_SEND_NO_RICH_INFO est transmis à [IAddrBook:: CreateOneOff](iaddrbook-createoneoff.md) méthode.</span><span class="sxs-lookup"><span data-stu-id="9b32d-119">This flag is set when MAPI_SEND_NO_RICH_INFO is passed to [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) method.</span></span> 
  
<span data-ttu-id="9b32d-120">L'indicateur MAPI_ONE_OFF_UNICODE est défini si le nom d'affichage et l'adresse de messagerie sont des chaînes Unicode.</span><span class="sxs-lookup"><span data-stu-id="9b32d-120">The MAPI_ONE_OFF_UNICODE flag is set if the display name and email address are Unicode strings.</span></span> <span data-ttu-id="9b32d-121">Cet indicateur est défini lorsque la MAPI_UNICODE est transmise à **IAddrBook:: CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="9b32d-121">This flag is set when the MAPI_UNICODE is passed to **IAddrBook::CreateOneOff**.</span></span> <span data-ttu-id="9b32d-122">Lorsque l'indicateur MAPI_UNICODE n'est pas transmis à **CreateOneOff**, MAPI suppose que le nom d'affichage et les chaînes d'adresse de messagerie se trouvent dans le jeu de caractères ANSI actuel de la station de travail.</span><span class="sxs-lookup"><span data-stu-id="9b32d-122">When the MAPI_UNICODE flag is not passed to **CreateOneOff**, MAPI assumes that the display name and email address strings are in the workstation's current ANSI character set.</span></span> <span data-ttu-id="9b32d-123">En règle générale, les chaînes ANSI ne fonctionnent pas correctement dans les messages qui sont envoyés entre les plateformes utilisant des jeux de caractères différents car la page de code n'est pas codée dans l'identificateur d'entrée.</span><span class="sxs-lookup"><span data-stu-id="9b32d-123">ANSI strings generally do not work well in messages that are sent between platforms using different character sets because the code page is not encoded in the entry identifier.</span></span> <span data-ttu-id="9b32d-124">Pour vous protéger contre cette incompatibilité potentielle, de nombreux types d'adresses sont limités aux seuls caractères communs à plusieurs jeux de caractères.</span><span class="sxs-lookup"><span data-stu-id="9b32d-124">To protect against this potential incompatibility, many address types are limited to only those characters that are common across multiple character sets.</span></span> <span data-ttu-id="9b32d-125">Toutefois, pour garantir la compatibilité des jeux de caractères et des plateformes, les clients doivent utiliser Unicode pour les chaînes de caractères de leurs messages.</span><span class="sxs-lookup"><span data-stu-id="9b32d-125">However, to ensure character set and platform compatibility, clients should use Unicode for the character strings in their messages.</span></span>
  
<span data-ttu-id="9b32d-126">Le nom complet est une chaîne terminée par un caractère null qui correspond à la propriété **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) du destinataire et au paramètre _lpszName_ transmis à **IAddrBook:: CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="9b32d-126">The display name is a null-terminated string that corresponds to the recipient's **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property and to the  _lpszName_ parameter passed to **IAddrBook::CreateOneOff**.</span></span> <span data-ttu-id="9b32d-127">Le jeu de caractères est Unicode si l'indicateur MAPI_ONE_OFF_UNICODE est défini et ANSI s'il est clair.</span><span class="sxs-lookup"><span data-stu-id="9b32d-127">The character set is Unicode if the MAPI_ONE_OFF_UNICODE flag is set and ANSI if it is clear.</span></span> 
  
<span data-ttu-id="9b32d-128">Le type d'adresse est une chaîne terminée par un caractère null qui correspond à la propriété **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) du destinataire et au paramètre _lpszAdrType_ transmis à **IAddrBook:: CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="9b32d-128">The address type is a null-terminated string that corresponds to the recipient's **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) property and to the  _lpszAdrType_ parameter passed to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="9b32d-129">L'adresse de messagerie est une chaîne terminée par un caractère null qui correspond à la propriété **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) du destinataire et au paramètre _lpszAddress_ transmis à **IAddrBook:: CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="9b32d-129">The email address is a null-terminated string that corresponds to the recipient's **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) property and to the  _lpszAddress_ parameter passed to **IAddrBook::CreateOneOff**.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="9b32d-130">Il n'y a pas de remplissage dans les structures d'identificateur d'entrée unique; les octets sont conditionnés exactement comme indiqué ci-dessus et la longueur de l'identificateur d'entrée ne doit pas inclure d'octets au-delà du caractère null de fin de l'adresse de messagerie.</span><span class="sxs-lookup"><span data-stu-id="9b32d-130">There is no padding in one-off entry identifier structures; the bytes are packed exactly as indicated above and the entry identifier length should not include any bytes beyond the terminating null character of the email address.</span></span> 
  
<span data-ttu-id="9b32d-131">Les clients et les fournisseurs de carnets d'adresses qui construisent manuellement des identificateurs d'entrée uniques peuvent également avoir besoin de générer des valeurs pour les propriétés **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) et **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="9b32d-131">Clients and address book providers that manually construct one-off entry identifiers might also need to generate values for the **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) and **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) properties.</span></span> <span data-ttu-id="9b32d-132">La clé d'enregistrement est identique à l'identificateur d'entrée.</span><span class="sxs-lookup"><span data-stu-id="9b32d-132">The record key is identical to the entry identifier.</span></span> <span data-ttu-id="9b32d-133">La clé de recherche doit être formée en concaténant les champs suivants dans l'ordre suivant:</span><span class="sxs-lookup"><span data-stu-id="9b32d-133">The search key should be formed by concatenating the following fields in the following order:</span></span>
  
1. <span data-ttu-id="9b32d-134">Type d'adresse, converti en caractères majuscules.</span><span class="sxs-lookup"><span data-stu-id="9b32d-134">The address type, converted to uppercase characters.</span></span>
    
2. <span data-ttu-id="9b32d-135">Un signe deux-points (:).</span><span class="sxs-lookup"><span data-stu-id="9b32d-135">A colon (:).</span></span>
    
3. <span data-ttu-id="9b32d-136">Adresse de messagerie convertie en caractères majuscules.</span><span class="sxs-lookup"><span data-stu-id="9b32d-136">The email address, converted to uppercase characters.</span></span>
    
4. <span data-ttu-id="9b32d-137">Caractère null de fin.</span><span class="sxs-lookup"><span data-stu-id="9b32d-137">A terminating null character.</span></span>
    
<span data-ttu-id="9b32d-138">Aucune conversion de jeu de caractères ne doit être réalisée lors de la génération de la clé de recherche.</span><span class="sxs-lookup"><span data-stu-id="9b32d-138">No character set conversion must be done when generating the search key.</span></span>
  

