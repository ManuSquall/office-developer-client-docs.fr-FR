---
title: Banques de messages en lecture seule
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 752ff2d6-ca64-4507-adf1-4c054c321203
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: e0a66443194a3f89b47218ed9dc0ed9ad9c2df83
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22584512"
---
# <a name="read-only-message-stores"></a><span data-ttu-id="74af9-103">Banques de messages en lecture seule</span><span class="sxs-lookup"><span data-stu-id="74af9-103">Read-Only Message Stores</span></span>

  
  
<span data-ttu-id="74af9-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="74af9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="74af9-p101">Une banque de messages en lecture seule est une dans laquelle ni le client MAPI, ni le spouleur MAPI peut cr�er, modifier ou supprimer les objets de la banque de messages. Il existe plusieurs raisons peuvent expliquer pourquoi vous souhaiterez peut-�tre mettre en �uvre une banque de messages en lecture seule. Par exemple, un cabinet de cr�ation de rapports de cr�dit peut utiliser un magasin en lecture seule pour permettre � ses clients ou des employ�s � voir, mais ne modifie pas les rapports de cr�dit individuels. Possibilit� de rendre un message en lecture seule � stocker a des cons�quences de la structure du fournisseur de banque et de la banque elle-m�me. Par exemple, une banque de messages en lecture seule n'est pas un dossier bo�te d'envoi, car, puis les clients MAPI demandait que les nouveaux messages sortants �tre cr��s dans ce dossier. De m�me, il incombe au fournisseur de magasin afin de garantir l'int�grit� du m�canisme de stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="74af9-p101">A read-only message store is one in which neither the MAPI client nor the MAPI spooler can create, modify, or delete the objects in the message store. There are many reasons why you might want to implement a read-only message store. For example, a credit reporting firm could use a read-only store to allow its customers or employees to see but not change individual credit reports. Choosing to make a read-only message store has implications for the structure of the store provider and for the store itself. For example, a read-only message store cannot have an Outbox folder, because then MAPI clients would request that new outgoing messages be created in that folder. Similarly, it is the store provider's responsibility to ensure the integrity of the underlying storage mechanism.</span></span>
  
<span data-ttu-id="74af9-111">Il existe trois indicateurs peuvent être définies dans la propriété **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) de la banque messages qui prennent en charge différents niveaux d’accès en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="74af9-111">There are three flags that can be set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property that support different levels of read-only access.</span></span> <span data-ttu-id="74af9-112">The STORE_READONLY flag indicates that all [IMAPIProp : IUnknown](imapipropiunknown.md) interfaces on objects in the message store are read-only.</span><span class="sxs-lookup"><span data-stu-id="74af9-112">The STORE_READONLY flag indicates that all [IMAPIProp : IUnknown](imapipropiunknown.md) interfaces on objects in the message store are read-only.</span></span> <span data-ttu-id="74af9-113">The STORE_MODIFY_OK flag indicates that existing messages in the message store may be modified, but new folders and messages may not be created.</span><span class="sxs-lookup"><span data-stu-id="74af9-113">The STORE_MODIFY_OK flag indicates that existing messages in the message store may be modified, but new folders and messages may not be created.</span></span> <span data-ttu-id="74af9-114">The STORE_CREATE_OK flag indicates that new messages and folders may be created, but indicates nothing about whether existing objects may be modified.</span><span class="sxs-lookup"><span data-stu-id="74af9-114">The STORE_CREATE_OK flag indicates that new messages and folders may be created, but indicates nothing about whether existing objects may be modified.</span></span> 
  
<span data-ttu-id="74af9-p103">Le fait que les clients MAPI et le spouleur MAPI ne peuvent pas �tre en mesure de cr�er, modifier ou supprimer des objets dans la banque de messages ne signifie pas que le contenu du m�canisme de stockage sous-jacent change jamais. Ni, cela signifie que votre fournisseur de magasin doit jamais autorisations en �criture pour le m�canisme de stockage sous-jacent. Dans certaines circonstances ces deux conditions peuvent appliquer, mais pas dans le cas g�n�ral d'un message en lecture seule stocker. Le niveau d'acc�s que requiert votre fournisseur de magasins et ou non votre fournisseur de magasin de modification des donn�es dans le m�canisme de stockage sous-jacent d�pend essentiellement de la nature sp�cifique de votre fournisseur de magasins.</span><span class="sxs-lookup"><span data-stu-id="74af9-p103">The fact that MAPI clients and the MAPI spooler may not be able to create, modify, or delete objects in the message store does not mean that the contents of the underlying storage mechanism never change. Nor does it mean that your store provider never needs write permission to the underlying storage mechanism. In some circumstances those two conditions may apply, but not in the general case of a read-only message store. The level of access that your store provider requires and whether or not your store provider ever changes data in the underlying storage mechanism depends mainly on the specific nature of your store provider.</span></span>
  
<span data-ttu-id="74af9-p104">Par exemple, si vous �crivez un fournisseur de magasins pour donner des clients MAPI l'acc�s � une base de donn�es stock�e sur un lecteur de CD-ROM, le m�canisme de stockage sous-jacent ne peut pas modifier et votre fournisseur de magasin peut avoir l'autorisation en lecture seule. Si, toutefois, vous �crivez un fournisseur de magasins pour permettre aux clients MAPI un acc�s en lecture seule pour une base de donn�es de dossiers publics, mais le fournisseur de magasins doit assurer le suivi de l'�tat lu/des messages pour chaque utilisateur, le fournisseur de banque vous devrez �crire les nouvelles donn�es dans le m�canisme de stockage sous-jacent. Toutefois, ni exemple le fournisseur de banque jamais doit cr�er, modifier ou supprimer des dossiers ou des messages � la demande des clients MAPI ou le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="74af9-p104">For example, if you are writing a store provider to give MAPI clients access to a database stored on a CD-ROM device, the underlying storage mechanism cannot change and your store provider can have read-only permission for it. If, however, you are writing a store provider to give MAPI clients read-only access to a public folder database, but the store provider needs to keep track of the read/unread status of messages for each user, the store provider will need to write new data to the underlying storage mechanism. However, in neither example does the store provider ever have to create, modify, or delete folders or messages at the request of MAPI clients or the MAPI spooler.</span></span>
  
<span data-ttu-id="74af9-122">La courte liste des raisons pour lesquelles un fournisseur de magasins aurais besoin pour �crire des donn�es � un m�canisme de stockage sous-jacent est en lecture seule est comme suit :</span><span class="sxs-lookup"><span data-stu-id="74af9-122">The short list of reasons that a store provider would need to write data to an underlying storage mechanism that is otherwise read-only is as follows:</span></span>
  
- <span data-ttu-id="74af9-123">Pour stocker l'�tat lu/des messages.</span><span class="sxs-lookup"><span data-stu-id="74af9-123">To store the read/unread status of messages.</span></span>
    
- <span data-ttu-id="74af9-124">Pour impl�menter des notifications de lecture/suppression du mode lecture.</span><span class="sxs-lookup"><span data-stu-id="74af9-124">To implement read/nonread notifications.</span></span> 
    
- <span data-ttu-id="74af9-125">Pour stocker les affichages.</span><span class="sxs-lookup"><span data-stu-id="74af9-125">To store views.</span></span>
    
- <span data-ttu-id="74af9-126">Pour mettre en cache index permanents pour les ordres de tri de dossier d�fini par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="74af9-126">To cache persistent indexes for user-defined folder sort orders.</span></span>
    
- <span data-ttu-id="74af9-127">To store the sort order of a folder's contents (supporting [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)).</span><span class="sxs-lookup"><span data-stu-id="74af9-127">To store the sort order of a folder's contents (supporting [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)).</span></span>
    
- <span data-ttu-id="74af9-128">To store search criteria, search state, and results, if the message store provider supports searches (supporting [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)).</span><span class="sxs-lookup"><span data-stu-id="74af9-128">To store search criteria, search state, and results, if the message store provider supports searches (supporting [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)).</span></span>
    
<span data-ttu-id="74af9-p105">Si votre fournisseur de banque de messages peut jamais �crire des donn�es dans le m�canisme de stockage sous-jacent, qu'elle a besoin impl�menter ces fonctionnalit�s � l'aide d'un m�canisme de stockage distinct � l'ext�rieur du m�canisme de stockage sous-jacent. Par exemple, un fournisseur de magasin de message en lecture seule peut stocker l'�tat lu/des messages dans le magasin dans un fichier sur l'ordinateur de l'utilisateur. Cette strat�gie pr�sente des difficult�s suppl�mentaires, mais sans doute la fa�on de mesure du possible uniquement pour les messages en lecture seule � mettre en �uvre de certaines fonctionnalit�s, les fournisseurs de magasins. Par exemple, en conservant le contenu du dispositif de stockage distincts synchronis� avec les objets de la banque de messages est plus difficile que le stockage de l'�tat lu/directement dans la banque de messages proprement dit.</span><span class="sxs-lookup"><span data-stu-id="74af9-p105">If your message store provider can never write data to the underlying storage mechanism, it will need to implement these features by using a separate storage mechanism outside of the underlying storage mechanism. For example, a read-only message store provider could store the read/unread status of messages in the store in a file on the user's computer. This strategy presents additional difficulties but may be the only feasable way for read-only message store providers to implement some features. For example, keeping the contents of the separate storage mechanism synchronized with the objects in the message store is more difficult than storing the read/unread status directly in the message store itself.</span></span>
  
<span data-ttu-id="74af9-133">Recherche pr�sente une complication suppl�mentaire pour les fournisseurs de banque de message en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="74af9-133">Searching presents an additional complication for read-only message store providers.</span></span> <span data-ttu-id="74af9-134">Clients utilisent le dossier spécifié dans la propriété **PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) de l’objet de banque de message pour localiser le dossier utilisé pour les résultats de la recherche.</span><span class="sxs-lookup"><span data-stu-id="74af9-134">Clients use the folder specified in the message store object's **PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) property to locate the folder used for search results.</span></span> <span data-ttu-id="74af9-135">Les fournisseurs de banque de message en lecture seule souvent impossible d'installer un dossier permanent de r�sultats de recherche dans la banque de messages.</span><span class="sxs-lookup"><span data-stu-id="74af9-135">Read-only message store providers often cannot install a permanent search-results folder into the message store.</span></span> <span data-ttu-id="74af9-136">Dans ce cas, le fournisseur de banque de messages doit stocker un identificateur d'entr�e dans la propri�t� **PR_FINDER_ENTRYID** qu'il peut reconna�tre lorsque les clients ouvrent les dossiers afin qu'elle peut cr�er dynamiquement un dossier de r�sultats de recherche au lieu de lire une dans le m�canisme de stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="74af9-136">In that situation, the message store provider should store an entry identifier in the **PR_FINDER_ENTRYID** property that it can recognize when clients open folders so that it can dynamically create a search-results folder instead of reading one from the underlying storage mechanism.</span></span> <span data-ttu-id="74af9-137">Toutefois, �tant donn� que de nombreux fournisseurs de banque de message en lecture seule cr�ent dynamiquement tous leurs dossiers, il s'agit g�n�ralement pas trop lourde.</span><span class="sxs-lookup"><span data-stu-id="74af9-137">However, because many read-only message store providers create all their folders dynamically, this is usually not too much of a burden.</span></span> 
  
<span data-ttu-id="74af9-p107">Le fait que votre fournisseur de banque de messages est en lecture seule est publi� dans la propri�t� **PR_STORE_SUPPORT_MASK** de l'objet fournisseur de magasins. Toutefois, ne sont pas sur les clients de respecter cette propri�t� ; code de votre fournisseur magasin doit appliquer l'�tat en lecture seule du m�canisme de stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="74af9-p107">The fact that your message store provider is read-only is advertised in the store provider object's **PR_STORE_SUPPORT_MASK** property. However, do not count on clients to respect that property; your store provider's code should enforce the read-only status of the underlying storage mechanism.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="74af9-140">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="74af9-140">See also</span></span>



[<span data-ttu-id="74af9-141">Développement d’un fournisseur de banque de messages MAPI</span><span class="sxs-lookup"><span data-stu-id="74af9-141">Developing a MAPI Message Store Provider</span></span>](developing-a-mapi-message-store-provider.md)

