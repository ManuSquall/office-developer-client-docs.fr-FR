---
title: Implémentation d’objet état
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 48fd3e28-c2d2-474d-9487-5e2f08ca7319
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: e019ad8d0063514cd41017b459cc701c45c22a2e
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22569595"
---
# <a name="status-object-implementation"></a><span data-ttu-id="f2738-103">Implémentation d’objet état</span><span class="sxs-lookup"><span data-stu-id="f2738-103">Status object implementation</span></span>

<span data-ttu-id="f2738-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="f2738-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="f2738-105">Tous les fournisseurs de services doivent implémenter un objet d’état et fournir des propriétés à partir de celui-ci à la table d’état de session.</span><span class="sxs-lookup"><span data-stu-id="f2738-105">All service providers must implement a status object and furnish properties from it to the session status table.</span></span> <span data-ttu-id="f2738-106">Vous pouvez inclure une ou plusieurs lignes dans la table d’état, en fonction du nombre de ressources que vous contrôlez.</span><span class="sxs-lookup"><span data-stu-id="f2738-106">You can include one or more rows in the status table, depending on the number of resources that you control.</span></span> <span data-ttu-id="f2738-107">Par exemple, un fournisseur de transport doit créer une ligne dans la table d’état pour chaque file d’attente de message qu’il gère.</span><span class="sxs-lookup"><span data-stu-id="f2738-107">A transport provider, for example, should create a row in the status table for each message queue it manages.</span></span> <span data-ttu-id="f2738-108">Lorsque des modifications se produisent, la ligne de tableau statut approprié doit être mis à jour.</span><span class="sxs-lookup"><span data-stu-id="f2738-108">When changes occur, the appropriate status table row must be updated.</span></span> <span data-ttu-id="f2738-109">Objets d’état sont implémentées pour fournir l’accès à la fois pour les informations contenues dans la table d’état et des informations supplémentaires non inclus dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="f2738-109">Status objects are implemented to provide access both to the information included in the status table and to additional information not included in the table.</span></span>
  
### <a name="to-implement-a-status-object"></a><span data-ttu-id="f2738-110">Pour implémenter un objet d’état</span><span class="sxs-lookup"><span data-stu-id="f2738-110">To implement a status object</span></span>

1. <span data-ttu-id="f2738-111">Implémentez la méthode **OpenStatusEntry** de l’objet d’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="f2738-111">Implement the **OpenStatusEntry** method of your logon object.</span></span> <span data-ttu-id="f2738-112">Lorsque les clients souhaitent ouvrir votre objet état, ils appellent [IMAPISession::OpenEntry](imapisession-openentry.md).</span><span class="sxs-lookup"><span data-stu-id="f2738-112">When clients want to open your status object, they call [IMAPISession::OpenEntry](imapisession-openentry.md).</span></span> <span data-ttu-id="f2738-113">MAPI répond à la demande d’ouverture en appelant la méthode **OpenStatusEntry** de votre fournisseur, à l’origine de votre fournisseur ouvrir son objet état et revenir au client un pointeur vers son implémentation **IMAPIStatus** .</span><span class="sxs-lookup"><span data-stu-id="f2738-113">MAPI fulfills the open request by calling your provider's **OpenStatusEntry** method, causing your provider to open its status object and return to the client a pointer to its **IMAPIStatus** implementation.</span></span> <span data-ttu-id="f2738-114">Dans votre implémentation **OpenStatusEntry** , procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="f2738-114">In your **OpenStatusEntry** implementation, complete the following steps:</span></span> 
    
   1. <span data-ttu-id="f2738-115">Effectuer les tâches suivantes si votre objet de connexion n’a pas encore créé un objet d’état :</span><span class="sxs-lookup"><span data-stu-id="f2738-115">Perform the following tasks if your logon object has not yet created a status object:</span></span>
    
      1. <span data-ttu-id="f2738-116">Appeler la méthode [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) de l’objet de la prise en charge pour accéder à section de profil de votre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="f2738-116">Call the support object's [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method to access your provider's profile section.</span></span> 
          
      2. <span data-ttu-id="f2738-117">Créer un nouvel objet d’état.</span><span class="sxs-lookup"><span data-stu-id="f2738-117">Create a new status object.</span></span>
          
      3. <span data-ttu-id="f2738-118">Stocker une référence à la section profil dans l’objet d’état de votre fournisseur et appeler la méthode [IUnknown::AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) de la section profil pour incrémenter son décompte de références.</span><span class="sxs-lookup"><span data-stu-id="f2738-118">Store a reference to the profile section in your provider's status object and call the profile section's [IUnknown::AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) method to increment its reference count.</span></span> 
          
      4. <span data-ttu-id="f2738-119">Stocker une référence à l’objet d’ouverture de session dans l’objet d’état de votre fournisseur et appelez la méthode **IUnknown::AddRef** de l’objet d’ouverture de session pour incrémenter son décompte de références.</span><span class="sxs-lookup"><span data-stu-id="f2738-119">Store a reference to the logon object in your provider's status object and call the logon object's **IUnknown::AddRef** method to increment its reference count.</span></span> 
          
      5. <span data-ttu-id="f2738-120">Stocker une référence à l’objet de l’état de l’objet de connexion de votre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="f2738-120">Store a reference to the status object in your provider's logon object.</span></span>
    
   2. <span data-ttu-id="f2738-121">Appeler la méthode **IUnknown::AddRef** de l’objet état pour incrémenter son décompte de références dans l’objet d’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="f2738-121">Call the status object's **IUnknown::AddRef** method to increment its reference count in the logon object.</span></span> 
    
   3. <span data-ttu-id="f2738-122">Définissez la propriété **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md)) de l’objet d’état à MAPI_STATUS.</span><span class="sxs-lookup"><span data-stu-id="f2738-122">Set the status object's **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md)) property to MAPI_STATUS.</span></span>
    
   4. <span data-ttu-id="f2738-123">Définissez le paramètre de sortie _lppMAPIStatus_ pour pointer vers l’objet de l’état et retourner.</span><span class="sxs-lookup"><span data-stu-id="f2738-123">Set the  _lppMAPIStatus_ output parameter to point to the status object, and return.</span></span> 
    
   5. <span data-ttu-id="f2738-124">Vérifiez le paramètre d’entrée _ulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="f2738-124">Check the  _ulFlags_ input parameter.</span></span> <span data-ttu-id="f2738-125">Si elle est définie à n’et votre fournisseur prend en charge l’accès en lecture/écriture à son objet état, retourne un objet accessible en écriture.</span><span class="sxs-lookup"><span data-stu-id="f2738-125">If it is set to MAPI_MODIFY and your provider supports read/write access to its status object, return a writeable object.</span></span> <span data-ttu-id="f2738-126">Toutefois, si votre fournisseur ne gère pas l’accès en lecture/écriture à son objet état, n’échouent pas.</span><span class="sxs-lookup"><span data-stu-id="f2738-126">However, if your provider does not support read/write access to its status object, do not fail.</span></span> <span data-ttu-id="f2738-127">Renvoie un objet état qui est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="f2738-127">Return a status object that is read-only.</span></span> <span data-ttu-id="f2738-128">Les clients qui doivent recevoir les objets d’état en lecture/écriture doivent vérifier que l’autorisation en lecture/écriture a été octroyée avant d’essayer d’apporter des modifications.</span><span class="sxs-lookup"><span data-stu-id="f2738-128">Clients that expect to receive read/write status objects should verify that read/write permission has been granted before attempting to make any changes.</span></span> 
    
2. <span data-ttu-id="f2738-129">Définissez toutes les l’état requis d’objet et état de propriétés du tableau.</span><span class="sxs-lookup"><span data-stu-id="f2738-129">Set all of the required status object and status table properties.</span></span> <span data-ttu-id="f2738-130">Les propriétés que vous incluez dans votre ligne de tableau d’état doivent être disponibles par le biais de votre objet d’état à l’exception des propriétés calculées par MAPI.</span><span class="sxs-lookup"><span data-stu-id="f2738-130">The properties that you include in your status table row should be available through your status object, except for the properties calculated by MAPI.</span></span> <span data-ttu-id="f2738-131">Les propriétés requises sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="f2738-131">The required properties are as follows:</span></span>
    
   - <span data-ttu-id="f2738-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f2738-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
   - <span data-ttu-id="f2738-133">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f2738-133">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span></span>
    
   - <span data-ttu-id="f2738-134">**PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f2738-134">**PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span></span>
    
   - <span data-ttu-id="f2738-135">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f2738-135">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span></span>
    
   - <span data-ttu-id="f2738-136">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f2738-136">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span></span>
    
   - <span data-ttu-id="f2738-137">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f2738-137">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span></span>
    
   - <span data-ttu-id="f2738-138">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f2738-138">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span></span>
    
3. <span data-ttu-id="f2738-139">Implémenter le [IMAPIStatus : IMAPIProp](imapistatusimapiprop.md) méthodes qui conviennent à votre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="f2738-139">Implement the [IMAPIStatus : IMAPIProp](imapistatusimapiprop.md) methods that are appropriate for your provider.</span></span> <span data-ttu-id="f2738-140">En fonction de votre fournisseur, il est inutile d’implémenter toutes les quatre méthodes dans **IMAPIStatus**.</span><span class="sxs-lookup"><span data-stu-id="f2738-140">Depending on your provider, you do not need to implement all of the four methods in **IMAPIStatus**.</span></span> <span data-ttu-id="f2738-141">Chaque fournisseur doit implémenter une version en lecture seule des méthodes de le [IMAPIProp : IUnknown](imapipropiunknown.md) interface et la méthode [IMAPIStatus::ValidateState](imapistatus-validatestate.md) .</span><span class="sxs-lookup"><span data-stu-id="f2738-141">Every provider should implement a read-only version of the methods of the [IMAPIProp : IUnknown](imapipropiunknown.md) interface and the [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method.</span></span> 

   <span data-ttu-id="f2738-142">Fournisseurs de transport doivent également implémenter [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md)et tous les fournisseurs doivent prendre en charge [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md).</span><span class="sxs-lookup"><span data-stu-id="f2738-142">Transport providers should also implement [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md), and all providers should support [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md).</span></span> <span data-ttu-id="f2738-143">Toutefois, la prise en charge de [IMAPIStatus::ChangePassword](imapistatus-changepassword.md) est facultative.</span><span class="sxs-lookup"><span data-stu-id="f2738-143">However, support for [IMAPIStatus::ChangePassword](imapistatus-changepassword.md) is optional.</span></span> <span data-ttu-id="f2738-144">Seuls les fournisseurs de services qui nécessitent des mots de passe et pour permettre aux utilisateurs de les modifier par programme doivent implémenter cette méthode.</span><span class="sxs-lookup"><span data-stu-id="f2738-144">Only service providers that require passwords and want to allow users to change them programmatically need to implement this method.</span></span> <span data-ttu-id="f2738-145">Pour chaque méthode que vous prenez en charge, définissez le bit correspondant dans la propriété **PR_RESOURCE_METHODS** .</span><span class="sxs-lookup"><span data-stu-id="f2738-145">For every method that you support, set the corresponding bit in the **PR_RESOURCE_METHODS** property.</span></span> <span data-ttu-id="f2738-146">Par exemple, si vous prenez en charge **ValidateState** et **dialogue** uniquement, définissez **PR_RESOURCE_METHODS** à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="f2738-146">For example, if you support **ValidateState** and **SettingsDialog** only, set **PR_RESOURCE_METHODS** to the following:</span></span> 
    
   `STATUS_VALIDATE_STATE | STATUS_SETTINGS_DIALOG`
    
   <span data-ttu-id="f2738-147">Avant d’essayer d’appeler votre objet état, les clients doivent vérifier la valeur de **PR_RESOURCE_METHODS** .</span><span class="sxs-lookup"><span data-stu-id="f2738-147">Clients should check the value of **PR_RESOURCE_METHODS** before attempting to call your status object.</span></span> <span data-ttu-id="f2738-148">Gérer les appels à n’importe lequel de vos méthodes non prises en charge en retournant MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="f2738-148">Handle calls to any of your unsupported methods by returning MAPI_E_NO_SUPPORT.</span></span> 
    
4. <span data-ttu-id="f2738-149">Appelez [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) au cours de l’ouverture de session pour ajouter l’ou les lignes à la table d’état.</span><span class="sxs-lookup"><span data-stu-id="f2738-149">Call [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) during logon to add your row or rows to the status table.</span></span> <span data-ttu-id="f2738-150">Passez un tableau de valeurs de propriété qui contient les informations de colonne pour la ligne et 0 pour le paramètre _ulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="f2738-150">Pass a property value array that contains the column information for the row and 0 for the  _ulFlags_ parameter.</span></span> <span data-ttu-id="f2738-151">Si à un moment donné plus loin dans la session changements d’état de votre fournisseur et qu’il s’avère nécessaire pour mettre à jour les informations de colonne, rappelez **ModifyStatusRow** avec l’indicateur STATUSROW_UPDATE.</span><span class="sxs-lookup"><span data-stu-id="f2738-151">If at some point later in the session your provider's status changes and it becomes necessary to update the column information, call **ModifyStatusRow** again with the STATUSROW_UPDATE flag set.</span></span> 
    
<span data-ttu-id="f2738-152">Pour plus d’informations sur les objets d’état, voir [Objets d’état MAPI](mapi-status-objects.md).</span><span class="sxs-lookup"><span data-stu-id="f2738-152">For more information about status objects, see [MAPI Status Objects](mapi-status-objects.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="f2738-153">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f2738-153">See also</span></span>

- [<span data-ttu-id="f2738-154">Fournisseurs de services MAPI</span><span class="sxs-lookup"><span data-stu-id="f2738-154">MAPI Service Providers</span></span>](mapi-service-providers.md)

