---
title: L’ouverture d’un dossier de la banque de messages
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d858e4fe-822e-4330-9ed3-4b7d22fa51dc
description: Dernière modification le 09 mars 2015
ms.openlocfilehash: 2ac4a30d6afc7e5245441bfe2d501169dd3a9447
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22586122"
---
# <a name="opening-a-message-store-folder"></a><span data-ttu-id="2491a-103">L’ouverture d’un dossier de la banque de messages</span><span class="sxs-lookup"><span data-stu-id="2491a-103">Opening a message store folder</span></span>

<span data-ttu-id="2491a-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2491a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2491a-105">Avant de n’importe quel dossier peut être ouverts, son identificateur d’entrée doit être disponible.</span><span class="sxs-lookup"><span data-stu-id="2491a-105">Before any folder can be opened, its entry identifier must be available.</span></span> <span data-ttu-id="2491a-106">Pour la plupart des dossiers, cela signifie récupérer leurs propriétés **PR_ENTRYID** .</span><span class="sxs-lookup"><span data-stu-id="2491a-106">For most folders, this means retrieving their **PR_ENTRYID** properties.</span></span> <span data-ttu-id="2491a-107">Pour les dossiers spéciaux, tels que les dossiers de la sous-arborescence IPM et autres dossiers racine, MAPI définit propriétés d’identificateur d’entrée qui sont accessibles en appelant la méthode de **IMAPIProp::GetProps** de la banque de messages.</span><span class="sxs-lookup"><span data-stu-id="2491a-107">For special folders, such as some of the IPM subtree folders and other root folders, MAPI defines special entry identifier properties that are accessible by calling the message store's **IMAPIProp::GetProps** method.</span></span> <span data-ttu-id="2491a-108">Ces identificateurs d’entrée sont toujours à long terme et sont nommés comme suit :</span><span class="sxs-lookup"><span data-stu-id="2491a-108">These entry identifiers are always long-term and are named as follows:</span></span> 
  
|<span data-ttu-id="2491a-109">**Folder**</span><span class="sxs-lookup"><span data-stu-id="2491a-109">**Folder**</span></span>|<span data-ttu-id="2491a-110">**Propriété identificateur**</span><span class="sxs-lookup"><span data-stu-id="2491a-110">**Entry identifier property**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2491a-111">Dossier bo�te d'envoi</span><span class="sxs-lookup"><span data-stu-id="2491a-111">Outbox folder</span></span>  <br/> |<span data-ttu-id="2491a-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (Classe de message IPM)</span><span class="sxs-lookup"><span data-stu-id="2491a-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (IPM message class only)</span></span>  <br/> |
|<span data-ttu-id="2491a-113">Dossier �l�ments supprim�s</span><span class="sxs-lookup"><span data-stu-id="2491a-113">Deleted Items folder</span></span>  <br/> |<span data-ttu-id="2491a-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-115">dossier �l�ments envoy�s</span><span class="sxs-lookup"><span data-stu-id="2491a-115">Sent Items folder</span></span>  <br/> |<span data-ttu-id="2491a-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-117">Dossier racine IPM</span><span class="sxs-lookup"><span data-stu-id="2491a-117">IPM root folder</span></span>  <br/> |<span data-ttu-id="2491a-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-119">Dossier racine de r�sultats de recherche</span><span class="sxs-lookup"><span data-stu-id="2491a-119">Search-results root folder</span></span>  <br/> |<span data-ttu-id="2491a-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-121">Dossier racine de vues commun</span><span class="sxs-lookup"><span data-stu-id="2491a-121">Common views root folder</span></span>  <br/> |<span data-ttu-id="2491a-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-123">Dossier racine de vues personnelles</span><span class="sxs-lookup"><span data-stu-id="2491a-123">Personal views root folder</span></span>  <br/> |<span data-ttu-id="2491a-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-125">Dossier racine de contacts</span><span class="sxs-lookup"><span data-stu-id="2491a-125">Contacts root folder</span></span>  <br/> |<span data-ttu-id="2491a-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-127">Dossier racine de brouillons</span><span class="sxs-lookup"><span data-stu-id="2491a-127">Drafts root folder</span></span>  <br/> |<span data-ttu-id="2491a-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-129">Dossier racine de journal</span><span class="sxs-lookup"><span data-stu-id="2491a-129">Journal root folder</span></span>  <br/> |<span data-ttu-id="2491a-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-131">Dossier racine de calendrier</span><span class="sxs-lookup"><span data-stu-id="2491a-131">Calendar root folder</span></span>  <br/> |<span data-ttu-id="2491a-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-133">Dossier racine de notes</span><span class="sxs-lookup"><span data-stu-id="2491a-133">Notes root folder</span></span>  <br/> |<span data-ttu-id="2491a-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2491a-135">Dossier racine de tâches</span><span class="sxs-lookup"><span data-stu-id="2491a-135">Tasks root folder</span></span>  <br/> |<span data-ttu-id="2491a-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2491a-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="2491a-137">Avant d’essayer de récupérer l’une de ces identificateurs d’entrée, récupérer le **PR\_VALID_FOLDER_MASK** propriété ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) de la banque de messages.</span><span class="sxs-lookup"><span data-stu-id="2491a-137">Before you try to retrieve one of these special entry identifiers, retrieve the **PR\_VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) property of the message store.</span></span> <span data-ttu-id="2491a-138">**PR\_VALID_FOLDER_MASK** est un masque de bits qui identifie les identificateurs existent de l’entrée.</span><span class="sxs-lookup"><span data-stu-id="2491a-138">**PR\_VALID_FOLDER_MASK** is a bitmask that identifies which of the special entry identifiers exist.</span></span> <span data-ttu-id="2491a-139">Il existe un bit pour chacun des dossiers spéciaux.</span><span class="sxs-lookup"><span data-stu-id="2491a-139">There is one bit for each of the special folders.</span></span> <span data-ttu-id="2491a-140">Si le bit est activé, il indique que le dossier correspondant est pris en charge et qu’il possède un identificateur d’entrée valide.</span><span class="sxs-lookup"><span data-stu-id="2491a-140">If the bit is set, it indicates that the corresponding folder is supported and has a valid entry identifier.</span></span> <span data-ttu-id="2491a-141">Par exemple, si le dossier éléments supprimés existe et qu’il possède un identificateur d’entrée valide, le dossier\_IPM_WASTEBASKET_VALID bits sera définie dans **PR_VALID_FOLDER_MASK**.</span><span class="sxs-lookup"><span data-stu-id="2491a-141">For example, if the Deleted Items folder exists and has a valid entry identifier, the FOLDER\_IPM_WASTEBASKET_VALID bit will be set in **PR_VALID_FOLDER_MASK**.</span></span> 
  
## <a name="open-the-folder-where-all-incoming-messages-of-a-particular-class-are-placed"></a><span data-ttu-id="2491a-142">Ouvrez le dossier dans lequel sont placés tous les messages entrants d’une classe particulière</span><span class="sxs-lookup"><span data-stu-id="2491a-142">Open the folder where all incoming messages of a particular class are placed</span></span>
  
1. <span data-ttu-id="2491a-143">Appelez [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) pour récupérer son identificateur d’entrée, la définition du paramètre _lpszMessageClass_ pour pointer vers une chaîne de caractères qui identifie la classe de message.</span><span class="sxs-lookup"><span data-stu-id="2491a-143">Call [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) to retrieve its entry identifier, setting the  _lpszMessageClass_ parameter to point to a character string identifying the message class.</span></span> <span data-ttu-id="2491a-144">Par exemple, si vous souhaitez ouvrir la boîte de réception pour la sous-arborescence IPM, pointez _lpszMessageClass_ IPM.</span><span class="sxs-lookup"><span data-stu-id="2491a-144">For example, if you want to open the Inbox for your IPM subtree, point  _lpszMessageClass_ to IPM.</span></span> <span data-ttu-id="2491a-145">Si vous souhaitez ouvrir le dossier de réception des messages IPC, définissez qu’elle pointe vers IPC.</span><span class="sxs-lookup"><span data-stu-id="2491a-145">If you want to open the receive folder for IPC messages, set it to point to IPC.</span></span> 

   <span data-ttu-id="2491a-146">S’il n’existe aucun dossier de réception inscrits pour la classe de message, **GetReceiveFolder** choisit le dossier de réception dont la classe de message associé établit une correspondance avec le préfixe le plus longtemps possible de la classe de message passé.</span><span class="sxs-lookup"><span data-stu-id="2491a-146">If there is no registered receive folder for the message class, **GetReceiveFolder** chooses the receive folder whose associated message class matches the longest possible prefix of the message class passed in.</span></span> <span data-ttu-id="2491a-147">Pour plus d’informations, voir [MAPI recevoir des dossiers](mapi-receive-folders.md).</span><span class="sxs-lookup"><span data-stu-id="2491a-147">For more information, see [MAPI Receive Folders](mapi-receive-folders.md).</span></span> 
   
   <span data-ttu-id="2491a-148">Notez que la propriété **PR_IPM_OUTBOX_ENTRYID** est utilisée pour ouvrir le dossier boîte d’envoi uniquement pour les messages IPM.</span><span class="sxs-lookup"><span data-stu-id="2491a-148">Note that the **PR_IPM_OUTBOX_ENTRYID** property is used to open the Outbox folder only for IPM messages.</span></span> <span data-ttu-id="2491a-149">Si vous ouvrez la boîte d’envoi des messages IPC, utilisez plutôt l’identificateur d’entrée de son dossier de réception.</span><span class="sxs-lookup"><span data-stu-id="2491a-149">If you are opening the Outbox for IPC messages, use instead the entry identifier for its receive folder.</span></span> <span data-ttu-id="2491a-150">Les messages entrants et sortants IPC sont placés dans le dossier de réception.</span><span class="sxs-lookup"><span data-stu-id="2491a-150">Both incoming and outgoing IPC messages are placed in the receive folder.</span></span> 
    
2. <span data-ttu-id="2491a-151">Appelez un des quatre méthodes **OpenEntry** pour ouvrir le dossier et retourne un pointeur d’interface qui vous permet d’y accéder.</span><span class="sxs-lookup"><span data-stu-id="2491a-151">Call one of four **OpenEntry** methods to open the folder and return an interface pointer that you can use to access it.</span></span> <span data-ttu-id="2491a-152">Vous pouvez appeler l’une des méthodes suivantes pour ouvrir un dossier :</span><span class="sxs-lookup"><span data-stu-id="2491a-152">You can call any one of the following methods to open a folder:</span></span> 
    
   - [<span data-ttu-id="2491a-153">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2491a-153">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
   - [<span data-ttu-id="2491a-154">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2491a-154">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md)
    
   - [<span data-ttu-id="2491a-155">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2491a-155">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md)
    
   - [<span data-ttu-id="2491a-156">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2491a-156">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md)
    
   <span data-ttu-id="2491a-157">La méthode spécifique que vous choisissez dépend du dossier à ouvrir et les objets qui sont disponibles au moment.</span><span class="sxs-lookup"><span data-stu-id="2491a-157">The specific method that you choose depends on the folder to be opened and the objects that are available at the time.</span></span> <span data-ttu-id="2491a-158">Étant donné que la méthode **IMAPISession** peut ouvrir n’importe quel dossier pour les messages dans le profil actuel, appelez cette **OpenEntry** lorsque vous ne savez pas quoi que ce soit sur le dossier à ouvrir.</span><span class="sxs-lookup"><span data-stu-id="2491a-158">Because the **IMAPISession** method can open any folder for any message store in the current profile, call this **OpenEntry** when you do not know anything about the folder to be opened.</span></span> <span data-ttu-id="2491a-159">Si vous connaissez lesquelles messages possède le dossier et que vous avez un pointeur vers la banque de messages, appelez **IMsgStore::OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="2491a-159">If you know which message store owns the folder and you have a pointer to the message store, call **IMsgStore::OpenEntry**.</span></span> 
    
   <span data-ttu-id="2491a-160">Par exemple, utilisez la méthode **IMsgStore** pour ouvrir un dossier de réception.</span><span class="sxs-lookup"><span data-stu-id="2491a-160">For example, use the **IMsgStore** method to open a receive folder.</span></span> <span data-ttu-id="2491a-161">Si vous avez un pointeur vers l’objet d’ouverture de session du fournisseur de banque de messages, appelez **IMSLogon::OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="2491a-161">If you have a pointer to the message store provider's logon object, call **IMSLogon::OpenEntry**.</span></span> <span data-ttu-id="2491a-162">Étant donné que ces appels aller directement vers le fournisseur de banque de messages plutôt que par le biais de MAPI, le traitement est plus rapide.</span><span class="sxs-lookup"><span data-stu-id="2491a-162">Because these calls go directly to the message store provider rather than through MAPI, processing is faster.</span></span> <span data-ttu-id="2491a-163">Si le dossier que vous ouvrez est un sous-dossier d’un dossier que vous avez déjà ouvert, appeler la méthode de **IMAPIContainer::OpenEntry** du dossier ouvert.</span><span class="sxs-lookup"><span data-stu-id="2491a-163">If the folder you are opening is a subfolder of a folder that you already have open, call the open folder's **IMAPIContainer::OpenEntry** method.</span></span> <span data-ttu-id="2491a-164">La méthode **IMAPIContainer** uniquement les sous-dossiers d’un dossier actuellement ouvert s’ouvre et est la seule méthode pour travailler avec les identificateurs d’entrée à court terme.</span><span class="sxs-lookup"><span data-stu-id="2491a-164">The **IMAPIContainer** method only opens subfolders of a currently opened folder and is the only method guaranteed to work with short-term entry identifiers.</span></span> 
    
3. <span data-ttu-id="2491a-165">Si vous souhaitez être en mesure d’apporter des modifications dans le dossier à ouvrir, spécifiez un niveau d’accès en définissant la soit MAPI\_meilleures\_ACCESS ou MAPI\_indicateur modifier dans l’appel de **OpenEntry** .</span><span class="sxs-lookup"><span data-stu-id="2491a-165">If you want to be able to make changes to the folder to be opened, specify an access level by setting either the MAPI\_BEST\_ACCESS or MAPI\_MODIFY flag in the **OpenEntry** call.</span></span> <span data-ttu-id="2491a-166">Ces indicateurs sont des suggestions pour le fournisseur de banque de messages pour accorder le niveau d’accès, le plus élevé pour MAPI\_meilleures\_ou accès en lecture/écriture, pour MAPI\_modifier, lors de l’ouverture du dossier.</span><span class="sxs-lookup"><span data-stu-id="2491a-166">These flags are suggestions to the message store provider to grant the highest level of access, for MAPI\_BEST\_ACCESS, or read/write access, for MAPI\_MODIFY, when opening the folder.</span></span> 

   <span data-ttu-id="2491a-167">Étant donné que ces indicateurs ne sont que des propositions, le dossier peut ou ne peut pas être ouvert avec le niveau d’accès souhaité.</span><span class="sxs-lookup"><span data-stu-id="2491a-167">Because these flags are only suggestions, the folder may or may not be opened with the access level you expect.</span></span> <span data-ttu-id="2491a-168">En récupérant la propriété **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)), vous pouvez déterminer la plage d’opérations qui peuvent être effectuées dans le dossier ouvert.</span><span class="sxs-lookup"><span data-stu-id="2491a-168">By retrieving the **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) property, you can determine the range of operations that can be performed on the open folder.</span></span> 
    
   <span data-ttu-id="2491a-169">Toutefois, étant donné que de nombreux fournisseurs de banque de messages calculer la valeur de cette propriété sur la demande, plutôt qu’il prise en charge sous la forme d’une propriété de dossier ou en tant que colonne dans leur table de hiérarchie, récupérer peut prendre du temps.</span><span class="sxs-lookup"><span data-stu-id="2491a-169">However, because many message store providers calculate the value for this property on demand rather than supporting it as a folder property or as a column in their hierarchy table, retrieving it can be time-consuming.</span></span> <span data-ttu-id="2491a-170">Une autre stratégie consiste à essayer de toute opération, vous devez effectuer et renvoie une erreur si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="2491a-170">An alternate strategy is to attempt whatever operation you need to perform and return an error if necessary.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="2491a-171">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2491a-171">See also</span></span>

- [<span data-ttu-id="2491a-172">Propriété canonique PidTagEntryId</span><span class="sxs-lookup"><span data-stu-id="2491a-172">PidTagEntryId Canonical Property</span></span>](pidtagentryid-canonical-property.md) 
- [<span data-ttu-id="2491a-173">IMAPIProp::GetProps</span><span class="sxs-lookup"><span data-stu-id="2491a-173">IMAPIProp::GetProps</span></span>](imapiprop-getprops.md)

