---
title: Ouverture d’un dossier d’une banque de messages
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d858e4fe-822e-4330-9ed3-4b7d22fa51dc
description: Dernière modification le 9 mars 2015
ms.openlocfilehash: df7db013cb435484c721388abab51ab4ba43828f
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436537"
---
# <a name="opening-a-message-store-folder"></a><span data-ttu-id="2b213-103">Ouverture d’un dossier d’une banque de messages</span><span class="sxs-lookup"><span data-stu-id="2b213-103">Opening a message store folder</span></span>

<span data-ttu-id="2b213-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2b213-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2b213-105">Pour pouvoir ouvrir un dossier, son identificateur d’entrée doit être disponible.</span><span class="sxs-lookup"><span data-stu-id="2b213-105">Before any folder can be opened, its entry identifier must be available.</span></span> <span data-ttu-id="2b213-106">Pour la plupart des dossiers, cela implique la récupération de leurs propriétés **PR_ENTRYID** propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b213-106">For most folders, this means retrieving their **PR_ENTRYID** properties.</span></span> <span data-ttu-id="2b213-107">Pour les dossiers spéciaux, tels que certains des dossiers de sous-arbre IPM et d’autres dossiers racine, MAPI définit des propriétés d’identificateur d’entrée spéciales qui sont accessibles en appelant la méthode **IMAPIProp::GetProps** de la boutique de messages.</span><span class="sxs-lookup"><span data-stu-id="2b213-107">For special folders, such as some of the IPM subtree folders and other root folders, MAPI defines special entry identifier properties that are accessible by calling the message store's **IMAPIProp::GetProps** method.</span></span> <span data-ttu-id="2b213-108">Ces identificateurs d’entrée sont toujours à long terme et sont nommés comme suit :</span><span class="sxs-lookup"><span data-stu-id="2b213-108">These entry identifiers are always long-term and are named as follows:</span></span> 
  
|<span data-ttu-id="2b213-109">**Folder**</span><span class="sxs-lookup"><span data-stu-id="2b213-109">**Folder**</span></span>|<span data-ttu-id="2b213-110">**Propriété d’identificateur d’entrée**</span><span class="sxs-lookup"><span data-stu-id="2b213-110">**Entry identifier property**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2b213-111">Dossier bo�te d'envoi</span><span class="sxs-lookup"><span data-stu-id="2b213-111">Outbox folder</span></span>  <br/> |<span data-ttu-id="2b213-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (classe de message IPM uniquement)</span><span class="sxs-lookup"><span data-stu-id="2b213-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (IPM message class only)</span></span>  <br/> |
|<span data-ttu-id="2b213-113">dossier Éléments supprimés</span><span class="sxs-lookup"><span data-stu-id="2b213-113">Deleted Items folder</span></span>  <br/> |<span data-ttu-id="2b213-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-115">dossier �l�ments envoy�s</span><span class="sxs-lookup"><span data-stu-id="2b213-115">Sent Items folder</span></span>  <br/> |<span data-ttu-id="2b213-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-117">Dossier racine IPM</span><span class="sxs-lookup"><span data-stu-id="2b213-117">IPM root folder</span></span>  <br/> |<span data-ttu-id="2b213-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-119">Dossier racine de r�sultats de recherche</span><span class="sxs-lookup"><span data-stu-id="2b213-119">Search-results root folder</span></span>  <br/> |<span data-ttu-id="2b213-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-121">Dossier racine des affichages communs</span><span class="sxs-lookup"><span data-stu-id="2b213-121">Common views root folder</span></span>  <br/> |<span data-ttu-id="2b213-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-123">Dossier racine des affichages personnels</span><span class="sxs-lookup"><span data-stu-id="2b213-123">Personal views root folder</span></span>  <br/> |<span data-ttu-id="2b213-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-125">Dossier racine contacts</span><span class="sxs-lookup"><span data-stu-id="2b213-125">Contacts root folder</span></span>  <br/> |<span data-ttu-id="2b213-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-127">Dossier racine Brouillons</span><span class="sxs-lookup"><span data-stu-id="2b213-127">Drafts root folder</span></span>  <br/> |<span data-ttu-id="2b213-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-129">Dossier racine du journal</span><span class="sxs-lookup"><span data-stu-id="2b213-129">Journal root folder</span></span>  <br/> |<span data-ttu-id="2b213-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-131">Dossier racine du calendrier</span><span class="sxs-lookup"><span data-stu-id="2b213-131">Calendar root folder</span></span>  <br/> |<span data-ttu-id="2b213-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-133">Dossier racine Notes</span><span class="sxs-lookup"><span data-stu-id="2b213-133">Notes root folder</span></span>  <br/> |<span data-ttu-id="2b213-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2b213-135">Dossier racine des tâches</span><span class="sxs-lookup"><span data-stu-id="2b213-135">Tasks root folder</span></span>  <br/> |<span data-ttu-id="2b213-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2b213-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="2b213-137">Avant d’essayer de récupérer l’un de ces identificateurs d’entrée spéciaux, récupérez la propriété **pr \_ VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) de la magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="2b213-137">Before you try to retrieve one of these special entry identifiers, retrieve the **PR\_VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) property of the message store.</span></span> <span data-ttu-id="2b213-138">**PR \_ VALID_FOLDER_MASK** est un masque de bits qui identifie lequel des identificateurs d’entrée spéciaux existe.</span><span class="sxs-lookup"><span data-stu-id="2b213-138">**PR\_VALID_FOLDER_MASK** is a bitmask that identifies which of the special entry identifiers exist.</span></span> <span data-ttu-id="2b213-139">Il existe un bit pour chacun des dossiers spéciaux.</span><span class="sxs-lookup"><span data-stu-id="2b213-139">There is one bit for each of the special folders.</span></span> <span data-ttu-id="2b213-140">Si le bit est définie, il indique que le dossier correspondant est pris en charge et possède un identificateur d’entrée valide.</span><span class="sxs-lookup"><span data-stu-id="2b213-140">If the bit is set, it indicates that the corresponding folder is supported and has a valid entry identifier.</span></span> <span data-ttu-id="2b213-141">Par exemple, si le dossier Éléments supprimés existe et possède un identificateur d’entrée valide, le bit IPM_WASTEBASKET_VALID FOLDER sera définie dans \_ **PR_VALID_FOLDER_MASK**.</span><span class="sxs-lookup"><span data-stu-id="2b213-141">For example, if the Deleted Items folder exists and has a valid entry identifier, the FOLDER\_IPM_WASTEBASKET_VALID bit will be set in **PR_VALID_FOLDER_MASK**.</span></span> 
  
## <a name="open-the-folder-where-all-incoming-messages-of-a-particular-class-are-placed"></a><span data-ttu-id="2b213-142">Ouvrir le dossier dans lequel tous les messages entrants d’une classe particulière sont placés</span><span class="sxs-lookup"><span data-stu-id="2b213-142">Open the folder where all incoming messages of a particular class are placed</span></span>
  
1. <span data-ttu-id="2b213-143">Appelez [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) pour récupérer son identificateur d’entrée et définir le paramètre  _lpszMessageClass_ pour qu’il pointe vers une chaîne de caractères identifiant la classe de message.</span><span class="sxs-lookup"><span data-stu-id="2b213-143">Call [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) to retrieve its entry identifier, setting the  _lpszMessageClass_ parameter to point to a character string identifying the message class.</span></span> <span data-ttu-id="2b213-144">Par exemple, si vous souhaitez ouvrir la boîte de réception de votre sous-arbre IPM, pointez  _lpszMessageClass_ vers IPM.</span><span class="sxs-lookup"><span data-stu-id="2b213-144">For example, if you want to open the Inbox for your IPM subtree, point  _lpszMessageClass_ to IPM.</span></span> <span data-ttu-id="2b213-145">Si vous souhaitez ouvrir le dossier de réception pour les messages IPC, définissez-le pour qu’il pointe vers IPC.</span><span class="sxs-lookup"><span data-stu-id="2b213-145">If you want to open the receive folder for IPC messages, set it to point to IPC.</span></span> 

   <span data-ttu-id="2b213-146">S’il n’existe aucun dossier de réception enregistré pour la classe de message, **GetReceiveFolder** choisit le dossier de réception dont la classe de message associée correspond au préfixe le plus long possible de la classe de message transmise.</span><span class="sxs-lookup"><span data-stu-id="2b213-146">If there is no registered receive folder for the message class, **GetReceiveFolder** chooses the receive folder whose associated message class matches the longest possible prefix of the message class passed in.</span></span> <span data-ttu-id="2b213-147">Pour plus d’informations, [voir Dossiers de réception MAPI.](mapi-receive-folders.md)</span><span class="sxs-lookup"><span data-stu-id="2b213-147">For more information, see [MAPI Receive Folders](mapi-receive-folders.md).</span></span> 
   
   <span data-ttu-id="2b213-148">Notez que la **PR_IPM_OUTBOX_ENTRYID** est utilisée pour ouvrir le dossier Boîte d’envoi uniquement pour les messages IPM.</span><span class="sxs-lookup"><span data-stu-id="2b213-148">Note that the **PR_IPM_OUTBOX_ENTRYID** property is used to open the Outbox folder only for IPM messages.</span></span> <span data-ttu-id="2b213-149">Si vous ouvrent la boîte d’envoi pour les messages IPC, utilisez plutôt l’identificateur d’entrée pour son dossier de réception.</span><span class="sxs-lookup"><span data-stu-id="2b213-149">If you are opening the Outbox for IPC messages, use instead the entry identifier for its receive folder.</span></span> <span data-ttu-id="2b213-150">Les messages IPC entrants et sortants sont placés dans le dossier de réception.</span><span class="sxs-lookup"><span data-stu-id="2b213-150">Both incoming and outgoing IPC messages are placed in the receive folder.</span></span> 
    
2. <span data-ttu-id="2b213-151">Appelez l’une des quatre méthodes **OpenEntry** pour ouvrir le dossier et renvoyer un pointeur d’interface que vous pouvez utiliser pour y accéder.</span><span class="sxs-lookup"><span data-stu-id="2b213-151">Call one of four **OpenEntry** methods to open the folder and return an interface pointer that you can use to access it.</span></span> <span data-ttu-id="2b213-152">Vous pouvez appeler l’une des méthodes suivantes pour ouvrir un dossier :</span><span class="sxs-lookup"><span data-stu-id="2b213-152">You can call any one of the following methods to open a folder:</span></span> 
    
   - [<span data-ttu-id="2b213-153">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2b213-153">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
   - [<span data-ttu-id="2b213-154">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2b213-154">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md)
    
   - [<span data-ttu-id="2b213-155">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2b213-155">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md)
    
   - [<span data-ttu-id="2b213-156">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2b213-156">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md)
    
   <span data-ttu-id="2b213-157">La méthode spécifique que vous choisissez dépend du dossier à ouvrir et des objets disponibles à ce moment-là.</span><span class="sxs-lookup"><span data-stu-id="2b213-157">The specific method that you choose depends on the folder to be opened and the objects that are available at the time.</span></span> <span data-ttu-id="2b213-158">Étant donné que la méthode **IMAPISession** peut ouvrir n’importe quel dossier pour n’importe quelle magasine de messages dans le profil actuel, appelez cet **OpenEntry** lorsque vous ne connaissez rien du dossier à ouvrir.</span><span class="sxs-lookup"><span data-stu-id="2b213-158">Because the **IMAPISession** method can open any folder for any message store in the current profile, call this **OpenEntry** when you do not know anything about the folder to be opened.</span></span> <span data-ttu-id="2b213-159">Si vous connaissez la boutique de messages propriétaire du dossier et que vous avez un pointeur vers la boutique de messages, appelez **IMsgStore::OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="2b213-159">If you know which message store owns the folder and you have a pointer to the message store, call **IMsgStore::OpenEntry**.</span></span> 
    
   <span data-ttu-id="2b213-160">Par exemple, utilisez la **méthode IMsgStore** pour ouvrir un dossier de réception.</span><span class="sxs-lookup"><span data-stu-id="2b213-160">For example, use the **IMsgStore** method to open a receive folder.</span></span> <span data-ttu-id="2b213-161">Si vous avez un pointeur vers l’objet d’ouverture de conférence du fournisseur de magasins de messages, appelez **IMSLogon::OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="2b213-161">If you have a pointer to the message store provider's logon object, call **IMSLogon::OpenEntry**.</span></span> <span data-ttu-id="2b213-162">Étant donné que ces appels sont directement envoyés au fournisseur de la boutique de messages plutôt que via MAPI, le traitement est plus rapide.</span><span class="sxs-lookup"><span data-stu-id="2b213-162">Because these calls go directly to the message store provider rather than through MAPI, processing is faster.</span></span> <span data-ttu-id="2b213-163">Si le dossier que vous ouvrez est un sous-dossier d’un dossier que vous avez déjà ouvert, appelez la méthode **IMAPIContainer::OpenEntry** du dossier ouvert.</span><span class="sxs-lookup"><span data-stu-id="2b213-163">If the folder you are opening is a subfolder of a folder that you already have open, call the open folder's **IMAPIContainer::OpenEntry** method.</span></span> <span data-ttu-id="2b213-164">La **méthode IMAPIContainer** ouvre uniquement les sous-dossiers d’un dossier actuellement ouvert et est la seule méthode garantie pour fonctionner avec des identificateurs d’entrée à court terme.</span><span class="sxs-lookup"><span data-stu-id="2b213-164">The **IMAPIContainer** method only opens subfolders of a currently opened folder and is the only method guaranteed to work with short-term entry identifiers.</span></span> 
    
3. <span data-ttu-id="2b213-165">Si vous souhaitez être en mesure d’apporter des modifications au dossier à ouvrir, spécifiez un niveau d’accès en spécifiant l’indicateur MAPI BEST ACCESS ou MAPI MODIFY dans l’appel \_ \_ \_ **OpenEntry.**</span><span class="sxs-lookup"><span data-stu-id="2b213-165">If you want to be able to make changes to the folder to be opened, specify an access level by setting either the MAPI\_BEST\_ACCESS or MAPI\_MODIFY flag in the **OpenEntry** call.</span></span> <span data-ttu-id="2b213-166">Ces indicateurs sont des suggestions au fournisseur de magasin de messages pour accorder le niveau d’accès le plus élevé, pour MAPI BEST ACCESS, ou accès en \_ \_ lecture/écriture, pour MAPI MODIFY, lors de l’ouverture du \_ dossier.</span><span class="sxs-lookup"><span data-stu-id="2b213-166">These flags are suggestions to the message store provider to grant the highest level of access, for MAPI\_BEST\_ACCESS, or read/write access, for MAPI\_MODIFY, when opening the folder.</span></span> 

   <span data-ttu-id="2b213-167">Étant donné que ces indicateurs ne sont que des suggestions, le dossier peut ou non être ouvert avec le niveau d’accès prévu.</span><span class="sxs-lookup"><span data-stu-id="2b213-167">Because these flags are only suggestions, the folder may or may not be opened with the access level you expect.</span></span> <span data-ttu-id="2b213-168">En récupérant la propriété **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)), vous pouvez déterminer la plage d’opérations qui peut être effectuée sur le dossier ouvert.</span><span class="sxs-lookup"><span data-stu-id="2b213-168">By retrieving the **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) property, you can determine the range of operations that can be performed on the open folder.</span></span> 
    
   <span data-ttu-id="2b213-169">Toutefois, étant donné que de nombreux fournisseurs de magasins de messages calculent la valeur de cette propriété à la demande plutôt que de la prendre en charge en tant que propriété de dossier ou en tant que colonne dans leur table hiérarchique, sa récupération peut prendre du temps.</span><span class="sxs-lookup"><span data-stu-id="2b213-169">However, because many message store providers calculate the value for this property on demand rather than supporting it as a folder property or as a column in their hierarchy table, retrieving it can be time-consuming.</span></span> <span data-ttu-id="2b213-170">Une autre stratégie consiste à essayer l’opération que vous devez effectuer et à renvoyer une erreur si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="2b213-170">An alternate strategy is to attempt whatever operation you need to perform and return an error if necessary.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="2b213-171">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2b213-171">See also</span></span>

- [<span data-ttu-id="2b213-172">Propriété canonique PidTagEntryId</span><span class="sxs-lookup"><span data-stu-id="2b213-172">PidTagEntryId Canonical Property</span></span>](pidtagentryid-canonical-property.md) 
- [<span data-ttu-id="2b213-173">IMAPIProp::GetProps</span><span class="sxs-lookup"><span data-stu-id="2b213-173">IMAPIProp::GetProps</span></span>](imapiprop-getprops.md)

