---
title: Profils MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 493c87a4-317d-47ec-850b-342cac59594b
description: Dernière modification le 9 mars 2015
ms.openlocfilehash: 9db1f8e163e44a44df1e798cebccb3639325275e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32340081"
---
# <a name="mapi-profiles"></a><span data-ttu-id="844f2-103">Profils MAPI</span><span class="sxs-lookup"><span data-stu-id="844f2-103">MAPI Profiles</span></span>

  
  
<span data-ttu-id="844f2-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="844f2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="844f2-105">Un profil stocke des informations sur les fournisseurs de services et les services de messagerie installés sur un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="844f2-105">A profile stores information about service providers and message services that are installed on a computer.</span></span> <span data-ttu-id="844f2-106">Pour chaque session, un client au moment de l’ouverture de session sélectionne un profil qui décrit les fournisseurs et services à utiliser.</span><span class="sxs-lookup"><span data-stu-id="844f2-106">For every session, a client at logon time selects one profile that describes the providers and services to be used.</span></span> <span data-ttu-id="844f2-107">Un client peut choisir parmi une collection de profils et, si vous le souhaitez, en établir un par défaut.</span><span class="sxs-lookup"><span data-stu-id="844f2-107">A client can choose from a collection of profiles and, if desired, establish one as the default.</span></span> <span data-ttu-id="844f2-108">Le profil par défaut est le profil qui est sélectionné automatiquement lorsqu’un client démarre une session et n’a pas explicitement spécifié de profil.</span><span class="sxs-lookup"><span data-stu-id="844f2-108">The default profile is the profile that is selected automatically when a client starts a session and has not explicitly specified a profile.</span></span>
  
<span data-ttu-id="844f2-109">Dans ces rubriques, vous trouverez également une discussion sur le cache de surnoms, qui est stocké dans un flux binaire.</span><span class="sxs-lookup"><span data-stu-id="844f2-109">Also in these topics, you will find a discussion of the nickname cache, which is stored in a binary stream.</span></span>
  
- [<span data-ttu-id="844f2-110">Cache de surnoms</span><span class="sxs-lookup"><span data-stu-id="844f2-110">Nickname cache</span></span>](nickname-cache.md)
    
- [<span data-ttu-id="844f2-111">Autocomplete Stream</span><span class="sxs-lookup"><span data-stu-id="844f2-111">Autocomplete Stream</span></span>](autocomplete-stream.md)
    
- [<span data-ttu-id="844f2-112">Binary File Parsing</span><span class="sxs-lookup"><span data-stu-id="844f2-112">Binary File Parsing</span></span>](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
    
## <a name="profile-sections"></a><span data-ttu-id="844f2-113">Sections de profil</span><span class="sxs-lookup"><span data-stu-id="844f2-113">Profile Sections</span></span>

<span data-ttu-id="844f2-114">Les profils sont divisés en sections accessibles aux clients et aux fournisseurs de services pour afficher les propriétés de profil aux utilisateurs ou pour apporter des modifications de configuration.</span><span class="sxs-lookup"><span data-stu-id="844f2-114">Profiles are divided into sections that clients and service providers access to display profile properties to users or to make configuration changes.</span></span> <span data-ttu-id="844f2-115">Une section de profil est un objet MAPI qui implémente l’interface **IProfSect,** une interface qui dérive **d’IMAPIProp** et qui ne possède aucune méthode supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="844f2-115">A profile section is a MAPI object that implements the **IProfSect** interface, an interface that derives from **IMAPIProp** and has no additional methods.</span></span> <span data-ttu-id="844f2-116">Pour plus d’informations, [voir IProfSect : IMAPIProp](iprofsectimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="844f2-116">For more information, see [IProfSect : IMAPIProp](iprofsectimapiprop.md).</span></span> <span data-ttu-id="844f2-117">Son seul objectif est de manipuler les propriétés d’une section de profil.</span><span class="sxs-lookup"><span data-stu-id="844f2-117">Its only purpose is to manipulate the properties of a profile section.</span></span> <span data-ttu-id="844f2-118">Pour récupérer un **pointeur IProfSect** vers une section de profil particulière, les clients et les fournisseurs de services appellent les méthodes suivantes.</span><span class="sxs-lookup"><span data-stu-id="844f2-118">To retrieve an **IProfSect** pointer to a particular profile section, clients and service providers call the following methods.</span></span> 
  
|||
|:-----|:-----|
|<span data-ttu-id="844f2-119">Les clients peuvent appeler :</span><span class="sxs-lookup"><span data-stu-id="844f2-119">Clients can call:</span></span>  <br/> |[<span data-ttu-id="844f2-120">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="844f2-120">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="844f2-121">Les fournisseurs de services peuvent appeler :</span><span class="sxs-lookup"><span data-stu-id="844f2-121">Service providers can call:</span></span>  <br/> |[<span data-ttu-id="844f2-122">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="844f2-122">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md) <br/> |
|<span data-ttu-id="844f2-123">Les clients ou fournisseurs peuvent appeler :</span><span class="sxs-lookup"><span data-stu-id="844f2-123">Either clients or providers can call:</span></span>  <br/> |[<span data-ttu-id="844f2-124">IProviderAdmin::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="844f2-124">IProviderAdmin::OpenProfileSection</span></span>](iprovideradmin-openprofilesection.md) <br/> |
   
<span data-ttu-id="844f2-125">Les profils sont organisés hiérarchiquement de la même manière que MAPISVC. Fichier INF.</span><span class="sxs-lookup"><span data-stu-id="844f2-125">Profiles are organized hierarchically much like the MAPISVC.INF file.</span></span> <span data-ttu-id="844f2-126">En haut de la hiérarchie, il existe des sections de profil qui contiennent des informations pertinentes pour le profil.</span><span class="sxs-lookup"><span data-stu-id="844f2-126">At the top of the hierarchy, there are profile sections that contain information relevant to the profile.</span></span> <span data-ttu-id="844f2-127">Le niveau intermédiaire inclut des sections qui contiennent des informations sur un service de messagerie particulier et le niveau inférieur comprend des sections qui contiennent des informations sur l’un des fournisseurs de services dans un service de messagerie.</span><span class="sxs-lookup"><span data-stu-id="844f2-127">The middle level includes sections that contain information about a particular message service and the lower level includes sections that contain information about one of the service providers in a message service.</span></span> 
  
<span data-ttu-id="844f2-128">Chaque profil possède plusieurs propriétés requises qui sont stockées dans une ou plusieurs sections du profil.</span><span class="sxs-lookup"><span data-stu-id="844f2-128">Every profile has several required properties that are stored in one or more of the sections of the profile.</span></span> <span data-ttu-id="844f2-129">Par exemple, chaque profil possède les propriétés **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) et **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="844f2-129">For example, every profile has the **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) and **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) properties.</span></span> <span data-ttu-id="844f2-130">La clé de recherche d’un profil est définie sur la valeur définie dans MAPIGUID. H comme MUID_PROFILE_INSTANCE et est toujours garanti d’être unique parmi tous les profils.</span><span class="sxs-lookup"><span data-stu-id="844f2-130">A profile's search key is set to the value defined in MAPIGUID.H as MUID_PROFILE_INSTANCE and is always guaranteed to be unique among all profiles.</span></span> <span data-ttu-id="844f2-131">Bien que deux profils peuvent avoir le même nom, ils ne peuvent pas avoir la même clé de recherche.</span><span class="sxs-lookup"><span data-stu-id="844f2-131">Although two profiles can have the same name, they cannot have the same search key.</span></span> <span data-ttu-id="844f2-132">Les clés de recherche doivent être traitées comme des données binaires au lieu de données de n’importe quel type particulier.</span><span class="sxs-lookup"><span data-stu-id="844f2-132">Search keys should be treated as binary data instead of data of any particular type.</span></span>
  
<span data-ttu-id="844f2-133">Les fournisseurs de magasins de messages doivent inclure la propriété **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) de leur magasin de messages dans les sections de profil du profil et de leur fournisseur de magasin de messages, et pour maintenir la synchronisation de ces entrées.</span><span class="sxs-lookup"><span data-stu-id="844f2-133">Message store providers are required to include their message store's **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property in the profile sections for the profile and for their message store provider and to keep these entries synchronized.</span></span> <span data-ttu-id="844f2-134">Lorsqu’une magasin de messages  est créée, le fournisseur PR_DISPLAY_NAME en fonction de la valeur stockée dans ces sections de profil.</span><span class="sxs-lookup"><span data-stu-id="844f2-134">When a message store is created, the provider sets **PR_DISPLAY_NAME** based on the value stored in these profile sections.</span></span> 
  
<span data-ttu-id="844f2-135">Il existe deux différences majeures entre les sections de profil et les autres objets qui héritent **d’IMAPIProp**:</span><span class="sxs-lookup"><span data-stu-id="844f2-135">There are two major differences between profile sections and other objects that inherit from **IMAPIProp**:</span></span> 
  
- <span data-ttu-id="844f2-136">Les sections de profil ne supportent pas les transactions.</span><span class="sxs-lookup"><span data-stu-id="844f2-136">Profile sections do not support transactions.</span></span>
    
- <span data-ttu-id="844f2-137">Les sections de profil ne prisent pas en charge les propriétés nommées, renvoyant des MAPI_E_NO_SUPPORT à partir de leurs implémentations **IMAPIProp::GetIDsFromNames** et **IMAPIProp::GetNamesFromIDs.**</span><span class="sxs-lookup"><span data-stu-id="844f2-137">Profile sections do not support named properties, returning MAPI_E_NO_SUPPORT from their **IMAPIProp::GetIDsFromNames** and **IMAPIProp::GetNamesFromIDs** implementations.</span></span> <span data-ttu-id="844f2-138">Pour plus d’informations, voir [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) et [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span><span class="sxs-lookup"><span data-stu-id="844f2-138">For more information, see [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) and [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span></span>
    
<span data-ttu-id="844f2-139">Étant donné que les sections de profil ne prennent pas en charge les transactions, les modifications apportées avec les appels à **IMAPIProp::CopyProps,** **CopyTo** ou **SetProps** prennent immédiatement effet.</span><span class="sxs-lookup"><span data-stu-id="844f2-139">Because profile sections do not support transactions, any changes made with calls to **IMAPIProp::CopyProps**, **CopyTo**, or **SetProps** immediately take effect.</span></span> <span data-ttu-id="844f2-140">Pour plus d’informations, [voir IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="844f2-140">For more information, see [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span> <span data-ttu-id="844f2-141">Les clients et les fournisseurs de services peuvent appeler la méthode **IMAPIProp::SaveChanges** d’une section de profil et réussir, mais cela n’affecte pas les données de section de profil.</span><span class="sxs-lookup"><span data-stu-id="844f2-141">Clients and service providers can call a profile section's **IMAPIProp::SaveChanges** method and it will succeed, but it does not affect the profile section data.</span></span> <span data-ttu-id="844f2-142">Pour plus d’informations, [voir IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span><span class="sxs-lookup"><span data-stu-id="844f2-142">For more information, see [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span></span> <span data-ttu-id="844f2-143">Les modifications apportées immédiatement peuvent affecter la façon dont les fournisseurs de services implémentent les feuilles de propriétés que les clients utilisent pour afficher les propriétés de profil pour les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="844f2-143">Having changes occur immediately can affect how service providers implement the property sheets that clients use to display profile properties to users.</span></span> <span data-ttu-id="844f2-144">Les fournisseurs de services qui souhaitent que les utilisateurs puissent reporter ou annuler les modifications doivent implémenter leurs feuilles de propriétés avec des copies des sections de profil au lieu des sections réelles.</span><span class="sxs-lookup"><span data-stu-id="844f2-144">Service providers that want users to be able to postpone or undo changes must implement their property sheets with copies of profile sections instead of the real sections.</span></span> <span data-ttu-id="844f2-145">À l’aide de copies, les utilisateurs peuvent apporter des modifications, puis les annuler ultérieurement, sans modifier les sections de profil d’origine.</span><span class="sxs-lookup"><span data-stu-id="844f2-145">By using copies, users can make changes and then later cancel those changes, leaving the original profile sections untouched.</span></span> 
  
<span data-ttu-id="844f2-146">L’ordre dans lequel les informations apparaissent dans un profil affecte la façon dont MAPI configure les ressources et effectue des affectations dans une session.</span><span class="sxs-lookup"><span data-stu-id="844f2-146">The order in which information appears in a profile affects how MAPI configures resources and makes assignments in a session.</span></span> <span data-ttu-id="844f2-147">Les affectations suivantes sont affectées par l’ordre de profil :</span><span class="sxs-lookup"><span data-stu-id="844f2-147">The following assignments are affected by profile order:</span></span>
  
- <span data-ttu-id="844f2-148">Magasin de messages par défaut</span><span class="sxs-lookup"><span data-stu-id="844f2-148">Default message store</span></span>
    
- <span data-ttu-id="844f2-149">Carnet d’adresses personnel</span><span class="sxs-lookup"><span data-stu-id="844f2-149">Personal address book</span></span>
    
- <span data-ttu-id="844f2-150">Chemin de recherche de la boutique de messages par défaut</span><span class="sxs-lookup"><span data-stu-id="844f2-150">Default message store search path</span></span>
    
- <span data-ttu-id="844f2-151">Chemin de recherche de carnet d’adresses par défaut</span><span class="sxs-lookup"><span data-stu-id="844f2-151">Default address book search path</span></span>
    
- <span data-ttu-id="844f2-152">Commande du fournisseur de transport</span><span class="sxs-lookup"><span data-stu-id="844f2-152">Transport provider order</span></span>
    
<span data-ttu-id="844f2-153">MAPI définit la magasin de messages par défaut comme la première magasin de messages dans le profil dont l’indicateur STATUS_DEFAULT_STORE est définie dans sa propriété **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)), ce qui indique qu’il peut s’agit de la boutique par défaut.</span><span class="sxs-lookup"><span data-stu-id="844f2-153">MAPI sets the default message store to be the first message store in the profile that has the STATUS_DEFAULT_STORE flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property, which indicates that it can be the default store.</span></span> <span data-ttu-id="844f2-154">Les clients peuvent remplacer ce paramètre en appelant **IMAPISession::SetDefaultStore**.</span><span class="sxs-lookup"><span data-stu-id="844f2-154">Clients can override this setting by calling **IMAPISession::SetDefaultStore**.</span></span> <span data-ttu-id="844f2-155">Pour plus d’informations, [voir IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span><span class="sxs-lookup"><span data-stu-id="844f2-155">For more information, see [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span></span>
  
<span data-ttu-id="844f2-156">MAPI crée un ordre de transport pour la gestion des messages sortants et entrants.</span><span class="sxs-lookup"><span data-stu-id="844f2-156">MAPI creates a transport order for handling outgoing and incoming messages.</span></span> <span data-ttu-id="844f2-157">Lorsque plusieurs fournisseurs de transport se sont inscrits pour un message d’un type particulier, MAPI utilise cet ordre pour déterminer quel fournisseur doit gérer le message.</span><span class="sxs-lookup"><span data-stu-id="844f2-157">When more than one transport provider has registered for a message of a particular type, MAPI uses this order to determine which provider should handle the message.</span></span> <span data-ttu-id="844f2-158">MAPI définit l’ordre de transport comme l’ordre dans lequel les fournisseurs de transport ont été ajoutés au profil à une exception près : les transports qui définissent l’indicateur STATUS_XP_PREFER_LAST dans leur propriété **PR_RESOURCE_FLAGS** sont positionnés en dernier dans l’ordre.</span><span class="sxs-lookup"><span data-stu-id="844f2-158">MAPI sets the transport order to be the order in which the transport providers were added to the profile with one exception--the transports that set the STATUS_XP_PREFER_LAST flag in their **PR_RESOURCE_FLAGS** property are positioned last in the order.</span></span> <span data-ttu-id="844f2-159">Les clients peuvent définir l’ordre de transport en appelant **IMsgServiceAdmin::MsgServiceTransportOrder**.</span><span class="sxs-lookup"><span data-stu-id="844f2-159">Clients can set the transport order by calling **IMsgServiceAdmin::MsgServiceTransportOrder**.</span></span> <span data-ttu-id="844f2-160">Pour plus d’informations, [voir IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span><span class="sxs-lookup"><span data-stu-id="844f2-160">For more information, see [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span></span>
  
<span data-ttu-id="844f2-161">Ces instructions relatives à l’ordre des fournisseurs de services et des services de messagerie peuvent parfois être en conflit.</span><span class="sxs-lookup"><span data-stu-id="844f2-161">These guidelines for ordering service providers and message services might sometimes conflict.</span></span> <span data-ttu-id="844f2-162">En cas de conflit, votre code doit résoudre le conflit.</span><span class="sxs-lookup"><span data-stu-id="844f2-162">If there is a conflict, your code should resolve the conflict.</span></span> <span data-ttu-id="844f2-163">Vous pouvez utiliser le programme panneau de configuration du courrier électronique pour inspecter un profil que vous avez créé afin de déterminer si les fournisseurs ont été configurés comme prévu.</span><span class="sxs-lookup"><span data-stu-id="844f2-163">You can use the Mail Control Panel program to inspect a profile that you have created to determine whether the providers have been configured as expected.</span></span>
  

