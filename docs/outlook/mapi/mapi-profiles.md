---
title: Profils MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 493c87a4-317d-47ec-850b-342cac59594b
description: 'Derni�re modification�: lundi 9 mars 2015'
ms.openlocfilehash: 7f241fde8aedeae9debc66f728ee21c1c6bed6fb
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19784663"
---
# <a name="mapi-profiles"></a><span data-ttu-id="5a28d-103">Profils MAPI</span><span class="sxs-lookup"><span data-stu-id="5a28d-103">MAPI Profiles</span></span>

  
  
<span data-ttu-id="5a28d-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="5a28d-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="5a28d-105">Un profil stocke des informations sur les fournisseurs de services et les services de messagerie qui sont installés sur un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="5a28d-105">A profile stores information about service providers and message services that are installed on a computer.</span></span> <span data-ttu-id="5a28d-106">Pour chaque session, un client au moment de l’ouverture de session sélectionne un seul profil qui décrit les fournisseurs et les services à utiliser.</span><span class="sxs-lookup"><span data-stu-id="5a28d-106">For every session, a client at logon time selects one profile that describes the providers and services to be used.</span></span> <span data-ttu-id="5a28d-107">Un client peut choisir d’une collection de profils et, si vous le souhaitez, établir un en tant que la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="5a28d-107">A client can choose from a collection of profiles and, if desired, establish one as the default.</span></span> <span data-ttu-id="5a28d-108">Le profil par défaut est le profil qui est sélectionné automatiquement lorsqu’un client démarre une session et un profil n’a pas explicitement spécifié.</span><span class="sxs-lookup"><span data-stu-id="5a28d-108">The default profile is the profile that is selected automatically when a client starts a session and has not explicitly specified a profile.</span></span>
  
<span data-ttu-id="5a28d-109">Dans ces rubriques, vous trouverez également une discussion sur le cache du surnom, qui est stocké dans un objet stream binaire.</span><span class="sxs-lookup"><span data-stu-id="5a28d-109">Also in these topics, you will find a discussion of the nickname cache, which is stored in a binary stream.</span></span>
  
- [<span data-ttu-id="5a28d-110">Cache du surnom dans</span><span class="sxs-lookup"><span data-stu-id="5a28d-110">Nickname cache</span></span>](nickname-cache.md)
    
- [<span data-ttu-id="5a28d-111">Flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="5a28d-111">Autocomplete Stream</span></span>](autocomplete-stream.md)
    
- [<span data-ttu-id="5a28d-112">L’analyse des fichiers binaires</span><span class="sxs-lookup"><span data-stu-id="5a28d-112">Binary File Parsing</span></span>](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
    
## <a name="profile-sections"></a><span data-ttu-id="5a28d-113">Sections de profil</span><span class="sxs-lookup"><span data-stu-id="5a28d-113">Profile Sections</span></span>

<span data-ttu-id="5a28d-114">Profils sont divisées en sections que les clients et fournisseurs de services accéder pour afficher les propriétés de profil pour les utilisateurs ou pour apporter des modifications de configuration.</span><span class="sxs-lookup"><span data-stu-id="5a28d-114">Profiles are divided into sections that clients and service providers access to display profile properties to users or to make configuration changes.</span></span> <span data-ttu-id="5a28d-115">Une section de profil est un objet MAPI qui implémente l’interface **IProfSect** , une interface qui dérive de **IMAPIProp** et possède pas de méthodes supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="5a28d-115">A profile section is a MAPI object that implements the **IProfSect** interface, an interface that derives from **IMAPIProp** and has no additional methods.</span></span> <span data-ttu-id="5a28d-116">Pour plus d’informations, voir [IProfSect : IMAPIProp](iprofsectimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="5a28d-116">For more information, see [IProfSect : IMAPIProp](iprofsectimapiprop.md).</span></span> <span data-ttu-id="5a28d-117">Son seul but est pour manipuler les propriétés d’une section de profil.</span><span class="sxs-lookup"><span data-stu-id="5a28d-117">Its only purpose is to manipulate the properties of a profile section.</span></span> <span data-ttu-id="5a28d-118">Pour récupérer un pointeur **IProfSect** à une section de profil particulier, clients et fournisseurs de services appeler les méthodes suivantes.</span><span class="sxs-lookup"><span data-stu-id="5a28d-118">To retrieve an **IProfSect** pointer to a particular profile section, clients and service providers call the following methods.</span></span> 
  
|||
|:-----|:-----|
|<span data-ttu-id="5a28d-119">Les clients peuvent appeler :</span><span class="sxs-lookup"><span data-stu-id="5a28d-119">Clients can call:</span></span>  <br/> |[<span data-ttu-id="5a28d-120">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="5a28d-120">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="5a28d-121">Fournisseurs de services peuvent appeler :</span><span class="sxs-lookup"><span data-stu-id="5a28d-121">Service providers can call:</span></span>  <br/> |[<span data-ttu-id="5a28d-122">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="5a28d-122">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md) <br/> |
|<span data-ttu-id="5a28d-123">Clients ou fournisseurs peuvent appeler :</span><span class="sxs-lookup"><span data-stu-id="5a28d-123">Either clients or providers can call:</span></span>  <br/> |[<span data-ttu-id="5a28d-124">IProviderAdmin::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="5a28d-124">IProviderAdmin::OpenProfileSection</span></span>](iprovideradmin-openprofilesection.md) <br/> |
   
<span data-ttu-id="5a28d-125">Profils sont organisées de façon hiérarchique beaucoup comme le fichier MAPISVC.inf. Fichier.</span><span class="sxs-lookup"><span data-stu-id="5a28d-125">Profiles are organized hierarchically much like the MAPISVC.INF file.</span></span> <span data-ttu-id="5a28d-126">En haut de la hiérarchie, il existe des sections de profil qui contiennent des informations relatives au profil.</span><span class="sxs-lookup"><span data-stu-id="5a28d-126">At the top of the hierarchy, there are profile sections that contain information relevant to the profile.</span></span> <span data-ttu-id="5a28d-127">Le niveau intermédiaire comporte des sections qui contiennent des informations sur un service particulier de message et le niveau inférieur comporte des sections qui contiennent des informations sur un des fournisseurs de services dans un service de message.</span><span class="sxs-lookup"><span data-stu-id="5a28d-127">The middle level includes sections that contain information about a particular message service and the lower level includes sections that contain information about one of the service providers in a message service.</span></span> 
  
<span data-ttu-id="5a28d-128">Chaque profil possède plusieurs propriétés requises qui sont stockées dans un ou plusieurs des sections du profil.</span><span class="sxs-lookup"><span data-stu-id="5a28d-128">Every profile has several required properties that are stored in one or more of the sections of the profile.</span></span> <span data-ttu-id="5a28d-129">Par exemple, chaque profil a les **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) et les propriétés de **clé PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="5a28d-129">For example, every profile has the **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) and **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) properties.</span></span> <span data-ttu-id="5a28d-130">Clé de recherche d’un profil est définie sur la valeur définie dans MAPIGUID. H en tant que MUID_PROFILE_INSTANCE et est toujours unique parmi tous les profils.</span><span class="sxs-lookup"><span data-stu-id="5a28d-130">A profile's search key is set to the value defined in MAPIGUID.H as MUID_PROFILE_INSTANCE and is always guaranteed to be unique among all profiles.</span></span> <span data-ttu-id="5a28d-131">Bien que deux profils peuvent avoir le même nom, ils ne peuvent pas avoir la même clé de recherche.</span><span class="sxs-lookup"><span data-stu-id="5a28d-131">Although two profiles can have the same name, they cannot have the same search key.</span></span> <span data-ttu-id="5a28d-132">Clés de recherche doivent être traitées en tant que données binaires plutôt que des données d’un type particulier.</span><span class="sxs-lookup"><span data-stu-id="5a28d-132">Search keys should be treated as binary data instead of data of any particular type.</span></span>
  
<span data-ttu-id="5a28d-133">Fournisseurs de magasins de message sont requis pour inclure leur propriété **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) du message dans les sections de profil pour le profil et pour leur message fournisseur de magasins et de garder ces entrées synchronisées.</span><span class="sxs-lookup"><span data-stu-id="5a28d-133">Message store providers are required to include their message store's **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property in the profile sections for the profile and for their message store provider and to keep these entries synchronized.</span></span> <span data-ttu-id="5a28d-134">Lors de la création d’une banque de messages, le fournisseur définit **PR_DISPLAY_NAME** en fonction de la valeur stockée dans ces sections du profil.</span><span class="sxs-lookup"><span data-stu-id="5a28d-134">When a message store is created, the provider sets **PR_DISPLAY_NAME** based on the value stored in these profile sections.</span></span> 
  
<span data-ttu-id="5a28d-135">Il existe deux principales différences entre les sections de profil et d’autres objets qui héritent de **IMAPIProp**:</span><span class="sxs-lookup"><span data-stu-id="5a28d-135">There are two major differences between profile sections and other objects that inherit from **IMAPIProp**:</span></span> 
  
- <span data-ttu-id="5a28d-136">Sections profil ne prennent pas en charge transactions.</span><span class="sxs-lookup"><span data-stu-id="5a28d-136">Profile sections do not support transactions.</span></span>
    
- <span data-ttu-id="5a28d-137">Sections profil n’acceptent pas les propriétés nommées, renvoi MAPI_E_NO_SUPPORT à partir de leurs implémentations **IMAPIProp::GetIDsFromNames** et **IMAPIProp::GetNamesFromIDs** .</span><span class="sxs-lookup"><span data-stu-id="5a28d-137">Profile sections do not support named properties, returning MAPI_E_NO_SUPPORT from their **IMAPIProp::GetIDsFromNames** and **IMAPIProp::GetNamesFromIDs** implementations.</span></span> <span data-ttu-id="5a28d-138">Pour plus d’informations, voir [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) et [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span><span class="sxs-lookup"><span data-stu-id="5a28d-138">For more information, see [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) and [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span></span>
    
<span data-ttu-id="5a28d-139">Étant donné que les sections de profil ne prennent pas en charge les transactions, toutes les modifications apportées par des appels à **IMAPIProp::CopyProps**, **CopyTo**ou **SetProps** immédiatement prennent effet.</span><span class="sxs-lookup"><span data-stu-id="5a28d-139">Because profile sections do not support transactions, any changes made with calls to **IMAPIProp::CopyProps**, **CopyTo**, or **SetProps** immediately take effect.</span></span> <span data-ttu-id="5a28d-140">Pour plus d’informations, voir [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="5a28d-140">For more information, see [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span> <span data-ttu-id="5a28d-141">Clients et fournisseurs de services peuvent appeler la méthode de **IMAPIProp::SaveChanges** d’une section de profil et réussit, mais elle n’affecte pas les données de la section profil.</span><span class="sxs-lookup"><span data-stu-id="5a28d-141">Clients and service providers can call a profile section's **IMAPIProp::SaveChanges** method and it will succeed, but it does not affect the profile section data.</span></span> <span data-ttu-id="5a28d-142">Pour plus d’informations, voir [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span><span class="sxs-lookup"><span data-stu-id="5a28d-142">For more information, see [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span></span> <span data-ttu-id="5a28d-143">Avoir des modifications se produisent immédiatement peut affecter les comment les fournisseurs de services implémentent les feuilles de propriétés que les clients utilisent pour afficher les propriétés de profil aux utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="5a28d-143">Having changes occur immediately can affect how service providers implement the property sheets that clients use to display profile properties to users.</span></span> <span data-ttu-id="5a28d-144">Fournisseurs de services que vous souhaitez que les utilisateurs puissent différer ou annuler les modifications doivent implémenter leurs feuilles de propriété avec les copies des sections de profil au lieu des sections réelles.</span><span class="sxs-lookup"><span data-stu-id="5a28d-144">Service providers that want users to be able to postpone or undo changes must implement their property sheets with copies of profile sections instead of the real sections.</span></span> <span data-ttu-id="5a28d-145">À l’aide de copies, les utilisateurs peuvent apporter des modifications et puis ultérieurement Annuler les modifications, en laissant les sections de profil d’origine intacts.</span><span class="sxs-lookup"><span data-stu-id="5a28d-145">By using copies, users can make changes and then later cancel those changes, leaving the original profile sections untouched.</span></span> 
  
<span data-ttu-id="5a28d-146">L’ordre dans lequel les informations apparaissent dans un profil affecte comment MAPI configure les ressources et effectue des affectations dans une session.</span><span class="sxs-lookup"><span data-stu-id="5a28d-146">The order in which information appears in a profile affects how MAPI configures resources and makes assignments in a session.</span></span> <span data-ttu-id="5a28d-147">Les affectations suivantes sont affectées par ordre de profil :</span><span class="sxs-lookup"><span data-stu-id="5a28d-147">The following assignments are affected by profile order:</span></span>
  
- <span data-ttu-id="5a28d-148">Banque de messages par défaut</span><span class="sxs-lookup"><span data-stu-id="5a28d-148">Default message store</span></span>
    
- <span data-ttu-id="5a28d-149">Carnet d’adresses personnel</span><span class="sxs-lookup"><span data-stu-id="5a28d-149">Personal address book</span></span>
    
- <span data-ttu-id="5a28d-150">Chemin de recherche de magasin de message par défaut</span><span class="sxs-lookup"><span data-stu-id="5a28d-150">Default message store search path</span></span>
    
- <span data-ttu-id="5a28d-151">Chemin de recherche de livre adresse par défaut</span><span class="sxs-lookup"><span data-stu-id="5a28d-151">Default address book search path</span></span>
    
- <span data-ttu-id="5a28d-152">Ordre des fournisseurs de transport</span><span class="sxs-lookup"><span data-stu-id="5a28d-152">Transport provider order</span></span>
    
<span data-ttu-id="5a28d-153">MAPI définit la banque de messages par défaut à la première banque de messages dans le profil de l’indicateur STATUS_DEFAULT_STORE dans sa propriété **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)), ce qui indique qu’il peut être la banque par défaut.</span><span class="sxs-lookup"><span data-stu-id="5a28d-153">MAPI sets the default message store to be the first message store in the profile that has the STATUS_DEFAULT_STORE flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property, which indicates that it can be the default store.</span></span> <span data-ttu-id="5a28d-154">Les clients peuvent remplacer ce paramètre en appelant **IMAPISession::SetDefaultStore**.</span><span class="sxs-lookup"><span data-stu-id="5a28d-154">Clients can override this setting by calling **IMAPISession::SetDefaultStore**.</span></span> <span data-ttu-id="5a28d-155">Pour plus d’informations, voir [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span><span class="sxs-lookup"><span data-stu-id="5a28d-155">For more information, see [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span></span>
  
<span data-ttu-id="5a28d-156">MAPI crée un ordre de transport pour la gestion des messages entrants et sortants.</span><span class="sxs-lookup"><span data-stu-id="5a28d-156">MAPI creates a transport order for handling outgoing and incoming messages.</span></span> <span data-ttu-id="5a28d-157">Lorsque plusieurs fournisseurs de transport a inscrit pour un message d’un type particulier, MAPI utilise cette commande pour déterminer le fournisseur doit traiter le message.</span><span class="sxs-lookup"><span data-stu-id="5a28d-157">When more than one transport provider has registered for a message of a particular type, MAPI uses this order to determine which provider should handle the message.</span></span> <span data-ttu-id="5a28d-158">MAPI définit l’ordre de transport à l’ordre dans lequel le transport fournisseurs ont été ajoutés au profil à une seule exception : les transports de définir l’indicateur STATUS_XP_PREFER_LAST dans leur propriété **PR_RESOURCE_FLAGS** sont positionnés en dernier dans l’ordre.</span><span class="sxs-lookup"><span data-stu-id="5a28d-158">MAPI sets the transport order to be the order in which the transport providers were added to the profile with one exception--the transports that set the STATUS_XP_PREFER_LAST flag in their **PR_RESOURCE_FLAGS** property are positioned last in the order.</span></span> <span data-ttu-id="5a28d-159">Les clients peuvent définir l’ordre de transport en appelant **IMsgServiceAdmin::MsgServiceTransportOrder**.</span><span class="sxs-lookup"><span data-stu-id="5a28d-159">Clients can set the transport order by calling **IMsgServiceAdmin::MsgServiceTransportOrder**.</span></span> <span data-ttu-id="5a28d-160">Pour plus d’informations, voir [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span><span class="sxs-lookup"><span data-stu-id="5a28d-160">For more information, see [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span></span>
  
<span data-ttu-id="5a28d-161">Ces instructions pour le classement des fournisseurs de services et les services de messagerie peuvent parfois entrer en conflit.</span><span class="sxs-lookup"><span data-stu-id="5a28d-161">These guidelines for ordering service providers and message services might sometimes conflict.</span></span> <span data-ttu-id="5a28d-162">S’il existe un conflit, votre code doit résoudre le conflit.</span><span class="sxs-lookup"><span data-stu-id="5a28d-162">If there is a conflict, your code should resolve the conflict.</span></span> <span data-ttu-id="5a28d-163">Vous pouvez utiliser le programme de messagerie le panneau de configuration pour inspecter un profil que vous avez créée pour déterminer si les fournisseurs ont été configurés comme prévu.</span><span class="sxs-lookup"><span data-stu-id="5a28d-163">You can use the Mail Control Panel program to inspect a profile that you have created to determine whether the providers have been configured as expected.</span></span>
  

