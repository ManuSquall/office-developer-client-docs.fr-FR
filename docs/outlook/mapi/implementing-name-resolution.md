---
title: Mise en œuvre de la résolution de noms
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a4c71b08-c47a-4421-8603-d5356d32dca9
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 15c1d502947865c02973f4950b6b6fa8109b8e78
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33434703"
---
# <a name="implementing-name-resolution"></a><span data-ttu-id="3a9d6-103">Mise en œuvre de la résolution de noms</span><span class="sxs-lookup"><span data-stu-id="3a9d6-103">Implementing Name Resolution</span></span>

  
  
<span data-ttu-id="3a9d6-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3a9d6-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3a9d6-105">Les fournisseurs de carnets d’adresses sont responsables de la prise en charge de la résolution de noms , c’est-à-dire le processus d’association d’un identificateur d’entrée à un nom complet.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-105">Address book providers are responsible for supporting name resolution — the process of associating an entry identifier with a display name.</span></span> <span data-ttu-id="3a9d6-106">Les clients lancent la résolution de noms lorsqu’ils appellent [IAddrBook::ResolveName](iaddrbook-resolvename.md) pour s’assurer que chaque membre de la liste des destinataires d’un message sortant correspond à une adresse valide.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-106">Clients initiate name resolution when they call [IAddrBook::ResolveName](iaddrbook-resolvename.md) to ensure that each member of an outgoing message's recipient list corresponds to a valid address.</span></span> 
  
<span data-ttu-id="3a9d6-107">Votre fournisseur peut prendre en charge la résolution de noms en :</span><span class="sxs-lookup"><span data-stu-id="3a9d6-107">Your provider can support name resolution by:</span></span>
  
- <span data-ttu-id="3a9d6-108">Prise en **charge PR_ANR** restriction de propriété ([PidTagAnr](pidtaganr-canonical-property.md)), une condition requise pour tous les conteneurs de carnet d’adresses.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-108">Supporting the **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)) property restriction, a requirement for all address book containers.</span></span>
    
- <span data-ttu-id="3a9d6-109">Mise en œuvre [de la méthode IABContainer::ResolveNames,](iabcontainer-resolvenames.md) une option pour tous les conteneurs de carnet d’adresses.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-109">Implementing the [IABContainer::ResolveNames](iabcontainer-resolvenames.md) method, an option for all address book containers.</span></span> 
    
<span data-ttu-id="3a9d6-110">Si vous choisissez de prendre en charge **IABContainer::ResolveNames,** essayez de rechercher une correspondance exacte pour chaque nom complet non résolu dans la structure [ADRLIST](adrlist.md) transmise avec le paramètre _lpAdrList._</span><span class="sxs-lookup"><span data-stu-id="3a9d6-110">If you choose to support **IABContainer::ResolveNames**, attempt to locate an exact match for each unresolved display name in the [ADRLIST](adrlist.md) structure passed in with the  _lpAdrList_ parameter.</span></span> <span data-ttu-id="3a9d6-111">Vous pouvez identifier un nom complet non résolu car il manque la propriété **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) dans le tableau de valeurs de propriété dans son membre **aEntries** de la structure **ADRLIST.**</span><span class="sxs-lookup"><span data-stu-id="3a9d6-111">You can identifiy an unresolved display name because it is missing the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property in the property value array in its **aEntries** member of the **ADRLIST** structure.</span></span> <span data-ttu-id="3a9d6-112">Ignorez les entrées qui ne sont associées à aucune propriété.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-112">Ignore any entries that have zero properties associated with them.</span></span> 
  
<span data-ttu-id="3a9d6-113">Signalez le résultat de votre tentative de résolution dans le paramètre  _lpFlagList,_ un tableau d’indicateurs qui correspond au tableau de noms complets dans  _lpAdrList_.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-113">Report the result of your attempt at resolution in the  _lpFlagList_ parameter, an array of flags that corresponds to the array of display names in  _lpAdrList_.</span></span> <span data-ttu-id="3a9d6-114">Les indicateurs sont positionnels de telle sorte que le premier indicateur corresponde au premier membre **aEntries** dans la structure **ADRLIST,** le deuxième indicateur correspond au deuxième membre **aEntries,** etc.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-114">The flags are positional such that the first flag corresponds to the first **aEntries** member in the **ADRLIST** structure, the second flag corresponds to the second **aEntries** member, and so on.</span></span> 
  
<span data-ttu-id="3a9d6-115">Il existe trois résultats possibles pour chaque entrée non résolue :</span><span class="sxs-lookup"><span data-stu-id="3a9d6-115">There are three possible results for each unresolved entry:</span></span>
  
- <span data-ttu-id="3a9d6-116">Aucune correspondance n’a été trouvée, ce qui signifie qu’aucune des entrées de votre conteneur ne correspond à l’entrée dans la structure **ADRLIST.**</span><span class="sxs-lookup"><span data-stu-id="3a9d6-116">No match was found, meaning that none of the entries in your container entries match the entry in the **ADRLIST** structure.</span></span> <span data-ttu-id="3a9d6-117">Définissez l’entrée correspondante dans  _le paramètre lpFlagList_ sur MAPI_UNRESOLVED.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-117">Set the corresponding entry in the  _lpFlagList_ parameter to MAPI_UNRESOLVED.</span></span> 
    
- <span data-ttu-id="3a9d6-118">Plusieurs correspondances sont trouvées, ce qui signifie qu’il existe plusieurs entrées de conteneur qui correspondent à l’entrée dans la structure **ADRLIST.**</span><span class="sxs-lookup"><span data-stu-id="3a9d6-118">Several matches can be found, meaning that there are multiple container entries that match the entry in the **ADRLIST** structure.</span></span> <span data-ttu-id="3a9d6-119">Définissez l’entrée correspondante dans  _le paramètre lpFlagList_ sur MAPI_AMBIGUOUS.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-119">Set the corresponding entry in the  _lpFlagList_ parameter to MAPI_AMBIGUOUS.</span></span> <span data-ttu-id="3a9d6-120">Ne modifiez pas le nombre d’entrées dans la structure **ADRLIST.**</span><span class="sxs-lookup"><span data-stu-id="3a9d6-120">Do not change the number of entries in the **ADRLIST** structure.</span></span> 
    
- <span data-ttu-id="3a9d6-121">Une correspondance exacte est trouvée, ce qui signifie qu’il n’existe qu’une seule entrée de conteneur qui correspond à l’entrée dans la structure **ADRLIST.**</span><span class="sxs-lookup"><span data-stu-id="3a9d6-121">An exact match can be found, meaning that there is only one container entry that matches the entry in the **ADRLIST** structure.</span></span> <span data-ttu-id="3a9d6-122">Définissez le membre correspondant dans le paramètre _lpFlagList_ sur MAPI_RESOLVED et ajoutez l’identificateur d’entrée au tableau des propriétés associées à l’entrée **ADRLIST.**</span><span class="sxs-lookup"><span data-stu-id="3a9d6-122">Set the corresponding member in the  _lpFlagList_ parameter to MAPI_RESOLVED and add the entry identifier to the array of properties associated with the **ADRLIST** entry.</span></span> 
    
<span data-ttu-id="3a9d6-123">Si vous choisissez de ne pas prendre en charge **IABContainer::ResolveNames,** renvoyez MAPI_E_NO_SUPPORT à partir de votre implémentation.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-123">If you choose not to support **IABContainer::ResolveNames**, return MAPI_E_NO_SUPPORT from your implementation.</span></span>
  
<span data-ttu-id="3a9d6-124">Tous les fournisseurs de carnet d’adresses sont tenus de prendre en charge la résolution de noms **ambigus (restriction PR_ANR** propriété) sur les tables de contenu de leurs conteneurs.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-124">All address book providers are required to support ambiguous name resolution — the **PR_ANR** property restriction — on their containers' contents tables.</span></span> <span data-ttu-id="3a9d6-125">Pour fournir cette prise en charge, traitez la restriction PR_ANR dans votre implémentation [d’IMAPITable::Restrict](imapitable-restrict.md) en faisant une recherche de type « de meilleure estimation », en faisant la correspondance avec une ou plusieurs propriétés particulières qui sont logiques pour votre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-125">To provide this support, handle the PR_ANR restriction in your implementation of [IMAPITable::Restrict](imapitable-restrict.md) by performing a "best guess" type of search, matching against one or more particular properties that make sense for your provider.</span></span> <span data-ttu-id="3a9d6-126">Vous pouvez choisir d’utiliser la même propriété ou propriété à chaque fois, par exemple **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) ou **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)), ou autoriser un administrateur à choisir parmi une liste de propriétés acceptables.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-126">You can choose to use the same property or properties every time, such as **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) or **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)), or allow an administrator to choose from a list of acceptable properties.</span></span> 
  
<span data-ttu-id="3a9d6-127">Bien que la plupart des fournisseurs fournissent leur propre implémentation de table des matières, vous pouvez personnaliser l’implémentation fournie par MAPI via [la fonction CreateTable.](createtable.md)</span><span class="sxs-lookup"><span data-stu-id="3a9d6-127">Although most providers supply their own contents table implementation, you can customize the implementation supplied by MAPI through the [CreateTable](createtable.md) function.</span></span> <span data-ttu-id="3a9d6-128">Toutefois, étant donné que l’implémentation MAPI ne prend en charge aucune restriction, vous devez créer un objet wrapper pour inclure une version personnalisée de **Restrict** qui intercepte l’appel.</span><span class="sxs-lookup"><span data-stu-id="3a9d6-128">However, because the MAPI implementation does not support restrictions of any kind, you must create a wrapper object to include a customized version of **Restrict** that intercepts the call.</span></span> 
  

