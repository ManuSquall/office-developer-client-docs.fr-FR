---
title: Écriture de Code de formulaire Server
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ff33badc-ceed-4364-b99c-8af3af83ceb6
description: 'Derni�re modification�: lundi 9 mars 2015'
ms.openlocfilehash: 860b0150fd1ec66fa8fee387d8d4a96e8bb79761
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19787478"
---
# <a name="writing-form-server-code"></a><span data-ttu-id="dd4a3-103">Écriture de Code de formulaire Server</span><span class="sxs-lookup"><span data-stu-id="dd4a3-103">Writing Form Server Code</span></span>

  
  
<span data-ttu-id="dd4a3-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="dd4a3-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="dd4a3-105">Vous pouvez considérer un serveur de formulaire comme suit :</span><span class="sxs-lookup"><span data-stu-id="dd4a3-105">You can think of a form server as the following:</span></span> 
  
- <span data-ttu-id="dd4a3-106">Un programme Win32 qui affiche une interface et gère les messages windows par les mécanismes de pompe de message Windows standards.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-106">A Win32 program that displays an interface and handles windows messages by way of the standard Windows message pump mechanisms.</span></span>
    
- <span data-ttu-id="dd4a3-107">Objet qui enregistre la fabrique de classe avec OLE et est activé par les méthodes OLE automation.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-107">An object that registers its class factory with OLE and is activated by OLE automation methods.</span></span>
    
- <span data-ttu-id="dd4a3-108">Un objet MAPI qui suit les règles MAPI pour les interactions avec les autres composants MAPI.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-108">A MAPI object that follows the MAPI rules for interactions with other MAPI components.</span></span>
    
 <span data-ttu-id="dd4a3-109">Votre code doit traiter tous les trois de ces exigences large simultanément.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-109">Your code has to handle all three of those broad requirements simultaneously.</span></span> 
  
<span data-ttu-id="dd4a3-110">Consultez la section COM et ActiveX Object Services dans le SDK de Windows pour plus d’informations sur l’inscription de fabrique de classe du serveur de votre formulaire.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-110">See the COM and ActiveX Object Services section in the Windows SDK for details about registering your form server's class factory.</span></span> <span data-ttu-id="dd4a3-111">Gestion des messages windows et l’affichage d’une interface sont Windows techniques de programmation standard qui n’ont pas toutes les exigences particulières en ce qui concerne les formulaires MAPI.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-111">Handling windows messages and displaying an interface are standard Windows programming techniques that do not have any special requirements with respect to MAPI forms.</span></span> <span data-ttu-id="dd4a3-112">Là encore, le Kit de développement Windows a plus d’informations sur la programmation Windows.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-112">Again, the Windows SDK has details about Windows programming.</span></span> <span data-ttu-id="dd4a3-113">Ce document contient ce que vous devez connaître pour implémenter les interfaces de formulaire MAPI requis et facultatifs afin qu’ils suivent les règles MAPI pour les interactions avec les autres composants MAPI — principalement l’interface MAPI de formulaire manager et les applications de client de messagerie.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-113">This document contains what you need to know to implement the required and optional MAPI form interfaces so that they follow the MAPI rules for interactions with other MAPI components — primarily the MAPI form manager and messaging client applications.</span></span>
  
<span data-ttu-id="dd4a3-114">Toutes les interfaces que vous pouvez utiliser lorsque vous implémentez des serveurs de formulaire sont dérivées, directement ou indirectement, de OLE [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx)de classe de base.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-114">All of the interfaces that you can use when you implement form servers are derived — either directly or indirectly — from the OLE base class [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx).</span></span> <span data-ttu-id="dd4a3-115">Cela signifie que toutes vos mises en œuvre de ces interfaces devra méthodes **QueryInterface**, **AddRef**et **Release** .</span><span class="sxs-lookup"><span data-stu-id="dd4a3-115">This means that all your implementations of these interfaces will need to have **QueryInterface**, **AddRef**, and **Release** methods.</span></span> <span data-ttu-id="dd4a3-116">Vous pouvez vous épargner beaucoup de travail si vous utilisez plusieurs l’héritage des autorisations pour implémenter toutes les interfaces requises dans une nouvelle classe de votre choix, afin que toutes les interfaces que vous utilisez peuvent partager une seule implémentation des méthodes **IUnknown** requis.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-116">You can save yourself a lot of work if you use multiple inheritance to implement all of the required interfaces in one new class of your own, so that all the interfaces you use can share a single implementation of the required **IUnknown** methods.</span></span> <span data-ttu-id="dd4a3-117">Pour plus d’informations, voir les méthodes [IUnknown::AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) [IUnknown::QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)et [IUnknown::Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="dd4a3-117">For more information, see the [IUnknown::AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown::QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx), and [IUnknown::Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) methods.</span></span> <span data-ttu-id="dd4a3-118">Il n’existe aucune considérations spéciales en ce qui concerne les serveurs de formulaire MAPI pour ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-118">There are no special considerations with respect to MAPI form servers for these methods.</span></span> 
  
<span data-ttu-id="dd4a3-119">Alors que toutes les interfaces de formulaire MAPI sont obligatoires pour tous les serveurs de formulaire, les méthodes de n’importe quelle interface donné sont obligatoires.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-119">While not all of the MAPI form interfaces are mandatory for all form servers, the methods in any given interface are mandatory.</span></span> <span data-ttu-id="dd4a3-120">Autrement dit, si vous choisissez d’implémenter une interface particulière, vous devez implémenter toutes les méthodes dans l’interface.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-120">That is, if you choose to implement a particular interface, you must implement all of the methods in the interface.</span></span> <span data-ttu-id="dd4a3-121">Cette opération diffère de la situation avec d’autres composants MAPI, tel que des transports du message.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-121">This is different from the situation with some other MAPI components, such as message transports.</span></span> <span data-ttu-id="dd4a3-122">Heureusement, les méthodes dans les interfaces de formulaire MAPI sont relativement simples, afin que l’implémentation de toutes les ne place une grande charge sur les développeurs.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-122">Fortunately, the methods in the MAPI form interfaces are relatively straightforward, so implementing all of them does not put a great burden on developers.</span></span>
  
<span data-ttu-id="dd4a3-123">Les interfaces de formulaire MAPI sont indépendants du type de l’outil de développement utilisé pour créer un formulaire de serveur.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-123">The MAPI form interfaces are independent of the type of development tool used to create a form server.</span></span> <span data-ttu-id="dd4a3-124">Cela permet aux formulaires d’être créés à l’aide des outils de développement différents.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-124">This allows forms to be created by using different development tools.</span></span> <span data-ttu-id="dd4a3-125">La seule exigence est que tous les serveurs de formulaire doivent prendre en charge les interfaces de formulaire MAPI requis.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-125">The only requirement is that all form servers must support the required MAPI form interfaces.</span></span>
  
<span data-ttu-id="dd4a3-126">Toutes les interfaces MAPI qui sont associées aux formulaires sont requis par tous les serveurs du formulaire.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-126">Not all of the MAPI interfaces that relate to forms are required by all form servers.</span></span> <span data-ttu-id="dd4a3-127">Interfaces facultatives permettent d’implémenter certaines fonctions avancées de formulaire qui ne sont pas nécessaires à la plupart des serveurs de formulaire.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-127">The optional interfaces allow you to implement some advanced form functions that are not needed by most form servers.</span></span> <span data-ttu-id="dd4a3-128">Le tableau suivant répertorie les interfaces, qu’ils sont destinés et si vous devez les implémenter.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-128">The following table lists the interfaces, what they are for, and whether you must implement them.</span></span>
  
|<span data-ttu-id="dd4a3-129">**Interface**</span><span class="sxs-lookup"><span data-stu-id="dd4a3-129">**Interface**</span></span>|<span data-ttu-id="dd4a3-130">**Description**</span><span class="sxs-lookup"><span data-stu-id="dd4a3-130">**Description**</span></span>|<span data-ttu-id="dd4a3-131">**Status**</span><span class="sxs-lookup"><span data-stu-id="dd4a3-131">**Status**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="dd4a3-132">IMAPIForm : IUnknown</span><span class="sxs-lookup"><span data-stu-id="dd4a3-132">IMAPIForm : IUnknown</span></span>](imapiformiunknown.md) <br/> |<span data-ttu-id="dd4a3-133">L’interface principale que les clients utilisent pour la charge des serveurs de formulaire, d’exécuter des verbes formulaire et arrêter les serveurs de formulaire.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-133">The primary interface that clients use to load form servers, execute form verbs, and shut down form servers.</span></span> <span data-ttu-id="dd4a3-134">C’est également l’interface dérivée OLE **IUnknown** utilisé pour informer les autres composants OLE concernant les interfaces implémente un objet form.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-134">This is also the interface derived from the OLE **IUnknown** that is used to inform other OLE components regarding what interfaces a form object implements.</span></span>  <br/> |<span data-ttu-id="dd4a3-135">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="dd4a3-135">Required</span></span>  <br/> |
|[<span data-ttu-id="dd4a3-136">IPersistMessage : IUnknown</span><span class="sxs-lookup"><span data-stu-id="dd4a3-136">IPersistMessage : IUnknown</span></span>](ipersistmessageiunknown.md) <br/> |<span data-ttu-id="dd4a3-137">Utilisé lors du chargement des messages dans et l’enregistrement des messages à partir des objets de formulaire.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-137">Used when loading messages into and saving messages from form objects.</span></span>  <br/> |<span data-ttu-id="dd4a3-138">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="dd4a3-138">Required</span></span>  <br/> |
|[<span data-ttu-id="dd4a3-139">IMAPIFormAdviseSink : IUnknown</span><span class="sxs-lookup"><span data-stu-id="dd4a3-139">IMAPIFormAdviseSink : IUnknown</span></span>](imapiformadvisesinkiunknown.md) <br/> |<span data-ttu-id="dd4a3-140">Utilisé par les objets de formulaire pour garder une trace des état de la messagerie client et permettant de savoir si l’objet form est capable d’afficher le message suivant ou précédent dans un dossier.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-140">Used by form objects to keep track of messaging client status and to find out whether the form object is capable of displaying the next or previous message in a folder.</span></span>  <br/> |<span data-ttu-id="dd4a3-141">Facultatif</span><span class="sxs-lookup"><span data-stu-id="dd4a3-141">Optional</span></span>  <br/> |
|[<span data-ttu-id="dd4a3-142">IClassFactory</span><span class="sxs-lookup"><span data-stu-id="dd4a3-142">IClassFactory</span></span>](http://msdn.microsoft.com/library/f624f833-2b69-43bc-92cd-c4ecbe6051c5%28Office.15%29.aspx) <br/> |<span data-ttu-id="dd4a3-143">L’interface de fabrique de classe OLE utilisée par les objets de formulaire pour la conformité avec le mécanisme de fabrique de classe OLE.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-143">The OLE class factory interface used by form objects for compliance with the OLE class factory mechanism.</span></span>  <br/> |<span data-ttu-id="dd4a3-144">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="dd4a3-144">Required</span></span>  <br/> |
|[<span data-ttu-id="dd4a3-145">IMAPIFormFactory : IUnknown</span><span class="sxs-lookup"><span data-stu-id="dd4a3-145">IMAPIFormFactory : IUnknown</span></span>](imapiformfactoryiunknown.md) <br/> |<span data-ttu-id="dd4a3-146">Utilisé si votre serveur de formulaire prend en charge plusieurs types de formulaire.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-146">Used if your form server supports more than one type of form.</span></span> <span data-ttu-id="dd4a3-147">Dans ce cas, l’interface **IMAPIFormFactory** permet aux applications clientes accéder aux interfaces **IClassFactory** plusieurs (une par type de formulaire qui prend en charge de votre serveur de formulaire) que le serveur de votre formulaire doit également implémenter.</span><span class="sxs-lookup"><span data-stu-id="dd4a3-147">In this case, the **IMAPIFormFactory** interface allows client applications to access the multiple **IClassFactory** interfaces (one per type of form that your form server supports) that your form server must also implement.</span></span>  <br/> |<span data-ttu-id="dd4a3-148">Facultatif</span><span class="sxs-lookup"><span data-stu-id="dd4a3-148">Optional</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="dd4a3-149">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="dd4a3-149">See also</span></span>



[<span data-ttu-id="dd4a3-150">Développez serveurs de formulaire MAPI</span><span class="sxs-lookup"><span data-stu-id="dd4a3-150">Developing MAPI Form Servers</span></span>](developing-mapi-form-servers.md)

