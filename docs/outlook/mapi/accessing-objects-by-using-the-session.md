---
title: Accès aux objets à l’aide de la session
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ecada707-2960-41ec-be7e-619cad257c57
description: Dernière modification le 9 mars 2015
ms.openlocfilehash: a76397b74642aedf9ad5c9704735d869f61db7e3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410538"
---
# <a name="accessing-objects-by-using-the-session"></a><span data-ttu-id="5dba1-103">Accès aux objets à l’aide de la session</span><span class="sxs-lookup"><span data-stu-id="5dba1-103">Accessing Objects by Using the Session</span></span>

  
  
<span data-ttu-id="5dba1-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="5dba1-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="5dba1-105">Le pointeur de session que vous recevez de votre appel [à MAPILogonEx](mapilogonex.md) peut être utilisé pour accéder à un large éventail d’objets.</span><span class="sxs-lookup"><span data-stu-id="5dba1-105">The session pointer that you receive from your call to [MAPILogonEx](mapilogonex.md) can be used to access a wide variety of objects.</span></span> <span data-ttu-id="5dba1-106">Le tableau suivant répertorie les méthodes utilisées pour accéder à différents objets :</span><span class="sxs-lookup"><span data-stu-id="5dba1-106">The following table lists the methods that are used to access various objects:</span></span> 
  
|<span data-ttu-id="5dba1-107">**Object**</span><span class="sxs-lookup"><span data-stu-id="5dba1-107">**Object**</span></span>|<span data-ttu-id="5dba1-108">**Méthode session**</span><span class="sxs-lookup"><span data-stu-id="5dba1-108">**Session method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="5dba1-109">Section Profil</span><span class="sxs-lookup"><span data-stu-id="5dba1-109">Profile section</span></span>  <br/> |[<span data-ttu-id="5dba1-110">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="5dba1-110">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="5dba1-111">Magasin de messages</span><span class="sxs-lookup"><span data-stu-id="5dba1-111">Message store</span></span>  <br/> |[<span data-ttu-id="5dba1-112">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="5dba1-112">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md) <br/> |
|<span data-ttu-id="5dba1-113">Carnet d’adresses</span><span class="sxs-lookup"><span data-stu-id="5dba1-113">Address book</span></span>  <br/> |[<span data-ttu-id="5dba1-114">IMAPISession::OpenAddressBook</span><span class="sxs-lookup"><span data-stu-id="5dba1-114">IMAPISession::OpenAddressBook</span></span>](imapisession-openaddressbook.md) <br/> |
|<span data-ttu-id="5dba1-115">Objet d’administration du service de message</span><span class="sxs-lookup"><span data-stu-id="5dba1-115">Message service administration object</span></span>  <br/> |[<span data-ttu-id="5dba1-116">IMAPISession::AdminServices</span><span class="sxs-lookup"><span data-stu-id="5dba1-116">IMAPISession::AdminServices</span></span>](imapisession-adminservices.md) <br/> |
|<span data-ttu-id="5dba1-117">Dossier, message, conteneur de carnet d’adresses, liste de distribution ou utilisateur de messagerie</span><span class="sxs-lookup"><span data-stu-id="5dba1-117">Folder, message, address book container, distribution list, or messaging user</span></span>  <br/> |[<span data-ttu-id="5dba1-118">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="5dba1-118">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
   
<span data-ttu-id="5dba1-119">Avec la **méthode OpenEntry et** un identificateur d’entrée valide, vous pouvez ouvrir n’importe quel objet fournisseur de carnet d’adresses ou de magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="5dba1-119">With the **OpenEntry** method and a valid entry identifier, you can open any address book or message store provider object.</span></span> <span data-ttu-id="5dba1-120">Il existe **d’autres méthodes OpenEntry** dans MAPI, en plus de la méthode **IMAPISession.**</span><span class="sxs-lookup"><span data-stu-id="5dba1-120">There are other **OpenEntry** methods in MAPI, in addition to the **IMAPISession** method.</span></span> <span data-ttu-id="5dba1-121">**OpenEntry est** implémenté dans les objets suivants :</span><span class="sxs-lookup"><span data-stu-id="5dba1-121">**OpenEntry** is implemented in the following objects:</span></span> 
  
|<span data-ttu-id="5dba1-122">**Object**</span><span class="sxs-lookup"><span data-stu-id="5dba1-122">**Object**</span></span>|<span data-ttu-id="5dba1-123">**Méthode**</span><span class="sxs-lookup"><span data-stu-id="5dba1-123">**Method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="5dba1-124">Objet d’accès au fournisseur de carnet d’adresses</span><span class="sxs-lookup"><span data-stu-id="5dba1-124">Address book provider's logon object</span></span>  <br/> |[<span data-ttu-id="5dba1-125">IABLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="5dba1-125">IABLogon::OpenEntry</span></span>](iablogon-openentry.md) <br/> |
|<span data-ttu-id="5dba1-126">Carnet d’adresses</span><span class="sxs-lookup"><span data-stu-id="5dba1-126">Address book</span></span>  <br/> |[<span data-ttu-id="5dba1-127">IAddrBook::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="5dba1-127">IAddrBook::OpenEntry</span></span>](iaddrbook-openentry.md) <br/> |
|<span data-ttu-id="5dba1-128">Conteneur de carnet d’adresses</span><span class="sxs-lookup"><span data-stu-id="5dba1-128">Address book container</span></span>  <br/> |[<span data-ttu-id="5dba1-129">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="5dba1-129">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="5dba1-130">Session</span><span class="sxs-lookup"><span data-stu-id="5dba1-130">Session</span></span>  <br/> |[<span data-ttu-id="5dba1-131">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="5dba1-131">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
|<span data-ttu-id="5dba1-132">Magasin de messages</span><span class="sxs-lookup"><span data-stu-id="5dba1-132">Message store</span></span>  <br/> |[<span data-ttu-id="5dba1-133">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="5dba1-133">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md) <br/> |
|<span data-ttu-id="5dba1-134">Objet d’ouverture de messagerie du fournisseur de magasins de messages</span><span class="sxs-lookup"><span data-stu-id="5dba1-134">Message store provider's logon object</span></span>  <br/> |[<span data-ttu-id="5dba1-135">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="5dba1-135">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md) <br/> |
|<span data-ttu-id="5dba1-136">Dossier</span><span class="sxs-lookup"><span data-stu-id="5dba1-136">Folder</span></span>  <br/> |[<span data-ttu-id="5dba1-137">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="5dba1-137">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="5dba1-138">Objet Support</span><span class="sxs-lookup"><span data-stu-id="5dba1-138">Support object</span></span>  <br/> |[<span data-ttu-id="5dba1-139">IMAPISupport::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="5dba1-139">IMAPISupport::OpenEntry</span></span>](imapisupport-openentry.md) <br/> |
   
<span data-ttu-id="5dba1-140">Certaines **méthodes OpenEntry** nécessitent l’ouverture d’un identificateur d’entrée de l’objet, tout comme **IMAPISession::OpenEntry**; d’autres méthodes permettent de spécifier la valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="5dba1-140">Some **OpenEntry** methods require an entry identifier of the object to be opened, as does **IMAPISession::OpenEntry**; other methods allow NULL to be specified.</span></span> <span data-ttu-id="5dba1-141">Un identificateur d’entrée NULL est interprété différemment en fonction de l’objet.</span><span class="sxs-lookup"><span data-stu-id="5dba1-141">A NULL entry identifier is interpreted differently depending on the object.</span></span> <span data-ttu-id="5dba1-142">Par exemple, lorsque vous appelez **IAddrBook::OpenEntry** avec un identificateur d’entrée NULL, MAPI ouvre le conteneur racine du carnet d’adresses.</span><span class="sxs-lookup"><span data-stu-id="5dba1-142">For example, when you call **IAddrBook::OpenEntry** with a NULL entry identifier, MAPI opens the root container of the address book.</span></span> <span data-ttu-id="5dba1-143">La méthode **OpenEntry** de la boutique de messages se comporte de la même manière . il ouvre le dossier racine de la boutique de messages.</span><span class="sxs-lookup"><span data-stu-id="5dba1-143">The message store's **OpenEntry** method behaves similarly; it opens the root folder of the message store.</span></span> <span data-ttu-id="5dba1-144">**IMAPIContainer::OpenEntry**, implémenté par les conteneurs de dossiers et de carnet d’adresses, peut renvoyer MAPI_E_INVALID_PARAMETER ou le conteneur racine, en fonction de l’implémenteur.</span><span class="sxs-lookup"><span data-stu-id="5dba1-144">**IMAPIContainer::OpenEntry**, implemented by both folders and address book containers, might return MAPI_E_INVALID_PARAMETER or the root container, depending on the implementer.</span></span> 
  
<span data-ttu-id="5dba1-145">En plus de refuser une valeur NULL pour l’identificateur d’entrée, la méthode **OpenEntry** de la session diffère des autres méthodes **OpenEntry,** car son travail n’est pas d’ouvrir des objets.</span><span class="sxs-lookup"><span data-stu-id="5dba1-145">In addition to disallowing a NULL value for the entry identifier, the session's **OpenEntry** method differs from other **OpenEntry** methods because its job is not to open objects.</span></span> <span data-ttu-id="5dba1-146">Au lieu de cela, il examine l’identificateur d’entrée et fait suivre l’appel à une autre méthode **OpenEntry** implémentée par le fournisseur de services approprié.</span><span class="sxs-lookup"><span data-stu-id="5dba1-146">Instead, it examines the entry identifier and forwards the call to another **OpenEntry** method implemented by the appropriate service provider.</span></span> <span data-ttu-id="5dba1-147">Par exemple, si vous appelez **IMAPISession::OpenEntry** avec l’identificateur d’entrée d’un message, MAPI appelle la méthode **IMSLogon::OpenEntry** de la boutique de messages responsable du message.</span><span class="sxs-lookup"><span data-stu-id="5dba1-147">For example, if you call **IMAPISession::OpenEntry** with the entry identifier of a message, MAPI calls the **IMSLogon::OpenEntry** method of the message store responsible for the message.</span></span> 
  
<span data-ttu-id="5dba1-148">Outre l’utilisation de la session pour ouvrir des objets, les clients l’utilisent pour les comparer.</span><span class="sxs-lookup"><span data-stu-id="5dba1-148">In addition to using the session to open objects, clients use it to compare them.</span></span> <span data-ttu-id="5dba1-149">La [méthode IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) compare les objets en comparant leurs identificateurs d’entrée.</span><span class="sxs-lookup"><span data-stu-id="5dba1-149">The [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) method compares objects by comparing their entry identifiers.</span></span> <span data-ttu-id="5dba1-150">Si les structures [MAPIUID](mapiuid.md) contenues dans les identificateurs d’entrée appartiennent au même fournisseur de services, MAPI le fait.</span><span class="sxs-lookup"><span data-stu-id="5dba1-150">If the [MAPIUID](mapiuid.md) structures contained within the entry identifiers belong to the same service provider, MAPI forwards the call to that provider.</span></span> <span data-ttu-id="5dba1-151">**CompareEntryIDs renvoie une** valeur d’erreur lorsque les deux identificateurs d’entrée ne correspondent pas.</span><span class="sxs-lookup"><span data-stu-id="5dba1-151">**CompareEntryIDs** returns an error value when the two entry identifiers do not match.</span></span> <span data-ttu-id="5dba1-152">Bien que cette méthode puisse comparer les identificateurs d’entrée qui appartiennent à n’importe quel type d’objet, **CompareEntryIDs** fonctionne mieux pour les objets de niveau supérieur tels que les magasins de messages et les conteneurs de carnet d’adresses.</span><span class="sxs-lookup"><span data-stu-id="5dba1-152">Although this method can compare entry identifiers that belong to any type of object, **CompareEntryIDs** works best for higher level objects such as message stores and address book containers.</span></span> <span data-ttu-id="5dba1-153">Pour comparer des objets de niveau inférieur, comparez directement les clés de recherche des objets (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) ou les clés d’enregistrement (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span><span class="sxs-lookup"><span data-stu-id="5dba1-153">To compare lower level objects, compare directly the objects' search keys (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) or record keys (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span></span> 
  
<span data-ttu-id="5dba1-154">Comme **OpenEntry**, **CompareEntryIDs** est implémenté par plusieurs objets.</span><span class="sxs-lookup"><span data-stu-id="5dba1-154">Like **OpenEntry**, **CompareEntryIDs** is implemented by multiple objects.</span></span> <span data-ttu-id="5dba1-155">Choisissez la **méthode OpenEntry** et **CompareEntryID** à utiliser en fonction de la quantité d’informations que vous avez sur l’objet ou les objets à ouvrir ou à comparer.</span><span class="sxs-lookup"><span data-stu-id="5dba1-155">Choose which **OpenEntry** and **CompareEntryID** method to use according to the amount of information that you have about the object or objects to be opened or compared.</span></span> <span data-ttu-id="5dba1-156">Utilisez les instructions suivantes lors du choix de la méthode d’interface à appeler :</span><span class="sxs-lookup"><span data-stu-id="5dba1-156">Use the following guidelines when deciding which interface method to call:</span></span> 
  
- <span data-ttu-id="5dba1-157">Si vous n’avez aucune information sur les objets cibles, appelez [IMAPISession::OpenEntry](imapisession-openentry.md) ou [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span><span class="sxs-lookup"><span data-stu-id="5dba1-157">If you have no information about the target objects, call [IMAPISession::OpenEntry](imapisession-openentry.md) or [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span></span> <span data-ttu-id="5dba1-158">Cette approche permet d’accéder à n’importe quel objet, mais elle est la plus lente des trois.</span><span class="sxs-lookup"><span data-stu-id="5dba1-158">This approach enables access to any object, but is the slowest of the three.</span></span>
    
- <span data-ttu-id="5dba1-159">Si vous savez que les objets cibles sont des entrées de carnet d’adresses plutôt que, par exemple, des dossiers, appelez la méthode [IAddrBook::OpenEntry](iaddrbook-openentry.md) ou [IAddrBook::CompareEntryIDs.](iaddrbook-compareentryids.md)</span><span class="sxs-lookup"><span data-stu-id="5dba1-159">If you know that the target objects are address book entries rather than, for example, folders, call the [IAddrBook::OpenEntry](iaddrbook-openentry.md) or [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) method.</span></span> <span data-ttu-id="5dba1-160">**IAddrBook::OpenEntry** ouvre le conteneur racine du carnet d’adresses lorsque NULL est spécifié en tant qu’objet cible.</span><span class="sxs-lookup"><span data-stu-id="5dba1-160">**IAddrBook::OpenEntry** opens the root container of the address book when NULL is specified as the target object.</span></span> <span data-ttu-id="5dba1-161">Cette approche permet d’accéder à n’importe quel objet de carnet d’adresses et est plus rapide que d’utiliser **IMAPISession,** mais plus lente que d’utiliser **IMAPIContainer**.</span><span class="sxs-lookup"><span data-stu-id="5dba1-161">This approach enables access to any address book object and is faster than using **IMAPISession**, but slower than using **IMAPIContainer**.</span></span>
    
- <span data-ttu-id="5dba1-162">Si l’identificateur d’entrée utilisé est un identificateur d’entrée à court terme ou si vous savez que les objets cibles appartiennent à un conteneur ou dossier de carnet d’adresses particulier, appelez la méthode [IMAPIContainer::OpenEntry.](imapicontainer-openentry.md)</span><span class="sxs-lookup"><span data-stu-id="5dba1-162">If the entry identifier being used is a short-term entry identifier or if you know that the target objects belong to a particular address book container or folder, call the [IMAPIContainer::OpenEntry](imapicontainer-openentry.md) method.</span></span> <span data-ttu-id="5dba1-163">Cette approche permet d’obtenir les performances les plus rapides, mais permet d’accéder uniquement aux objets d’un conteneur ou d’un dossier spécifique.</span><span class="sxs-lookup"><span data-stu-id="5dba1-163">This approach yields the fastest performance, but enables access only to objects in a specific container or folder.</span></span> 
    

