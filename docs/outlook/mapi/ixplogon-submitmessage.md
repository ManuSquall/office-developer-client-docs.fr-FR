---
title: IXPLogonSubmitMessage
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPLogon.SubmitMessage
api_type:
- COM
ms.assetid: a261ba0d-cb56-4935-b745-1d4bbd0b8b9d
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: ae124cb94cff5be0a655386d31f1bf2c82f66a85
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33423320"
---
# <a name="ixplogonsubmitmessage"></a><span data-ttu-id="a0bb9-103">IXPLogon::SubmitMessage</span><span class="sxs-lookup"><span data-stu-id="a0bb9-103">IXPLogon::SubmitMessage</span></span>

  
  
<span data-ttu-id="a0bb9-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a0bb9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a0bb9-105">Indique que lepooler MAPI a un message à remettre au fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-105">Indicates that the MAPI spooler has a message for the transport provider to deliver.</span></span>
  
```cpp
HRESULT SubmitMessage(
  ULONG ulFlags,
  LPMESSAGE lpMessage,
  ULONG FAR * lpulMsgRef,
  ULONG FAR * lpulReturnParm
);
```

## <a name="parameters"></a><span data-ttu-id="a0bb9-106">Paramètres</span><span class="sxs-lookup"><span data-stu-id="a0bb9-106">Parameters</span></span>

 <span data-ttu-id="a0bb9-107">_ulFlags_</span><span class="sxs-lookup"><span data-stu-id="a0bb9-107">_ulFlags_</span></span>
  
> <span data-ttu-id="a0bb9-108">[in] Masque de bits d’indicateurs qui contrôle la façon dont le message est envoyé.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-108">[in] A bitmask of flags that controls how the message is submitted.</span></span> <span data-ttu-id="a0bb9-109">L’indicateur suivant peut être définie :</span><span class="sxs-lookup"><span data-stu-id="a0bb9-109">The following flag can be set:</span></span>
    
<span data-ttu-id="a0bb9-110">BEGIN_DEFERRED</span><span class="sxs-lookup"><span data-stu-id="a0bb9-110">BEGIN_DEFERRED</span></span> 
  
> <span data-ttu-id="a0bb9-111">Lepooler MAPI appelle un fournisseur de transport avec un message qui a été différé précédemment.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-111">The MAPI spooler is calling a transport provider with a message that was previously deferred.</span></span> <span data-ttu-id="a0bb9-112">L’identificateur d’entrée du message est identique au moment où il a été différé.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-112">The entry identifier of the message is the same as when it was deferred.</span></span> <span data-ttu-id="a0bb9-113">Le message a été différé en passant son identificateur d’entrée aupooler MAPI à l’aide de la méthode [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) avec l’indicateur NOTIFY_SENTDEFERRED.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-113">The message was deferred by passing its entry identifier back to the MAPI spooler by using the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method with the NOTIFY_SENTDEFERRED flag.</span></span> 
    
 <span data-ttu-id="a0bb9-114">_lpMessage_</span><span class="sxs-lookup"><span data-stu-id="a0bb9-114">_lpMessage_</span></span>
  
> <span data-ttu-id="a0bb9-115">[in] Pointeur vers un objet de message (représentant le message à remettre) qui dispose d’une autorisation de lecture/écriture, que le fournisseur de transport utilise pour accéder à ce message et le manipuler.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-115">[in] A pointer to a message object (representing the message to deliver) that has read/write permission, which the transport provider uses to access and manipulate that message.</span></span> <span data-ttu-id="a0bb9-116">Cet objet reste valide jusqu’au retour du fournisseur de transport à partir d’un appel ultérieur à la [méthode IXPLogon::EndMessage.](ixplogon-endmessage.md)</span><span class="sxs-lookup"><span data-stu-id="a0bb9-116">This object remains valid until after the transport provider returns from a subsequent call to the [IXPLogon::EndMessage](ixplogon-endmessage.md) method.</span></span> 
    
 <span data-ttu-id="a0bb9-117">_lpulMsgRef_</span><span class="sxs-lookup"><span data-stu-id="a0bb9-117">_lpulMsgRef_</span></span>
  
> <span data-ttu-id="a0bb9-118">[out] Pointeur vers une variable dans laquelle le fournisseur de transport renvoie la valeur de référence qu’il a affectée à ce message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-118">[out] A pointer to a variable in which the transport provider returns the reference value it assigned to this message.</span></span> <span data-ttu-id="a0bb9-119">Lepooler MAPI transmet cette valeur de référence dans les appels suivants pour ce message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-119">The MAPI spooler passes this reference value in subsequent calls for this message.</span></span> <span data-ttu-id="a0bb9-120">Lepooler MAPI initialise la valeur sur 0 avant de la renvoyer au fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-120">The MAPI spooler initializes the value to 0 before returning it to the transport provider.</span></span>
    
 <span data-ttu-id="a0bb9-121">_lpulReturnParm_</span><span class="sxs-lookup"><span data-stu-id="a0bb9-121">_lpulReturnParm_</span></span>
  
> <span data-ttu-id="a0bb9-122">[out] Pointeur vers une variable qui correspond à la valeur d’erreur MAPI_E_WAIT ou MAPI_E_NETWORK_ERROR renvoyée par **SubmitMessage**.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-122">[out] A pointer to a variable that corresponds to the MAPI_E_WAIT or MAPI_E_NETWORK_ERROR error value returned by **SubmitMessage**.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="a0bb9-123">Valeur renvoyée</span><span class="sxs-lookup"><span data-stu-id="a0bb9-123">Return value</span></span>

<span data-ttu-id="a0bb9-124">S_OK</span><span class="sxs-lookup"><span data-stu-id="a0bb9-124">S_OK</span></span> 
  
> <span data-ttu-id="a0bb9-125">L’appel a réussi et a renvoyé la ou les valeurs attendues.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-125">The call succeeded and returned the expected value or values.</span></span>
    
<span data-ttu-id="a0bb9-126">MAPI_E_BUSY</span><span class="sxs-lookup"><span data-stu-id="a0bb9-126">MAPI_E_BUSY</span></span> 
  
> <span data-ttu-id="a0bb9-127">Le fournisseur de transport ne peut pas gérer le message, car il effectue une autre opération.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-127">The transport provider cannot handle the message, because it is performing another operation.</span></span> <span data-ttu-id="a0bb9-128">Un fournisseur doit utiliser cette valeur de retour pour indiquer qu’aucun traitement ne s’est produit et que lepooler MAPI ne doit pas appeler **EndMessage**.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-128">A provider should use this return value to indicate that no processing occurred and that the MAPI spooler should not call **EndMessage**.</span></span> <span data-ttu-id="a0bb9-129">Lepooler MAPI tentera à nouveau **l’appel SubmitMessage** ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-129">The MAPI spooler will try the **SubmitMessage** call again later.</span></span> 
    
<span data-ttu-id="a0bb9-130">MAPI_E_CANCEL</span><span class="sxs-lookup"><span data-stu-id="a0bb9-130">MAPI_E_CANCEL</span></span> 
  
> <span data-ttu-id="a0bb9-131">Bien que le fournisseur de transport a demandé aupooler MAPI de resoumettre le message lors d’un appel **SpoolerNotify** précédent, les conditions ont depuis été modifiées et le message ne doit pas être resenté.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-131">Although the transport provider requested that the MAPI spooler resubmit the message on a previous **SpoolerNotify** call, conditions have since changed, and the message should not be resent.</span></span> <span data-ttu-id="a0bb9-132">Lepooler MAPI va continuer pour gérer autre chose.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-132">The MAPI spooler will go on to handle something else.</span></span> 
    
<span data-ttu-id="a0bb9-133">MAPI_E_NETWORK_ERROR</span><span class="sxs-lookup"><span data-stu-id="a0bb9-133">MAPI_E_NETWORK_ERROR</span></span> 
  
> <span data-ttu-id="a0bb9-134">Une erreur réseau a empêché l’exécution de l’opération.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-134">A network error prevented successful completion of the operation.</span></span> <span data-ttu-id="a0bb9-135">Le  _paramètre lpulReturnParm_ doit être définie sur le nombre de secondes qui s’écouléeront avant que lepooler MAPI ne retransmettre le message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-135">The  _lpulReturnParm_ parameter should be set to the number of seconds that will elapse before the MAPI spooler resubmits the message.</span></span> 
    
<span data-ttu-id="a0bb9-136">MAPI_E_NOT_ME</span><span class="sxs-lookup"><span data-stu-id="a0bb9-136">MAPI_E_NOT_ME</span></span> 
  
> <span data-ttu-id="a0bb9-137">Le fournisseur de transport ne peut pas gérer ce message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-137">The transport provider cannot handle this message.</span></span> <span data-ttu-id="a0bb9-138">Lepooler MAPI doit essayer de trouver un autre fournisseur de transport pour celui-ci.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-138">The MAPI spooler should try to find another transport provider for it.</span></span> <span data-ttu-id="a0bb9-139">Un fournisseur doit utiliser cette valeur de retour pour indiquer qu’aucun traitement ne s’est produit et que lepooler MAPI ne doit pas appeler **EndMessage**.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-139">A provider should use this return value to indicate that no processing occurred and that the MAPI spooler should not call **EndMessage**.</span></span>
    
<span data-ttu-id="a0bb9-140">MAPI_E_WAIT</span><span class="sxs-lookup"><span data-stu-id="a0bb9-140">MAPI_E_WAIT</span></span> 
  
> <span data-ttu-id="a0bb9-141">Un problème temporaire empêche le fournisseur de transport de gérer le message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-141">A temporary problem prevents the transport provider from handling the message.</span></span> <span data-ttu-id="a0bb9-142">Le  _paramètre lpulReturnParm_ doit être définie sur le nombre de secondes qui s’écouléeront avant que lepooler MAPI ne retransmettre le message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-142">The  _lpulReturnParm_ parameter should be set to the number of seconds that will elapse before the MAPI spooler resubmits the message.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="a0bb9-143">Remarques</span><span class="sxs-lookup"><span data-stu-id="a0bb9-143">Remarks</span></span>

<span data-ttu-id="a0bb9-144">Lepooler MAPI appelle la méthode **IXPLogon::SubmitMessage** lorsqu’il a un message à remettre au fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-144">The MAPI spooler calls the **IXPLogon::SubmitMessage** method when it has a message for the transport provider to deliver.</span></span> <span data-ttu-id="a0bb9-145">Le message est transmis au fournisseur de transport à l’aide du _paramètre lpMessage._</span><span class="sxs-lookup"><span data-stu-id="a0bb9-145">The message is passed to the transport provider by using the  _lpMessage_ parameter.</span></span> 
  
<span data-ttu-id="a0bb9-146">Si le fournisseur est prêt à accepter le message, il doit renvoyer une valeur de référence à l’aide du paramètre  _lpulMsgRef,_ traiter l’objet transmis et renvoyer la valeur appropriée (généralement S_OK).</span><span class="sxs-lookup"><span data-stu-id="a0bb9-146">If the provider is ready to accept the message, it should return a reference value by using the  _lpulMsgRef_ parameter, process the passed object, and return the appropriate value (usually S_OK).</span></span> <span data-ttu-id="a0bb9-147">Si le fournisseur n’est pas prêt à gérer le transfert, il doit renvoyer une valeur d’erreur et, éventuellement, une autre valeur de retour MAPI dans  _lpulReturnParm_ pour indiquer le temps d’attente dupooler MAPI avant de renvoyer le message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-147">If the provider is not prepared to handle the transfer, it should return an error value and, optionally, another MAPI return value in  _lpulReturnParm_ to indicate how long the MAPI spooler should wait before resubmitting the message.</span></span> 
  
<span data-ttu-id="a0bb9-148">L’implémentation de cette méthode par un fournisseur de transport peut :</span><span class="sxs-lookup"><span data-stu-id="a0bb9-148">A transport provider's implementation of this method can do the following:</span></span>
  
- <span data-ttu-id="a0bb9-149">Placez le message dans une file d’attente interne pour attendre la transmission, éventuellement en copiant le message dans le stockage local, puis renvoyez-le.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-149">Put the message into an internal queue to wait for transmission, possibly copying the message to local storage, and return.</span></span>
    
- <span data-ttu-id="a0bb9-150">Essayez d’effectuer la transmission réelle et de la renvoyer une fois la transmission terminée, avec succès ou sans succès.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-150">Attempt to perform the actual transmission and return when the transmission completes, either successfully or unsuccessfully.</span></span>
    
- <span data-ttu-id="a0bb9-151">Déterminez s’il faut envoyer le message après avoir vérifié la ressource impliquée.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-151">Determine whether to send the message after checking the resource involved.</span></span> <span data-ttu-id="a0bb9-152">Dans ce cas, si la ressource est gratuite, le fournisseur peut verrouiller la ressource, préparer le message et l’envoyer.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-152">In this case, if the resource is free, the provider can lock the resource, prepare the message, and submit it.</span></span> <span data-ttu-id="a0bb9-153">Si la ressource est occupée, le fournisseur peut préparer le message et différer l’envoi à une heure ultérieure.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-153">If the resource is busy, the provider can prepare the message and defer sending to a later time.</span></span>
    
<span data-ttu-id="a0bb9-154">La technique préférée pour la transmission des messages dépend du fournisseur de transport et du nombre attendu de processus concurrents pour les ressources système.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-154">The preferred technique for message transmission depends on the transport provider and the expected number of processes competing for system resources.</span></span> 
  
<span data-ttu-id="a0bb9-155">Lors **d’un appel SubmitMessage,** le fournisseur de transport contrôle le transfert des données de message à partir de l’objet de message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-155">During a **SubmitMessage** call, the transport provider controls the transfer of message data from the message object.</span></span> <span data-ttu-id="a0bb9-156">Toutefois, le fournisseur de transport doit affecter une valeur de référence au message, à laquelle il renvoie un pointeur dans  _lpulMsgRef_, avant de transférer des données.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-156">However, the transport provider should assign a reference value to the message, to which it returns a pointer in  _lpulMsgRef_, before transferring data.</span></span> <span data-ttu-id="a0bb9-157">Il le fait car à tout moment au cours du processus, lepooler MAPI peut appeler la méthode [IXPLogon::TransportNotify](ixplogon-transportnotify.md) avec l’indicateur NOTIFY_CANCEL_MESSAGE pour signaler au fournisseur qu’il doit libérer tous les objets ouverts et arrêter le transfert des messages.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-157">It does so because at any point during the process, the MAPI spooler can call the [IXPLogon::TransportNotify](ixplogon-transportnotify.md) method with the NOTIFY_CANCEL_MESSAGE flag set to signal the provider that it should release any open objects and stop message transfer.</span></span> 
  
<span data-ttu-id="a0bb9-158">Le fournisseur de transport ne doit pas envoyer de propriétés nontransmitables du message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-158">The transport provider should not send any nontransmittable properties of the message.</span></span> <span data-ttu-id="a0bb9-159">Lorsqu’elle trouve une telle propriété, elle doit continuer pour traiter la propriété suivante.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-159">When it finds such a property, it should go on to process the next property.</span></span> <span data-ttu-id="a0bb9-160">Le fournisseur doit faire tout son possible pour ne pas afficher MAPI_P1 du destinataire dans le cadre du contenu du message transmis . le fournisseur doit utiliser ces informations de destinataire uniquement à des fins d’adressan.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-160">The provider should make every effort not to display MAPI_P1 recipient information as part of the transmitted message content; the provider should use this recipient information only for addressing purposes.</span></span> <span data-ttu-id="a0bb9-161">MAPI_P1 destinataires sont des destinataires générés en interne qui sont utilisés pour renvoyer des messages ; ils ne doivent pas être transmis.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-161">MAPI_P1 recipients are internally generated recipients that are used for resending messages; they should not be transmitted.</span></span> <span data-ttu-id="a0bb9-162">Utilisez plutôt les autres destinataires pour transmettre des informations sur les destinataires.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-162">Instead, use the other recipients for transmitting recipient information.</span></span> <span data-ttu-id="a0bb9-163">L’objectif de cette disposition est de permettre aux destinataires de renvoyer la même table de destinataires que les destinataires d’origine.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-163">The purpose of this arrangement is to permit resend recipients to see the exact same recipient table as the original recipients.</span></span>
  
<span data-ttu-id="a0bb9-164">Au cours **d’un appel SubmitMessage,** lepooler MAPI traite les méthodes pour les objets ouverts lors du transfert du message et traite les pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-164">During a **SubmitMessage** call, the MAPI spooler processes methods for objects that are opened during the transfer of the message, and it processes any attachments.</span></span> <span data-ttu-id="a0bb9-165">Ce traitement peut prendre beaucoup de temps.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-165">This processing can take a long time.</span></span> <span data-ttu-id="a0bb9-166">Les fournisseurs de transport peuvent appeler fréquemment la méthode [IMAPISupport::SpoolerYield](imapisupport-spooleryield.md) pour lepooler MAPI pendant ce traitement pour libérer du temps processeur pour d’autres tâches système.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-166">Transport providers can call the [IMAPISupport::SpoolerYield](imapisupport-spooleryield.md) method for the MAPI spooler frequently during this processing to release CPU time for other system tasks.</span></span> 
  
<span data-ttu-id="a0bb9-167">Tous les destinataires du message sont visibles dans la table des destinataires du message que lepooler MAPI a transmis à l’origine.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-167">All message recipients are visible in the recipient table of the message that the MAPI spooler originally passed.</span></span> <span data-ttu-id="a0bb9-168">Le fournisseur de transport doit traiter uniquement les destinataires qu’il peut gérer (en fonction de l’identificateur d’entrée, du type d’adresse ou des deux) et dont la propriété **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) n’a pas encore la valeur TRUE.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-168">The transport provider should process only those recipients that it can handle — based on entry identifier, address type, or both — and that do not already have their **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property set to TRUE.</span></span> <span data-ttu-id="a0bb9-169">Si **PR_RESPONSIBILITY** est déjà définie sur TRUE, un autre fournisseur de transport a géré ce destinataire.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-169">If **PR_RESPONSIBILITY** is already set to TRUE, another transport provider has handled that recipient.</span></span> <span data-ttu-id="a0bb9-170">Lorsque le fournisseur termine un traitement suffisant d’un destinataire pour déterminer s’il peut gérer les messages pour ce destinataire, il doit définir la propriété **PR_RESPONSIBILITY** de ce destinataire sur TRUE dans le message transmis.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-170">When the provider completes sufficient processing of a recipient to determine whether it can handle messages for that recipient, it should set that recipient's **PR_RESPONSIBILITY** property to TRUE in the passed message.</span></span> <span data-ttu-id="a0bb9-171">En règle générale, le fournisseur effectue cette détermination une fois la remise du message terminée.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-171">Usually, the provider makes this determination after message delivery is complete.</span></span> 
  
<span data-ttu-id="a0bb9-172">En règle générale, le fournisseur de transport ne revient pas d’un appel **SubmitMessage** tant qu’il n’a pas terminé le transfert des données de message.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-172">Typically, the transport provider does not return from a **SubmitMessage** call until it completes the transfer of message data.</span></span> <span data-ttu-id="a0bb9-173">Si aucune erreur n’est renvoyée, l’appel suivant dupooler MAPI au fournisseur est un appel à la méthode [IXPLogon::EndMessage.](ixplogon-endmessage.md)</span><span class="sxs-lookup"><span data-stu-id="a0bb9-173">If no error is returned, the next call from the MAPI spooler to the provider is a call to the [IXPLogon::EndMessage](ixplogon-endmessage.md) method.</span></span> 
  
<span data-ttu-id="a0bb9-174">Si **SubmitMessage renvoie** une erreur, lepooler MAPI libère le message en cours de traitement sans enregistrer les modifications.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-174">If **SubmitMessage** returns an error, the MAPI spooler releases the message in process without saving changes.</span></span> <span data-ttu-id="a0bb9-175">Si le fournisseur de transport requiert l’enregistrer, il doit appeler la méthode [IMAPIProp::SaveChanges](imapiprop-savechanges.md) sur le message avant de le renvoyer.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-175">If the transport provider requires message changes to be saved, it must call the [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method on the message before returning.</span></span> 
  
<span data-ttu-id="a0bb9-176">En cas d’erreurs qui se produisent en raison de problèmes de transport, lepooler MAPI conserve le message, mais il retarde le resoumettre le message au fournisseur de transport en fonction de la valeur renvoyée dans  _lpulReturnParm_.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-176">In case of errors that occur because of transport problems, the MAPI spooler retains the message, but it delays resubmitting the message to the transport provider based on the value returned in  _lpulReturnParm_.</span></span> <span data-ttu-id="a0bb9-177">Le fournisseur de transport doit remplir cette valeur si sa valeur de retour de **SubmitMessage** est MAPI_E_WAIT ou MAPI_E_NETWORK_ERROR.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-177">The transport provider must fill in that value if its return value from **SubmitMessage** is MAPI_E_WAIT or MAPI_E_NETWORK_ERROR.</span></span> <span data-ttu-id="a0bb9-178">Si une condition d’erreur grave se produit, le fournisseur de transport doit appeler la méthode [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) avec l’NOTIFY_CRITICAL_ERROR’indicateur.</span><span class="sxs-lookup"><span data-stu-id="a0bb9-178">If a severe error condition occurs, the transport provider must call the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method with the NOTIFY_CRITICAL_ERROR flag.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="a0bb9-179">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a0bb9-179">See also</span></span>



[<span data-ttu-id="a0bb9-180">IMAPIProp::SaveChanges</span><span class="sxs-lookup"><span data-stu-id="a0bb9-180">IMAPIProp::SaveChanges</span></span>](imapiprop-savechanges.md)
  
[<span data-ttu-id="a0bb9-181">IMAPISupport::SpoolerNotify</span><span class="sxs-lookup"><span data-stu-id="a0bb9-181">IMAPISupport::SpoolerNotify</span></span>](imapisupport-spoolernotify.md)
  
[<span data-ttu-id="a0bb9-182">IMAPISupport::SpoolerYield</span><span class="sxs-lookup"><span data-stu-id="a0bb9-182">IMAPISupport::SpoolerYield</span></span>](imapisupport-spooleryield.md)
  
[<span data-ttu-id="a0bb9-183">IXPLogon::EndMessage</span><span class="sxs-lookup"><span data-stu-id="a0bb9-183">IXPLogon::EndMessage</span></span>](ixplogon-endmessage.md)
  
[<span data-ttu-id="a0bb9-184">IXPLogon::TransportNotify</span><span class="sxs-lookup"><span data-stu-id="a0bb9-184">IXPLogon::TransportNotify</span></span>](ixplogon-transportnotify.md)
  
[<span data-ttu-id="a0bb9-185">IXPLogon : IUnknown</span><span class="sxs-lookup"><span data-stu-id="a0bb9-185">IXPLogon : IUnknown</span></span>](ixplogoniunknown.md)

