---
title: Identité principale MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8787a873-6752-4b17-8ea3-8fed793e1371
description: Dernière modification le 09 mars 2015
ms.openlocfilehash: de1fe8fd5ef5a6e79934478c62b2403c48f85b5e
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22565878"
---
# <a name="mapi-primary-identity"></a><span data-ttu-id="8e7e3-103">Identité principale MAPI</span><span class="sxs-lookup"><span data-stu-id="8e7e3-103">MAPI Primary Identity</span></span>

  
  
<span data-ttu-id="8e7e3-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8e7e3-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8e7e3-105">La plupart des sessions MAPI ont un fournisseur de services qui fournit l’identité du principale pour la session.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-105">Most MAPI sessions have a particular service provider that supplies the primary identity for the session.</span></span> <span data-ttu-id="8e7e3-106">En règle générale, il est un fournisseur de carnet d’adresses, qui fournit l’identité par le biais d’une de ses listes de distribution ou les objets utilisateur de messagerie.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-106">Typically, it is an address book provider, which supplies identity through one of its messaging user objects or distribution lists.</span></span> <span data-ttu-id="8e7e3-107">En fait, MAPI recommande de services de messagerie qui incluent un fournisseur de carnet d’adresses d’utiliser une de ses objets pour l’identité du principale.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-107">In fact, MAPI recommends that message services that include an address book provider use one of its objects for the primary identity.</span></span> <span data-ttu-id="8e7e3-108">Lorsqu’un fournisseur de services qui appartient à un service de message fournit l’identité principale, tous les autres fournisseurs de service dans le service message partagent cette identité.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-108">When a service provider that belongs to a message service supplies the primary identity, all of the other service providers in the message service share this identity.</span></span>
  
<span data-ttu-id="8e7e3-109">Le fichier MAPISVC.inf. Fichier configuration comporte des entrées relatives à l’identité au niveau du service de message et au niveau du fournisseur de service.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-109">The MAPISVC.INF configuration file has entries relating to identity at both the message service and service provider level.</span></span> <span data-ttu-id="8e7e3-110">Sections de service de message doivent inclure une entrée qui indique si le service peut fournir l’identité du principale ; sections de fournisseur de service incluent une entrée similaire uniquement lorsque le fournisseur peut fournir une identité.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-110">Message service sections must include an entry that states whether or not the service can supply the primary identity; service provider sections include a similar entry only when the provider can supply an identity.</span></span>
  
<span data-ttu-id="8e7e3-111">Le tableau suivant répertorie les entrées qui apparaissent dans les sections de fournisseur de service dans le fichier MAPISVC.inf et le service de message. Fichier.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-111">The following table lists the entries that appear in the message service and service provider sections in the MAPISVC.INF file.</span></span>
  
|<span data-ttu-id="8e7e3-112">**Fournisseur d’identité principale**</span><span class="sxs-lookup"><span data-stu-id="8e7e3-112">**Primary identity supplier**</span></span>|<span data-ttu-id="8e7e3-113">**Paramètre PR_RESOURCE_FLAGS**</span><span class="sxs-lookup"><span data-stu-id="8e7e3-113">**PR_RESOURCE_FLAGS setting**</span></span>|
|:-----|:-----|
|<span data-ttu-id="8e7e3-114">Service de message</span><span class="sxs-lookup"><span data-stu-id="8e7e3-114">Message service</span></span>  <br/> | `SERVICE_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="8e7e3-115">Pas le service de message</span><span class="sxs-lookup"><span data-stu-id="8e7e3-115">Not the message service</span></span>  <br/> | `SERVICE_NO_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="8e7e3-116">Fournisseur de services</span><span class="sxs-lookup"><span data-stu-id="8e7e3-116">Service provider</span></span>  <br/> | `STATUS_PRIMARY_IDENTITY` <br/> |
   
<span data-ttu-id="8e7e3-117">Bien que plusieurs services de messagerie peuvent déclarer leur capacité à fournir l’identité principale d’une session, service qu’un message est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-117">Although multiple message services can declare their ability to provide a session's primary identity, only one message service is selected to do so.</span></span> <span data-ttu-id="8e7e3-118">Cette sélection peut se produire :</span><span class="sxs-lookup"><span data-stu-id="8e7e3-118">This selection can occur:</span></span>
  
- <span data-ttu-id="8e7e3-119">Lorsque vous créez un profil.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-119">When a profile is created.</span></span>
    
- <span data-ttu-id="8e7e3-120">Lorsqu’un client appelle **IMsgServiceAdmin::SetPrimaryIdentity** pour établir explicitement un service de message particulier en tant que le fournisseur de l’identité de la session.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-120">When a client calls **IMsgServiceAdmin::SetPrimaryIdentity** to explicitly establish a particular message service as the provider of the session identity.</span></span> <span data-ttu-id="8e7e3-121">Pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-121">For more information.</span></span> <span data-ttu-id="8e7e3-122">Voir [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="8e7e3-122">See [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span></span>
    
<span data-ttu-id="8e7e3-123">Lorsqu’un profil est créé, MAPI désigne le premier service de message à être configuré qui inclut un fournisseur avec l’indicateur STATUS_PRIMARY_IDENTITY dans sa propriété **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) pour fournir l’identité du principale .</span><span class="sxs-lookup"><span data-stu-id="8e7e3-123">When a profile is created, MAPI designates the first message service to be configured that includes a provider with the STATUS_PRIMARY_IDENTITY flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property to supply the primary identity.</span></span> <span data-ttu-id="8e7e3-124">Au sein du service de message spécifique, le premier fournisseur à configurer avec cet indicateur défini de ressources est choisi pour fournir l’identité du service.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-124">Within the designated message service, the first provider to be configured with this resource flag set is chosen to provide the identity for the service.</span></span> <span data-ttu-id="8e7e3-125">L’indicateur STATUS_PRIMARY_IDENTITY est désactivée pour tous les autres fournisseurs dans le service désigné et autres services de messagerie dans le profil.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-125">The STATUS_PRIMARY_IDENTITY flag is cleared for all other providers in the designated service and other message services in the profile.</span></span> <span data-ttu-id="8e7e3-126">Si le fournisseur d’identité principale de fournir à tout moment est supprimé du profil, MAPI attribue le rôle au fournisseur suivant pour configurer qui peut fournir l’identité.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-126">If at any time the provider supplying primary identity is removed from the profile, MAPI assigns the role to the next provider to be configured that can supply identity.</span></span> <span data-ttu-id="8e7e3-127">Cela est déterminé par l’apparence de la `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entrée dans la section du fournisseur dans le fichier MAPISVC.INF.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-127">This is determined by the appearance of the  `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entry in the provider's section in MAPISVC.INF.</span></span> 
  
<span data-ttu-id="8e7e3-128">Lorsqu’un client appelle la méthode de **IMsgServiceAdmin::SetPrimaryIdentity** d’un service de message, il spécifie la MAPIUID pour un fournisseur de services au sein du service cible.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-128">When a client calls a message service's **IMsgServiceAdmin::SetPrimaryIdentity** method, it specifies the MAPIUID for a service provider within the target service.</span></span> <span data-ttu-id="8e7e3-129">Pour plus d’informations, voir [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="8e7e3-129">For more information, see [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="8e7e3-130">Le fournisseur de services représenté par l' **MAPIUID** est affecté à fournir l’identité principale pour le service de message et de la session, et toutes les autres fournisseurs dans le service utilisent cette identité.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-130">The service provider represented by the **MAPIUID** is assigned to supply the primary identity for the message service and for the session, and all of the other providers in the service will share this identity.</span></span> 
  
<span data-ttu-id="8e7e3-131">Chaque fournisseur dans le service message chargé de fournir l’identité du principale met à jour sa ligne dans la table d’état pour inclure les propriétés suivantes.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-131">Every provider in the message service responsible for supplying the primary identity updates its row in the status table to include the following properties.</span></span>
  
|<span data-ttu-id="8e7e3-132">**Propriété identité principale**</span><span class="sxs-lookup"><span data-stu-id="8e7e3-132">**Primary identity property**</span></span>|<span data-ttu-id="8e7e3-133">**Définition sur**</span><span class="sxs-lookup"><span data-stu-id="8e7e3-133">**Set to**</span></span>|
|:-----|:-----|
|<span data-ttu-id="8e7e3-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8e7e3-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8e7e3-135">Nom complet de l’objet en fournissant l’identité du principale.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-135">Display name of the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="8e7e3-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8e7e3-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8e7e3-137">Clé de recherche pour l’objet en fournissant l’identité du principale.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-137">Search key for the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="8e7e3-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8e7e3-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8e7e3-139">Identificateur d’entrée pour l’objet en fournissant l’identité du principale.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-139">Entry identifier for the object supplying the primary identity.</span></span>  <br/> |
   
 <span data-ttu-id="8e7e3-140">**Pour récupérer l’identificateur d’entrée pour l’objet en fournissant l’identité du principale**</span><span class="sxs-lookup"><span data-stu-id="8e7e3-140">**To retrieve the entry identifier for the object supplying the primary identity**</span></span>
  
- <span data-ttu-id="8e7e3-141">Appelez la méthode **IMAPISession::QueryIdentity** .</span><span class="sxs-lookup"><span data-stu-id="8e7e3-141">Call the **IMAPISession::QueryIdentity** method.</span></span> <span data-ttu-id="8e7e3-142">Pour plus d’informations, voir [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="8e7e3-142">For more information, see [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span></span> <span data-ttu-id="8e7e3-143">**QueryIdentity** recherche dans la table d’état de la ligne qui contient la valeur STATUS_PRIMARY_IDENTITY dans la colonne **PR_RESOURCE_FLAGS** et renvoie le correspondant **PR_IDENTITY_ENTRYID** en tant que l’identificateur d’entrée pour le serveur principal identité.</span><span class="sxs-lookup"><span data-stu-id="8e7e3-143">**QueryIdentity** searches the status table for the row that contains the value STATUS_PRIMARY_IDENTITY in its **PR_RESOURCE_FLAGS** column and returns the corresponding **PR_IDENTITY_ENTRYID** as the entry identifier for the primary identity.</span></span> 
    

