---
title: Ouverture d’une banque de messages
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 43b23fd7-999a-42c0-8f4d-47f5de266bdb
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 665c14b285db166e4f2a421d46e57f23e2f7ad52
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432372"
---
# <a name="opening-a-message-store"></a><span data-ttu-id="a0dba-103">Ouverture d’une banque de messages</span><span class="sxs-lookup"><span data-stu-id="a0dba-103">Opening a message store</span></span>

<span data-ttu-id="a0dba-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a0dba-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a0dba-105">Selon le profil, un client doit ouvrir une ou plusieurs magasins de messages au cours d’une session classique.</span><span class="sxs-lookup"><span data-stu-id="a0dba-105">Depending on the profile, a client will need to open one or more message stores during a typical session.</span></span> <span data-ttu-id="a0dba-106">L’ouverture d’une magasin de messages signifie accéder à un pointeur vers son [implémentation IMsgStore : IMAPIProp.](imsgstoreimapiprop.md)</span><span class="sxs-lookup"><span data-stu-id="a0dba-106">Opening a message store means gaining access to a pointer to its [IMsgStore : IMAPIProp](imsgstoreimapiprop.md) implementation.</span></span> <span data-ttu-id="a0dba-107">**L’interface IMsgStore** fournit des méthodes de notification, d’affectation de dossiers et d’accès aux dossiers et aux messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-107">The **IMsgStore** interface provides methods for notification, making folder assignments, and accessing folders and messages.</span></span> 
  
<span data-ttu-id="a0dba-108">Clients open message stores at logon and when a profile is being modified.</span><span class="sxs-lookup"><span data-stu-id="a0dba-108">Clients open message stores at logon and when a profile is being modified.</span></span> <span data-ttu-id="a0dba-109">Si votre client permet aux utilisateurs d’ajouter des magasins de messages au profil pendant une session active, vous pouvez les ouvrir immédiatement ou les ignorer jusqu’à la prochaine session.</span><span class="sxs-lookup"><span data-stu-id="a0dba-109">If your client allows users to add message stores to the profile during an active session, you can either open them immediately or ignore them until the next session.</span></span> <span data-ttu-id="a0dba-110">En vous enregistrant pour les notifications sur la table de la boutique de messages, vous serez averti de la disponibilité d’une nouvelle magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-110">By registering for notifications on the message store table, you will be alerted to the availability of a new message store.</span></span>
  
<span data-ttu-id="a0dba-111">Pour ouvrir une magasin de messages, son identificateur d’entrée doit être disponible.</span><span class="sxs-lookup"><span data-stu-id="a0dba-111">To open a message store, you must have its entry identifier available.</span></span> <span data-ttu-id="a0dba-112">La plupart des clients accèdent aux identificateurs d’entrée pour les magasins de messages qu’ils souhaitent ouvrir via la table de la boutique de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-112">Most clients access the entry identifiers for the message stores they wish to open through the message store table.</span></span> <span data-ttu-id="a0dba-113">Toutefois, certains messages stockent le format de leurs identificateurs d’entrée, ce qui permet aux clients de contourner la table de la boutique de messages et de construire l’identificateur d’entrée nécessaire.</span><span class="sxs-lookup"><span data-stu-id="a0dba-113">However, some message stores document the format of their entry identifiers, thereby enabling clients to bypass the message store table and construct the necessary entry identifier.</span></span> <span data-ttu-id="a0dba-114">Ils peuvent transmettre cet identificateur d’entrée directement à [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) et MAPI crée automatiquement une section de profil pour le fournisseur sans l’associer à un service de message.</span><span class="sxs-lookup"><span data-stu-id="a0dba-114">They can pass this entry identifier directly to [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) and MAPI automatically creates a profile section for the provider without associating it with any message service.</span></span> 
  
## <a name="retrieve-an-entry-identifier-from-the-message-store-table"></a><span data-ttu-id="a0dba-115">Récupérer un identificateur d’entrée à partir de la table de la boutique de messages</span><span class="sxs-lookup"><span data-stu-id="a0dba-115">Retrieve an entry identifier from the message store table</span></span>
  
1. <span data-ttu-id="a0dba-116">Appelez [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) pour ouvrir la table de la boutique de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-116">Call [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) to open the message store table.</span></span> 
    
2. <span data-ttu-id="a0dba-117">Appelez **IMAPITable::SetColumns** pour limiter le tableau à un petit jeu de colonnes qui inclut les colonnes suivantes :</span><span class="sxs-lookup"><span data-stu-id="a0dba-117">Call **IMAPITable::SetColumns** to limit the table to a small column set that includes the following columns:</span></span> 
    
   - <span data-ttu-id="a0dba-118">**PR_PROVIDER_DISPLAY** ou **PR_DISPLAY_NAME**</span><span class="sxs-lookup"><span data-stu-id="a0dba-118">**PR_PROVIDER_DISPLAY** or **PR_DISPLAY_NAME**</span></span>
   - <span data-ttu-id="a0dba-119">**PR_ENTRYID** propriétés</span><span class="sxs-lookup"><span data-stu-id="a0dba-119">**PR_ENTRYID** properties</span></span> 
   - <span data-ttu-id="a0dba-120">**PR_MDB_PROVIDER**</span><span class="sxs-lookup"><span data-stu-id="a0dba-120">**PR_MDB_PROVIDER**</span></span>
   - <span data-ttu-id="a0dba-121">**PR_RESOURCE_FLAGS**</span><span class="sxs-lookup"><span data-stu-id="a0dba-121">**PR_RESOURCE_FLAGS**</span></span>
    
3. <span data-ttu-id="a0dba-122">Créez une restriction pour filtrer la ligne qui représente la magasin de messages à ouvrir.</span><span class="sxs-lookup"><span data-stu-id="a0dba-122">Build a restriction to filter out the row that represents the message store to be opened.</span></span> <span data-ttu-id="a0dba-123">Pour plus d’informations sur la recherche de la magasin de messages par défaut, voir [Ouverture de la boutique de messages par défaut.](opening-the-default-message-store.md)</span><span class="sxs-lookup"><span data-stu-id="a0dba-123">For more information about looking for the default message store, see [Opening the Default Message Store](opening-the-default-message-store.md).</span></span> <span data-ttu-id="a0dba-124">Pour rechercher un magasin de messages par nom, appliquez l’une des restrictions de propriété suivantes :</span><span class="sxs-lookup"><span data-stu-id="a0dba-124">To look for a message store by name, apply any of the following property restrictions:</span></span>
    
   - <span data-ttu-id="a0dba-125">Correspond **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) avec le nom général de ce type de magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-125">Match **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) with the general name for this type of message store.</span></span> <span data-ttu-id="a0dba-126">Par exemple, PR_PROVIDER_DISPLAY peut être définie sur « Dossiers personnels ».</span><span class="sxs-lookup"><span data-stu-id="a0dba-126">For example, PR_PROVIDER_DISPLAY might be set to "Personal Folders".</span></span>
    
   - <span data-ttu-id="a0dba-127">Faire **correspondre PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) avec le **MAPIUID** spécifique pour ce type de magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-127">Match **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) with the specific **MAPIUID** for this type of message store.</span></span> 
    
   - <span data-ttu-id="a0dba-128">Faire **correspondre PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) avec le nom de ce magasin de messages particulier.</span><span class="sxs-lookup"><span data-stu-id="a0dba-128">Match **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) with the name for this particular message store.</span></span> <span data-ttu-id="a0dba-129">Par exemple, **PR_DISPLAY_NAME** peut être définie sur « Mes messages pour l’année fiscale 2010 ».</span><span class="sxs-lookup"><span data-stu-id="a0dba-129">For example, **PR_DISPLAY_NAME** might be set to "My Messages for Fiscal Year 2010."</span></span> 
    
4. <span data-ttu-id="a0dba-130">Appelez [HrQueryAllRows pour](hrqueryallrows.md) récupérer la ligne appropriée à partir de la table de la boutique de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-130">Call [HrQueryAllRows](hrqueryallrows.md) to retrieve the appropriate row from the message store table.</span></span> <span data-ttu-id="a0dba-131">L’identificateur d’entrée de la ligne sera inclus dans le tableau des valeurs de propriété pour le membre **aRow** du jeu de lignes pointé par le _paramètre pprows._</span><span class="sxs-lookup"><span data-stu-id="a0dba-131">The entry identifier for the row will be included in the property value array for the **aRow** member of the row set pointed to by the  _pprows_ parameter.</span></span> 
    
5. <span data-ttu-id="a0dba-132">Appelez [FreeProws pour](freeprows.md) libérer le jeu de lignes pointé par  _pprows_.</span><span class="sxs-lookup"><span data-stu-id="a0dba-132">Call [FreeProws](freeprows.md) to free the row set pointed to by  _pprows_.</span></span>
    
6. <span data-ttu-id="a0dba-133">Release the message store table by calling its **IUnknown::Release** method.</span><span class="sxs-lookup"><span data-stu-id="a0dba-133">Release the message store table by calling its **IUnknown::Release** method.</span></span> 
    
<span data-ttu-id="a0dba-134">Si vous avez créé un identificateur d’entrée personnalisé pour l’ouverture de la boutique de messages, appelez la fonction [WrapStoreEntryID](wrapstoreentryid.md) pour la convertir en identificateur d’entrée standard.</span><span class="sxs-lookup"><span data-stu-id="a0dba-134">If you have created a custom entry identifier for the message store to be opened, call the [WrapStoreEntryID](wrapstoreentryid.md) function to convert it to a standard entry identifier.</span></span> 
  
<span data-ttu-id="a0dba-135">Une fois que vous avez l’identificateur d’entrée d’une boutique de messages, appelez l’une des méthodes suivantes pour l’ouvrir :</span><span class="sxs-lookup"><span data-stu-id="a0dba-135">After you have a message store's entry identifier, call one of the following methods to open it:</span></span>
  
- [<span data-ttu-id="a0dba-136">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="a0dba-136">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md)
- [<span data-ttu-id="a0dba-137">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a0dba-137">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
<span data-ttu-id="a0dba-138">Appelez **OpenMsgStore** si vous devez spécifier une variété d’options spéciales pour la magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-138">Call **OpenMsgStore** if you need to specify a variety of special options for the message store.</span></span> <span data-ttu-id="a0dba-139">**OpenMsgStore** vous permet de supprimer l’affichage des boîtes de dialogue, d’identifier la magasin de messages comme temporaire ou comme magasin de non-hébergement, de définir des niveaux d’accès et de différer les erreurs.</span><span class="sxs-lookup"><span data-stu-id="a0dba-139">**OpenMsgStore** allows you to suppress the display of dialog boxes, identify the message store as temporary or as a nonmessaging store, set access levels, and to defer errors.</span></span> <span data-ttu-id="a0dba-140">**OpenEntry vous permet** uniquement de définir des niveaux d’accès et de différer les erreurs.</span><span class="sxs-lookup"><span data-stu-id="a0dba-140">**OpenEntry** allows you only to set access levels and defer errors.</span></span> 
  
<span data-ttu-id="a0dba-141">La définition MDB_NO_MAIL’indicateur de message indique à MAPI que la boutique de messages ne sera pas utilisée pour l’envoi ou la réception de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-141">Setting the MDB_NO_MAIL flag indicates to MAPI that the message store will not be used for sending or receiving messages.</span></span> <span data-ttu-id="a0dba-142">MAPI n’informe pas lepooler MAPI de l’existence de ce magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-142">MAPI does not inform the MAPI spooler about the existence of this message store.</span></span> <span data-ttu-id="a0dba-143">L MDB_TEMPORARY désigne une collection de messages comme temporaire, ce qui signifie qu’elle ne peut pas être utilisée pour stocker des informations permanentes.</span><span class="sxs-lookup"><span data-stu-id="a0dba-143">The MDB_TEMPORARY flag designates a message store as temporary, implying that it cannot be used to store permanent information.</span></span> <span data-ttu-id="a0dba-144">Les magasins de messages temporaires n’apparaissent pas dans la table de la boutique de messages.</span><span class="sxs-lookup"><span data-stu-id="a0dba-144">Temporary message stores do not appear in the message store table.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="a0dba-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a0dba-145">See also</span></span>

- [<span data-ttu-id="a0dba-146">IMAPITable::SetColumns</span><span class="sxs-lookup"><span data-stu-id="a0dba-146">IMAPITable::SetColumns</span></span>](imapitable-setcolumns.md)

