---
title: Ouverture d’une banque de messages
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 43b23fd7-999a-42c0-8f4d-47f5de266bdb
description: 'Dernière modification : 23 juillet 2011'
ms.openlocfilehash: 665c14b285db166e4f2a421d46e57f23e2f7ad52
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32326221"
---
# <a name="opening-a-message-store"></a><span data-ttu-id="e9977-103">Ouverture d’une banque de messages</span><span class="sxs-lookup"><span data-stu-id="e9977-103">Opening a message store</span></span>

<span data-ttu-id="e9977-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e9977-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e9977-105">Selon le profil, un client doit ouvrir un ou plusieurs magasins de messages pendant une session standard.</span><span class="sxs-lookup"><span data-stu-id="e9977-105">Depending on the profile, a client will need to open one or more message stores during a typical session.</span></span> <span data-ttu-id="e9977-106">L'ouverture d'une banque de messages permet d'accéder à un pointeur vers son implémentation [IMsgStore: IMAPIProp](imsgstoreimapiprop.md) .</span><span class="sxs-lookup"><span data-stu-id="e9977-106">Opening a message store means gaining access to a pointer to its [IMsgStore : IMAPIProp](imsgstoreimapiprop.md) implementation.</span></span> <span data-ttu-id="e9977-107">L'interface **IMsgStore** fournit des méthodes de notification, de création d'affectations de dossiers et d'accès aux dossiers et aux messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-107">The **IMsgStore** interface provides methods for notification, making folder assignments, and accessing folders and messages.</span></span> 
  
<span data-ttu-id="e9977-108">Les clients ouvrent les banques de messages à l'ouverture de session et lorsqu'un profil est modifié.</span><span class="sxs-lookup"><span data-stu-id="e9977-108">Clients open message stores at logon and when a profile is being modified.</span></span> <span data-ttu-id="e9977-109">Si votre client permet aux utilisateurs d'ajouter des banques de messages au profil pendant une session active, vous pouvez les ouvrir immédiatement ou les ignorer jusqu'à la prochaine session.</span><span class="sxs-lookup"><span data-stu-id="e9977-109">If your client allows users to add message stores to the profile during an active session, you can either open them immediately or ignore them until the next session.</span></span> <span data-ttu-id="e9977-110">En vous inscrivant aux notifications dans la table de banque de messages, vous serez averti de la disponibilité d'une nouvelle banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-110">By registering for notifications on the message store table, you will be alerted to the availability of a new message store.</span></span>
  
<span data-ttu-id="e9977-111">Pour ouvrir une banque de messages, son identificateur d'entrée doit être disponible.</span><span class="sxs-lookup"><span data-stu-id="e9977-111">To open a message store, you must have its entry identifier available.</span></span> <span data-ttu-id="e9977-112">La plupart des clients accèdent aux identificateurs d'entrée pour les banques de messages qu'ils souhaitent ouvrir par le biais de la table de banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-112">Most clients access the entry identifiers for the message stores they wish to open through the message store table.</span></span> <span data-ttu-id="e9977-113">Toutefois, certains magasins de messages documentent le format de leurs identificateurs d'entrée, ce qui permet aux clients de contourner la table de banque de messages et de construire l'identificateur d'entrée nécessaire.</span><span class="sxs-lookup"><span data-stu-id="e9977-113">However, some message stores document the format of their entry identifiers, thereby enabling clients to bypass the message store table and construct the necessary entry identifier.</span></span> <span data-ttu-id="e9977-114">Ils peuvent transmettre cet identificateur d'entrée directement à [IMAPISession:: OpenMsgStore](imapisession-openmsgstore.md) et MAPI crée automatiquement une section de profil pour le fournisseur sans l'associer à un service de messagerie.</span><span class="sxs-lookup"><span data-stu-id="e9977-114">They can pass this entry identifier directly to [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) and MAPI automatically creates a profile section for the provider without associating it with any message service.</span></span> 
  
## <a name="retrieve-an-entry-identifier-from-the-message-store-table"></a><span data-ttu-id="e9977-115">Récupérer un identificateur d'entrée de la table de banque de messages</span><span class="sxs-lookup"><span data-stu-id="e9977-115">Retrieve an entry identifier from the message store table</span></span>
  
1. <span data-ttu-id="e9977-116">Appelez [IMAPISession:: GetMsgStoresTable](imapisession-getmsgstorestable.md) pour ouvrir la table de banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-116">Call [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) to open the message store table.</span></span> 
    
2. <span data-ttu-id="e9977-117">Appelez **IMAPITable:: SetColumns** pour limiter le tableau à un petit jeu de colonnes qui inclut les colonnes suivantes:</span><span class="sxs-lookup"><span data-stu-id="e9977-117">Call **IMAPITable::SetColumns** to limit the table to a small column set that includes the following columns:</span></span> 
    
   - <span data-ttu-id="e9977-118">**PR_PROVIDER_DISPLAY** ou **PR_DISPLAY_NAME**</span><span class="sxs-lookup"><span data-stu-id="e9977-118">**PR_PROVIDER_DISPLAY** or **PR_DISPLAY_NAME**</span></span>
   - <span data-ttu-id="e9977-119">Propriétés **PR_ENTRYID**</span><span class="sxs-lookup"><span data-stu-id="e9977-119">**PR_ENTRYID** properties</span></span> 
   - <span data-ttu-id="e9977-120">**PR_MDB_PROVIDER**</span><span class="sxs-lookup"><span data-stu-id="e9977-120">**PR_MDB_PROVIDER**</span></span>
   - <span data-ttu-id="e9977-121">**PR_RESOURCE_FLAGS**</span><span class="sxs-lookup"><span data-stu-id="e9977-121">**PR_RESOURCE_FLAGS**</span></span>
    
3. <span data-ttu-id="e9977-122">Créez une restriction pour filtrer la ligne qui représente la Banque de messages à ouvrir.</span><span class="sxs-lookup"><span data-stu-id="e9977-122">Build a restriction to filter out the row that represents the message store to be opened.</span></span> <span data-ttu-id="e9977-123">Pour plus d'informations sur la recherche de la Banque de messages par défaut, consultez [la rubrique ouverture de la Banque de messages par défaut](opening-the-default-message-store.md).</span><span class="sxs-lookup"><span data-stu-id="e9977-123">For more information about looking for the default message store, see [Opening the Default Message Store](opening-the-default-message-store.md).</span></span> <span data-ttu-id="e9977-124">Pour rechercher une banque de messages par nom, appliquez l'une des restrictions de propriété suivantes:</span><span class="sxs-lookup"><span data-stu-id="e9977-124">To look for a message store by name, apply any of the following property restrictions:</span></span>
    
   - <span data-ttu-id="e9977-125">Faire correspondre **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) au nom général de ce type de banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-125">Match **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) with the general name for this type of message store.</span></span> <span data-ttu-id="e9977-126">Par exemple, PR_PROVIDER_DISPLAY peut être défini sur «dossiers personnels».</span><span class="sxs-lookup"><span data-stu-id="e9977-126">For example, PR_PROVIDER_DISPLAY might be set to "Personal Folders".</span></span>
    
   - <span data-ttu-id="e9977-127">Faire correspondre **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) avec le **MAPIUID** spécifique pour ce type de banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-127">Match **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) with the specific **MAPIUID** for this type of message store.</span></span> 
    
   - <span data-ttu-id="e9977-128">Faire correspondre **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) au nom de cette banque de messages particulière.</span><span class="sxs-lookup"><span data-stu-id="e9977-128">Match **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) with the name for this particular message store.</span></span> <span data-ttu-id="e9977-129">Par exemple, **PR_DISPLAY_NAME** peut être défini sur «mes messages pour l'année fiscale 2010».</span><span class="sxs-lookup"><span data-stu-id="e9977-129">For example, **PR_DISPLAY_NAME** might be set to "My Messages for Fiscal Year 2010."</span></span> 
    
4. <span data-ttu-id="e9977-130">Appelez [HrQueryAllRows](hrqueryallrows.md) pour extraire la ligne appropriée de la table de banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-130">Call [HrQueryAllRows](hrqueryallrows.md) to retrieve the appropriate row from the message store table.</span></span> <span data-ttu-id="e9977-131">L'identificateur d'entrée de la ligne est inclus dans le tableau de valeurs de la propriété pour le membre **aRow** du jeu de lignes pointé par le paramètre _ppRows_ .</span><span class="sxs-lookup"><span data-stu-id="e9977-131">The entry identifier for the row will be included in the property value array for the **aRow** member of the row set pointed to by the  _pprows_ parameter.</span></span> 
    
5. <span data-ttu-id="e9977-132">Appelez [FreeProws](freeprows.md) pour libérer l'ensemble de lignes pointé par _ppRows_.</span><span class="sxs-lookup"><span data-stu-id="e9977-132">Call [FreeProws](freeprows.md) to free the row set pointed to by  _pprows_.</span></span>
    
6. <span data-ttu-id="e9977-133">Libérez la table de banque de messages en appelant sa méthode **IUnknown:: Release** .</span><span class="sxs-lookup"><span data-stu-id="e9977-133">Release the message store table by calling its **IUnknown::Release** method.</span></span> 
    
<span data-ttu-id="e9977-134">Si vous avez créé un identificateur d'entrée personnalisé pour la Banque de messages à ouvrir, appelez la fonction [WrapStoreEntryID](wrapstoreentryid.md) pour la convertir en identificateur d'entrée standard.</span><span class="sxs-lookup"><span data-stu-id="e9977-134">If you have created a custom entry identifier for the message store to be opened, call the [WrapStoreEntryID](wrapstoreentryid.md) function to convert it to a standard entry identifier.</span></span> 
  
<span data-ttu-id="e9977-135">Une fois que vous avez un identificateur d'entrée d'une banque de messages, appelez l'une des méthodes suivantes pour l'ouvrir:</span><span class="sxs-lookup"><span data-stu-id="e9977-135">After you have a message store's entry identifier, call one of the following methods to open it:</span></span>
  
- [<span data-ttu-id="e9977-136">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="e9977-136">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md)
- [<span data-ttu-id="e9977-137">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="e9977-137">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
<span data-ttu-id="e9977-138">Appelez **OpenMsgStore** si vous devez spécifier une variété d'options spéciales pour la Banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-138">Call **OpenMsgStore** if you need to specify a variety of special options for the message store.</span></span> <span data-ttu-id="e9977-139">**OpenMsgStore** vous permet de supprimer l'affichage des boîtes de dialogue, d'identifier la Banque de messages comme étant temporaire ou en tant que magasin de messagerie, de définir les niveaux d'accès et de différer les erreurs.</span><span class="sxs-lookup"><span data-stu-id="e9977-139">**OpenMsgStore** allows you to suppress the display of dialog boxes, identify the message store as temporary or as a nonmessaging store, set access levels, and to defer errors.</span></span> <span data-ttu-id="e9977-140">**OpenEntry** vous permet de définir uniquement les niveaux d'accès et les erreurs de report.</span><span class="sxs-lookup"><span data-stu-id="e9977-140">**OpenEntry** allows you only to set access levels and defer errors.</span></span> 
  
<span data-ttu-id="e9977-141">La définition de l'indicateur MDB_NO_MAIL indique à MAPI que la Banque de messages ne sera pas utilisée pour l'envoi ou la réception de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-141">Setting the MDB_NO_MAIL flag indicates to MAPI that the message store will not be used for sending or receiving messages.</span></span> <span data-ttu-id="e9977-142">MAPI n'informe pas le spouleur MAPI de l'existence de cette banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-142">MAPI does not inform the MAPI spooler about the existence of this message store.</span></span> <span data-ttu-id="e9977-143">L'indicateur MDB_TEMPORARY désigne une banque de messages comme étant temporaire, ce qui signifie qu'elle ne peut pas être utilisée pour stocker des informations permanentes.</span><span class="sxs-lookup"><span data-stu-id="e9977-143">The MDB_TEMPORARY flag designates a message store as temporary, implying that it cannot be used to store permanent information.</span></span> <span data-ttu-id="e9977-144">Les banques de messages temporaires n'apparaissent pas dans la table de banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e9977-144">Temporary message stores do not appear in the message store table.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e9977-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e9977-145">See also</span></span>

- [<span data-ttu-id="e9977-146">IMAPITable::SetColumns</span><span class="sxs-lookup"><span data-stu-id="e9977-146">IMAPITable::SetColumns</span></span>](imapitable-setcolumns.md)

