---
title: Développement d’un fournisseur de Transport prenant en charge TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7525eee1-4016-49b8-9509-5ebbe1db819f
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: 9f80feecda219e3bcebbf8ceb346b5034e821470
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19783161"
---
# <a name="developing-a-tnef-enabled-transport-provider"></a><span data-ttu-id="13a59-103">Développement d’un fournisseur de Transport prenant en charge TNEF</span><span class="sxs-lookup"><span data-stu-id="13a59-103">Developing a TNEF-Enabled Transport Provider</span></span>

  
  
<span data-ttu-id="13a59-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="13a59-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="13a59-105">Pour promouvoir l’interopérabilité entre les systèmes de messagerie qui prennent en charge différentes fonctionnalités MAPI, MAPI fournit le Transport Neutral Encapsulation Format TNEF () en tant que standard permet de transférer des données.</span><span class="sxs-lookup"><span data-stu-id="13a59-105">To promote interoperability between messaging systems that support different sets of MAPI features, MAPI provides the Transport Neutral Encapsulation Format (TNEF) as a standard way to transfer data.</span></span> <span data-ttu-id="13a59-106">Ce format encapsule des propriétés MAPI non pris en charge par un système de messagerie sous-jacent dans un objet stream binaire qui peut être transféré ainsi que le message lorsque envoie un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="13a59-106">This format encapsulates MAPI properties not supported by an underlying messaging system into a binary stream that can be transferred along with the message when a transport provider sends it.</span></span> <span data-ttu-id="13a59-107">Le fournisseur de transport qui reçoit le message peut décoder puis le flux binaire pour récupérer toutes les propriétés du message d’origine et les rendre disponibles pour les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="13a59-107">The transport provider that receives the message can then decode the binary stream to retrieve all the properties of the original message and make them available to client applications.</span></span> <span data-ttu-id="13a59-108">Le modèle opérationnel pour TNEF est la suivante :</span><span class="sxs-lookup"><span data-stu-id="13a59-108">The operational model for TNEF is:</span></span>
  
- <span data-ttu-id="13a59-109">Clients de messagerie envoyant et recevoir des messages à un transport TNEF comme d’habitude.</span><span class="sxs-lookup"><span data-stu-id="13a59-109">Messaging clients submit and receive messages to a TNEF transport as normal.</span></span>
    
- <span data-ttu-id="13a59-110">Le transport sépare les propriétés sur les messages sortants en deux catégories : celles prenant en charge le système de messagerie sous-jacent et il n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="13a59-110">The transport separates the properties on outgoing messages into two categories: those that the underlying message system supports and those that it does not.</span></span> <span data-ttu-id="13a59-111">Les valeurs des propriétés qui sont prises en charge par le système de messagerie sous-jacent sont converties dans le format requis.</span><span class="sxs-lookup"><span data-stu-id="13a59-111">The values of the properties that are supported by the underlying messaging system are translated into the required format.</span></span>
    
- <span data-ttu-id="13a59-112">Le transport utilise les méthodes de MAPI TNEF pour coder toutes les propriétés non prises en charge dans un flux de données.</span><span class="sxs-lookup"><span data-stu-id="13a59-112">The transport uses the MAPI TNEF methods to encode any unsupported properties into a single data stream.</span></span> <span data-ttu-id="13a59-113">Le transport puis transforme ce flux de données particulière d’une pièce jointe dans le message sortant, à l’aide du modèle de pièce jointe du système de messagerie sous-jacent, avant d’envoyer le message.</span><span class="sxs-lookup"><span data-stu-id="13a59-113">The transport then turns that data stream into a special attachment on the outgoing message, using the underlying messaging system's attachment model, before sending the message.</span></span>
    
- <span data-ttu-id="13a59-114">Un type de transport TNEF activé qui reçoit un message de ce type exécute deux tâches.</span><span class="sxs-lookup"><span data-stu-id="13a59-114">A TNEF enabled transport that receives such a message does two things.</span></span> <span data-ttu-id="13a59-115">Tout d’abord, traduit les propriétés du message entrant — ceux pris en charge par le système de messagerie sous-jacent, dans propriétés MAPI.</span><span class="sxs-lookup"><span data-stu-id="13a59-115">First, it translates the incoming message's properties — the ones supported by the underlying message system — into MAPI properties.</span></span> <span data-ttu-id="13a59-116">Deuxièmement, si la pièce jointe spéciale n’est présente, il utilise les méthodes de MAPI TNEF pour récupérer les propriétés MAPI supplémentaires à partir de la pièce jointe avant de remettre le message à une application cliente.</span><span class="sxs-lookup"><span data-stu-id="13a59-116">Second, if the special attachment is present, it uses the MAPI TNEF methods to retrieve additional MAPI properties from the attachment before delivering the message to a client application.</span></span>
    
<span data-ttu-id="13a59-117">MAPI fournit une implémentation de l’interface **ITnef** pour une utilisation par des fournisseurs de transport MAPI lorsque vous travaillez avec des objets TNEF.</span><span class="sxs-lookup"><span data-stu-id="13a59-117">MAPI supplies an implementation of the **ITnef** interface for use by MAPI transport providers when working with TNEF objects.</span></span> <span data-ttu-id="13a59-118">La fonction [OpenTnefStreamEx](opentnefstreamex.md) est utilisée pour créer des objets TNEF et les associer à un message.</span><span class="sxs-lookup"><span data-stu-id="13a59-118">The [OpenTnefStreamEx](opentnefstreamex.md) function is used to create TNEF objects and associate them with a message.</span></span> <span data-ttu-id="13a59-119">Flux TNEF sont basées sur l’interface OLE **IStream**</span><span class="sxs-lookup"><span data-stu-id="13a59-119">TNEF streams are built on top of the OLE **IStream** interface</span></span> 
  
> [!NOTE]
> <span data-ttu-id="13a59-120">**OpenTnefStreamEx** vous permet de créer des objets TNEF.</span><span class="sxs-lookup"><span data-stu-id="13a59-120">You use **OpenTnefStreamEx** to create TNEF objects.</span></span> <span data-ttu-id="13a59-121">La fonction **OpenTnefStream** ancienne toujours pour assurer la compatibilité avec l’ancien code source et ne doit pas être utilisée dans un nouveau.</span><span class="sxs-lookup"><span data-stu-id="13a59-121">The old **OpenTnefStream** function still exists for compatibility with old source code and should not be used in anything new.</span></span> 
  
<span data-ttu-id="13a59-122">L’interface **ITnef** fournit les méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="13a59-122">The **ITnef** interface provides the following methods:</span></span> 
  
- [<span data-ttu-id="13a59-123">AddProps</span><span class="sxs-lookup"><span data-stu-id="13a59-123">AddProps</span></span>](itnef-addprops.md)
    
- [<span data-ttu-id="13a59-124">EncodeRecips</span><span class="sxs-lookup"><span data-stu-id="13a59-124">EncodeRecips</span></span>](itnef-encoderecips.md)
    
- [<span data-ttu-id="13a59-125">ExtractProps</span><span class="sxs-lookup"><span data-stu-id="13a59-125">ExtractProps</span></span>](itnef-extractprops.md)
    
- [<span data-ttu-id="13a59-126">Terminer</span><span class="sxs-lookup"><span data-stu-id="13a59-126">Finish</span></span>](itnef-finish.md)
    
- [<span data-ttu-id="13a59-127">FinishComponent</span><span class="sxs-lookup"><span data-stu-id="13a59-127">FinishComponent</span></span>](itnef-finishcomponent.md)
    
- [<span data-ttu-id="13a59-128">OpenTaggedBody</span><span class="sxs-lookup"><span data-stu-id="13a59-128">OpenTaggedBody</span></span>](itnef-opentaggedbody.md)
    
- [<span data-ttu-id="13a59-129">SetProps</span><span class="sxs-lookup"><span data-stu-id="13a59-129">SetProps</span></span>](itnef-setprops.md)
    
<span data-ttu-id="13a59-130">Le modèle de mise en œuvre MAPI TNEF prend en charge :</span><span class="sxs-lookup"><span data-stu-id="13a59-130">The MAPI TNEF implementation model supports:</span></span>
  
- <span data-ttu-id="13a59-131">Toutes les propriétés MAPI sans affecter d’autres propriétés de message.</span><span class="sxs-lookup"><span data-stu-id="13a59-131">All MAPI properties without affecting other message properties.</span></span> <span data-ttu-id="13a59-132">Dans l’ordre pour les messages de survivre transport via un système de messagerie MAPI, toutes les propriétés qui ne peuvent pas être codées en tant que propriétés du système de messagerie doivent être encapsulées.</span><span class="sxs-lookup"><span data-stu-id="13a59-132">In order for MAPI messages to survive transport through a messaging system, all properties that cannot be encoded as properties of the messaging system must be encapsulated.</span></span> <span data-ttu-id="13a59-133">Car il est presque jamais connu au moment où qu'un message est envoyé ou non un client compatible MAPI le message, le jeu d’encapsulation permet à un fournisseur de transport à coder uniquement les propriétés de message MAPI qui n’est pas le cas du système de messagerie prend en charge.</span><span class="sxs-lookup"><span data-stu-id="13a59-133">Because it is almost never known at the time a message is sent whether or not a MAPI-compliant client will receive the message, the encapsulation scheme allows a transport provider to encode only those MAPI message properties that the messaging system does not natively support.</span></span> <span data-ttu-id="13a59-134">Cela signifie que les messages qui utilisent le format TNEF ne sont pas « opaques » pour les systèmes de messagerie qui ne reposent sur MAPI, tel que UNIX basé sur SMTP systèmes de messagerie.</span><span class="sxs-lookup"><span data-stu-id="13a59-134">This means that messages which use TNEF are not "opaque" to messaging systems that are not based on MAPI such as SMTP-based UNIX messaging systems.</span></span> <span data-ttu-id="13a59-135">Ces systèmes reçoivent les propriétés qu’ils prennent en charge de quelque manière par défaut pour les propriétés et d’autres sont reçues en tant qu’un flux de données codé TNEF.</span><span class="sxs-lookup"><span data-stu-id="13a59-135">These systems receive the properties they support in whatever manner is typical for them, and other properties are received as an encoded TNEF data stream.</span></span> <span data-ttu-id="13a59-136">Le fournisseur de transport TNEF est chargé de différenciation entre ces deux jeux de propriétés et de l’envoi de l’ensemble de prise en charge de façon appropriée pour le système de messagerie.</span><span class="sxs-lookup"><span data-stu-id="13a59-136">The TNEF transport provider is responsible for differentiating between these two sets of properties and sending the supported set in the proper manner for the messaging system.</span></span> <span data-ttu-id="13a59-137">TNEF n’émet aucune hypothèse que le niveau de prise en charge offerte par un système de messagerie.</span><span class="sxs-lookup"><span data-stu-id="13a59-137">TNEF makes no assumptions as to the level of support provided by a messaging system.</span></span> <span data-ttu-id="13a59-138">Toutefois, dans les exemples d’utilisation du format TNEF inclus dans cette section, l’hypothèse est faite que le système de messagerie prend en charge au moins une seule pièce jointe en plus du message.</span><span class="sxs-lookup"><span data-stu-id="13a59-138">However, in the examples of TNEF usage included in this section, the assumption is made that the messaging system supports at least one single attachment aside from the message.</span></span> <span data-ttu-id="13a59-139">Dans certains cas, la pièce jointe peut uniquement être pris en charge via un flux UUENCODE et transmise dans le cadre du texte du message.</span><span class="sxs-lookup"><span data-stu-id="13a59-139">In some cases, the attachment can only be supported through a uuencoded stream and transmitted as part of the message text.</span></span> <span data-ttu-id="13a59-140">Uniquement dans les cas rares le système de messagerie a peu prise en charge pour les propriétés de message ce codage TNEF complète de toutes les propriétés est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="13a59-140">Only in very rare circumstances will the messaging system have so little support for message properties that full TNEF encoding of all properties is necessary.</span></span>
    
- <span data-ttu-id="13a59-141">Un mécanisme permettant de déterminer si un flux TNEF sur un message entrant appartient au message, selon la propriété MAPI **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="13a59-141">A mechanism for determining whether a TNEF stream on an incoming message belongs to the message, based on the MAPI property **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)).</span></span> <span data-ttu-id="13a59-142">Cette propriété doit se trouver dans le flux TNEF et dans un en-tête de message approprié.</span><span class="sxs-lookup"><span data-stu-id="13a59-142">This property should be found both in the TNEF stream and in an appropriate message header.</span></span> <span data-ttu-id="13a59-143">Si la propriété possède la même valeur aux deux endroits, ou est manquante à cet emplacement, le flux TNEF est supposé appartenant au message.</span><span class="sxs-lookup"><span data-stu-id="13a59-143">If the property has the same value in both places, or is missing in either place, the TNEF stream is assumed to belong to the message.</span></span> <span data-ttu-id="13a59-144">Dans le cas contraire, le flux TNEF est ignoré.</span><span class="sxs-lookup"><span data-stu-id="13a59-144">Otherwise, the TNEF stream is ignored.</span></span> <span data-ttu-id="13a59-145">Transports TNEF activé sont chargés de choix d’une valeur de cette propriété sur les messages sortants et le codage dans un en-tête de message approprié (par exemple, l’ID de Message : en-tête pour les messages SMTP) et dans le flux TNEF.</span><span class="sxs-lookup"><span data-stu-id="13a59-145">TNEF enabled transports are responsible for choosing a value for this property on outbound messages and encoding it in an appropriate message header (for example, the Message-ID: header for SMTP messages) and in the TNEF stream.</span></span>
    

