---
title: Vue d'ensemble de l'arrêt rapide
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a7830d73-427c-4f8b-86f4-51e040c142c3
description: 'Dernière modification : 26 juin 2012'
ms.openlocfilehash: 8c33214b04e7c41eab173196c09f145c20ddf219
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32341097"
---
# <a name="fast-shutdown-overview"></a><span data-ttu-id="4f61b-103">Vue d'ensemble de l'arrêt rapide</span><span class="sxs-lookup"><span data-stu-id="4f61b-103">Fast Shutdown Overview</span></span>

<span data-ttu-id="4f61b-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4f61b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4f61b-105">L'arrêt rapide est un mécanisme permettant à un client MAPI de lancer un arrêt rapide du processus client, d'avertir tous les fournisseurs avec lesquels le client a une session MAPI active pour enregistrer les données et les paramètres avant la sortie du processus client.</span><span class="sxs-lookup"><span data-stu-id="4f61b-105">Fast shutdown is a mechanism for a MAPI client to initiate a quick shutdown of the client process, notifying all providers with which the client has an active MAPI session to save data and settings before the client process exits.</span></span> <span data-ttu-id="4f61b-106">Cette rubrique décrit le mécanisme de base de l'arrêt rapide.</span><span class="sxs-lookup"><span data-stu-id="4f61b-106">This topic describes the basic mechanism of fast shutdown.</span></span> 

<span data-ttu-id="4f61b-107">À partir de Microsoft Outlook 2010 et y compris Microsoft Outlook 2013, le sous-système MAPI fournit l'interface [IMAPIClientShutdown: IUnknown](imapiclientshutdowniunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="4f61b-107">Starting in Microsoft Outlook 2010 and now including Microsoft Outlook 2013, the MAPI subsystem provides the [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span></span> <span data-ttu-id="4f61b-108">Outlook et d'autres clients MAPI peuvent adopter l'arrêt rapide comme mécanisme par défaut pour quitter le processus client.</span><span class="sxs-lookup"><span data-stu-id="4f61b-108">Outlook and other MAPI clients can adopt fast shutdown as the default mechanism to exit the client process.</span></span> <span data-ttu-id="4f61b-109">Un paramètre au niveau de l'utilisateur dans le Registre Windows de l'ordinateur client contrôle l'adoption de l'arrêt rapide pour tous les clients MAPI de cet utilisateur sur cet ordinateur.</span><span class="sxs-lookup"><span data-stu-id="4f61b-109">A user-level setting in the Windows registry of the client computer controls the adoption of fast shutdown for all MAPI clients for that user on that computer.</span></span> <span data-ttu-id="4f61b-110">Pour plus d'informations sur les paramètres du Registre, consultez la rubrique options de l' [utilisateur à arrêt rapide](fast-shutdown-user-options.md).</span><span class="sxs-lookup"><span data-stu-id="4f61b-110">For details about the registry settings, see [Fast Shutdown User Options](fast-shutdown-user-options.md).</span></span>
  
<span data-ttu-id="4f61b-111">Si un client MAPI doit adopter l'arrêt rapide, il doit utiliser l'interface **IMAPIClientShutdown: IUnknown** .</span><span class="sxs-lookup"><span data-stu-id="4f61b-111">If a MAPI client needs to adopt fast shutdown, it must use the **IMAPIClientShutdown : IUnknown** interface.</span></span> <span data-ttu-id="4f61b-112">Voici le cours classique des événements lorsque le client tente de s'arrêter:</span><span class="sxs-lookup"><span data-stu-id="4f61b-112">The following is the typical course of events when the client attempts to shut down:</span></span> 
  
1. <span data-ttu-id="4f61b-113">Le client MAPI lance l'arrêt en appelant la méthode [IMAPIClientShutdown:: QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) pour déterminer si le sous-système MAPI prend en charge l'arrêt rapide.</span><span class="sxs-lookup"><span data-stu-id="4f61b-113">The MAPI client initiates the shutdown by calling the [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) method to determine whether the MAPI subsystem supports fast shutdown.</span></span> 
    
2. <span data-ttu-id="4f61b-114">Le sous-système MAPI répond avec la prise en charge de l'arrêt rapide disponible à l'appel **IMAPIClientShutdown:: QueryFastShutdown** du client à l'aide de la procédure suivante:</span><span class="sxs-lookup"><span data-stu-id="4f61b-114">The MAPI subsystem responds with the available fast shutdown support to the client's **IMAPIClientShutdown::QueryFastShutdown** call by using the following procedure:</span></span> 
    
    1. <span data-ttu-id="4f61b-115">Le sous-système MAPI appelle la méthode [IMAPIProviderShutdown:: QueryFastShutdown](imapiprovidershutdown-queryfastshutdown.md) pour chaque fournisseur MAPI avec lequel le processus client MAPI a une session MAPI active, si le fournisseur a implémenté l' [IMAPIProviderShutdown: IUnknown](imapiprovidershutdowniunknown.md) Lip.</span><span class="sxs-lookup"><span data-stu-id="4f61b-115">The MAPI subsystem calls the [IMAPIProviderShutdown::QueryFastShutdown](imapiprovidershutdown-queryfastshutdown.md) method for each MAPI provider with which the MAPI client process has an active MAPI session, if the provider has implemented the [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface.</span></span> 
        
       > [!NOTE]
       >  <span data-ttu-id="4f61b-116">Le sous-système MAPI interroge et notifie toujours les fournisseurs MAPI via l'interface **IUnknown IMAPIProviderShutdown: IUnknown** au sein de chaque session MAPI, dans l'ordre suivant:</span><span class="sxs-lookup"><span data-stu-id="4f61b-116">The MAPI subsystem always queries and notifies MAPI providers through the **IMAPIProviderShutdown : IUnknown** interface within each MAPI session in the following order:</span></span>
       > 1. <span data-ttu-id="4f61b-117">Fournisseurs de transport</span><span class="sxs-lookup"><span data-stu-id="4f61b-117">Transport providers</span></span>
       > 2. <span data-ttu-id="4f61b-118">Fournisseurs de carnets d'adresses</span><span class="sxs-lookup"><span data-stu-id="4f61b-118">Address book providers</span></span>
       > 3. <span data-ttu-id="4f61b-119">Fournisseurs de magasin</span><span class="sxs-lookup"><span data-stu-id="4f61b-119">Store providers</span></span> 
    
    2. <span data-ttu-id="4f61b-120">En fonction du paramètre de registre de l'arrêt rapide de cet utilisateur sur l'ordinateur client, le sous-système MAPI spécifie le code de retour approprié à **IMAPIClientShutdown:: QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="4f61b-120">Depending on the fast shutdown registry setting for that user on the client computer, the MAPI subsystem specifies the appropriate return code to **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="4f61b-121">Le code renvoyé est S_OK ou MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="4f61b-121">The return code is either S_OK or MAPI_E_NO_SUPPORT.</span></span>
        
    3. <span data-ttu-id="4f61b-122">Le client MAPI appelle la méthode [IMAPIClientShutdown:: NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) pour indiquer au sous-système MAPI l'intention de s'arrêter.</span><span class="sxs-lookup"><span data-stu-id="4f61b-122">The MAPI client calls the [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) method to indicate to the MAPI subsystem the intention to shut down.</span></span> 
        
    4. <span data-ttu-id="4f61b-123">Le sous-système MAPI indique à chaque fournisseur MAPI chargé de s'arrêter le client MAPI.</span><span class="sxs-lookup"><span data-stu-id="4f61b-123">The MAPI subsystem indicates to each loaded MAPI provider that the MAPI client will shut down.</span></span> <span data-ttu-id="4f61b-124">Pour les fournisseurs qui ont implémenté l'interface **IMAPIProviderShutdown: IUnknown** , le sous-système MAPI appelle la méthode [IMAPIProviderShutdown:: NotifyProcessShutdown](imapiprovidershutdown-notifyprocessshutdown.md) correspondante.</span><span class="sxs-lookup"><span data-stu-id="4f61b-124">For those providers that have implemented the **IMAPIProviderShutdown : IUnknown** interface, the MAPI subsystem calls the corresponding [IMAPIProviderShutdown::NotifyProcessShutdown](imapiprovidershutdown-notifyprocessshutdown.md) method.</span></span> 
        
    5. <span data-ttu-id="4f61b-125">Le client MAPI appelle la méthode [IMAPIClientShutdown::D ofastshutdown](imapiclientshutdown-dofastshutdown.md) pour indiquer au sous-système MAPI que le processus client quitte immédiatement.</span><span class="sxs-lookup"><span data-stu-id="4f61b-125">The MAPI client calls the [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) method to indicate to the MAPI subsystem that the client process is exiting immediately.</span></span> 
        
    6. <span data-ttu-id="4f61b-126">Le sous-système MAPI indique à chaque fournisseur MAPI chargé de quitter le processus client MAPI.</span><span class="sxs-lookup"><span data-stu-id="4f61b-126">The MAPI subsystem indicates to each loaded MAPI provider that the MAPI client process is exiting.</span></span> <span data-ttu-id="4f61b-127">Pour les fournisseurs qui ont implémenté l'interface **IMAPIProviderShutdown: IUnknown** , le sous-système MAPI appelle la méthode [IMAPIProviderShutdown::D ofastshutdown](imapiprovidershutdown-dofastshutdown.md) correspondante.</span><span class="sxs-lookup"><span data-stu-id="4f61b-127">For those providers that have implemented the **IMAPIProviderShutdown : IUnknown** interface, the MAPI subsystem calls the corresponding [IMAPIProviderShutdown::DoFastShutdown](imapiprovidershutdown-dofastshutdown.md) method.</span></span> <span data-ttu-id="4f61b-128">À ce stade, ces fournisseurs MAPI doivent vérifier que toutes les actions nécessaires, telles que l'enregistrement des données et des paramètres, sont terminées en préparation pour le client MAPI afin de déconnecter immédiatement toutes les références et quitter.</span><span class="sxs-lookup"><span data-stu-id="4f61b-128">At this point, these MAPI providers should verify that all necessary actions, such as saving data and settings, are complete in preparation for the MAPI client to immediately disconnect all references and exit.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="4f61b-129">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4f61b-129">See also</span></span>

- [<span data-ttu-id="4f61b-130">Arrêt du client dans MAPI</span><span class="sxs-lookup"><span data-stu-id="4f61b-130">Client Shutdown in MAPI</span></span>](client-shutdown-in-mapi.md)
- [<span data-ttu-id="4f61b-131">Options de l'utilisateur à arrêt rapide</span><span class="sxs-lookup"><span data-stu-id="4f61b-131">Fast Shutdown User Options</span></span>](fast-shutdown-user-options.md)
- [<span data-ttu-id="4f61b-132">Meilleures pratiques en cas d’arrêt rapide</span><span class="sxs-lookup"><span data-stu-id="4f61b-132">Best Practices for Fast Shutdown</span></span>](best-practices-for-fast-shutdown.md)

