---
title: Tables d’état
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f2b2aca7-757f-4260-96a5-d0af55189711
description: Dernière modification le 9 mars 2015
ms.openlocfilehash: d612738ef8bf0e6925d89a5be7cb423695672d28
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422361"
---
# <a name="status-tables"></a><span data-ttu-id="d2d66-103">Tables d’état</span><span class="sxs-lookup"><span data-stu-id="d2d66-103">Status Tables</span></span>

  
  
<span data-ttu-id="d2d66-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d2d66-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d2d66-105">La table d’état contient des informations relatives à l’état de la session en cours.</span><span class="sxs-lookup"><span data-stu-id="d2d66-105">The status table contains information relating to the state of the current session.</span></span> <span data-ttu-id="d2d66-106">Il existe une table d’état pour chaque session MAPI qui inclut les informations fournies par MAPI et par les fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="d2d66-106">There is one status table for every MAPI session that includes information provided by MAPI and by service providers.</span></span> <span data-ttu-id="d2d66-107">MAPI fournit des données pour trois lignes : une ligne pour le sous-système MAPI, une ligne pour lepooler MAPI et une ligne pour le carnet d’adresses intégré.</span><span class="sxs-lookup"><span data-stu-id="d2d66-107">MAPI provides data for three rows: a row for the MAPI subsystem, a row for the MAPI spooler, and a row for the integrated address book.</span></span> <span data-ttu-id="d2d66-108">Étant donné que les fournisseurs de transport sont tenus de fournir des informations d’état à la table d’état, il existe une ligne pour chaque fournisseur de transport actif.</span><span class="sxs-lookup"><span data-stu-id="d2d66-108">Because transport providers are required to supply status information to the status table, there is one row for every active transport provider.</span></span> <span data-ttu-id="d2d66-109">Les fournisseurs de carnet d’adresses et de magasin de messages peuvent choisir de prendre en charge la table d’état.</span><span class="sxs-lookup"><span data-stu-id="d2d66-109">Address book and message store providers can choose whether to support the status table.</span></span> 
  
<span data-ttu-id="d2d66-110">Étant donné que chaque ligne est fournie par une ressource différente, l’ensemble des colonnes peut varier d’une ligne à l’autre.</span><span class="sxs-lookup"><span data-stu-id="d2d66-110">Because each row is provided by a different resource, the set of columns can vary from row to row.</span></span> <span data-ttu-id="d2d66-111">Chaque objet d’état doit fournir un ensemble de colonnes et un ensemble de colonnes que MAPI fournit.</span><span class="sxs-lookup"><span data-stu-id="d2d66-111">There is a set of columns that every status object is required to supply and a set of columns that MAPI supplies.</span></span> <span data-ttu-id="d2d66-112">Un fournisseur de services peut ajouter à ces ensembles pour exposer des propriétés spécifiques au fournisseur.</span><span class="sxs-lookup"><span data-stu-id="d2d66-112">A service provider can add to these sets to expose provider-specific properties.</span></span> <span data-ttu-id="d2d66-113">Par exemple, les fournisseurs de magasins de messages peuvent ajouter PR_STORE_RECORD_KEY **(** [PidTagStoreRecordKey](pidtagstorerecordkey-canonical-property.md)) pour fournir aux clients l’identificateur de leur magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="d2d66-113">For example, message store providers might add **PR_STORE_RECORD_KEY** ([PidTagStoreRecordKey](pidtagstorerecordkey-canonical-property.md)) to supply clients with the identifier of their message store.</span></span> <span data-ttu-id="d2d66-114">Les clients doivent avoir une connaissance avancée de l’existence de ces informations supplémentaires pour pouvoir les utiliser.</span><span class="sxs-lookup"><span data-stu-id="d2d66-114">Clients must have advance knowledge of the existence of this extra information to be able to use it.</span></span> 
  
<span data-ttu-id="d2d66-115">Le tableau suivant répertorie les propriétés qui doivent se trouver dans chaque ligne de tableau d’état.</span><span class="sxs-lookup"><span data-stu-id="d2d66-115">The following table lists the properties that must be in every status table row.</span></span> <span data-ttu-id="d2d66-116">L’implémenteur de l’objet d’état fournit certaines des propriétés ; d’autres sont calculées par MAPI.</span><span class="sxs-lookup"><span data-stu-id="d2d66-116">The implementer of the status object provides some of the properties; others are computed by MAPI.</span></span>
  
|<span data-ttu-id="d2d66-117">**Propriétés fournies par l’objet status**</span><span class="sxs-lookup"><span data-stu-id="d2d66-117">**Properties provided by status object**</span></span>|<span data-ttu-id="d2d66-118">**Propriétés fournies par MAPI**</span><span class="sxs-lookup"><span data-stu-id="d2d66-118">**Properties provided by MAPI**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d2d66-119">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-119">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="d2d66-120">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-120">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="d2d66-121">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-121">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="d2d66-122">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-122">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="d2d66-123">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-123">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="d2d66-124">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-124">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="d2d66-125">Si l’objet d’état fournit une identité, il doit définir **PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md)), **PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md)) et **PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md)), et inclure ces propriétés dans la table.</span><span class="sxs-lookup"><span data-stu-id="d2d66-125">If the status object provides an identity, it should set **PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md)), **PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md)), and **PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md)), and include these properties in the table.</span></span> 
  
<span data-ttu-id="d2d66-126">Quatre propriétés sont calculées par MAPI pour chaque ligne de tableau d’état :</span><span class="sxs-lookup"><span data-stu-id="d2d66-126">Four properties are computed by MAPI for each status table row:</span></span>
  
|||
|:-----|:-----|
|<span data-ttu-id="d2d66-127">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-127">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="d2d66-128">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-128">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="d2d66-129">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-129">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="d2d66-130">**PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d2d66-130">**PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="d2d66-131">MAPI affecte un identificateur d’entrée à la ligne d’état pour permettre aux clients d’ouvrir l’objet d’état correspondant.</span><span class="sxs-lookup"><span data-stu-id="d2d66-131">MAPI assigns an entry identifier to the status row to enable clients to open the corresponding status object.</span></span> <span data-ttu-id="d2d66-132">Un identificateur de ligne est également affecté pour identifier la ligne dans le tableau comme il s’agit d’une clé d’instance pour identifier les données dans l’objet d’état.</span><span class="sxs-lookup"><span data-stu-id="d2d66-132">A row identifier is also assigned to identify the row in the table as is an instance key to identify the data in the status object.</span></span> <span data-ttu-id="d2d66-133">La **propriété PR_OBJECT_TYPE** est définie sur MAPI_STATUS.</span><span class="sxs-lookup"><span data-stu-id="d2d66-133">The **PR_OBJECT_TYPE** property is set to MAPI_STATUS.</span></span> 
  
<span data-ttu-id="d2d66-134">Pour accéder à la table d’état, les clients appellent la méthode [IMAPISession::GetStatusTable.](imapisession-getstatustable.md)</span><span class="sxs-lookup"><span data-stu-id="d2d66-134">To access the status table, clients call the [IMAPISession::GetStatusTable](imapisession-getstatustable.md) method.</span></span> <span data-ttu-id="d2d66-135">Cet appel ne doit pas être effectué immédiatement au démarrage.</span><span class="sxs-lookup"><span data-stu-id="d2d66-135">This call should not be made immediately upon startup.</span></span> <span data-ttu-id="d2d66-136">Cela est dû au fait que **GetStatusTable** doit attendre que lepooler MAPI initialise les fournisseurs de transport, opération qui est différée jusqu’à ce que le client ait terminé sa ouverture de compte.</span><span class="sxs-lookup"><span data-stu-id="d2d66-136">This is because **GetStatusTable** has to wait for the MAPI spooler to initialize the transport providers, an operation that is postponed until after the client has finished its logon.</span></span> <span data-ttu-id="d2d66-137">**GetStatusTable est** un appel relativement rapide une fois que lepooler MAPI a terminé son traitement de démarrage.</span><span class="sxs-lookup"><span data-stu-id="d2d66-137">**GetStatusTable** is a relatively fast call after the MAPI spooler has completed its startup processing.</span></span> 
  
<span data-ttu-id="d2d66-138">Les informations de la table d’état peuvent être utilisées de différentes manières, par exemple pour accéder à un objet d’état, pour déterminer si un client est en cours d’exécution en mode connecté ou hors connexion, et pour surveiller l’état d’un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="d2d66-138">Status table information can be used in a variety of ways, such as to access a status object, to determine whether a client is running in a connected or offline mode, and to monitor a provider's state.</span></span> <span data-ttu-id="d2d66-139">Par exemple, les clients peuvent ouvrir l’objet d’état d’un fournisseur de services spécifique en passant la valeur de la propriété **PR_ENTRYID** à la méthode [IMAPISession::OpenEntry.](imapisession-openentry.md)</span><span class="sxs-lookup"><span data-stu-id="d2d66-139">For example, clients can open a specific service provider's status object by passing the value of the **PR_ENTRYID** property to the [IMAPISession::OpenEntry](imapisession-openentry.md) method.</span></span> <span data-ttu-id="d2d66-140">L’objet d’état prend en charge l’interface **IMAPIStatus,** une interface qui contient des méthodes pour modifier un mot de passe de fournisseur de services, vider la file d’attente des messages, afficher une feuille des propriétés de configuration ou confirmer l’état auprès d’un fournisseur directement.</span><span class="sxs-lookup"><span data-stu-id="d2d66-140">The status object supports the **IMAPIStatus** interface, an interface that contains methods to change a service provider password, flush the message queue, display a configuration property sheet, or confirm status with a provider directly.</span></span> <span data-ttu-id="d2d66-141">Les informations de la table d’état peuvent également être utilisées pour créer une boîte de dialogue afin d’informer les clients de la progression au cours d’une longue opération.</span><span class="sxs-lookup"><span data-stu-id="d2d66-141">Status table information can also be used to build a dialog box to inform clients of progress during a lengthy operation.</span></span> 
  
<span data-ttu-id="d2d66-142">Les fournisseurs de services qui utilisent la table d’état utilisent la méthode [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) pour créer et mettre à jour leur ligne.</span><span class="sxs-lookup"><span data-stu-id="d2d66-142">Service providers who do support the status table use the [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) method to create and update their row.</span></span> <span data-ttu-id="d2d66-143">Chaque fois qu’une modification a lieu sur leur ligne, tous les objets de réception inscrits pour recevoir des notifications de table d’état doivent être avertis.</span><span class="sxs-lookup"><span data-stu-id="d2d66-143">Whenever a change occurs to their row, all advise sink objects registered to receive status table notifications must be notified.</span></span> <span data-ttu-id="d2d66-144">Les fournisseurs de services peuvent appeler la méthode [IMAPISupport::Notify](imapisupport-notify.md) s’ils utilisent l’utilitaire de notification MAPI ou appeler directement la méthode [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) de chaque réception de notification.</span><span class="sxs-lookup"><span data-stu-id="d2d66-144">Service providers can call the [IMAPISupport::Notify](imapisupport-notify.md) method if they are using the MAPI notification utility or call each advise sink's [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method directly.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="d2d66-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d2d66-145">See also</span></span>



[<span data-ttu-id="d2d66-146">MAPI Tables</span><span class="sxs-lookup"><span data-stu-id="d2d66-146">MAPI Tables</span></span>](mapi-tables.md)

