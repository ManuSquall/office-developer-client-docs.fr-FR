---
title: Table d’état et les objets d’état
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 203765c1-4b08-4032-a5bf-18f3e752a899
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: 774aaea0365066981b9d6426a2579160f6578844
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19787254"
---
# <a name="status-table-and-status-objects"></a><span data-ttu-id="85c72-103">Table d’état et les objets d’état</span><span class="sxs-lookup"><span data-stu-id="85c72-103">Status Table and Status Objects</span></span>

  
  
<span data-ttu-id="85c72-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="85c72-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="85c72-105">MAPI fournit un tableau avec des informations sur l’état du sous-système MAPI, spouleur MAPI, carnet d’adresses ou un fournisseur de services.</span><span class="sxs-lookup"><span data-stu-id="85c72-105">MAPI provides a table with information about the status of the MAPI subsystem, MAPI spooler, address book, or a particular service provider.</span></span> <span data-ttu-id="85c72-106">Vous pouvez accéder à ce tableau en appelant [IMAPISession::GetStatusTable](imapisession-getstatustable.md).</span><span class="sxs-lookup"><span data-stu-id="85c72-106">You can access this table by calling [IMAPISession::GetStatusTable](imapisession-getstatustable.md).</span></span>
  
<span data-ttu-id="85c72-107">Chaque ligne dans la table d’état représente un objet de statut implémenté par MAPI ou un fournisseur de services.</span><span class="sxs-lookup"><span data-stu-id="85c72-107">Each row in the status table represents a status object implemented by MAPI or a service provider.</span></span> <span data-ttu-id="85c72-108">Vous pouvez utiliser un objet d’état pour afficher la feuille de propriétés de configuration d’un fournisseur, pour modifier un mot de passe fournisseur, de télécharger des messages des et de communiquer avec un fournisseur de transport spécifique.</span><span class="sxs-lookup"><span data-stu-id="85c72-108">You can use a status object to display a provider's configuration property sheet, to change a provider password, to upload or download messages, and to communicate with a particular transport provider.</span></span> 
  
<span data-ttu-id="85c72-109">Il existe deux façons d’accéder à un objet d’état :</span><span class="sxs-lookup"><span data-stu-id="85c72-109">There are two ways to access a status object:</span></span>
  
- <span data-ttu-id="85c72-110">Par le biais de la table d’état</span><span class="sxs-lookup"><span data-stu-id="85c72-110">Through the status table</span></span>
    
- <span data-ttu-id="85c72-111">Via la méthode **OpenStatusEntry** de l’objet d’une ouverture de session</span><span class="sxs-lookup"><span data-stu-id="85c72-111">Through a logon object's **OpenStatusEntry** method</span></span> 
    
<span data-ttu-id="85c72-112">Étant donné que les objets d’ouverture de session ne sont pas disponibles pour les clients, vous devez utiliser la table d’état pour accéder aux objets de l’état.</span><span class="sxs-lookup"><span data-stu-id="85c72-112">Because logon objects are unavailable to clients, you must use the status table to access status objects.</span></span> <span data-ttu-id="85c72-113">L’approche de table d’état est indirect, nécessitant quelques appels avant de l’objet de l’état est ouvert et un pointeur vers son implémentation **IMAPIStatus** renvoyé.</span><span class="sxs-lookup"><span data-stu-id="85c72-113">The status table approach is indirect, requiring a few calls before the status object is opened and a pointer to its **IMAPIStatus** implementation returned.</span></span> 
  
 <span data-ttu-id="85c72-114">**Pour utiliser la table d’état pour ouvrir un objet d’état**</span><span class="sxs-lookup"><span data-stu-id="85c72-114">**To use the status table to open a status object**</span></span>
  
1. <span data-ttu-id="85c72-115">Appelez **IMAPIStatus::GetStatusTable** pour récupérer un pointeur [IMAPITable](imapitableiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="85c72-115">Call **IMAPIStatus::GetStatusTable** to retrieve an [IMAPITable](imapitableiunknown.md) pointer.</span></span> 
    
2. <span data-ttu-id="85c72-116">Appeler la méthode de [IMAPITable::SetColumns](imapitable-setcolumns.md) de la table d’état pour limiter la colonne valeur **PR_DISPLAY_NAME** ([ **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) et **PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)) PidTagDisplayName](pidtagdisplayname-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="85c72-116">Call the status table's [IMAPITable::SetColumns](imapitable-setcolumns.md) method to limit the column set to **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)), **PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)), and **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)).</span></span>
    
3. <span data-ttu-id="85c72-117">Limiter l’affichage de tableau à un objet état particulier.</span><span class="sxs-lookup"><span data-stu-id="85c72-117">Limit the table view to a particular status object.</span></span> <span data-ttu-id="85c72-118">Pour des implémentations MAPI, un client peut définir une restriction de propriété à l’aide de **PR_RESOURCE_TYPE**.</span><span class="sxs-lookup"><span data-stu-id="85c72-118">For MAPI implementations, a client can define a property restriction using **PR_RESOURCE_TYPE**.</span></span> <span data-ttu-id="85c72-119">Pour les implémentations de fournisseur de service, un client peut restreindre sur **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)), le nom du fournisseur, ou sur **PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md)), le nom de la DLL du fournisseur fichier.</span><span class="sxs-lookup"><span data-stu-id="85c72-119">For service provider implementations, a client can restrict on **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)), the name of the provider, or on **PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md)), the name of the provider DLL file.</span></span>
    
4. <span data-ttu-id="85c72-120">Appelez [IMAPITable](imapitable-restrict.md) pour définir la restriction.</span><span class="sxs-lookup"><span data-stu-id="85c72-120">Call [IMAPITable::Restrict](imapitable-restrict.md) to set the restriction.</span></span> 
    
5. <span data-ttu-id="85c72-121">Appelez [HrQueryAllRows](hrqueryallrows.md), en passant la structure [SPropertyRestriction](spropertyrestriction.md) , pour récupérer la ligne qui représente l’état du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="85c72-121">Call [HrQueryAllRows](hrqueryallrows.md), passing in the [SPropertyRestriction](spropertyrestriction.md) structure, to retrieve the row that represents the status of the provider.</span></span> 
    
6. <span data-ttu-id="85c72-122">Appelez [IMAPISession::OpenEntry](imapisession-openentry.md), spécifiant l’identificateur d’entrée à partir de la ligne de tableau d’état, pour ouvrir l’objet de l’état et de récupérer un pointeur **IMAPIStatus** .</span><span class="sxs-lookup"><span data-stu-id="85c72-122">Call [IMAPISession::OpenEntry](imapisession-openentry.md), specifying the entry identifier from the status table row, to open the status object and retrieve an **IMAPIStatus** pointer.</span></span> 
    
<span data-ttu-id="85c72-123">Pour afficher une feuille de propriétés, appeler la méthode [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) de l’objet état pour le fournisseur cible.</span><span class="sxs-lookup"><span data-stu-id="85c72-123">To display a property sheet, call the status object's [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) method for the target provider.</span></span> <span data-ttu-id="85c72-124">**Dialogue** affiche une feuille de propriétés pour l’affichage et dans certains cas, modifier les propriétés de configuration d’un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="85c72-124">**SettingsDialog** displays a property sheet for viewing and in some cases, changing the configuration properties of a provider.</span></span> 
  
<span data-ttu-id="85c72-125">Pour communiquer avec un fournisseur de transport, appelez la méthode [IMAPIStatus::ValidateState](imapistatus-validatestate.md) de l’objet de son état.</span><span class="sxs-lookup"><span data-stu-id="85c72-125">To communicate with a transport provider, call its status object's [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method.</span></span> <span data-ttu-id="85c72-126">**ValidateState** pouvez reconfigurer un fournisseur de transport, empêcher le fournisseur d’afficher une interface utilisateur et contrôler une session impliquant le téléchargement des en-têtes des messages à partir d’un serveur distant, selon les indicateurs que vous passez.</span><span class="sxs-lookup"><span data-stu-id="85c72-126">**ValidateState** can reconfigure a transport provider, prevent the provider from displaying a user interface, and control a session that involves downloading message headers from a remote server, depending on the flags that you pass in.</span></span> <span data-ttu-id="85c72-127">Pour annuler le téléchargement des en-têtes à distance, par exemple, passez l’indicateur ABORT_XP_HEADER_OPERATION à **ValidateState**.</span><span class="sxs-lookup"><span data-stu-id="85c72-127">For example, to cancel the downloading of remote headers, pass the ABORT_XP_HEADER_OPERATION flag to **ValidateState**.</span></span> <span data-ttu-id="85c72-128">Pour se connecter ou se déconnecter du serveur distant, transmettez FORCE_XP_CONNECT ou FORCE_XP_DISCONNECT.</span><span class="sxs-lookup"><span data-stu-id="85c72-128">To connect or disconnect from the remote server, pass FORCE_XP_CONNECT or FORCE_XP_DISCONNECT.</span></span> <span data-ttu-id="85c72-129">Pour reconfigurer le fournisseur, transmettez CONFIG_CHANGED.</span><span class="sxs-lookup"><span data-stu-id="85c72-129">To reconfigure the provider, pass CONFIG_CHANGED.</span></span> 
  
<span data-ttu-id="85c72-130">Les clients qui implémentent l’envoi ou la réception de messages à la demande appellent soit un fournisseur de transport ou du spouleur MAPI [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md) .</span><span class="sxs-lookup"><span data-stu-id="85c72-130">Clients that implement sending or receiving of messages on demand call either a transport provider's or the MAPI spooler's [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md) method.</span></span> <span data-ttu-id="85c72-131">Vous pouvez passer des trois indicateurs dans la méthode : FLUSH_UPLOAD, FLUSH_DOWNLOAD et FLUSH_FORCE.</span><span class="sxs-lookup"><span data-stu-id="85c72-131">You can pass three flags into the method: FLUSH_UPLOAD, FLUSH_DOWNLOAD, and FLUSH_FORCE.</span></span> <span data-ttu-id="85c72-132">FLUSH_UPLOAD indique le fournisseur ou le spouleur MAPI pour envoyer des messages en attente dans la file d’attente de sortie, tandis que FLUSH_DOWNLOAD indique au fournisseur ou le spouleur MAPI qui recevra les messages entrants.</span><span class="sxs-lookup"><span data-stu-id="85c72-132">FLUSH_UPLOAD instructs the provider or the MAPI spooler to send any messages waiting in the output queue while FLUSH_DOWNLOAD instructs the provider or the MAPI spooler to receive any incoming messages.</span></span> <span data-ttu-id="85c72-133">FLUSH_FORCE peut être définie avec une des autres indicateurs à l’objet d’état effectuer le vidage, quel que soit le minutage.</span><span class="sxs-lookup"><span data-stu-id="85c72-133">FLUSH_FORCE can be set with either of the other flags to cause the status object to perform the flush regardless of the timing.</span></span> 
  
<span data-ttu-id="85c72-134">Ne pensez pas pouvoir appeler **dialogue** ou [ChangePassword](imapistatus-changepassword.md) sur n’importe quel le sous-système MAPI, spouleur MAPI ou l’adresse, objets d’état book.</span><span class="sxs-lookup"><span data-stu-id="85c72-134">Do not expect to be able to call **SettingsDialog** or [ChangePassword](imapistatus-changepassword.md) on any of the MAPI subsystem, MAPI spooler, or address book status objects.</span></span> <span data-ttu-id="85c72-135">Objets d’état book le sous-système et l’adresse prennent uniquement en charge **ValidateState**; l’objet d’état spouleur MAPI prend en charge **FlushQueues** outre **ValidateState**.</span><span class="sxs-lookup"><span data-stu-id="85c72-135">Both the subsystem and address book status objects only support **ValidateState**; the MAPI spooler status object supports **FlushQueues** in addition to **ValidateState**.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="85c72-136">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="85c72-136">See also</span></span>



[<span data-ttu-id="85c72-137">Tableaux d’état</span><span class="sxs-lookup"><span data-stu-id="85c72-137">Status Tables</span></span>](status-tables.md)
  
[<span data-ttu-id="85c72-138">Objets d’état MAPI</span><span class="sxs-lookup"><span data-stu-id="85c72-138">MAPI Status Objects</span></span>](mapi-status-objects.md)

