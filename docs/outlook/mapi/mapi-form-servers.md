---
title: Serveurs de formulaire MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 3c95f6a1d4d50dd6552c6e786d17c40da14f3f3c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419106"
---
# <a name="mapi-form-servers"></a><span data-ttu-id="3a5fe-103">Serveurs de formulaire MAPI</span><span class="sxs-lookup"><span data-stu-id="3a5fe-103">MAPI Form Servers</span></span>

  
  
<span data-ttu-id="3a5fe-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3a5fe-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3a5fe-105">Du point de vue de l’utilisateur, un formulaire est généralement une feuille de propriétés pour un message ou un formulaire de saisie de données qui permet aux utilisateurs d’entrer des informations structurées.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-105">From the user's perspective, a form is usually a property sheet for a message or a data-entry form that enables users to enter structured information.</span></span> <span data-ttu-id="3a5fe-106">Toutefois, il peut s’agit de n’importe quelle interface utilisateur associée à une classe de message.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-106">However, it can be any user interface that is associated with a message class.</span></span> <span data-ttu-id="3a5fe-107">Du point de vue du programmeur, un formulaire se compose de :</span><span class="sxs-lookup"><span data-stu-id="3a5fe-107">From a programmer's point of view, a form consists of:</span></span>
  
- <span data-ttu-id="3a5fe-108">Type de message MAPI avec sa propre classe de message et son identificateur OLE.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-108">A type of MAPI message with its own message class and OLE identifier.</span></span>
    
- <span data-ttu-id="3a5fe-109">Fichier exécutable qui implémente le serveur de formulaires.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-109">The executable file that implements the form server.</span></span>
    
- <span data-ttu-id="3a5fe-110">Collection de propriétés MAPI (personnalisées ou autres) que le serveur de formulaires utilise.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-110">A collection of MAPI properties — custom or otherwise — that the form server uses.</span></span> <span data-ttu-id="3a5fe-111">Une partie ou l’ensemble de ces éléments peuvent être disponibles pour une utilisation par les clients de messagerie.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-111">Some or all of these may be available to messaging clients for use.</span></span>
    
- <span data-ttu-id="3a5fe-112">Fichier de configuration qui décrit le formulaire et est utilisé par le gestionnaire de formulaires.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-112">The configuration file that describes the form and is used by the form manager.</span></span>
    
<span data-ttu-id="3a5fe-113">Étant donné que les formulaires sont des objets [IMessage,](imessageimapiprop.md) ils présentent des propriétés et un comportement cohérents avec les objets de message MAPI.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-113">Because forms are [IMessage](imessageimapiprop.md) objects, they exhibit properties and behavior that is consistent with MAPI message objects.</span></span> <span data-ttu-id="3a5fe-114">Toutefois, étant donné que les formulaires peuvent avoir des propriétés personnalisées, des contrôles et un rendu d’affichage propre à l’application, les interfaces MAPI que les formulaires utilisent sont suffisamment génériques pour permettre tout type d’interface nécessaire.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-114">However, because forms can have custom properties, controls, and a display rendering that is application-specific, the MAPI interfaces that forms use are generic enough to permit any sort of interface that is needed.</span></span> <span data-ttu-id="3a5fe-115">La définition réelle d’un formulaire est stockée dans une bibliothèque de formulaires, comme expliqué plus loin dans cette section.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-115">The actual definition of a form is stored in a form library, which is discussed later in this section.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="3a5fe-116">Plus précisément, tous les messages sont des instances de formulaires MAPI.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-116">More accurately, all messages are instances of MAPI forms.</span></span> <span data-ttu-id="3a5fe-117">Toutefois, il est généralement plus facile de voir les formulaires personnalisés comme des cas particuliers de messages, car les formulaires de composition et de lecture de messages électroniques classiques sont les formulaires les plus couramment utilisés.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-117">However, it is usually easier to think of custom forms as special cases of messages, since forms for composing and reading typical email messages are the most commonly used forms.</span></span> <span data-ttu-id="3a5fe-118">Le fait que tous les messages soient simplement des formulaires donne aux formulaires personnalisés le même état que tout autre message dans le système MAPI.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-118">The fact that all messages are really just forms gives custom forms the same status as any other message in the MAPI system.</span></span> 
  
<span data-ttu-id="3a5fe-119">Chaque formulaire possède un ensemble de propriétés, dont certaines sont visibles dans l’interface utilisateur du formulaire.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-119">Every form has a set of properties, some of which are visible in the form's user interface.</span></span> <span data-ttu-id="3a5fe-120">En règle générale, les propriétés sont en correspondance avec les champs de l’interface utilisateur du formulaire.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-120">Usually, properties are matched to fields in the form's user interface.</span></span> <span data-ttu-id="3a5fe-121">Par exemple, un bon de commande peut avoir les champs Item, Description, Price, Tax et Subtotal.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-121">For example, a purchase order form might have the fields Item, Description, Price, Tax, and Subtotal.</span></span> <span data-ttu-id="3a5fe-122">Ces champs sont simplement des rendus visuels des propriétés de formulaire des mêmes noms.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-122">These fields are simply visual renderings of form properties of the same names.</span></span> <span data-ttu-id="3a5fe-123">Les clients peuvent déterminer quelles propriétés sont pris en charge par une classe de message particulière via la méthode [IMAPIFormInfo::CalcFormPropSet,](imapiforminfo-calcformpropset.md) qui est implémentée par le gestionnaire de formulaire MAPI.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-123">Clients ascertain which properties are supported by a particular message class through the [IMAPIFormInfo::CalcFormPropSet](imapiforminfo-calcformpropset.md) method, which is implemented by the MAPI form manager.</span></span> 
  
<span data-ttu-id="3a5fe-124">Comme les messages de base, les formulaires MAPI peuvent contenir toutes les propriétés de message standard telles que l’expéditeur, le destinataire prévu et le moment où le message a été envoyé.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-124">Like basic messages, MAPI forms can contain all the standard message properties such as the sender, the intended recipient, and when the message was sent.</span></span> <span data-ttu-id="3a5fe-125">Les formulaires peuvent également contenir n’importe quel nombre de propriétés personnalisées spécifiques au formulaire.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-125">Forms can also contain any number of custom properties that are specific to the form.</span></span> <span data-ttu-id="3a5fe-126">Par exemple, un formulaire « Rapport de bogue » peut contenir des propriétés personnalisées pour le type de bogue, la gravité du bogue et la version du produit.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-126">For example a "Bug Report" form might contain custom properties for Bug Type, Bug Severity, and Product Version.</span></span>
  
<span data-ttu-id="3a5fe-127">Pour créer un formulaire, vous devez implémenter un serveur de formulaires.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-127">To create a form you must implement a form server.</span></span> <span data-ttu-id="3a5fe-128">Le serveur de formulaires est le fichier exécutable qui est chargé lorsqu’un client de messagerie doit afficher un message qui est le type pris en charge par le serveur de formulaires.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-128">The form server is the executable file that is loaded when a messaging client needs to display a message that is the type supported by the form server.</span></span> <span data-ttu-id="3a5fe-129">Le serveur de formulaires crée à son tour des objets de formulaire si nécessaire pour afficher des messages spécifiques et gérer les interactions utilisateur avec ces messages.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-129">The form server in turn creates form objects as necessary to display specific messages and handle user interactions with those messages.</span></span>
  
<span data-ttu-id="3a5fe-130">Un fichier de configuration est associé à chaque serveur de formulaire.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-130">Every form server has a configuration file associated with it.</span></span> <span data-ttu-id="3a5fe-131">Ce fichier contient des informations qui décrivent le serveur de formulaires pour l’avantage du gestionnaire de formulaires.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-131">This file contains information that describes the form server for the benefit of the form manager.</span></span> <span data-ttu-id="3a5fe-132">Le gestionnaire de formulaires utilise ces informations lors de l’installation du serveur de formulaires dans une bibliothèque de formulaires.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-132">The form manager uses this information when installing the form server into a form library.</span></span>
  
<span data-ttu-id="3a5fe-133">Pour plus d’informations sur la création des composants d’un formulaire, voir [Developing MAPI Form Servers](developing-mapi-form-servers.md).</span><span class="sxs-lookup"><span data-stu-id="3a5fe-133">For details on creating the parts of a form, see [Developing MAPI Form Servers](developing-mapi-form-servers.md).</span></span>
  
<span data-ttu-id="3a5fe-134">Les serveurs de formulaires adhèrent au modèle objet composant (COM).</span><span class="sxs-lookup"><span data-stu-id="3a5fe-134">Form servers adhere to the Component Object Model (COM).</span></span> <span data-ttu-id="3a5fe-135">Les serveurs de formulaire s’exécutent en tant qu’exécutables autonomes, et non en tant que serveurs in-proc.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-135">Form servers run as standalone executables, not as in-proc servers.</span></span> <span data-ttu-id="3a5fe-136">Pour plus d’informations, voir la section COM et ActiveX Services d’objets dans le SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-136">For more information, see the COM and ActiveX Object Services section in the Windows SDK.</span></span>
  
<span data-ttu-id="3a5fe-137">Un identificateur de classe unique (CLSID) identifie chaque serveur de formulaires.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-137">A unique class identifier (CLSID) identifies each form server.</span></span> <span data-ttu-id="3a5fe-138">Il existe toujours un mappage un-à-un entre un identificateur de classe et sa classe de message.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-138">There is always a one-to-one mapping between a class identifier and its message class.</span></span> <span data-ttu-id="3a5fe-139">Toutefois, cela ne signifie pas qu’un serveur de formulaires ne peut fonctionner qu’avec les messages d’une classe de message.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-139">This does not mean, however, that a form server can only work with messages of one message class.</span></span> <span data-ttu-id="3a5fe-140">Si aucun serveur de formulaire n’est disponible pour le service d’un message d’une classe particulière, le gestionnaire de formulaires utilisé doit tenter de trouver un serveur de formulaire pour une classe de message supérieure dans la hiérarchie des classes de message . Le gestionnaire de formulaires par défaut fourni avec le SDK Windows le fait.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-140">If no form server is available to service a message of a particular class, the form manager being used should attempt to find a form server for a message class higher in the message class hierarchy; the default form manager supplied with the Windows SDK does this.</span></span> <span data-ttu-id="3a5fe-141">Un tel serveur de formulaires sera probablement en mesure de restituer uniquement un sous-ensemble des propriétés du message (celles qui sont pris en charge par la superclasse), mais il sera préférable à rien.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-141">Such a form server will probably be able to render only a subset of the message's properties (the ones supported by the superclass), but it will be better than nothing.</span></span> <span data-ttu-id="3a5fe-142">Ce qui se produit lorsqu’aucun serveur de formulaire correspondant n’est trouvé est un détail d’implémentation spécifique au gestionnaire de formulaires utilisé ; Le gestionnaire de formulaires par défaut n’ouvre pas les messages lorsque cela se produit.</span><span class="sxs-lookup"><span data-stu-id="3a5fe-142">What happens when no matching form server is found at all is an implementation detail specific to the form manager being used; the default form manager does not open messages when this happens.</span></span>
  
<span data-ttu-id="3a5fe-143">Pour plus d’informations, voir [CLASSES de message MAPI.](mapi-message-classes.md)</span><span class="sxs-lookup"><span data-stu-id="3a5fe-143">For more information, see [MAPI Message Classes](mapi-message-classes.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="3a5fe-144">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3a5fe-144">See also</span></span>



[<span data-ttu-id="3a5fe-145">Formulaires MAPI</span><span class="sxs-lookup"><span data-stu-id="3a5fe-145">MAPI Forms</span></span>](mapi-forms.md)

