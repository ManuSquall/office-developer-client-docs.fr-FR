---
title: Utilisation d’objets MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e342c1bd-8bee-4b02-a93f-e3941f4716c1
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 2b66b450318c802e773c2f2c47e4a39500c582d6
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22592768"
---
# <a name="using-mapi-objects"></a><span data-ttu-id="f4f6d-103">Utilisation d’objets MAPI</span><span class="sxs-lookup"><span data-stu-id="f4f6d-103">Using MAPI objects</span></span>

<span data-ttu-id="f4f6d-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="f4f6d-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="f4f6d-105">Clients et fournisseurs de services utilisent MAPI d’objets en appelant les méthodes dans leurs implémentations d’interface.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-105">Clients and service providers use MAPI objects by calling the methods in their interface implementations.</span></span> <span data-ttu-id="f4f6d-106">Il s’agit de la seule façon que les objets MAPI peuvent être utilisés ; méthodes qui sont implémentées par un objet en dehors d’une interface MAPI ne sont pas accessibles au public.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-106">This is the only way that MAPI objects can be used; methods that are implemented by an object outside of a MAPI interface are not publicly accessible.</span></span> <span data-ttu-id="f4f6d-107">Étant donné que toutes les interfaces d’un objet sont liées par le biais de l’héritage des autorisations, utilisateur d’un objet peut appeler des méthodes dans l’interface de base ou un des interfaces héritées comme s’ils appartiennent à la même interface.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-107">Because all of an object's interfaces are related through inheritance, an object's user can call methods in either the base interface or one of the inherited interfaces as if they belong to the same interface.</span></span> 
  
<span data-ttu-id="f4f6d-108">Lorsque l’utilisateur d’un objet souhaite émettre un appel à une méthode et cet objet implémente plusieurs interfaces liées par le biais de l’héritage des autorisations, l’utilisateur ne doit pas savoir interface à laquelle appartient la méthode.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-108">When an object's user wants to make a call to a method and that object implements several interfaces related through inheritance, the user need not know to which interface the method belongs.</span></span> <span data-ttu-id="f4f6d-109">L’utilisateur peut appeler une des méthodes sur n’importe lequel des interfaces avec un pointeur vers l’objet unique.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-109">The user can call any of the methods on any of the interfaces with a single pointer to the object.</span></span> <span data-ttu-id="f4f6d-110">Par exemple, l’illustration suivante montre comment une application cliente utilise un objet folder.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-110">For example, the following illustration shows how a client application uses a folder object.</span></span> <span data-ttu-id="f4f6d-111">Implémentent des objets de dossier la [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) interface qui hérite [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) indirectement via [IMAPIProp : IUnknown](imapipropiunknown.md) et [IMAPIContainer : IMAPIProp](imapicontainerimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="f4f6d-111">Folder objects implement the [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) interface, which inherits from [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) indirectly through [IMAPIProp : IUnknown](imapipropiunknown.md) and [IMAPIContainer : IMAPIProp](imapicontainerimapiprop.md).</span></span> <span data-ttu-id="f4f6d-112">Un client peut appeler une des méthodes **IMAPIProp** , tel [IMAPIProp::GetProps](imapiprop-getprops.md)et l’autre de la [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) méthodes, telles [IMAPIFolder::CreateMessage](imapifolder-createmessage.md), de la même façon avec le pointeur d’objet.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-112">A client can call one of the **IMAPIProp** methods, such as [IMAPIProp::GetProps](imapiprop-getprops.md), and one of the [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) methods, such as [IMAPIFolder::CreateMessage](imapifolder-createmessage.md), in the same way with the same object pointer.</span></span> <span data-ttu-id="f4f6d-113">Un client n’est pas connaissance ou affectés par le fait que ces appels appartiennent à différentes interfaces.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-113">A client is not aware of or affected by the fact that these calls belong to different interfaces.</span></span>
  
<span data-ttu-id="f4f6d-114">**Utilisation client d’un objet de dossier**</span><span class="sxs-lookup"><span data-stu-id="f4f6d-114">**Client use of a folder object**</span></span>
  
<span data-ttu-id="f4f6d-115">![Utiliser des clients d’un objet folder] (media/amapi_40.gif "Utiliser des clients d’un objet folder")</span><span class="sxs-lookup"><span data-stu-id="f4f6d-115">![Client use of a folder object](media/amapi_40.gif "Client use of a folder object")</span></span>
  
<span data-ttu-id="f4f6d-116">Ces appels traduisent le code différemment selon que le client de l’appel est écrit en C ou C++.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-116">These calls translate into code differently depending on whether the client making the calls is written in C or C++.</span></span> <span data-ttu-id="f4f6d-117">Avant d’effectuer un appel à une méthode, un pointeur vers l’implémentation d’interface doit être récupéré.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-117">Before any call to a method can be made, a pointer to the interface implementation must be retrieved.</span></span> <span data-ttu-id="f4f6d-118">Pointeurs d’interface peuvent être obtenus de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="f4f6d-118">Interface pointers can be obtained in the following ways:</span></span>
  
- <span data-ttu-id="f4f6d-119">Appelez une méthode sur un autre objet.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-119">Calling a method on a different object.</span></span>
    
- <span data-ttu-id="f4f6d-120">Appel d’une fonction d’API.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-120">Calling an API function.</span></span>
    
- <span data-ttu-id="f4f6d-121">L’appel de la méthode [IUnknown::QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) sur l’objet cible.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-121">Calling the [IUnknown::QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) method on the target object.</span></span> 
    
<span data-ttu-id="f4f6d-122">MAPI fournit plusieurs méthodes et fonctions de l’API qui retournent des pointeurs vers des implémentations d’interface.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-122">MAPI provides several methods and API functions that return pointers to interface implementations.</span></span> <span data-ttu-id="f4f6d-123">Par exemple, les clients peuvent appeler la méthode [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) pour récupérer un pointeur vers un objet table qui fournit l’accès aux informations de fournisseur de magasin de message par le biais de la [IMAPITable : IUnknown](imapitableiunknown.md) interface.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-123">For example, clients can call the [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) method to retrieve a pointer to a table object that provides access to message store provider information through the [IMAPITable : IUnknown](imapitableiunknown.md) interface.</span></span> <span data-ttu-id="f4f6d-124">Fournisseurs de services peuvent appeler la fonction API [Create table](createtable.md) pour récupérer un pointeur vers un objet de données de table.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-124">Service providers can call the API function [CreateTable](createtable.md) to retrieve a pointer to a table data object.</span></span> <span data-ttu-id="f4f6d-125">Lorsqu’il n’y a aucune fonction ou une méthode disponibles et les clients ou fournisseurs de services disposez déjà d’un pointeur vers un objet, elles peuvent appeler la méthode **QueryInterface** de l’objet pour extraire un pointeur vers un autre des implémentations d’interface de l’objet.</span><span class="sxs-lookup"><span data-stu-id="f4f6d-125">When there is no function or method available and clients or service providers already have a pointer to an object, they can call the object's **QueryInterface** method to retrieve a pointer to another of the object's interface implementations.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="f4f6d-126">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f4f6d-126">See also</span></span>

- [<span data-ttu-id="f4f6d-127">Objet MAPI et vue d’ensemble de l’Interface</span><span class="sxs-lookup"><span data-stu-id="f4f6d-127">MAPI Object and Interface Overview</span></span>](mapi-object-and-interface-overview.md)

