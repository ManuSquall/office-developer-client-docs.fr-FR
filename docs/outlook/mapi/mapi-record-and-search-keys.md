---
title: MAPI Record and Search Keys
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: caa7b7f3-a5a1-4f07-98c9-22652ecd5d21
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: b1b4c0087cecd9164fc96ce7c5b5415f75dbfb03
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33434563"
---
# <a name="mapi-record-and-search-keys"></a><span data-ttu-id="2bfa2-103">MAPI Record and Search Keys</span><span class="sxs-lookup"><span data-stu-id="2bfa2-103">MAPI Record and Search Keys</span></span>

  
  
<span data-ttu-id="2bfa2-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2bfa2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2bfa2-105">Les clés d’enregistrement et les clés de recherche sont des identificateurs binaires qui sont affectés à de nombreux objets MAPI.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-105">Record keys and search keys are binary identifiers that are assigned to many MAPI objects.</span></span> <span data-ttu-id="2bfa2-106">Contrairement à l’identificateur d’entrée d’un objet, son enregistrement ou sa clé de recherche est directement comparable et transmetable.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-106">Unlike an object's entry identifier, its record or search key is directly comparable as well as transmittable.</span></span> 
  
## <a name="record-keys"></a><span data-ttu-id="2bfa2-107">Clés d’enregistrement</span><span class="sxs-lookup"><span data-stu-id="2bfa2-107">Record Keys</span></span>

<span data-ttu-id="2bfa2-108">Une clé d’enregistrement permet de comparer deux objets.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-108">A record key is used to compare two objects.</span></span> <span data-ttu-id="2bfa2-109">Les objets de magasin de messages et de carnet d’adresses doivent avoir des clés d’enregistrement, qui sont stockées dans **leur PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="2bfa2-109">Message store and address book objects must have record keys, which are stored in their **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) property.</span></span> <span data-ttu-id="2bfa2-110">Étant donné qu’une clé d’enregistrement identifie un objet et non ses données, chaque instance d’un objet possède une clé d’enregistrement unique.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-110">Because a record key identifies an object and not its data, every instance of an object has a unique record key.</span></span> <span data-ttu-id="2bfa2-111">L’étendue d’une clé d’enregistrement pour les dossiers et les messages est la magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-111">The scope of a record key for folders and messages is the message store.</span></span> <span data-ttu-id="2bfa2-112">L’étendue des conteneurs de carnet d’adresses, des utilisateurs de messagerie et des listes de distribution est l’ensemble de conteneurs de niveau supérieur fourni par MAPI pour être utilisé dans le carnet d’adresses intégré.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-112">The scope for address book containers, messaging users, and distribution lists is the set of top-level containers provided by MAPI for use in the integrated address book.</span></span>
  
<span data-ttu-id="2bfa2-113">Les clés d’enregistrement peuvent être dupliquées dans une autre ressource.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-113">Record keys can be duplicated in another resource.</span></span> <span data-ttu-id="2bfa2-114">Par exemple, différents messages dans deux magasins de messages différents peuvent avoir la même clé d’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-114">For example, different messages in two different message stores can have the same record key.</span></span> <span data-ttu-id="2bfa2-115">Il est différent des identificateurs d’entrée à long terme ; étant donné que les identificateurs d’entrée à long terme contiennent une référence au fournisseur de services, ils ont une portée plus large.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-115">This is different from long-term entry identifiers; because long-term entry identifiers contain a reference to the service provider, they have a wider scope.</span></span> <span data-ttu-id="2bfa2-116">L’étendue de la clé d’enregistrement d’une magasin de messages est similaire à celle d’un identificateur d’entrée à long terme . Il doit être unique pour tous les fournisseurs de magasins de messages.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-116">A message store's record key is similar in scope to a long-term entry identifier; it should be unique across all message store providers.</span></span> <span data-ttu-id="2bfa2-117">Pour garantir cet unicité, les fournisseurs de magasins de messages définissent généralement leur clé d’enregistrement sur une valeur qui est la combinaison de leur propriété **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) et d’un identificateur propre à la magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-117">To ensure this uniqueness, message store providers typically set their record key to a value that is the combination of their **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) property and an identifier that is unique to the message store.</span></span>
  
## <a name="search-keys"></a><span data-ttu-id="2bfa2-118">Clés de recherche</span><span class="sxs-lookup"><span data-stu-id="2bfa2-118">Search Keys</span></span>

<span data-ttu-id="2bfa2-119">Une clé de recherche est utilisée pour comparer les données dans deux objets.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-119">A search key is used to compare the data in two objects.</span></span> <span data-ttu-id="2bfa2-120">La clé de recherche d’un objet est stockée dans sa **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="2bfa2-120">An object's search key is stored in its **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) property.</span></span> <span data-ttu-id="2bfa2-121">Étant donné qu’une clé de recherche représente les données d’un objet et non l’objet lui-même, deux objets différents avec les mêmes données peuvent avoir la même clé de recherche.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-121">Because a search key represents an object's data and not the object itself, two different objects with the same data can have the same search key.</span></span> <span data-ttu-id="2bfa2-122">Lorsqu’un objet est copié, par exemple, l’objet d’origine et sa copie ont les mêmes données et la même clé de recherche.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-122">When an object is copied, for example, both the original object and its copy have the same data and the same search key.</span></span>
  
<span data-ttu-id="2bfa2-123">Les messages et les utilisateurs de messagerie ont des clés de recherche.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-123">Messages and messaging users have search keys.</span></span> <span data-ttu-id="2bfa2-124">La clé de recherche d’un message est un identificateur unique des données du message.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-124">The search key of a message is a unique identifier of the message's data.</span></span> <span data-ttu-id="2bfa2-125">Les fournisseurs de magasins de messages fournissent la propriété PR_SEARCH_KEY **message** au moment de la création du message.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-125">Message store providers furnish a message's **PR_SEARCH_KEY** property at message creation time.</span></span> <span data-ttu-id="2bfa2-126">La clé de recherche d’une entrée de carnet d’adresses est calculée à partir de son type d’adresse (**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))) et de son adresse (**PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md))).</span><span class="sxs-lookup"><span data-stu-id="2bfa2-126">The search key of an address book entry is computed from its address type (**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))) and address (**PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md))).</span></span> <span data-ttu-id="2bfa2-127">Si l’entrée du carnet d’adresses est accessible en écriture, sa clé de recherche risque de ne pas être disponible tant que le type d’adresse et l’adresse n’ont pas été définies à l’aide de la méthode [IMAPIProp::SetProps](imapiprop-setprops.md) et que l’entrée a été enregistrée à l’aide de la méthode [IMAPIProp::SaveChanges.](imapiprop-savechanges.md)</span><span class="sxs-lookup"><span data-stu-id="2bfa2-127">If the address book entry is writeable, its search key might not be available until the address type and address have been set by using the [IMAPIProp::SetProps](imapiprop-setprops.md) method and the entry has been saved by using the [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method.</span></span> <span data-ttu-id="2bfa2-128">Lorsque ces propriétés d’adresse changent, il est possible que la clé de recherche correspondante ne soit pas synchronisée avec les nouvelles valeurs tant que les modifications n’ont pas été déterminées avec un appel **SaveChanges.**</span><span class="sxs-lookup"><span data-stu-id="2bfa2-128">When these address properties change, it is possible for the corresponding search key not to be synchronized with the new values until the changes have been committed with a **SaveChanges** call.</span></span> 
  
<span data-ttu-id="2bfa2-129">La valeur de la clé d’enregistrement d’un objet peut être identique ou différente de la valeur de sa clé de recherche, selon le fournisseur de services.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-129">The value of an object's record key can be the same as or different than the value of its search key, depending on the service provider.</span></span> <span data-ttu-id="2bfa2-130">Certains fournisseurs de services utilisent la même valeur pour la clé de recherche, la clé d’enregistrement et l’identificateur d’entrée d’un objet.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-130">Some service providers use the same value for an object's search key, record key, and entry identifier.</span></span> <span data-ttu-id="2bfa2-131">D’autres fournisseurs de services affectent des valeurs uniques pour chacun des identificateurs de ses objets.</span><span class="sxs-lookup"><span data-stu-id="2bfa2-131">Other service providers assign unique values for each of its objects' identifiers.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2bfa2-132">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2bfa2-132">See also</span></span>



[<span data-ttu-id="2bfa2-133">D�veloppement d'applications MAPI</span><span class="sxs-lookup"><span data-stu-id="2bfa2-133">MAPI Application Development</span></span>](mapi-application-development.md)

