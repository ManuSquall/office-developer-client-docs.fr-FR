---
title: Sélection d'une classe de message
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5ca8edd2-41b7-40e2-b755-b28eecb49786
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 279df7f07c8c8b66347488c6224d04f70292e968
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428052"
---
# <a name="choosing-a-message-class"></a><span data-ttu-id="ed6f2-103">Sélection d'une classe de message</span><span class="sxs-lookup"><span data-stu-id="ed6f2-103">Choosing a Message Class</span></span>

  
  
<span data-ttu-id="ed6f2-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ed6f2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ed6f2-105">Comme décrit dans les [classes de message MAPI](mapi-message-classes.md), les classes de message sont importantes pour établir la relation entre les types de messages personnalisés et, par extension, entre les serveurs de formulaires eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-105">As described in [MAPI Message Classes](mapi-message-classes.md), message classes are important for establishing the relationship between types of custom messages and, by extension, between form servers themselves.</span></span> <span data-ttu-id="ed6f2-106">Heureusement, le choix d'une chaîne de classe de message est relativement simple.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-106">Fortunately, choosing a message class string is fairly simple.</span></span> <span data-ttu-id="ed6f2-107">La chaîne de classe de message d'une classe de message est une chaîne arbitraire, mais elle doit utiliser les conventions suivantes:</span><span class="sxs-lookup"><span data-stu-id="ed6f2-107">The message class string of a message class is an arbitrary string, but it should use the following conventions:</span></span>
  
- <span data-ttu-id="ed6f2-108">La chaîne doit satisfaire à toutes les conventions décrites dans la documentation de la propriété **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="ed6f2-108">The string should satisfy all the conventions described in the documentation for the **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)) property.</span></span> <span data-ttu-id="ed6f2-109">En important, la chaîne doit être entièrement composée de caractères ANSI et comporter moins de 256 caractères.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-109">Importantly, the string must be composed entirely of ANSI characters and be less than 256 characters long.</span></span>
    
- <span data-ttu-id="ed6f2-110">Si votre serveur de formulaire est dérivé d'un serveur de formulaires existant ou s'il s'agit d'une extension d'un serveur de formulaires existant, la chaîne de votre classe de message doit être formée en ajoutant un point et un autre mot à la chaîne de classe de message du serveur de formulaire sur lequel votre formulaire est basé.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-110">If your form server is derived from an existing form server or is an extension of an existing form server, your message class string should be formed by adding a period and another word to the message class string of the form server that your form is based on.</span></span> <span data-ttu-id="ed6f2-111">Par exemple, vous pouvez implémenter un formulaire pour replanifier une réunion, et votre formulaire est basé sur un formulaire existant pour la planification des réunions.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-111">For example, you might want to implement a form to reschedule a meeting, and your form is based on an existing form for scheduling meetings.</span></span> <span data-ttu-id="ed6f2-112">Si la chaîne de classe de message du formulaire de planification de la réunion est «IPM. Réunion ", la chaîne de votre classe de message peut être" IPM. Meeting. reschedule».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-112">If the meeting scheduling form's message class string is "IPM.Meeting", your message class string could be "IPM.Meeting.Reschedule".</span></span>
    
- <span data-ttu-id="ed6f2-113">Si votre formulaire n'est pas basé sur un formulaire existant, la chaîne de votre classe de message doit toujours commencer par «IPM».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-113">If your form is not based on any existing form, your message class string should still begin with either the "IPM."</span></span> <span data-ttu-id="ed6f2-114">ou «IPC».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-114">or "IPC."</span></span> <span data-ttu-id="ed6f2-115">, selon que le formulaire est destiné à être reçu par une personne ou par une autre application.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-115">prefix, depending on whether the form is intended to be received by a person or by another application.</span></span> <span data-ttu-id="ed6f2-116">«IPM».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-116">"IPM."</span></span> <span data-ttu-id="ed6f2-117">désigne un message interpersonnel qui se trouve généralement dans la boîte de réception d'un utilisateur, et «IPC».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-117">designates an interpersonal message that usually ends up in a user's Inbox, and "IPC."</span></span> <span data-ttu-id="ed6f2-118">désigne un message de communication entre processus qui n'est généralement pas remis dans la boîte de réception d'un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-118">designates an interprocess communication message that is not typically delivered to a user's Inbox.</span></span>
    
- <span data-ttu-id="ed6f2-119">Si votre classe de message est destinée à être lisible par un utilisateur, la chaîne de classe de message doit commencer par «IPM».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-119">If your message class is intended to be human-readable, the message class string should start with "IPM."</span></span> <span data-ttu-id="ed6f2-120">Une classe de message est généralement considérée comme lisible par l'homme si elle utilise des propriétés qui contiennent du texte brut, du code HTML ou des données RTF (Rich Text Format).</span><span class="sxs-lookup"><span data-stu-id="ed6f2-120">A message class is generally considered human-readable if it uses any properties that contain plain text, HTML, or Rich Text Format (RTF) data.</span></span> <span data-ttu-id="ed6f2-121">Si votre formulaire utilise la propriété **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)), il doit utiliser un «IPM».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-121">If your form uses the **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) property, it should almost certainly use an "IPM."</span></span> <span data-ttu-id="ed6f2-122">chaîne de classe de message.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-122">message class string.</span></span> <span data-ttu-id="ed6f2-123">Par exemple, si vous implémentez un formulaire pour les bons de commande et que votre organisation exige que les bons de commande soient approuvés par un responsable, la chaîne de votre classe de message peut être «IPM. Purchase_Order».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-123">For example, if you are implementing a form for purchase orders, and your organization requires that purchase orders be approved by a manager, your message class string could be "IPM.Purchase_Order".</span></span> <span data-ttu-id="ed6f2-124">Les formulaires qui sont conçus pour être utilisés avec des dossiers publics ou des applications de dossiers publics sont généralement considérés comme interpersonnels, car ils sont lus par des personnes même s'ils ne sont pas réellement adressés à l'adresse de messagerie d'une personne.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-124">Forms that are designed for use with public folders or public folder applications are typically considered to be interpersonal because they are read by people even though they are not actually addressed to any person's email address.</span></span> <span data-ttu-id="ed6f2-125">Le préfixe standard pour les classes de message de dossier public est «IPM. Post».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-125">The typical prefix for public folder message classes is "IPM.Post".</span></span> 
    
- <span data-ttu-id="ed6f2-126">Si votre classe de message doit être reçue par une autre application et non par une personne, la chaîne de classe de message doit commencer par «IPC».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-126">If your message class is intended to be received by another application instead of by a person, the message class string should start with "IPC."</span></span> <span data-ttu-id="ed6f2-127">Par exemple, si vous implémentez un formulaire qui permet aux utilisateurs de s'abonner automatiquement à des listes de publipostage, la chaîne de votre classe de message peut être «IPC. S'abonner».</span><span class="sxs-lookup"><span data-stu-id="ed6f2-127">For example, if you are implementing a form that enables people to automatically subscribe to mailing lists, your message class string could be "IPC.Subscribe".</span></span>
    
- <span data-ttu-id="ed6f2-128">La chaîne de votre classe de message ne doit jamais se terminer par un point.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-128">Your message class string should never end with a period.</span></span>
    
<span data-ttu-id="ed6f2-129">La chaîne de classe de message doit être placée dans la section **[Description]** du fichier de configuration de formulaire, dans l'entrée **MessageClass** , semblable à la suivante:</span><span class="sxs-lookup"><span data-stu-id="ed6f2-129">The message class string should be put in the **[Description]** section of the form configuration file, in the **MessageClass** entry, similar to the following:</span></span> 
  
 `MessageClass=IPM.Meeting.Reschedule`
  
<span data-ttu-id="ed6f2-130">Une fois que vous avez choisi une chaîne de classe de message appropriée, vous devez générer un identificateur de classe pour celle-ci.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-130">After you have chosen an appropriate message class string, you should generate a class identifier for it.</span></span> <span data-ttu-id="ed6f2-131">Les identificateurs de classe peuvent être générés à l'aide de la commande **Create GUID** incluse dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-131">Class identifiers can be generated with the **Create GUID** command that is included in Visual Studio.</span></span> <span data-ttu-id="ed6f2-132">L'identificateur de classe doit être placé dans l'entrée **CLSID** du fichier de configuration du formulaire, avec l'entrée **MessageClass** , semblable à la suivante:</span><span class="sxs-lookup"><span data-stu-id="ed6f2-132">The class identifier must be put in the form configuration file's **CLSID** entry, along with the **MessageClass** entry, similar to the following:</span></span> 
  
 `CLSID={88FFF551-B8C5-11ce-8DE0-00AA0060D242}`
  
<span data-ttu-id="ed6f2-133">Votre identificateur de classe sera presque certainement différent, bien entendu.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-133">Your class identifier will almost certainly be different, of course.</span></span> <span data-ttu-id="ed6f2-134">Pour plus d'informations, consultez [la rubrique Création d'un fichier de configuration de formulaire](creating-a-form-configuration-file.md).</span><span class="sxs-lookup"><span data-stu-id="ed6f2-134">For more information, see [Creating a Form Configuration File](creating-a-form-configuration-file.md).</span></span>
  
<span data-ttu-id="ed6f2-135">Lorsque le formulaire est installé sur l'ordinateur d'un utilisateur, votre processus d'installation, qu'il s'agisse d'un programme d'installation ou autre, doit créer une entrée de Registre dans la section \*\*HKEY_CLASSES_ROOT\CLSID\* \* du Registre pour l'identificateur de classe.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-135">When the form is installed on a user's computer, your installation process — whether it is a setup program or something else — must make a registry entry in the \**HKEY_CLASSES_ROOT\CLSID\** section of the registry for the class identifier.</span></span> <span data-ttu-id="ed6f2-136">Cette entrée doit être définie sur la chaîne de classe de message.</span><span class="sxs-lookup"><span data-stu-id="ed6f2-136">This entry must be set to the message class string.</span></span> <span data-ttu-id="ed6f2-137">Par exemple, vous créez une entrée de registre semblable à la suivante pour l'exemple d'identificateur de classe ci-dessus:</span><span class="sxs-lookup"><span data-stu-id="ed6f2-137">For example, you would create a registry entry similar to the following for the example class identifier above:</span></span> 
  
 `HKEY_CLASSES_ROOT\CLSID\{88FFF551-B8C5-11ce-8DE0-00AA0060D242}="IPM.Meeting.Reschedule"`
  
<span data-ttu-id="ed6f2-138">Pour plus d'informations, consultez la rubrique [installation d'un formulaire dans une bibliothèque](installing-a-form-into-a-library.md).</span><span class="sxs-lookup"><span data-stu-id="ed6f2-138">For more information, see [Installing a Form into a Library](installing-a-form-into-a-library.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="ed6f2-139">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ed6f2-139">See also</span></span>



[<span data-ttu-id="ed6f2-140">Développement de serveurs de formulaires MAPI</span><span class="sxs-lookup"><span data-stu-id="ed6f2-140">Developing MAPI Form Servers</span></span>](developing-mapi-form-servers.md)

