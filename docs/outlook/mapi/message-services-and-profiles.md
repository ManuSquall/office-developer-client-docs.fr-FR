---
title: Profils et des services de messagerie
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: 0f55d4cda013810884177a0f47e861e3693defd7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19784896"
---
# <a name="message-services-and-profiles"></a><span data-ttu-id="708ed-103">Profils et des services de messagerie</span><span class="sxs-lookup"><span data-stu-id="708ed-103">Message services and profiles</span></span>
  
<span data-ttu-id="708ed-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="708ed-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="708ed-105">Certains utilisateurs requièrent les services de plusieurs systèmes de messagerie, chacun avec un ou plusieurs fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="708ed-105">Some users require the services of several messaging systems, each with one or more service providers.</span></span> <span data-ttu-id="708ed-106">Car il est difficile à installer et configurer individuellement chacun de ces fournisseurs de services, car un serveur de messagerie nécessite généralement un groupe de fournisseurs associés pour exposer toutes ses fonctionnalités, MAPI inclut le concept d’un service de message.</span><span class="sxs-lookup"><span data-stu-id="708ed-106">Because it is cumbersome to install and configure each of these service providers individually, and because a messaging server usually requires a group of related providers to expose all its functionality, MAPI includes the concept of a message service.</span></span> <span data-ttu-id="708ed-107">Services de messagerie aident les utilisateurs à installer et configurer leurs fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="708ed-107">Message services help users install and configure their service providers.</span></span>
  
<span data-ttu-id="708ed-108">Pour créer un service de message, un développeur écrit un programme de point d’entrée du service de message pour gérer la configuration de chaque fournisseur dans le service et un programme d’installation pour effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="708ed-108">To create a message service, a developer writes a message-service entry point program to handle the configuration of each provider in the service and a setup program to do the following:</span></span>
  
- <span data-ttu-id="708ed-109">Installer le service de chaque fournisseur.</span><span class="sxs-lookup"><span data-stu-id="708ed-109">Install each provider in the service.</span></span>
    
- <span data-ttu-id="708ed-110">Créer les entrées du fichier de Registre et initialisation.</span><span class="sxs-lookup"><span data-stu-id="708ed-110">Create registry and initialization file entries.</span></span>
    
- <span data-ttu-id="708ed-111">Créer des entrées dans le fichier de configuration MAPI Mapisvc.inf.</span><span class="sxs-lookup"><span data-stu-id="708ed-111">Create entries in the MAPI configuration file, Mapisvc.inf.</span></span>
    
<span data-ttu-id="708ed-112">Le fichier Mapisvc.inf contient des informations relatives à la configuration de tous les services de messagerie et les fournisseurs de services installés sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="708ed-112">The Mapisvc.inf file contains information that relates to the configuration of all message services and service providers installed on the computer.</span></span> <span data-ttu-id="708ed-113">Il se compose des sections hiérarchiques, avec chaque niveau de lié à la suivante.</span><span class="sxs-lookup"><span data-stu-id="708ed-113">It is organized in hierarchical sections, with each level linked to the next.</span></span> <span data-ttu-id="708ed-114">Dans la partie supérieure sont trois sections qui contiennent les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="708ed-114">At the top are three sections that contain the following:</span></span> 
  
- <span data-ttu-id="708ed-115">Liste des fichiers d’aide de service de message.</span><span class="sxs-lookup"><span data-stu-id="708ed-115">A list of message service Help files.</span></span>
    
- <span data-ttu-id="708ed-116">Une liste des services de message plus importantes, ou par défaut.</span><span class="sxs-lookup"><span data-stu-id="708ed-116">A list of the most important, or default, message services.</span></span>
    
- <span data-ttu-id="708ed-117">Une liste de tous les services sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="708ed-117">A list of all the services on the computer.</span></span>
    
<span data-ttu-id="708ed-118">Le niveau suivant contient des sections pour chaque service de message et le dernier niveau contient des sections pour chaque fournisseur de services dans un service.</span><span class="sxs-lookup"><span data-stu-id="708ed-118">The next level contains sections for each message service, and the last level contains sections for each service provider in a service.</span></span> <span data-ttu-id="708ed-119">MAPI exige que les développeurs de fournisseurs de services et les services de messagerie ajoutent certaines entrées à Mapisvc.inf ; les développeurs peuvent ajouter d’autres entrées à leur convenance.</span><span class="sxs-lookup"><span data-stu-id="708ed-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; developers can add other entries at their own discretion.</span></span> <span data-ttu-id="708ed-120">La plupart des informations de Mapisvc.inf finit dans un ou plusieurs profils, une collection d’informations de configuration pour un utilisateur préféré ensemble de services de messagerie.</span><span class="sxs-lookup"><span data-stu-id="708ed-120">Most of the information in Mapisvc.inf ends up in one or more profiles, a collection of configuration information for a user's preferred set of message services.</span></span> <span data-ttu-id="708ed-121">Un ordinateur peut avoir plusieurs utilisateurs et un utilisateur unique peut avoir plusieurs ensembles de préférences, plusieurs profils peuvent exister sur un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="708ed-121">Because a computer can have multiple users and a single user can have multiple sets of preferences, many profiles can exist on a computer.</span></span> <span data-ttu-id="708ed-122">Chaque profil décrit un ensemble de services de messagerie différent.</span><span class="sxs-lookup"><span data-stu-id="708ed-122">Each profile describes a different set of message services.</span></span> <span data-ttu-id="708ed-123">Avoir plusieurs profils permet à un utilisateur à l’utilisation, par exemple, chez un ensemble de services de messagerie et au bureau avec un ensemble différent.</span><span class="sxs-lookup"><span data-stu-id="708ed-123">Having multiple profiles enables a user to work, for example, at home with one set of message services and at the office with a different set.</span></span>
  
<span data-ttu-id="708ed-124">Profils créés à l’installation du service de message ou l’heure d’ouverture de session par une application cliente qui fournit la prise en charge de la configuration.</span><span class="sxs-lookup"><span data-stu-id="708ed-124">Profiles are created at message service installation or logon time by a client application that provides configuration support.</span></span> <span data-ttu-id="708ed-125">MAPI fournit deux clients de ces applications : un élément du Panneau de configuration et l’Assistant profil.</span><span class="sxs-lookup"><span data-stu-id="708ed-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span></span> <span data-ttu-id="708ed-126">L’élément du Panneau de configuration est une application de la configuration complète avec lequel les utilisateurs peuvent créer, supprimer, modifier et copier des profils, ainsi qu’apporter des modifications aux entrées situées dans un profil.</span><span class="sxs-lookup"><span data-stu-id="708ed-126">The Control Panel item is a full-service configuration application with which users can create, delete, edit, and copy profiles, as well as make modifications to the entries in a profile.</span></span> <span data-ttu-id="708ed-127">L’Assistant profil est une simple application conçue pour faciliter l’ajout d’un service de message à un profil aussi simple que possible.</span><span class="sxs-lookup"><span data-stu-id="708ed-127">The Profile Wizard is a simple application designed to make adding a message service to a profile as easy as possible.</span></span> <span data-ttu-id="708ed-128">L’Assistant profil se compose d’une série de boîtes de dialogue, appelée pages de propriétés, qui invite l’utilisateur à travers le processus d’installation et configuration d’un service.</span><span class="sxs-lookup"><span data-stu-id="708ed-128">The Profile Wizard consists of a series of dialog boxes, called property pages, that prompt the user through the process of installing and configuring a service.</span></span> <span data-ttu-id="708ed-129">L’utilisateur est invité uniquement pour les valeurs pour les paramètres stratégiques ; tous les autres paramètres héritent des valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="708ed-129">The user is prompted only for values for the most critical settings; all other settings inherit default values.</span></span> <span data-ttu-id="708ed-130">Une fois que le profil a été créé, les utilisateurs ne sont pas autorisés à apporter des modifications.</span><span class="sxs-lookup"><span data-stu-id="708ed-130">Once the profile has been created, users are not allowed to make changes.</span></span> 
  
<span data-ttu-id="708ed-131">Tandis que l’élément du Panneau de configuration est toujours appelé par le biais du Panneau de configuration, il existe de nombreux scénarios qui peuvent provoquer l’Assistant profil à appeler.</span><span class="sxs-lookup"><span data-stu-id="708ed-131">Whereas the Control Panel item is always invoked through the Control Panel, there are a variety of scenarios that can cause the Profile Wizard to be called.</span></span> <span data-ttu-id="708ed-132">Les applications clientes peuvent appeler l’Assistant profil pour créer un profil par défaut au moment de l’ouverture de session lorsqu’un n'a pas encore été créé.</span><span class="sxs-lookup"><span data-stu-id="708ed-132">Client applications can call the Profile Wizard to create a default profile at logon time when one has not yet been created.</span></span> <span data-ttu-id="708ed-133">Au lieu de réimplémenter le code pour ajouter un profil, l’élément du Panneau de configuration ou une autre application cliente permettre compter sur les fonctionnalités déjà dans l’Assistant profil.</span><span class="sxs-lookup"><span data-stu-id="708ed-133">Rather than reimplementing code to add a profile, the Control Panel item or another client application can rely on the functionality already in the Profile Wizard.</span></span> <span data-ttu-id="708ed-134">Un service de message, en fonction de son point d’entrée, peut appeler l’Assistant profil lorsque le service doit être ajouté au profil par défaut.</span><span class="sxs-lookup"><span data-stu-id="708ed-134">A message service, in its entry point function, can call the Profile Wizard when the service needs to be added to the default profile.</span></span> <span data-ttu-id="708ed-135">Services de messagerie qui utilisent l’Assistant profil doivent écrire une fonction de point d’entrée supplémentaire et une procédure de boîte de dialogue Windows standard.</span><span class="sxs-lookup"><span data-stu-id="708ed-135">Message services that use the Profile Wizard must write an extra entry point function and a standard Windows dialog box procedure.</span></span> <span data-ttu-id="708ed-136">L’Assistant profil appelle la fonction de point d’entrée pour récupérer la boîte de dialogue configuration du service pendant la procédure de boîte de dialogue gère les messages qui sont générées lorsque cette boîte de dialogue est en cours d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="708ed-136">The Profile Wizard calls the entry point function to retrieve the service's configuration dialog box while the dialog box procedure handles the messages that are generated when this dialog box is in use.</span></span> 
  
<span data-ttu-id="708ed-137">Les profils sont organisés de façon similaire au fichier Mapisvc.inf.</span><span class="sxs-lookup"><span data-stu-id="708ed-137">Profiles are organized in a similar way to the Mapisvc.inf file.</span></span> <span data-ttu-id="708ed-138">Profils ont liés sections hiérarchiques ; service fournisseurs propres sections de niveau le plus bas, services message possèdent des sections de niveau intermédiaire et MAPI possède des sections de niveau le plus élevé.</span><span class="sxs-lookup"><span data-stu-id="708ed-138">Profiles have linked hierarchical sections; service providers own sections in the lowest level, message services own sections in the middle level, and MAPI owns sections in the highest level.</span></span> <span data-ttu-id="708ed-139">Chaque section est identifiée par un identificateur unique appelé une [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="708ed-139">Each section is identified with a unique identifier known as a [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="708ed-140">Les sections MAPI contiennent des informations internes à MAPI, tels que les identificateurs de toutes les sections de profil de service de message et des liens vers chacune des autres sections.</span><span class="sxs-lookup"><span data-stu-id="708ed-140">The MAPI sections contain information internal to MAPI, such as the identifiers of all of the message service profile sections and links to each of the other sections.</span></span> <span data-ttu-id="708ed-141">Chaque section du service de message stocke des liens vers les sections de fournisseur, et chaque section fournisseur stocke un lien vers la section service.</span><span class="sxs-lookup"><span data-stu-id="708ed-141">Each message service section stores links to its provider sections, and each provider section stores a link to its service section.</span></span> 
  
<span data-ttu-id="708ed-142">L’illustration suivante montre le contenu des deux profils standard.</span><span class="sxs-lookup"><span data-stu-id="708ed-142">The following illustration shows the contents of two typical profiles.</span></span> <span data-ttu-id="708ed-143">SAM a deux profils sur son ordinateur, un pour un usage personnel et un pour l’utilisation d’office.</span><span class="sxs-lookup"><span data-stu-id="708ed-143">Sam has two profiles on his computer, one for home use and one for office use.</span></span> <span data-ttu-id="708ed-144">Le profil d’accueil contient trois services de messagerie.</span><span class="sxs-lookup"><span data-stu-id="708ed-144">The home profile contains three message services.</span></span> <span data-ttu-id="708ed-145">Message Service X est un service de fournisseur unique pour la gestion de carnet d’adresses.</span><span class="sxs-lookup"><span data-stu-id="708ed-145">Message Service X is a single provider service for address book management.</span></span> <span data-ttu-id="708ed-146">Message Services Y et Z comporte trois fournisseurs : un fournisseur de carnet d’adresses, un fournisseur de magasin de message et un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="708ed-146">Message Services Y and Z have three providers — an address book provider, a message store provider, and a transport provider.</span></span> <span data-ttu-id="708ed-147">Profil de travail de SAM contient deux services différents de messages, chacun d'entre eux avec un fournisseur de carnet d’adresses, d’un fournisseur de magasin de message et un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="708ed-147">Sam's Work Profile contains two different message services, each of which has an address book provider, a message store provider, and a transport provider.</span></span> 
  
<span data-ttu-id="708ed-148">**Exemple de profil**</span><span class="sxs-lookup"><span data-stu-id="708ed-148">**Profile example**</span></span>
  
<span data-ttu-id="708ed-149">![Exemple de profil] (media/amapi_56.gif "Exemple de profil")</span><span class="sxs-lookup"><span data-stu-id="708ed-149">![Profile example](media/amapi_56.gif "Profile example")</span></span>
  
<span data-ttu-id="708ed-150">L’illustration suivante montre un profil qui inclut deux services de messagerie.</span><span class="sxs-lookup"><span data-stu-id="708ed-150">The following illustration shows a profile that includes two message services.</span></span> <span data-ttu-id="708ed-151">Le code pour installer et configurer les fournisseurs de services qui appartiennent au service de message se trouve dans la même DLL que le code pour les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="708ed-151">The code for installing and configuring the service providers that belong to the message service resides in the same DLL as the code for the providers.</span></span> <span data-ttu-id="708ed-152">Ce code lit les informations de profil au moment de l’ouverture de session pour configurer les fournisseurs de services, et il invite l’utilisateur, dans la mesure du possible et nécessaire, les informations manquantes.</span><span class="sxs-lookup"><span data-stu-id="708ed-152">This code reads information from the profile at logon time to configure the service providers, and it prompts the user, if possible and necessary, for missing information.</span></span> <span data-ttu-id="708ed-153">Demandes d’un client pour afficher ou modifier les paramètres de configuration pour tous les fournisseurs sont également gérés par ce code courantes.</span><span class="sxs-lookup"><span data-stu-id="708ed-153">Requests from a client to view or change configuration settings for any of the providers are also handled by this common code.</span></span>
  
<span data-ttu-id="708ed-154">**Installation et configuration des fournisseurs de services**</span><span class="sxs-lookup"><span data-stu-id="708ed-154">**Installing and configuring service providers**</span></span>
  
<span data-ttu-id="708ed-155">![Installation et configuration des fournisseurs de services] (media/amapi_55.gif "Installation et configuration des fournisseurs de services")</span><span class="sxs-lookup"><span data-stu-id="708ed-155">![Installing and configuring service providers](media/amapi_55.gif "Installing and configuring service providers")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="708ed-156">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="708ed-156">See also</span></span>

- [<span data-ttu-id="708ed-157">MAPIUID</span><span class="sxs-lookup"><span data-stu-id="708ed-157">MAPIUID</span></span>](mapiuid.md)
- [<span data-ttu-id="708ed-158">Vue d'ensemble de la programmation MAPI</span><span class="sxs-lookup"><span data-stu-id="708ed-158">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

