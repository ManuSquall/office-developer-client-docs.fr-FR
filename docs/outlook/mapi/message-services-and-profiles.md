---
title: Profils et services de messagerie
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 'Dernière modification : 23 juillet 2011'
ms.openlocfilehash: 78a13bacf13b019bbf9436830ad66db7fdfaf425
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32356957"
---
# <a name="message-services-and-profiles"></a><span data-ttu-id="31f4b-103">Profils et services de messagerie</span><span class="sxs-lookup"><span data-stu-id="31f4b-103">Message services and profiles</span></span>
  
<span data-ttu-id="31f4b-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="31f4b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="31f4b-105">Certains utilisateurs ont besoin des services de plusieurs systèmes de messagerie, chacun avec un ou plusieurs fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="31f4b-105">Some users require the services of several messaging systems, each with one or more service providers.</span></span> <span data-ttu-id="31f4b-106">Étant donné qu'il est lourd d'installer et de configurer chacun de ces fournisseurs de services individuellement, et qu'un serveur de messagerie exige généralement un groupe de fournisseurs associés pour exposer toutes ses fonctionnalités, MAPI inclut le concept de service de messagerie.</span><span class="sxs-lookup"><span data-stu-id="31f4b-106">Because it is cumbersome to install and configure each of these service providers individually, and because a messaging server usually requires a group of related providers to expose all its functionality, MAPI includes the concept of a message service.</span></span> <span data-ttu-id="31f4b-107">Les services de messagerie aident les utilisateurs à installer et à configurer leurs fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="31f4b-107">Message services help users install and configure their service providers.</span></span>
  
<span data-ttu-id="31f4b-108">Pour créer un service de messagerie, un développeur écrit un programme de point d'entrée de service de message afin de gérer la configuration de chaque fournisseur du service et d'un programme d'installation pour effectuer les opérations suivantes:</span><span class="sxs-lookup"><span data-stu-id="31f4b-108">To create a message service, a developer writes a message-service entry point program to handle the configuration of each provider in the service and a setup program to do the following:</span></span>
  
- <span data-ttu-id="31f4b-109">Installez chaque fournisseur dans le service.</span><span class="sxs-lookup"><span data-stu-id="31f4b-109">Install each provider in the service.</span></span>
    
- <span data-ttu-id="31f4b-110">Créez des entrées de Registre et de fichier d'initialisation.</span><span class="sxs-lookup"><span data-stu-id="31f4b-110">Create registry and initialization file entries.</span></span>
    
- <span data-ttu-id="31f4b-111">Créez des entrées dans le fichier de configuration MAPI, MAPISVC. inf.</span><span class="sxs-lookup"><span data-stu-id="31f4b-111">Create entries in the MAPI configuration file, Mapisvc.inf.</span></span>
    
<span data-ttu-id="31f4b-112">Le fichier MAPISVC. INF contient des informations relatives à la configuration de tous les services de messagerie et fournisseurs de services installés sur l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="31f4b-112">The Mapisvc.inf file contains information that relates to the configuration of all message services and service providers installed on the computer.</span></span> <span data-ttu-id="31f4b-113">Elle est organisée en sections hiérarchiques, chaque niveau étant lié à la suivante.</span><span class="sxs-lookup"><span data-stu-id="31f4b-113">It is organized in hierarchical sections, with each level linked to the next.</span></span> <span data-ttu-id="31f4b-114">Les deux sections suivantes contiennent les éléments suivants:</span><span class="sxs-lookup"><span data-stu-id="31f4b-114">At the top are three sections that contain the following:</span></span> 
  
- <span data-ttu-id="31f4b-115">Liste des fichiers d'aide du service de messagerie.</span><span class="sxs-lookup"><span data-stu-id="31f4b-115">A list of message service Help files.</span></span>
    
- <span data-ttu-id="31f4b-116">Une liste des services de messagerie les plus importants ou par défaut.</span><span class="sxs-lookup"><span data-stu-id="31f4b-116">A list of the most important, or default, message services.</span></span>
    
- <span data-ttu-id="31f4b-117">Liste de tous les services sur l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="31f4b-117">A list of all the services on the computer.</span></span>
    
<span data-ttu-id="31f4b-118">Le niveau suivant contient des sections pour chaque service de messagerie, et le dernier niveau contient des sections pour chaque fournisseur de services dans un service.</span><span class="sxs-lookup"><span data-stu-id="31f4b-118">The next level contains sections for each message service, and the last level contains sections for each service provider in a service.</span></span> <span data-ttu-id="31f4b-119">MAPI exige que les développeurs de fournisseurs de services et de services de messagerie ajoutent certaines entrées à Mapisvc. inf; les développeurs peuvent ajouter d'autres entrées à leur propre discrétion.</span><span class="sxs-lookup"><span data-stu-id="31f4b-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; developers can add other entries at their own discretion.</span></span> <span data-ttu-id="31f4b-120">La plupart des informations contenues dans le fichier MAPISVC. inf se terminent dans un ou plusieurs profils, une collection d'informations de configuration pour l'ensemble privilégié des services de messagerie d'un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="31f4b-120">Most of the information in Mapisvc.inf ends up in one or more profiles, a collection of configuration information for a user's preferred set of message services.</span></span> <span data-ttu-id="31f4b-121">Étant donné qu'un ordinateur peut avoir plusieurs utilisateurs et qu'un seul utilisateur peut avoir plusieurs ensembles de préférences, de nombreux profils peuvent exister sur un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="31f4b-121">Because a computer can have multiple users and a single user can have multiple sets of preferences, many profiles can exist on a computer.</span></span> <span data-ttu-id="31f4b-122">Chaque profil décrit un ensemble différent de services de messagerie.</span><span class="sxs-lookup"><span data-stu-id="31f4b-122">Each profile describes a different set of message services.</span></span> <span data-ttu-id="31f4b-123">Le fait de disposer de plusieurs profils permet à un utilisateur de travailler, par exemple, à la maison avec un ensemble de services de messagerie et au bureau avec un ensemble différent.</span><span class="sxs-lookup"><span data-stu-id="31f4b-123">Having multiple profiles enables a user to work, for example, at home with one set of message services and at the office with a different set.</span></span>
  
<span data-ttu-id="31f4b-124">Les profils sont créés lors de l'installation du service de messagerie ou de l'ouverture de session par une application cliente qui fournit la prise en charge de la configuration.</span><span class="sxs-lookup"><span data-stu-id="31f4b-124">Profiles are created at message service installation or logon time by a client application that provides configuration support.</span></span> <span data-ttu-id="31f4b-125">MAPI fournit deux applications clientes de ce type: un élément du panneau de configuration et l'Assistant Profil.</span><span class="sxs-lookup"><span data-stu-id="31f4b-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span></span> <span data-ttu-id="31f4b-126">L'élément du panneau de configuration est une application de configuration de service complet avec laquelle les utilisateurs peuvent créer, supprimer, modifier et copier des profils, ainsi que modifier les entrées d'un profil.</span><span class="sxs-lookup"><span data-stu-id="31f4b-126">The Control Panel item is a full-service configuration application with which users can create, delete, edit, and copy profiles, as well as make modifications to the entries in a profile.</span></span> <span data-ttu-id="31f4b-127">L'Assistant Profil est une application simple conçue pour faciliter l'ajout d'un service de messagerie à un profil.</span><span class="sxs-lookup"><span data-stu-id="31f4b-127">The Profile Wizard is a simple application designed to make adding a message service to a profile as easy as possible.</span></span> <span data-ttu-id="31f4b-128">L'Assistant Profil se compose d'une série de boîtes de dialogue, appelées pages de propriétés, qui invitent l'utilisateur à passer par le processus d'installation et de configuration d'un service.</span><span class="sxs-lookup"><span data-stu-id="31f4b-128">The Profile Wizard consists of a series of dialog boxes, called property pages, that prompt the user through the process of installing and configuring a service.</span></span> <span data-ttu-id="31f4b-129">L'utilisateur est invité uniquement à indiquer les valeurs des paramètres les plus critiques; tous les autres paramètres héritent des valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="31f4b-129">The user is prompted only for values for the most critical settings; all other settings inherit default values.</span></span> <span data-ttu-id="31f4b-130">Une fois le profil créé, les utilisateurs ne sont pas autorisés à effectuer des modifications.</span><span class="sxs-lookup"><span data-stu-id="31f4b-130">Once the profile has been created, users are not allowed to make changes.</span></span> 
  
<span data-ttu-id="31f4b-131">Tandis que l'élément du panneau de configuration est toujours appelé dans le panneau de configuration, il existe un grand nombre de scénarios susceptibles d'entraîner l'appel de l'Assistant Profil.</span><span class="sxs-lookup"><span data-stu-id="31f4b-131">Whereas the Control Panel item is always invoked through the Control Panel, there are a variety of scenarios that can cause the Profile Wizard to be called.</span></span> <span data-ttu-id="31f4b-132">Les applications clientes peuvent appeler l'Assistant Profil pour créer un profil par défaut lors de l'ouverture de session lorsque l'utilisateur n'a pas encore été créé.</span><span class="sxs-lookup"><span data-stu-id="31f4b-132">Client applications can call the Profile Wizard to create a default profile at logon time when one has not yet been created.</span></span> <span data-ttu-id="31f4b-133">Au lieu d'implémenter le code pour ajouter un profil, l'élément du panneau de configuration ou une autre application cliente peut compter sur les fonctionnalités déjà présentes dans l'Assistant Profil.</span><span class="sxs-lookup"><span data-stu-id="31f4b-133">Rather than reimplementing code to add a profile, the Control Panel item or another client application can rely on the functionality already in the Profile Wizard.</span></span> <span data-ttu-id="31f4b-134">Un service de messagerie, dans sa fonction de point d'entrée, peut appeler l'Assistant Profil lorsque le service doit être ajouté au profil par défaut.</span><span class="sxs-lookup"><span data-stu-id="31f4b-134">A message service, in its entry point function, can call the Profile Wizard when the service needs to be added to the default profile.</span></span> <span data-ttu-id="31f4b-135">Les services de messagerie qui utilisent l'Assistant Profil doivent écrire une fonction de point d'entrée supplémentaire et une procédure de boîte de dialogue Windows standard.</span><span class="sxs-lookup"><span data-stu-id="31f4b-135">Message services that use the Profile Wizard must write an extra entry point function and a standard Windows dialog box procedure.</span></span> <span data-ttu-id="31f4b-136">L'Assistant Profil appelle la fonction de point d'entrée pour récupérer la boîte de dialogue de configuration du service tandis que la procédure de la boîte de dialogue gère les messages générés lorsque cette boîte de dialogue est en cours d'utilisation.</span><span class="sxs-lookup"><span data-stu-id="31f4b-136">The Profile Wizard calls the entry point function to retrieve the service's configuration dialog box while the dialog box procedure handles the messages that are generated when this dialog box is in use.</span></span> 
  
<span data-ttu-id="31f4b-137">Les profils sont organisés de la même façon que le fichier MAPISVC. inf.</span><span class="sxs-lookup"><span data-stu-id="31f4b-137">Profiles are organized in a similar way to the Mapisvc.inf file.</span></span> <span data-ttu-id="31f4b-138">Les profils ont des sections hiérarchiques liées; les fournisseurs de services possèdent des sections au niveau le plus bas, les sections des services de messagerie au niveau intermédiaire et MAPI, le niveau le plus élevé.</span><span class="sxs-lookup"><span data-stu-id="31f4b-138">Profiles have linked hierarchical sections; service providers own sections in the lowest level, message services own sections in the middle level, and MAPI owns sections in the highest level.</span></span> <span data-ttu-id="31f4b-139">Chaque section est identifiée par un identificateur unique appelé [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="31f4b-139">Each section is identified with a unique identifier known as a [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="31f4b-140">Les sections MAPI contiennent des informations internes à MAPI, telles que les identificateurs de toutes les sections de profil de service de message et des liens vers chacune des autres sections.</span><span class="sxs-lookup"><span data-stu-id="31f4b-140">The MAPI sections contain information internal to MAPI, such as the identifiers of all of the message service profile sections and links to each of the other sections.</span></span> <span data-ttu-id="31f4b-141">Chaque section service de messagerie stocke des liens vers ses sections de fournisseur, et chaque section de fournisseur stocke un lien vers sa section service.</span><span class="sxs-lookup"><span data-stu-id="31f4b-141">Each message service section stores links to its provider sections, and each provider section stores a link to its service section.</span></span> 
  
<span data-ttu-id="31f4b-142">L'illustration suivante montre le contenu de deux profils standard.</span><span class="sxs-lookup"><span data-stu-id="31f4b-142">The following illustration shows the contents of two typical profiles.</span></span> <span data-ttu-id="31f4b-143">Sam dispose de deux profils sur son ordinateur, un pour les particuliers et un pour l'utilisation d'Office.</span><span class="sxs-lookup"><span data-stu-id="31f4b-143">Sam has two profiles on his computer, one for home use and one for office use.</span></span> <span data-ttu-id="31f4b-144">Le profil d'accueil contient trois services de messagerie.</span><span class="sxs-lookup"><span data-stu-id="31f4b-144">The home profile contains three message services.</span></span> <span data-ttu-id="31f4b-145">Le service de messagerie X est un service de fournisseur unique pour la gestion des carnets d'adresses.</span><span class="sxs-lookup"><span data-stu-id="31f4b-145">Message Service X is a single provider service for address book management.</span></span> <span data-ttu-id="31f4b-146">Les services de messagerie Y et Z ont trois fournisseurs, un fournisseur de carnets d'adresses, un fournisseur de banque de messages et un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="31f4b-146">Message Services Y and Z have three providers — an address book provider, a message store provider, and a transport provider.</span></span> <span data-ttu-id="31f4b-147">Le profil de travail de Sam contient deux services de messagerie différents, chacun d'eux disposant d'un fournisseur de carnet d'adresses, d'un fournisseur de banque de messages et d'un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="31f4b-147">Sam's Work Profile contains two different message services, each of which has an address book provider, a message store provider, and a transport provider.</span></span> 
  
<span data-ttu-id="31f4b-148">**Exemple de profil**</span><span class="sxs-lookup"><span data-stu-id="31f4b-148">**Profile example**</span></span>
  
<span data-ttu-id="31f4b-149">![Exemple de profil] (media/amapi_56.gif "Exemple de profil")</span><span class="sxs-lookup"><span data-stu-id="31f4b-149">![Profile example](media/amapi_56.gif "Profile example")</span></span>
  
<span data-ttu-id="31f4b-150">L'illustration suivante montre un profil qui inclut deux services de messagerie.</span><span class="sxs-lookup"><span data-stu-id="31f4b-150">The following illustration shows a profile that includes two message services.</span></span> <span data-ttu-id="31f4b-151">Le code permettant d'installer et de configurer les fournisseurs de services qui appartiennent au service de messagerie réside dans la même DLL que le code des fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="31f4b-151">The code for installing and configuring the service providers that belong to the message service resides in the same DLL as the code for the providers.</span></span> <span data-ttu-id="31f4b-152">Ce code lit les informations du profil au moment de l'ouverture de session pour configurer les fournisseurs de services, et il invite l'utilisateur, si possible et nécessaire, pour les informations manquantes.</span><span class="sxs-lookup"><span data-stu-id="31f4b-152">This code reads information from the profile at logon time to configure the service providers, and it prompts the user, if possible and necessary, for missing information.</span></span> <span data-ttu-id="31f4b-153">Les demandes d'un client permettant d'afficher ou de modifier les paramètres de configuration de l'un des fournisseurs sont également gérées par ce code commun.</span><span class="sxs-lookup"><span data-stu-id="31f4b-153">Requests from a client to view or change configuration settings for any of the providers are also handled by this common code.</span></span>
  
<span data-ttu-id="31f4b-154">**Installation et configuration des fournisseurs de services**</span><span class="sxs-lookup"><span data-stu-id="31f4b-154">**Installing and configuring service providers**</span></span>
  
<span data-ttu-id="31f4b-155">![Installation et configuration des fournisseurs de services] (media/amapi_55.gif "Installation et configuration des fournisseurs de services")</span><span class="sxs-lookup"><span data-stu-id="31f4b-155">![Installing and configuring service providers](media/amapi_55.gif "Installing and configuring service providers")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="31f4b-156">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="31f4b-156">See also</span></span>

- [<span data-ttu-id="31f4b-157">MAPIUID</span><span class="sxs-lookup"><span data-stu-id="31f4b-157">MAPIUID</span></span>](mapiuid.md)
- [<span data-ttu-id="31f4b-158">Vue d'ensemble de la programmation MAPI</span><span class="sxs-lookup"><span data-stu-id="31f4b-158">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

