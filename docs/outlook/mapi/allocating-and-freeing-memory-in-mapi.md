---
title: Allocation et libération de la mémoire dans MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e238f6bc-e9f6-4ea4-a2e4-ff5da2a04bd5
description: Dernière modification le 09 mars 2015
ms.openlocfilehash: 2ec5c2604c72d41078aa467764463e2659c62e65
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22587942"
---
# <a name="allocating-and-freeing-memory-in-mapi"></a><span data-ttu-id="5cd6d-103">Allocation et libération de la mémoire dans MAPI</span><span class="sxs-lookup"><span data-stu-id="5cd6d-103">Allocating and Freeing Memory in MAPI</span></span>

  
  
<span data-ttu-id="5cd6d-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="5cd6d-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="5cd6d-105">Outre la spécification de l’affectation et libérer de la mémoire, MAPI définit un modèle pour savoir quand la mémoire transmise entre la méthode d’interface publique et la fonction API appels doivent être libérés.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-105">In addition to specifying how to allocate and free memory, MAPI defines a model for knowing when memory passed between public interface method and API function calls should be freed.</span></span> <span data-ttu-id="5cd6d-106">Le modèle s’applique uniquement à la mémoire allouée pour les paramètres qui ne sont pas des pointeurs vers des interfaces, telles que des chaînes et des pointeurs vers des structures.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-106">The model applies only to memory allocated for parameters that are not pointers to interfaces, such as strings and pointers to structures.</span></span> <span data-ttu-id="5cd6d-107">Pointeurs d’interface utilisent le décompte de références mécanisme implémentés par le biais de **IUnknown**.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-107">Interface pointers use the reference counting mechanism implemented through **IUnknown**.</span></span> <span data-ttu-id="5cd6d-108">Lors de l’allocation et la libération non MAPI liées mémoire en interne au sein d’une application cliente ou d’un fournisseur de services, utilisez le mécanisme significatif.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-108">When allocating and freeing non-MAPI related memory internally within a client application or service provider, use whatever mechanism makes sense.</span></span> 
  
<span data-ttu-id="5cd6d-109">Le modèle définit les paramètres d’un des trois types.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-109">The model defines parameters as one of three types.</span></span> <span data-ttu-id="5cd6d-110">Ils peuvent être saisis paramètres, définis par l’appelant avec des informations pour être utilisé par la fonction ou la méthode, paramètres de sortie, défini par la méthode ou la fonction appelée et renvoyé à l’appelant, ou une combinaison des deux types de paramètres d’entrée / sortie.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-110">They can be input parameters, set by the caller with information to be used by the called function or method, output parameters, set by the called function or method and returned to the caller, or input-output parameters, a combination of the two types.</span></span> <span data-ttu-id="5cd6d-111">Paramètres de sortie sont souvent des pointeurs vers des données ou des pointeurs vers des pointeurs vers des données.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-111">Output parameters are frequently pointers to data or pointers to pointers to data.</span></span> <span data-ttu-id="5cd6d-112">Bien que la fonction appelée est chargée d’allouer les données pour les paramètres de sortie, l’appelant alloue de la mémoire pour le pointeur.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-112">Although the called function is responsible for allocating the data for output parameters, the caller allocates the memory for the pointer.</span></span> 
  
<span data-ttu-id="5cd6d-113">Les règles d’allouer et de libérer de la mémoire pour ces types de paramètres sont expliquées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-113">The rules for allocating and releasing memory for these types of parameters are explained in the following table.</span></span>
  
|<span data-ttu-id="5cd6d-114">**Type**</span><span class="sxs-lookup"><span data-stu-id="5cd6d-114">**Type**</span></span>|<span data-ttu-id="5cd6d-115">**Allocation de mémoire**</span><span class="sxs-lookup"><span data-stu-id="5cd6d-115">**Memory allocation**</span></span>|<span data-ttu-id="5cd6d-116">**Version de la mémoire**</span><span class="sxs-lookup"><span data-stu-id="5cd6d-116">**Memory release**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="5cd6d-117">Input</span><span class="sxs-lookup"><span data-stu-id="5cd6d-117">Input</span></span>  <br/> |<span data-ttu-id="5cd6d-118">L’appelant est chargé et permettre utiliser n’importe quel mécanisme.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-118">Caller is responsible and can use any mechanism.</span></span>  <br/> |<span data-ttu-id="5cd6d-119">L’appelant est chargé et permettre utiliser n’importe quel mécanisme.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-119">Caller is responsible and can use any mechanism.</span></span>  <br/> |
|<span data-ttu-id="5cd6d-120">Output</span><span class="sxs-lookup"><span data-stu-id="5cd6d-120">Output</span></span>  <br/> |<span data-ttu-id="5cd6d-121">Fonction appelée est chargée et doit utiliser **MAPIAllocateBuffer**.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-121">Called function is responsible and must use **MAPIAllocateBuffer**.</span></span> <span data-ttu-id="5cd6d-122">Pour plus d’informations, voir [MAPIAllocateBuffer](mapiallocatebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="5cd6d-122">For more information, see [MAPIAllocateBuffer](mapiallocatebuffer.md).</span></span>  <br/> |<span data-ttu-id="5cd6d-123">L’appelant est chargé et doit utiliser **MAPIFreeBuffer**.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-123">Caller is responsible and must use **MAPIFreeBuffer**.</span></span> <span data-ttu-id="5cd6d-124">Pour plus d’informations, voir [MAPIFreeBuffer](mapifreebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="5cd6d-124">For more information, see [MAPIFreeBuffer](mapifreebuffer.md).</span></span>  <br/> |
|<span data-ttu-id="5cd6d-125">Entrées / sorties</span><span class="sxs-lookup"><span data-stu-id="5cd6d-125">Input-output</span></span>  <br/> |<span data-ttu-id="5cd6d-126">L’appelant est responsable de l’allocation initiale et la fonction appelée peuvent réaffecter si nécessaire à l’aide de **MAPIAllocateBuffer**.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-126">Caller is responsible for the initial allocation and called function can reallocate if necessary using **MAPIAllocateBuffer**.</span></span>  <br/> |<span data-ttu-id="5cd6d-127">Fonction appelée est chargée de libérer initiale si réallocation est requise.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-127">Called function is responsible for initial freeing if reallocation is necessary.</span></span> <span data-ttu-id="5cd6d-128">L’appelant doit libérer la valeur de retour finale.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-128">Caller must free the final return value.</span></span>  <br/> |
   
<span data-ttu-id="5cd6d-129">Au cours des conditions d’échec, l’implémentation des méthodes d’interface doit attention aux paramètres de sortie et d’entrée / sortie car l’appelant a généralement aucun moyen pour les nettoyer.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-129">During failure conditions, implementers of interface methods need to pay attention to output and input-output parameters because the caller generally has no way to clean them up.</span></span> <span data-ttu-id="5cd6d-130">Si une erreur est renvoyée, puis chaque sortie ou le paramètre d’entrée / sortie doit soit rester à la valeur initialisée par l’appelant ou une valeur qui peut être nettoyés sans aucune action de la part de l’appelant.</span><span class="sxs-lookup"><span data-stu-id="5cd6d-130">If an error is returned, then each output or input-output parameter must either be left at the value initialized by the caller or set to a value that can be cleaned up without any action on the part of the caller.</span></span> <span data-ttu-id="5cd6d-131">Par exemple, un pointeur-paramètre de sortie de `void ** ppv` doit rester tel qu’il a été entrée ou peut être définie sur NULL ( `*ppv = NULL`).</span><span class="sxs-lookup"><span data-stu-id="5cd6d-131">For example, an output pointer-parameter of  `void ** ppv` must be left as it was on input or can be set to NULL (  `*ppv = NULL`).</span></span>
  

