---
title: Définition de nouvelles propriétés MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 1a2325ea-ddfa-480f-b65f-f5b20471fb40
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 666ee413319765e39e25d586208f764afc93ae6b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425014"
---
# <a name="defining-new-mapi-properties"></a><span data-ttu-id="d906d-103">Définition de nouvelles propriétés MAPI</span><span class="sxs-lookup"><span data-stu-id="d906d-103">Defining New MAPI Properties</span></span>

  
  
<span data-ttu-id="d906d-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d906d-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d906d-105">Malgré le grand éventail de propriétés fournies par MAPI pour les clients et les fournisseurs de services, MAPI permet de créer de nouvelles propriétés si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="d906d-105">In spite of the wealth of properties supplied by MAPI for use by clients and service providers, MAPI enables new properties to be created if necessary.</span></span> <span data-ttu-id="d906d-106">Certains des scénarios valides pour la définition de nouvelles propriétés publiques incluent un client qui crée des propriétés pour prendre en charge une nouvelle classe de message et un fournisseur de services qui crée de nouvelles propriétés pour exposer des fonctionnalités de système de messagerie uniques.</span><span class="sxs-lookup"><span data-stu-id="d906d-106">Some of the valid scenarios for defining new public properties include a client creating properties to support a new message class and a service provider creating new properties to expose unique messaging system features.</span></span>
  
<span data-ttu-id="d906d-107">En règle générale, il n'est pas valide pour un fournisseur de services de définir de nouvelles propriétés pour un objet MAPI ou une classe de message existant.</span><span class="sxs-lookup"><span data-stu-id="d906d-107">It is typically not valid for a service provider to define new properties for an existing MAPI object or message class.</span></span> <span data-ttu-id="d906d-108">L'un des principaux avantages de l'utilisation de MAPI est que les identificateurs et formats standard d'un grand nombre d'éléments du système de messagerie sont configurés, ce qui permet aux utilisateurs de combiner et de faire correspondre les fournisseurs de services de manière transparente.</span><span class="sxs-lookup"><span data-stu-id="d906d-108">One of the primary benefits of using MAPI is that standard identifiers and formats for a large number of messaging system elements are set up, enabling users to seamlessly mix and match service providers.</span></span> <span data-ttu-id="d906d-109">Les fournisseurs de services qui utilisent des propriétés non standard ne fonctionnent pas aussi bien avec d'autres fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="d906d-109">Service providers that use nonstandard properties do not work as well with other service providers.</span></span> 
  
<span data-ttu-id="d906d-110">Les clients peuvent créer des propriétés de contenu pour les nouvelles classes de messages en procédant comme suit:</span><span class="sxs-lookup"><span data-stu-id="d906d-110">Clients can create content properties for new message classes by:</span></span>
  
- <span data-ttu-id="d906d-111">Utilisation des identificateurs de propriété dans une plage désignée pour les propriétés de contenu propres à la classe de message.</span><span class="sxs-lookup"><span data-stu-id="d906d-111">Using property identifiers within a designated range for message class-specific content properties.</span></span>
    
    - <span data-ttu-id="d906d-112">Des</span><span class="sxs-lookup"><span data-stu-id="d906d-112">Or -</span></span>
    
- <span data-ttu-id="d906d-113">Utilisation des propriétés nommées.</span><span class="sxs-lookup"><span data-stu-id="d906d-113">Using named properties.</span></span> 
    
<span data-ttu-id="d906d-114">La première option est préférable, car tous les fournisseurs de services ne prennent pas en charge les propriétés nommées.</span><span class="sxs-lookup"><span data-stu-id="d906d-114">The first option is preferable because not all service providers support named properties.</span></span> <span data-ttu-id="d906d-115">MAPI définit deux plages distinctes pour les clients à utiliser pour les nouvelles propriétés de contenu propres à la classe de message:</span><span class="sxs-lookup"><span data-stu-id="d906d-115">MAPI defines two separate ranges for clients to use for new message class-specific content properties:</span></span>
  
- <span data-ttu-id="d906d-116">0x6800 vers 0x7BFF pour les propriétés transmissibles</span><span class="sxs-lookup"><span data-stu-id="d906d-116">0x6800 to 0x7BFF for transmittable properties</span></span>
    
- <span data-ttu-id="d906d-117">0x7C00 vers 0x7FFF pour les propriétés qui ne sont pas transmissibles</span><span class="sxs-lookup"><span data-stu-id="d906d-117">0x7C00 to 0x7FFF for nontransmittable properties</span></span>
    
<span data-ttu-id="d906d-118">Les identificateurs de propriété doivent faire partie de plages prédéfinies pour empêcher les collisions entre les propriétés définies par des fournisseurs ou des utilisateurs différents.</span><span class="sxs-lookup"><span data-stu-id="d906d-118">Property identifiers must fall in predefined ranges to help prevent collisions between properties defined by different vendors or users.</span></span> <span data-ttu-id="d906d-119">Toutefois, les utilisateurs des propriétés de ces plages ne peuvent pas faire des suppositions quant au comportement des propriétés.</span><span class="sxs-lookup"><span data-stu-id="d906d-119">However, users of properties in these ranges cannot make assumptions as to the behavior of the properties.</span></span> <span data-ttu-id="d906d-120">Tous les clients qui créent une nouvelle classe de message ont accès à ces plages; une propriété avec identificateur _xxxx_ peut signifier un comportement pour une classe de message et un autre comportement pour une autre classe de message.</span><span class="sxs-lookup"><span data-stu-id="d906d-120">Every client that creates a new message class has access to these ranges; a property with identifier  _xxxx_ can mean one behavior for one message class and another behavior for another message class.</span></span> 
  
<span data-ttu-id="d906d-121">Les propriétés nommées sont utilisées pour garantir qu'une propriété spécifique est unique à une classe de message.</span><span class="sxs-lookup"><span data-stu-id="d906d-121">Named properties are used to guarantee a specific property is unique to a message class.</span></span> <span data-ttu-id="d906d-122">Les identificateurs de propriétés nommés commencent dans la plage 0x8000.</span><span class="sxs-lookup"><span data-stu-id="d906d-122">Named property identifiers start in the 0x8000 range.</span></span> <span data-ttu-id="d906d-123">Les clients définissent un ou plusieurs noms, puis appellent la méthode [IMAPIProp:: GetIDsFromNames](imapiprop-getidsfromnames.md) de la Banque de messages pour associer un identificateur à chaque nom.</span><span class="sxs-lookup"><span data-stu-id="d906d-123">Clients define one or more names and then call the message store's [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) method to associate an identifier with each name.</span></span> <span data-ttu-id="d906d-124">Les propriétés nommées peuvent être utilisées par les clients ou les fournisseurs de services pour définir de nouvelles propriétés pour n'importe quel objet uniquement si le propriétaire de l'objet prend en charge les propriétés nommées.</span><span class="sxs-lookup"><span data-stu-id="d906d-124">Named properties can be used by clients or service providers to define new properties for any object only if the owner of the object supports named properties.</span></span> <span data-ttu-id="d906d-125">Les utilisateurs de ces propriétés appellent **GetIDsFromNames** et une méthode **IMAPIProp** associée, [GetNamesFromIDs](imapiprop-getnamesfromids.md), pour établir une correspondance entre un nom et son identificateur.</span><span class="sxs-lookup"><span data-stu-id="d906d-125">Users of these properties call **GetIDsFromNames** and a related **IMAPIProp** method, [GetNamesFromIDs](imapiprop-getnamesfromids.md), to map between a name and its identifier.</span></span>
  
<span data-ttu-id="d906d-126">Toutes les propriétés, nouvelles ou existantes, doivent utiliser l'ensemble de types de propriétés prédéfinis.</span><span class="sxs-lookup"><span data-stu-id="d906d-126">All properties, new or existing, must use the set of predefined property types.</span></span> <span data-ttu-id="d906d-127">Les nouveaux types de propriétés ne peuvent pas être ajoutés et les types existants ne peuvent pas être modifiés ou supprimés.</span><span class="sxs-lookup"><span data-stu-id="d906d-127">New property types cannot be added and existing types cannot be modified or deleted.</span></span> <span data-ttu-id="d906d-128">Les propriétés simples, de petite taille, telles que les propriétés d'entier à un seul caractère ou 16 bits, peuvent être stockées dans n'importe quel type approprié.</span><span class="sxs-lookup"><span data-stu-id="d906d-128">Simple, small properties, such as single-character or 16-bit integer properties, can be stored in any appropriate type.</span></span> <span data-ttu-id="d906d-129">Par exemple, des nombres entiers peuvent être stockés sous la forme **ULong** et des chaînes peuvent être stockées en tant que **PT_STRING8**.</span><span class="sxs-lookup"><span data-stu-id="d906d-129">For example, integers can be stored as **ULONG** and strings can be stored as **PT_STRING8**.</span></span> 
  
<span data-ttu-id="d906d-130">Utilisez le type **PT_BINARY** pour indiquer un tableau d'octets compté.</span><span class="sxs-lookup"><span data-stu-id="d906d-130">Use the **PT_BINARY** type to indicate a counted byte array.</span></span> <span data-ttu-id="d906d-131">Ce type de propriété est utile pour étendre les types de données pouvant être stockées dans un objet.</span><span class="sxs-lookup"><span data-stu-id="d906d-131">This property type is useful for extending the types of data that can be stored in an object.</span></span> <span data-ttu-id="d906d-132">Les octets sont transmis dans l'ordre et aucune hypothèse n'est faite sur la signification des données.</span><span class="sxs-lookup"><span data-stu-id="d906d-132">Bytes are transmitted in sequence and no assumptions are made about the meaning of the data.</span></span> <span data-ttu-id="d906d-133">Lorsqu'une application cliente lit des données à partir d'une telle propriété, les données ne sont pas modifiées par rapport à la façon dont elles ont été stockées.</span><span class="sxs-lookup"><span data-stu-id="d906d-133">When a client application reads data out of such a property, the data is unchanged from how it was stored.</span></span> <span data-ttu-id="d906d-134">Le client doit effectuer les permutations d'octets nécessaires lors du transfert des données entre les UC.</span><span class="sxs-lookup"><span data-stu-id="d906d-134">The client must perform any necessary byte swapping when moving data across CPUs.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="d906d-135">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d906d-135">See also</span></span>



[<span data-ttu-id="d906d-136">Vue d’ensemble de la propriété MAPI</span><span class="sxs-lookup"><span data-stu-id="d906d-136">MAPI Property Overview</span></span>](mapi-property-overview.md)

