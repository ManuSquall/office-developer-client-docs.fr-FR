---
title: Prise en charge des responsabilités de la banque de messages texte mis en forme
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a97993c2-52e4-4b71-ac03-2c02d82447d8
description: 'Derni�re modification�: lundi 9 mars 2015'
ms.openlocfilehash: 301ebbf8e7a3e2a2deb303af5b198fd11511d495
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19787272"
---
# <a name="supporting-formatted-text-message-store-responsibilities"></a><span data-ttu-id="7a0c9-103">Prenant en charge le format texte : Responsabilités de banque de messages</span><span class="sxs-lookup"><span data-stu-id="7a0c9-103">Supporting Formatted Text: Message Store Responsibilities</span></span>

  
  
<span data-ttu-id="7a0c9-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="7a0c9-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="7a0c9-105">Fournisseurs de banque de messages **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) la propriété permet pour publier ou non ils peuvent gérer le texte enrichi (RTF), le texte HTML et, si elles sont au format RTF prenant en charge, si elles stockent le texte mis en forme dans un format compressé ou non compressé.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-105">Message store providers use the **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property to publish whether or not they can handle Rich Text Format (RTF), HTML text and, if they are RTF-aware, whether they store the formatted text in a compressed or uncompressed format.</span></span> <span data-ttu-id="7a0c9-106">Fournisseurs de magasins de message indiquent qu’ils sont compatibles RTF en définissant le bit STORE_RTF_OK et qu’elles contiennent le texte mis en forme dans un formulaire non compressé en définissant le bit STORE_UNCOMPRESSED_RTF.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-106">Message store providers indicate that they are RTF-aware by setting the STORE_RTF_OK bit and that they store the formatted text in an uncompressed form by setting the STORE_UNCOMPRESSED_RTF bit.</span></span> <span data-ttu-id="7a0c9-107">Fournisseurs de magasins de message indiquent qu’ils sont compatibles HTML en définissant le bit STORE_HTML_OK.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-107">Message store providers indicate they are HTML-aware by setting the STORE_HTML_OK bit.</span></span>
  
<span data-ttu-id="7a0c9-108">S’il est important pour un client prenant en charge au format RTF vérifier la STORE_RTF_OK bit pour déterminer si une banque de messages prend en charge le format RTF, il n’est pas nécessaire pour qu’un client concernés avec le format de texte mis en forme d’un magasin de RTF prenant en charge.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-108">While it is important for an RTF-aware client to check for the STORE_RTF_OK bit to determine whether or not a message store supports RTF, it is not necessary for a client to be concerned with the format of an RTF-aware store's formatted text.</span></span> 
  
<span data-ttu-id="7a0c9-109">Tous les magasins de message doivent prendre en charge les clients non compatibles RTF.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-109">All message stores must support non-RTF-aware clients.</span></span> <span data-ttu-id="7a0c9-110">Une banque de messages non compatible RICH doit supprimer la propriété **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) pendant un appel à la méthode de [IMAPIProp::SaveChanges](imapiprop-savechanges.md) du message, si un client a été modifiée **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) sans mise à jour de le **PR_RTF_IN_SYNC** ou **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="7a0c9-110">A non-RTF-aware message store must delete the **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) property during a call to the message's [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method if a client has changed **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) without updating either **PR_RTF_IN_SYNC** or **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)).</span></span> <span data-ttu-id="7a0c9-111">Suppression de **PR_RTF_IN_SYNC** , la propriété **PR_RTF_COMPRESSED** recalculé à partir de la propriété **PR_BODY** la prochaine fois qu’un client prenant en charge les RTF appelle [RTFSync](rtfsync.md).</span><span class="sxs-lookup"><span data-stu-id="7a0c9-111">Deleting **PR_RTF_IN_SYNC** causes the **PR_RTF_COMPRESSED** property to be recomputed from the **PR_BODY** property the next time an RTF-aware client calls [RTFSync](rtfsync.md).</span></span> 
  
<span data-ttu-id="7a0c9-112">La plupart des banques de messages RTF prenant en charge ne figurent pas le texte du message par les clients ; Il doit être calculée à la demande.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-112">Most RTF-aware message stores are not given the message text by clients; it must be computed on request.</span></span> <span data-ttu-id="7a0c9-113">Ce calcul étant fastidieuse et coûteuse, les clients doivent utiliser **PR_RTF_COMPRESSED** autant que possible.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-113">Because this computation is time consuming and expensive, clients should use **PR_RTF_COMPRESSED** whenever possible.</span></span> <span data-ttu-id="7a0c9-114">Pour calculer la propriété **PR_BODY** , le fournisseur de banque de message doit décompresser le contenu de la propriété **PR_RTF_COMPRESSED** et supprimer la mise en forme de texte enrichi.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-114">To compute the **PR_BODY** property, the message store provider must uncompress the contents of the **PR_RTF_COMPRESSED** property and remove the rich text formatting.</span></span> <span data-ttu-id="7a0c9-115">Les clients qui ne prennent pas en charge la propriété **PR_RTF_COMPRESSED** nécessitent ce calcul s’effectuent pour chaque message.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-115">Clients that do not support the **PR_RTF_COMPRESSED** property require this computation to take place for every message.</span></span> 
  
<span data-ttu-id="7a0c9-116">Lors de la copie des messages, les fournisseurs qui n’utilisent pas les méthodes **IMAPISupport::DoCopyProps** ou **IMAPISupport::DoCopyTo** courez le risque de création d’un message sans contenu si leur mise en œuvre exclut le **PR_BODY** banque de messages propriété et s’appuie sur **PR_RTF_COMPRESSED**.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-116">When copying messages, message store providers that do not use the **IMAPISupport::DoCopyProps** or **IMAPISupport::DoCopyTo** methods run the risk of creating a message with no content if their implementation excludes the **PR_BODY** property and relies on **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="7a0c9-117">Il est possible pour les données dans la propriété **PR_RTF_COMPRESSED** est endommagé.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-117">It is possible for the data in the **PR_RTF_COMPRESSED** property to be corrupt.</span></span> <span data-ttu-id="7a0c9-118">Avant d’une de ces propriétés de contenu de message dans l’opération de copie exclure, vérifiez le comme suit :</span><span class="sxs-lookup"><span data-stu-id="7a0c9-118">Before excluding either of these message content properties in the copy operation, check for corruption as follows:</span></span> 
  
1. <span data-ttu-id="7a0c9-119">Si la valeur de **PR_RTF_COMPRESSED** n’est pas supérieure à du texte RTF compressé, la propriété est endommagée.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-119">If the value of **PR_RTF_COMPRESSED** is not larger than the compressed RTF, the property is corrupt.</span></span> 
    
2. <span data-ttu-id="7a0c9-120">Si la valeur magique dans l’en-tête du format RTF n’est pas _dwMagicCompressedRTF_ ou _dwMagicUncompressedRTF_, la propriété est endommagé.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-120">If the magic value in the RTF header is not  _dwMagicCompressedRTF_ or  _dwMagicUncompressedRTF_, the property is corrupt.</span></span>
    
<span data-ttu-id="7a0c9-121">Banque de messages fournisseurs à l’aide de la prise en charge des méthodes ne doivent ne pas être concernées par la mise en œuvre d’une vérification est endommagé **PR_RTF_COMPRESSED** ; MAPI garantit que les propriétés appropriées existent et sont valides.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-121">Message store providers using the support methods need not be concerned with implementing a check for **PR_RTF_COMPRESSED** corruption; MAPI ensures that the appropriate properties exist and are valid.</span></span> 
  
<span data-ttu-id="7a0c9-122">Il existe trois différents niveaux de prise en charge au format RTF peuvent implémentés par les fournisseurs de banque de messages ; MAPI recommande que les fournisseurs de magasins message RTF prenant en charge implémentent leur prise en charge au niveau du milieu ou la plus élevé.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-122">There are three different levels of RTF support that message store providers can implement; MAPI recommends that RTF-aware message store providers implement their support at the middle or highest level.</span></span> <span data-ttu-id="7a0c9-123">Tous les prenant en charge les RTF banque de messages fournisseurs de prendre en charge de la génération de **PR_BODY** à partir de données incluses dans **PR_RTF_COMPRESSED** sur les messages sortants et émettre un appel à **RTFSync** pour synchroniser le texte et la mise en forme dans les messages entrants.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-123">All RTF-aware message store providers take care of generating **PR_BODY** from the data included in **PR_RTF_COMPRESSED** on outgoing messages and make a call to **RTFSync** to synchronize text and formatting on incoming messages.</span></span> 
  
<span data-ttu-id="7a0c9-124">Les différences entre ces trois niveaux sont décrits dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-124">The differences between these three levels are described in the following table.</span></span> 
  
|<span data-ttu-id="7a0c9-125">**Niveau de prise en charge**</span><span class="sxs-lookup"><span data-stu-id="7a0c9-125">**Level of support**</span></span>|<span data-ttu-id="7a0c9-126">**Description**</span><span class="sxs-lookup"><span data-stu-id="7a0c9-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="7a0c9-127">Low</span><span class="sxs-lookup"><span data-stu-id="7a0c9-127">Low</span></span>  <br/> |<span data-ttu-id="7a0c9-128">Message stocker fournisseur appelle **RTFSync** chaque fois que les modifications sont enregistrées dans un message et extrait les données de la propriété **PR_BODY** de **PR_RTF_COMPRESSED** plutôt que des clients nécessitant qu’elle.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-128">Message store provider calls **RTFSync** whenever changes are saved to a message and extracts the data for the **PR_BODY** property from **PR_RTF_COMPRESSED** rather than requiring clients to set it.</span></span> <span data-ttu-id="7a0c9-129">Les **PR_BODY** et **PR_RTF_COMPRESSED** sont stockées.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-129">Both **PR_BODY** and **PR_RTF_COMPRESSED** are stored.</span></span>  <br/> |
|<span data-ttu-id="7a0c9-130">Milieu</span><span class="sxs-lookup"><span data-stu-id="7a0c9-130">Middle</span></span>  <br/> |<span data-ttu-id="7a0c9-131">Message stocker les magasins de fournisseur que la propriété **PR_RTF_COMPRESSED** informatique **PR_BODY** lorsque cela est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-131">Message store provider stores only the **PR_RTF_COMPRESSED** property, computing **PR_BODY** when necessary.</span></span>  <br/> |
|<span data-ttu-id="7a0c9-132">High</span><span class="sxs-lookup"><span data-stu-id="7a0c9-132">High</span></span>  <br/> |<span data-ttu-id="7a0c9-133">Message stocker les magasins de fournisseur ni **PR_BODY** , ni les propriétés RTF auxiliaires.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-133">Message store provider stores neither **PR_BODY** or the auxiliary RTF properties.</span></span> <span data-ttu-id="7a0c9-134">**RTFSync** est appelé lorsque le texte du message a été modifié et la mise en forme reste inchangée ou lorsqu’un nouveau message est téléchargé par un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="7a0c9-134">**RTFSync** is called when the message text has changed and the formatting remains unchanged or when a new message is downloaded by a transport provider.</span></span>  <br/> |
   

