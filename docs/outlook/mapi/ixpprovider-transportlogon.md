---
title: IXPProviderTransportLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPProvider.TransportLogon
api_type:
- COM
ms.assetid: 534929f2-36a2-463d-8c4c-d86060cde127
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 96e81442125ae49e0c2856a1cf3a97a16d3453cf
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22583336"
---
# <a name="ixpprovidertransportlogon"></a><span data-ttu-id="2fcc8-103">IXPProvider::TransportLogon</span><span class="sxs-lookup"><span data-stu-id="2fcc8-103">IXPProvider::TransportLogon</span></span>

<span data-ttu-id="2fcc8-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2fcc8-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2fcc8-105">Établit une session dans lequel une application cliente se connecte à un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-105">Establishes a session in which a client application logs on to a transport provider.</span></span> 
  
```cpp
HRESULT TransportLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG FAR * lpulFlags,
  LPMAPIERROR FAR * lppMAPIError,
  LPXPLOGON FAR * lppXPLogon
);
```

## <a name="parameters"></a><span data-ttu-id="2fcc8-106">Paramètres</span><span class="sxs-lookup"><span data-stu-id="2fcc8-106">Parameters</span></span>

<span data-ttu-id="2fcc8-107">_lpMAPISup_: [in] pointeur vers l’objet de prise en charge du fournisseur de transport pour les fonctions de rappel dans MAPI pour cette session.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-107">_lpMAPISup_: [in] Pointer to the transport provider's support object for callback functions within MAPI for this session.</span></span> <span data-ttu-id="2fcc8-108">Cet objet reste valide jusqu'à ce que le fournisseur de transport le libère.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-108">This object remains valid until the transport provider releases it.</span></span>
    
<span data-ttu-id="2fcc8-109">_ulUIParam_: [Handle vers la fenêtre parente de toutes les boîtes de dialogue ou windows cette méthode affiche in].</span><span class="sxs-lookup"><span data-stu-id="2fcc8-109">_ulUIParam_: [in] Handle to the parent window of any dialog boxes or windows this method displays.</span></span> <span data-ttu-id="2fcc8-110">Le paramètre _ulUIParam_ peut être non null, par exemple, lorsque la LOGON_SETUP indicateur est définie dans le paramètre _lpulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="2fcc8-110">The  _ulUIParam_ parameter can be non-null, for example when the LOGON_SETUP flag is set in the  _lpulFlags_ parameter.</span></span> 
    
<span data-ttu-id="2fcc8-111">_lpszProfileName_: [in] pointeur vers le nom du profil de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-111">_lpszProfileName_: [in] Pointer to the profile name of the user.</span></span> <span data-ttu-id="2fcc8-112">Le paramètre _lpszProfileName_ est principalement utilisé lorsqu’une boîte de dialogue doit être présentée.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-112">The  _lpszProfileName_ parameter is primarily used when a dialog box must be presented.</span></span> 
    
<span data-ttu-id="2fcc8-113">_lpulFlags_: [dans, out] masque de bits d’indicateurs qui contrôle la façon dont l’ouverture de session est établie.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-113">_lpulFlags_: [in, out] Bitmask of flags that controls how the logon session is established.</span></span> <span data-ttu-id="2fcc8-114">Les indicateurs suivants peuvent être définis à l’entrée par le spouleur MAPI :</span><span class="sxs-lookup"><span data-stu-id="2fcc8-114">The following flags can be set on input by the MAPI spooler:</span></span>
    
  - <span data-ttu-id="2fcc8-115">LOGON_NO_CONNECT : Le compte d’utilisateur se connecte à ce fournisseur de transport à des fins autres que l’émission et la réception de messages.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-115">LOGON_NO_CONNECT: The user account is logging on to this transport provider for purposes other than transmission and reception of messages.</span></span> <span data-ttu-id="2fcc8-116">Le fournisseur de transport ne doit pas essayer établir des connexions à d’autres systèmes de messagerie.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-116">The transport provider should not attempt to make any connections to other messaging systems.</span></span>
        
  - <span data-ttu-id="2fcc8-117">LOGON_NO_DIALOG : Aucune boîte de dialogue ne doit être affiché même si les informations d’identification de l’utilisateur actuellement enregistrés sont non valides ou insuffisants pour l’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-117">LOGON_NO_DIALOG: No dialog box should be displayed even if the currently saved user credentials are invalid or insufficient for logon.</span></span>
        
  - <span data-ttu-id="2fcc8-118">LOGON_NO_INBOUND : Le fournisseur de transport n’a pas d’initialisation pour la réception de messages et ne doit pas accepter les messages entrants.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-118">LOGON_NO_INBOUND: The transport provider does not have to initialize for reception of messages and should not accept incoming messages.</span></span> <span data-ttu-id="2fcc8-119">Le spouleur MAPI peut utiliser la méthode [IXPLogon::TransportNotify](ixplogon-transportnotify.md) ultérieurement pour signaler le fournisseur de transport pour activer le traitement des messages entrants.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-119">The MAPI spooler can use the [IXPLogon::TransportNotify](ixplogon-transportnotify.md) method later to signal the transport provider to enable incoming message processing.</span></span> 
        
  - <span data-ttu-id="2fcc8-120">LOGON_NO_OUTBOUND : Le fournisseur de transport ne dispose pas d’initialiser l’envoi des messages, comme le spouleur MAPI ne fournit aucune.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-120">LOGON_NO_OUTBOUND: The transport provider does not have to initialize for sending messages, as the MAPI spooler does not provide any.</span></span> <span data-ttu-id="2fcc8-121">Si une application cliente requiert une connexion à un fournisseur distant pendant la composition d’un message afin qu’il puisse faire des appels de méthode [IXPLogon::AddressTypes](ixplogon-addresstypes.md) , le fournisseur de transport doit établir la connexion.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-121">If a client application requires a connection to a remote provider during the composition of a message so that it can make [IXPLogon::AddressTypes](ixplogon-addresstypes.md) method calls, the transport provider should make the connection.</span></span> <span data-ttu-id="2fcc8-122">Le spouleur MAPI permet de signaler le fournisseur de transport lors d’opérations sortantes peuvent commencer **TransportNotify** .</span><span class="sxs-lookup"><span data-stu-id="2fcc8-122">The MAPI spooler can use **TransportNotify** to signal the transport provider when outgoing operations can begin.</span></span> 
      
  - <span data-ttu-id="2fcc8-123">MAPI_UNICODE : La chaîne transmise pour le nom de profil est au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-123">MAPI_UNICODE: The passed-in string for the profile name is in Unicode format.</span></span> <span data-ttu-id="2fcc8-124">Si l’interface MAPI\_indicateur UNICODE n’est pas définie, la chaîne est au format ANSI.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-124">If the MAPI\_UNICODE flag is not set, the string is in ANSI format.</span></span>
      
    <span data-ttu-id="2fcc8-125">Indicateurs ci-dessous peuvent être définies sur sortie par le fournisseur de transport :</span><span class="sxs-lookup"><span data-stu-id="2fcc8-125">The following flags can be set on output by the transport provider:</span></span>
      
  - <span data-ttu-id="2fcc8-126">LOGON_SP_IDLE : Demandes que le spouleur MAPI appelle fréquemment méthode de [IXPLogon::Idle](ixplogon-idle.md) du fournisseur de transport pour le traitement des périodes d’inactivité.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-126">LOGON_SP_IDLE: Requests that the MAPI spooler frequently call the transport provider's [IXPLogon::Idle](ixplogon-idle.md) method for idle-time processing.</span></span> 
      
  - <span data-ttu-id="2fcc8-127">LOGON_SP_POLL : Demandes le spouleur MAPI fréquemment appeler la méthode [IXPLogon::Poll](ixplogon-poll.md) sur l’objet retourné d’ouverture de session pour vérifier les nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-127">LOGON_SP_POLL: Requests that the MAPI spooler frequently call the [IXPLogon::Poll](ixplogon-poll.md) method on the returned logon object to check for new messages.</span></span> <span data-ttu-id="2fcc8-128">Si cet indicateur n’est pas défini, le spouleur MAPI vérifie uniquement pour les nouveaux messages lorsque le fournisseur de transport utilise la méthode [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) pour notifier le spouleur qu’il existe des nouveaux messages à traiter.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-128">If this flag is not set, the MAPI spooler only checks for new messages when the transport provider uses the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method to notify the spooler that there are new messages to process.</span></span> <span data-ttu-id="2fcc8-129">Un fournisseur de transport devient envoyer uniquement en définissant ne pas cet indicateur et en avertir ne pas le spouleur MAPI de la réception du message.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-129">A transport provider effectively becomes send-only by not setting this flag and by not notifying the MAPI spooler of message receipt.</span></span> 
      
  - <span data-ttu-id="2fcc8-130">LOGON_SP_RESOLVE : Les demandes de résoudre le spouleur MAPI total des adresses de toutes les adresses de message pour des destinataires non pris en charge par ce fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-130">LOGON_SP_RESOLVE: Requests that the MAPI spooler resolve to full addresses all message addresses for recipients not supported by this transport provider.</span></span> <span data-ttu-id="2fcc8-131">Par conséquent, que le fournisseur de transport pouvez construire un chemin d’accès de réponse pour tous les destinataires.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-131">Therefore that the transport provider can construct a reply path for all recipients.</span></span>
      
  - <span data-ttu-id="2fcc8-132">MAPI_UNICODE : Les chaînes retournées dans la structure [MAPIERROR](mapierror.md) , le cas échéant, sont au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-132">MAPI_UNICODE: The returned strings in the [MAPIERROR](mapierror.md) structure, if any, are in Unicode format.</span></span> <span data-ttu-id="2fcc8-133">Si l’indicateur MAPI_UNICODE n’est pas définie, les chaînes sont au format ANSI.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-133">If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</span></span> 
    
<span data-ttu-id="2fcc8-134">_lppMAPIError_: [out] pointeur vers un pointeur vers la structure **MAPIERROR** retournée, le cas échéant, qui contient des informations de version, composant et le contexte de l’erreur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-134">_lppMAPIError_: [out] Pointer to a pointer to the returned **MAPIERROR** structure, if any, that contains version, component, and context information for the error.</span></span> <span data-ttu-id="2fcc8-135">Le paramètre _lppMAPIError_ peut être défini sur la valeur NULL s’il n’existe aucune structure **MAPIERROR** pour renvoyer.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-135">The  _lppMAPIError_ parameter can be set to NULL if there is no **MAPIERROR** structure to return.</span></span> 
    
<span data-ttu-id="2fcc8-136">_lppXPLogon_: [out] pointeur vers le pointeur vers l’objet d’ouverture de session du fournisseur de transport renvoyée.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-136">_lppXPLogon_: [out] Pointer to the pointer to the returned transport provider logon object.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="2fcc8-137">Valeur renvoyée</span><span class="sxs-lookup"><span data-stu-id="2fcc8-137">Return value</span></span>

<span data-ttu-id="2fcc8-138">S_OK : L’appel a réussi et a renvoyé la valeur attendue ou les valeurs.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-138">S_OK: The call succeeded and has returned the expected value or values.</span></span>
    
<span data-ttu-id="2fcc8-139">Référence à MAPI_E_FAILONEPROVIDER : Ce fournisseur ne peut pas se connecter, mais cette erreur ne doit pas désactiver le service.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-139">MAPI_E_FAILONEPROVIDER: This provider cannot log on, but this error should not disable the service.</span></span> 
    
<span data-ttu-id="2fcc8-140">MAPI_E_UNCONFIGURED : Le profil ne contient pas de suffisamment d’informations pour l’ouverture de session à effectuer.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-140">MAPI_E_UNCONFIGURED: The profile does not contain enough information for the logon to be completed.</span></span> <span data-ttu-id="2fcc8-141">MAPI appelle la fonction de point d’entrée du service de message du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-141">MAPI calls the provider's message service entry point function.</span></span>
    
<span data-ttu-id="2fcc8-142">MAPI_E_UNKNOWN_CPID : Le fournisseur ne peut pas en charge de page de codes du client.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-142">MAPI_E_UNKNOWN_CPID: The provider cannot support the client's code page.</span></span>
    
<span data-ttu-id="2fcc8-143">MAPI_E_UNKNOWN_LCID : Le fournisseur ne peut pas prendre en charge les informations de paramètres régionaux du client.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-143">MAPI_E_UNKNOWN_LCID: The provider cannot support the client's locale information.</span></span>
    
<span data-ttu-id="2fcc8-144">MAPI_E_USER_CANCEL : L’utilisateur a annulé l’opération, en général en cliquant sur le bouton **Annuler** dans une boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-144">MAPI_E_USER_CANCEL: The user canceled the operation, typically by clicking the **Cancel** button in a dialog box.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="2fcc8-145">Remarques</span><span class="sxs-lookup"><span data-stu-id="2fcc8-145">Remarks</span></span>

<span data-ttu-id="2fcc8-146">Le spouleur MAPI appelle la méthode **IXPProvider::TransportLogon** pour établir une ouverture de session pour un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-146">The MAPI spooler calls the **IXPProvider::TransportLogon** method to establish a logon session for a user.</span></span> 
  
<span data-ttu-id="2fcc8-147">La plupart des fournisseurs de transport utiliser la méthode [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) fournie avec l’objet de prise en charge désigné par le paramètre _lpMAPISup_ pour l’enregistrement et la récupération des informations d’identité utilisateur, les adresses de serveur et les informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-147">Most transport providers use the [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method provided with the support object pointed to by the  _lpMAPISup_ parameter for saving and retrieving user identity information, server addresses, and credentials.</span></span> <span data-ttu-id="2fcc8-148">À l’aide de **OpenProfileSection**, un fournisseur de transport peut enregistrer des informations arbitraires et l’associer à une connexion à une ressource particulière.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-148">By using **OpenProfileSection**, a transport provider can save arbitrary information and associate it with a logon to a particular resource.</span></span> <span data-ttu-id="2fcc8-149">Par exemple, un fournisseur peut utiliser **OpenProfileSection** pour enregistrer le nom de compte et mot de passe associé à une session particulière et les noms de serveur ou autres informations nécessaires sont nécessaires pour accéder aux ressources pour cette session.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-149">For example, a provider can use **OpenProfileSection** to save the account name and password associated with a particular session and any server names or other necessary information that are required to access resources for that session.</span></span> <span data-ttu-id="2fcc8-150">MAPI masque les informations associées à une ressource à partir de l’accès externe.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-150">MAPI hides information associated with a resource from outside access.</span></span> <span data-ttu-id="2fcc8-151">La section profil rendue disponible par le biais de _lpMAPISup_ est gérée par le spouleur MAPI afin que les données liées à ce contexte utilisateur sont séparées à partir des données d’autres contextes.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-151">The profile section made available through  _lpMAPISup_ is managed by the MAPI spooler so data related to this user context is separated from data for other contexts.</span></span> 
  
<span data-ttu-id="2fcc8-152">Le fournisseur de transport doit appeler la méthode **IUnknown::AddRef** sur l’objet de prise en charge et conserver une copie du pointeur à cet objet dans le cadre de l’objet de connexion du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-152">The transport provider must call the **IUnknown::AddRef** method on the support object and keep a copy of the pointer to this object as part of the provider logon object.</span></span> 
  
<span data-ttu-id="2fcc8-153">Le nom complet de profil dans _lpszProfileName_ est fourni pour que le fournisseur de transport puisse l’utiliser dans les boîtes de dialogue d’ouverture de session ou les messages d’erreur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-153">The profile display name in  _lpszProfileName_ is provided so the transport provider can use it in error messages or logon dialog boxes.</span></span> <span data-ttu-id="2fcc8-154">Si le fournisseur conserve ce nom, il doit être copié vers un stockage alloué par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-154">If the provider retains this name, it must be copied to storage allocated by the provider.</span></span> 
  
<span data-ttu-id="2fcc8-155">Fournisseurs de transport qui sont étroitement liés à d’autres fournisseurs de services peuvent être nécessaire de travail supplémentaire à l’ouverture de session pour établir les informations d’identification d’une bonne requises pour les opérations entre les fournisseurs de Compagnon.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-155">Transport providers that are tightly coupled with other service providers may have to do additional work at logon to establish the good credentials required for operations between companion providers.</span></span>
  
<span data-ttu-id="2fcc8-156">En règle générale, les fournisseurs de transport sont ouverts lorsque l’utilisateur tout d’abord se connecte à un profil.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-156">Usually, transport providers are opened when the user first logs on to a profile.</span></span> <span data-ttu-id="2fcc8-157">Étant donné que la première connexion à un profil donc généralement vient avant ouverture de session dans le magasin de message, le spouleur MAPI appelle généralement **TransportLogon** avec les indicateurs LOGON_NO_OUTBOUND et LOGON_NO_INBOUND définis dans _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-157">Because the first logon to a profile therefore generally comes before logon to any message store, the MAPI spooler usually calls **TransportLogon** with both the LOGON_NO_INBOUND and LOGON_NO_OUTBOUND flags set in  _lpulFlags_.</span></span> <span data-ttu-id="2fcc8-158">Plus tard, lorsque les banques de messages appropriés sont disponibles dans la session de profil, le spouleur MAPI appelle **TransportNotify** pour lancer des opérations pour le fournisseur de transport entrantes et sortantes.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-158">Later, when the appropriate message stores are available in the profile session, the MAPI spooler calls **TransportNotify** to initiate incoming and outgoing operations for the transport provider.</span></span> 
  
<span data-ttu-id="2fcc8-159">En transmettant l’indicateur LOGON_NO_CONNECT dans des signaux _lpulFlags_ opération en mode hors connexion du fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-159">Passing the LOGON_NO_CONNECT flag in  _lpulFlags_ signals offline operation of the transport provider.</span></span> <span data-ttu-id="2fcc8-160">Cet indicateur signale qu'aucuns les connexions externes ne doivent être faites ; Si le fournisseur de transport ne peuvent pas établir une session sans une connexion externe, il doit renvoyer une valeur d’erreur pour l’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-160">This flag indicates no external connections should be made; if the transport provider cannot establish a session without an external connection, it should return an error value for the logon.</span></span> 
  
<span data-ttu-id="2fcc8-161">Un fournisseur de transport doit définir l’indicateur LOGON_SP_IDLE de _lpulFlags_ lors de l’initialisation si elle est conçue pour utiliser le temps passé par le système dans le cas contraire inactif.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-161">A transport provider should set the LOGON_SP_IDLE flag in  _lpulFlags_ at initialization time if it is designed to use time that the system otherwise spends idle.</span></span> <span data-ttu-id="2fcc8-162">Ce temps est souvent utilisé pour gérer les opérations automatiques, telle qu’automatique des messages le téléchargement, délai de téléchargement du message ou le délai de dépôt des messages.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-162">Such time is often used to handle automatic operations, such as automatic message downloading, timed message downloading, or timed message submission.</span></span> <span data-ttu-id="2fcc8-163">Si cet indicateur est défini, le spouleur MAPI appelle **inactif** lors de la durée d’inactivité système d’initier des opérations.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-163">If this flag is set, the MAPI spooler calls **Idle** when system idle time occurs to initiate such operations.</span></span> <span data-ttu-id="2fcc8-164">Le spouleur MAPI n’appelle pas **inactif** à intervalles réguliers ; au lieu de cela, elle est appelée uniquement pendant la durée d’inactivité true.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-164">The MAPI spooler does not call **Idle** at set intervals; rather, it is called only during true idle time.</span></span> <span data-ttu-id="2fcc8-165">Par conséquent, les fournisseurs ne doivent pas fonctionner sur n’importe quel hypothèse sur la fréquence à laquelle seront appelées leurs méthodes **inactif** .</span><span class="sxs-lookup"><span data-stu-id="2fcc8-165">Therefore, providers should not work on any assumption about how frequently their **Idle** methods will be called.</span></span> <span data-ttu-id="2fcc8-166">Les fournisseurs qui prennent en charge les opérations de périodes d’inactivité doivent fournir une interface utilisateur de configuration pour qu’il dans leur feuille de propriétés du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-166">Providers that support idle-time operations should supply a configuration user interface for it in their provider property sheet.</span></span> 
  
<span data-ttu-id="2fcc8-167">Si la connexion au fournisseur du transport aboutit, le fournisseur doit retourner dans le paramètre _lppXPLogon_ un pointeur vers un objet d’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-167">If the transport provider logon succeeds, the provider should return in the  _lppXPLogon_ parameter a pointer to a logon object.</span></span> <span data-ttu-id="2fcc8-168">Le spouleur MAPI utilise cet objet pour l’accès fournisseur supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-168">The MAPI spooler will use this object for additional provider access.</span></span> <span data-ttu-id="2fcc8-169">Si **TransportLogon** affiche une boîte de dialogue d’ouverture de session et l’utilisateur annule généralement d’ouverture de session en cliquant sur le bouton **Annuler** dans la boîte de dialogue le fournisseur doit retourner MAPI_E_USER_CANCEL.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-169">If **TransportLogon** displays a logon dialog box and the user cancels logon typically by clicking the **Cancel** button in the dialog box the provider should return MAPI_E_USER_CANCEL.</span></span> 
  
<span data-ttu-id="2fcc8-170">La plupart des valeurs d’erreur renvoyé à partir de **TransportLogon**, MAPI désactive les services de messagerie à laquelle appartient le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-170">For most error values returned from **TransportLogon**, MAPI disables the message services to which the provider belongs.</span></span> <span data-ttu-id="2fcc8-171">MAPI ne sera pas appeler tous les fournisseurs qui appartiennent à ce service pour le reste de la session MAPI.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-171">MAPI will not call any providers that belong to that service for the rest of the MAPI session.</span></span> <span data-ttu-id="2fcc8-172">En revanche, **TransportLogon** retourne la valeur d’erreur de référence à MAPI_E_FAILONEPROVIDER à partir de son ouverture de session MAPI ne désactive pas le service de message à laquelle appartient le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-172">In contrast, when **TransportLogon** returns the MAPI_E_FAILONEPROVIDER error value from its logon, MAPI does not disable the message service to which the provider belongs.</span></span> <span data-ttu-id="2fcc8-173">**TransportLogon** doit renvoyer la référence à MAPI_E_FAILONEPROVIDER si elle rencontre une erreur qui ne garantit pas la désactivation du service pour le reste de la session.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-173">**TransportLogon** should return MAPI_E_FAILONEPROVIDER if it encounters an error that does not warrant disabling the service for the rest of the session.</span></span> 
  
<span data-ttu-id="2fcc8-174">Si un fournisseur renvoie MAPI_E_UNCONFIGURED à partir de son ouverture de session, MAPI sont alors appeler la fonction de l’entrée de service de message du fournisseur et recommencez l’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-174">If a provider returns MAPI_E_UNCONFIGURED from its logon, MAPI will call the provider's message service entry function and then retry the logon.</span></span> <span data-ttu-id="2fcc8-175">MAPI passe MSG_SERVICE_CONFIGURE comme le contexte, pour donner à un risque de se configurer le service.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-175">MAPI passes MSG_SERVICE_CONFIGURE as the context, to give the service a chance to configure itself.</span></span> <span data-ttu-id="2fcc8-176">Si le client a choisi d’autoriser une interface utilisateur à l’ouverture de session, le service peut représenter sa feuille de propriétés de configuration afin que l’utilisateur peut entrer des informations de configuration.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-176">If the client has chosen to allow a user interface on the logon, the service can present its configuration property sheet so that the user can enter configuration information.</span></span> 
  
<span data-ttu-id="2fcc8-177">Si le fournisseur qui recherche toutes les informations requises ne sont pas dans le profil, elle doit retourner MAPI_E_UNCONFIGURED afin que MAPI appelle la fonction de point d’entrée du service de message du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2fcc8-177">If the provider finds that all the required information is not in the profile, it should return MAPI_E_UNCONFIGURED so that MAPI calls the provider's message service entry point function.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2fcc8-178">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2fcc8-178">See also</span></span>

- [<span data-ttu-id="2fcc8-179">IXPProvider : IUnknown</span><span class="sxs-lookup"><span data-stu-id="2fcc8-179">IXPProvider : IUnknown</span></span>](ixpprovideriunknown.md)  
- [<span data-ttu-id="2fcc8-180">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="2fcc8-180">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md)  
- [<span data-ttu-id="2fcc8-181">IMAPISupport::SpoolerNotify</span><span class="sxs-lookup"><span data-stu-id="2fcc8-181">IMAPISupport::SpoolerNotify</span></span>](imapisupport-spoolernotify.md)  
- [<span data-ttu-id="2fcc8-182">IXPLogon::AddressTypes</span><span class="sxs-lookup"><span data-stu-id="2fcc8-182">IXPLogon::AddressTypes</span></span>](ixplogon-addresstypes.md)  
- [<span data-ttu-id="2fcc8-183">IXPLogon::Idle</span><span class="sxs-lookup"><span data-stu-id="2fcc8-183">IXPLogon::Idle</span></span>](ixplogon-idle.md)  
- [<span data-ttu-id="2fcc8-184">IXPLogon::Poll</span><span class="sxs-lookup"><span data-stu-id="2fcc8-184">IXPLogon::Poll</span></span>](ixplogon-poll.md)  
- [<span data-ttu-id="2fcc8-185">IXPLogon::TransportNotify</span><span class="sxs-lookup"><span data-stu-id="2fcc8-185">IXPLogon::TransportNotify</span></span>](ixplogon-transportnotify.md) 
- [<span data-ttu-id="2fcc8-186">MAPIERROR</span><span class="sxs-lookup"><span data-stu-id="2fcc8-186">MAPIERROR</span></span>](mapierror.md)

