---
title: Prise en charge des pièces jointes de message pour les fournisseurs de banques de messages
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: 'Dernière modification : 07 décembre 2015'
ms.openlocfilehash: a94d1230f4f26d080976fd15768bdfeb6ea04748
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22576098"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="a13cb-103">Prise en charge des pièces jointes de message pour les fournisseurs de banques de messages</span><span class="sxs-lookup"><span data-stu-id="a13cb-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="a13cb-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a13cb-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a13cb-105">Votre fournisseur de magasin de message n’a pas besoin prendre en charge les pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="a13cb-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="a13cb-106">Toutefois, de nombreuses applications clientes prévoient être en mesure d’ajouter des pièces jointes aux messages.</span><span class="sxs-lookup"><span data-stu-id="a13cb-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="a13cb-107">Si votre banque de messages doit être utilisée pour créer ou stocker IPM. Remarque Les messages, puis vous devez prendre en charge des pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="a13cb-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="a13cb-108">Fournisseurs de banque de message par défaut doivent prennent également en charge les pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="a13cb-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="a13cb-109">Pour plus d’informations, consultez [Classes de Message MAPI](mapi-message-classes.md)et [Banques de Message par défaut](default-message-stores.md).</span><span class="sxs-lookup"><span data-stu-id="a13cb-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="a13cb-110">Il existe cinq types de pièces jointes qui prend en charge de MAPI : fichiers de pièces jointes, les pièces jointes de données, pièces jointes des messages, les pièces jointes objet OLE et des liens.</span><span class="sxs-lookup"><span data-stu-id="a13cb-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="a13cb-111">La configuration requise pour chaque type de prise en charge est différente.</span><span class="sxs-lookup"><span data-stu-id="a13cb-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="a13cb-112">Clients fait aucune différence entre les deux types de pièces jointes au moyen de la propriété **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) sur les objets de la pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="a13cb-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="a13cb-113">Prise en charge des pièces jointes signifie mettre en œuvre la [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span><span class="sxs-lookup"><span data-stu-id="a13cb-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="a13cb-114">L’interface **IAttach** possède pas de méthodes qui lui est propre ; il dispose uniquement de méthodes héritées de l’interface [IMAPIProp](imapipropiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="a13cb-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="a13cb-115">Parce que votre fournisseur de magasin de message doit implémenter déjà les propriétés d’objets de message, cela simplifie grandement la tâche de prise en charge des pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="a13cb-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="a13cb-116">Implémentation **IAttach** fondamentalement revient à fournir un moyen pour les clients pour accéder à une table de propriétés pour les pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="a13cb-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="a13cb-117">Pièces jointes sont simplement les pièces jointes dont le contenu de la pièce jointe est stocké directement dans la propriété **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) de la pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="a13cb-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="a13cb-118">Pièces jointes de données existent principalement pour permettre aux clients de joindre des fichiers à un message lors de l’expéditeur et le destinataire du message n’ont pas accès à un serveur de fichiers communs.</span><span class="sxs-lookup"><span data-stu-id="a13cb-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="a13cb-119">Pour plus d’informations, voir la propriété **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="a13cb-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="a13cb-120">Pièces jointes des messages sont des pièces jointes pour laquelle le sous-objet de pièce jointe est un autre [IMessage : MAPIProp](imessageimapiprop.md) objet.</span><span class="sxs-lookup"><span data-stu-id="a13cb-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="a13cb-121">Étant donné que les fournisseurs de banque de messages prennent déjà en charge l’interface **IMessage** , la prise en charge des pièces jointes des messages n’est pas difficile.</span><span class="sxs-lookup"><span data-stu-id="a13cb-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="a13cb-122">Prise en charge les pièces jointes OLE object signifie implémenter les interfaces OLE **IStorage** **IStream**et **IStreamDocfile** .</span><span class="sxs-lookup"><span data-stu-id="a13cb-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="a13cb-123">Votre fournisseur de magasin de message doit être en mesure de convertir les données stockées dans le message dans un objet OLE actif lorsqu’un client ouvre l’objet de l’objet OLE.</span><span class="sxs-lookup"><span data-stu-id="a13cb-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="a13cb-124">Liens sont de deux types : liens vers des fichiers et des liens vers d’autres messages.</span><span class="sxs-lookup"><span data-stu-id="a13cb-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="a13cb-125">Liens vers des fichiers utilisent la valeur ATTACH_BY_REF_ONLY pour la propriété **PR_ATTACH_METHOD** ainsi que **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) ou **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) pour spécifier l’emplacement d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="a13cb-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="a13cb-126">Comment un implémente des liens vers les messages peut-être dépendre des aspects du système de messagerie local et, par conséquent, ne peut pas être entièrement documenté ici.</span><span class="sxs-lookup"><span data-stu-id="a13cb-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="a13cb-127">Par exemple, l’envoi d’un lien à un message qui est stocké dans une banque de messages sur le serveur est généralement qu’une question de l’envoi de l’identificateur d’entrée du message lié, fournissant que l’expéditeur et le destinataire ont accès à ce serveur.</span><span class="sxs-lookup"><span data-stu-id="a13cb-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="a13cb-128">Autres configurations de système de messagerie présentent les autres exigences et les défis pour l’implémentation des liens vers des messages.</span><span class="sxs-lookup"><span data-stu-id="a13cb-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="a13cb-129">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a13cb-129">See also</span></span>



[<span data-ttu-id="a13cb-130">Fonctionnalit�s de la banque de messages</span><span class="sxs-lookup"><span data-stu-id="a13cb-130">Message Store Features</span></span>](message-store-features.md)

