---
title: Prise en charge des pièces jointes pour les fournisseurs de banques de messages
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: 'Derni�re modification�: lundi 7 d�cembre 2015'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412134"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="6011e-103">Prise en charge des pièces jointes pour les fournisseurs de banques de messages</span><span class="sxs-lookup"><span data-stu-id="6011e-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="6011e-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="6011e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="6011e-105">Votre fournisseur de banque de messages n'a pas besoin de prendre en charge les pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="6011e-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="6011e-106">Toutefois, de nombreuses applications clientes s'attendent à pouvoir ajouter des pièces jointes aux messages.</span><span class="sxs-lookup"><span data-stu-id="6011e-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="6011e-107">Si votre magasin de messages doit être utilisé pour créer ou stocker IPM. Notez les messages, puis prenez en charge les pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="6011e-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="6011e-108">Les fournisseurs de banques de messages par défaut doivent également prendre en charge les pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="6011e-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="6011e-109">Pour plus d'informations, consultez la rubrique [classes de messages MAPI](mapi-message-classes.md)et [banques de messages par défaut](default-message-stores.md).</span><span class="sxs-lookup"><span data-stu-id="6011e-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="6011e-110">MAPI prend en charge cinq types de pièces jointes: les pièces jointes, les pièces jointes, les pièces jointes, les pièces jointes et les liens.</span><span class="sxs-lookup"><span data-stu-id="6011e-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="6011e-111">Les conditions requises pour la prise en charge de chaque type sont différentes.</span><span class="sxs-lookup"><span data-stu-id="6011e-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="6011e-112">Les clients différencient les deux types de pièces jointes par le biais de la propriété **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) sur les objets Attachment.</span><span class="sxs-lookup"><span data-stu-id="6011e-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="6011e-113">La prise en charge des pièces jointes implique l'implémentation de l'interface [IAttach: IMAPIProp](iattachimapiprop.md) .</span><span class="sxs-lookup"><span data-stu-id="6011e-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="6011e-114">L'interface **IAttach** ne possède pas de méthode propre; elle possède uniquement des méthodes qui sont héritées de l'interface [IMAPIProp](imapipropiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="6011e-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="6011e-115">Étant donné que votre fournisseur de banque de messages doit déjà implémenter les propriétés pour les objets message, cela simplifie considérablement la tâche de prise en charge des pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="6011e-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="6011e-116">L'implémentation de **IAttach** signifie que les clients peuvent accéder à une table de propriétés pour des pièces jointes spécifiques sur les messages.</span><span class="sxs-lookup"><span data-stu-id="6011e-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="6011e-117">Les pièces jointes de données sont simplement des pièces jointes pour lesquelles le contenu de la pièce jointe est stocké directement dans la propriété **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) d'une pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="6011e-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="6011e-118">Les pièces jointes de données existent principalement pour permettre aux clients de joindre des fichiers à un message lorsque l'expéditeur et le destinataire du message n'ont pas accès à un serveur de fichiers commun.</span><span class="sxs-lookup"><span data-stu-id="6011e-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="6011e-119">Pour plus d'informations, reportez-vous à la propriété **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="6011e-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="6011e-120">Les pièces jointes des messages sont des pièces jointes pour lesquelles le sous-objet de pièce jointe est un autre objet [IMessage: MAPIProp](imessageimapiprop.md) .</span><span class="sxs-lookup"><span data-stu-id="6011e-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="6011e-121">Comme les fournisseurs de banque de messages prennent déjà en charge l'interface **IMessage** , la prise en charge des pièces jointes des messages n'est pas difficile.</span><span class="sxs-lookup"><span data-stu-id="6011e-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="6011e-122">La prise en charge des pièces jointes des objets OLE implique l'implémentation des interfaces OLE **IStorage**, **IStream**et **IStreamDocfile** .</span><span class="sxs-lookup"><span data-stu-id="6011e-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="6011e-123">Votre fournisseur de banque de messages doit pouvoir convertir les données d'objets OLE stockées dans le message en un objet OLE actif lorsqu'un client ouvre l'objet.</span><span class="sxs-lookup"><span data-stu-id="6011e-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="6011e-124">Il existe deux types de liens: des liens vers des fichiers et des liens vers d'autres messages.</span><span class="sxs-lookup"><span data-stu-id="6011e-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="6011e-125">Liens vers des fichiers utilisez la valeur ATTACH_BY_REF_ONLY pour la propriété **PR_ATTACH_METHOD** avec **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) ou **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) pour spécifier emplacement d'un fichier.</span><span class="sxs-lookup"><span data-stu-id="6011e-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="6011e-126">Le mode d'implémentation des liens vers les messages peut dépendre des aspects du système de messagerie local et, en tant que tel, ne peut pas être entièrement documenté ici.</span><span class="sxs-lookup"><span data-stu-id="6011e-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="6011e-127">Par exemple, l'envoi d'un lien vers un message qui est stocké dans une banque de messages basée sur le serveur est généralement une question d'envoi de l'identificateur d'entrée du message lié, à condition que l'expéditeur et le destinataire aient accès à ce serveur.</span><span class="sxs-lookup"><span data-stu-id="6011e-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="6011e-128">Les autres configurations de système de messagerie présentent d'autres exigences et défis en matière d'implémentation de liens vers des messages.</span><span class="sxs-lookup"><span data-stu-id="6011e-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="6011e-129">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6011e-129">See also</span></span>



[<span data-ttu-id="6011e-130">Fonctionnalit�s de la banque de messages</span><span class="sxs-lookup"><span data-stu-id="6011e-130">Message Store Features</span></span>](message-store-features.md)

