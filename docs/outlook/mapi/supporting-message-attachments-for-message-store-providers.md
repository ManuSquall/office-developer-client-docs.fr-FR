---
title: Prise en charge des pièces jointes de messages pour les fournisseurs de magasins de messages
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: 'Derni�re modification�: lundi 7 d�cembre 2015'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412134"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="0410c-103">Prise en charge des pièces jointes de messages pour les fournisseurs de magasins de messages</span><span class="sxs-lookup"><span data-stu-id="0410c-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="0410c-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="0410c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="0410c-105">Votre fournisseur de magasins de messages n’a pas besoin de prendre en charge les pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="0410c-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="0410c-106">Toutefois, de nombreuses applications clientes s’attendent à pouvoir ajouter des pièces jointes à des messages.</span><span class="sxs-lookup"><span data-stu-id="0410c-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="0410c-107">Si votre magasin de messages est utilisé pour créer ou stocker un IPM. Notez les messages, puis vous devez prendre en charge les pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="0410c-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="0410c-108">Les fournisseurs de magasins de messages par défaut doivent également prendre en charge les pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="0410c-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="0410c-109">Pour plus d’informations, voir Classes de [messages MAPI](mapi-message-classes.md)et [Magasins de messages par défaut.](default-message-stores.md)</span><span class="sxs-lookup"><span data-stu-id="0410c-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="0410c-110">MAPI prend en charge cinq types de pièces jointes : pièces jointes, pièces jointes de données, pièces jointes de message, pièces jointes d’objets OLE et liens.</span><span class="sxs-lookup"><span data-stu-id="0410c-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="0410c-111">Les conditions requises pour la prise en charge de chaque type sont différentes.</span><span class="sxs-lookup"><span data-stu-id="0410c-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="0410c-112">Les clients différencient les deux types de pièces jointes au moyen de la propriété **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) sur les objets de pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="0410c-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="0410c-113">La prise en charge des pièces jointes implique l’implémentation de l’interface [IAttach : IMAPIProp.](iattachimapiprop.md)</span><span class="sxs-lookup"><span data-stu-id="0410c-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="0410c-114">**L’interface IAttach** n’a aucune méthode propre ; Il possède uniquement des méthodes qui sont héritées de l’interface [IMAPIProp.](imapipropiunknown.md)</span><span class="sxs-lookup"><span data-stu-id="0410c-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="0410c-115">Étant donné que votre fournisseur de magasin de messages doit déjà implémenter des propriétés pour les objets de message, cela simplifie considérablement la tâche de prise en charge des pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="0410c-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="0410c-116">**L’implémentation d’IAttach** signifie essentiellement fournir aux clients un moyen d’accéder à une table de propriétés pour des pièces jointes particulières sur des messages.</span><span class="sxs-lookup"><span data-stu-id="0410c-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="0410c-117">Les pièces jointes de données sont simplement des pièces jointes pour lesquelles le contenu de la pièce jointe est stocké directement dans la propriété **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) d’une pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="0410c-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="0410c-118">Les pièces jointes de données permettent principalement aux clients de joindre des fichiers à un message lorsque l’expéditeur et le destinataire du message n’ont pas accès à un serveur de fichiers commun.</span><span class="sxs-lookup"><span data-stu-id="0410c-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="0410c-119">Pour plus d’informations, **voir la PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="0410c-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="0410c-120">Les pièces jointes de message sont des pièces jointes pour lesquelles le sous-objet de pièce jointe est un autre [objet IMessage : MAPIProp.](imessageimapiprop.md)</span><span class="sxs-lookup"><span data-stu-id="0410c-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="0410c-121">Étant donné que les fournisseurs de magasins de messages sont déjà en charge de l’interface **IMessage,** la prise en charge des pièces jointes de message n’est pas difficile.</span><span class="sxs-lookup"><span data-stu-id="0410c-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="0410c-122">La prise en charge des pièces jointes d’objet OLE implique l’implémentation des interfaces OLE **IStorage,** **IStream** et **IStreamDocfile.**</span><span class="sxs-lookup"><span data-stu-id="0410c-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="0410c-123">Votre fournisseur de magasins de messages doit être en mesure de convertir les données d’objet OLE stockées dans le message en un objet OLE actif lorsqu’un client ouvre l’objet.</span><span class="sxs-lookup"><span data-stu-id="0410c-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="0410c-124">Les liens sont de deux types : liens vers des fichiers et liens vers d’autres messages.</span><span class="sxs-lookup"><span data-stu-id="0410c-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="0410c-125">Les liens vers des fichiers utilisent la valeur ATTACH_BY_REF_ONLY pour la propriété **PR_ATTACH_METHOD** avec **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) ou **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) pour spécifier l’emplacement d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="0410c-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="0410c-126">La façon dont une personne implémente des liens vers des messages peut dépendre d’aspects du système de messagerie local et, en tant que telle, ne peut pas être entièrement documentée ici.</span><span class="sxs-lookup"><span data-stu-id="0410c-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="0410c-127">Par exemple, l’envoi d’un lien vers un message stocké sur un magasin de messages basé sur un serveur n’est généralement qu’une question d’envoi de l’identificateur d’entrée du message lié, à condition que l’expéditeur et le destinataire ont accès à ce serveur.</span><span class="sxs-lookup"><span data-stu-id="0410c-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="0410c-128">D’autres configurations de système de messagerie présentent d’autres exigences et défis pour l’implémentation de liens vers des messages.</span><span class="sxs-lookup"><span data-stu-id="0410c-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="0410c-129">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="0410c-129">See also</span></span>



[<span data-ttu-id="0410c-130">Fonctionnalit�s de la banque de messages</span><span class="sxs-lookup"><span data-stu-id="0410c-130">Message Store Features</span></span>](message-store-features.md)

