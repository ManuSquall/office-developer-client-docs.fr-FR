---
title: Meilleures pratiques pour l’arrêt rapide
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ae8a9214-e53f-4c57-8dbe-aa7cc6903aa8
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: c92347ab1a786196e7f0d99b286e8f4134ce7c24
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22590700"
---
# <a name="best-practices-for-fast-shutdown"></a><span data-ttu-id="1aed1-103">Meilleures pratiques pour l’arrêt rapide</span><span class="sxs-lookup"><span data-stu-id="1aed1-103">Best Practices for Fast Shutdown</span></span>

  
  
<span data-ttu-id="1aed1-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="1aed1-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="1aed1-105">Cette rubrique recommande les meilleures pratiques pour les administrateurs, les clients MAPI et fournisseurs MAPI à utiliser les paramètres du Registre Windows et les interfaces d’arrêt rapide afin de réduire la perte de données lors de l’arrêt du client.</span><span class="sxs-lookup"><span data-stu-id="1aed1-105">This topic recommends best practices for administrators, MAPI clients, and MAPI providers to use Windows registry settings and the fast shutdown interfaces to minimize data loss during client shutdown.</span></span>
  
- <span data-ttu-id="1aed1-106">Pour qu’un client MAPI effectuer correctement arrêt rapide afin que le processus de fournisseur n’entraînent pas la perte de données, le client MAPI devez d’abord appeler la méthode [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) .</span><span class="sxs-lookup"><span data-stu-id="1aed1-106">For a MAPI client to carry out fast shutdown successfully so that provider processes do not incur data loss, the MAPI client should first call the [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) method.</span></span> <span data-ttu-id="1aed1-107">Le client doit alors avec les méthodes [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) et [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) en fonction de la prise en charge du sous-système MAPI pour l’arrêt rapide, comme indiqué par la valeur de retour de ** IMAPIClientShutdown::QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="1aed1-107">The client should then proceed with the [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) and [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) methods based on the MAPI subsystem's support for fast shutdown, as indicated by the return value of **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="1aed1-108">Comme un client MAPI, Microsoft Outlook n’appelle pas **IMAPIClientShutdown::NotifyProcessShutdown** ou **IMAPIClientShutdown::DoFastShutdown** si **IMAPIClientShutdown::QueryFastShutdown** renvoie une erreur.</span><span class="sxs-lookup"><span data-stu-id="1aed1-108">As a MAPI client, Microsoft Outlook does not call **IMAPIClientShutdown::NotifyProcessShutdown** or **IMAPIClientShutdown::DoFastShutdown** if **IMAPIClientShutdown::QueryFastShutdown** returns an error.</span></span> <span data-ttu-id="1aed1-109">Si l’administrateur a désactivé arrêt rapide dans le Registre Windows, le sous-système MAPI renvoie MAPI_E_NO_SUPPORT à **IMAPIClientShutdown::QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="1aed1-109">If the administrator has disabled fast shutdown in the Windows registry, the MAPI subsystem would return MAPI_E_NO_SUPPORT to **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="1aed1-110">Dans ce cas, le sous-système MAPI informera pas quitter fournisseurs MAPI d’un processus d’exécution client.</span><span class="sxs-lookup"><span data-stu-id="1aed1-110">In this case, the MAPI subsystem would not inform MAPI providers of an immediate client process exit.</span></span> <span data-ttu-id="1aed1-111">Par conséquent, si un client MAPI ne tient pas compte de ce code d’erreur, procède à l’arrêt rapide d’et déconnecte tous les références externes, tous les fournisseurs MAPI chargés aura une perte de données.</span><span class="sxs-lookup"><span data-stu-id="1aed1-111">Therefore, if a MAPI client disregards this error return code, proceeds to do fast shutdown, and disconnects all external references, all loaded MAPI providers will have data loss.</span></span> 
    
- <span data-ttu-id="1aed1-112">Fournisseurs MAPI doivent implémenter la [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface d’effectuer en temps voulu et les mesures nécessaires pour éviter toute perte de données en raison de la déconnexion des références externes avant de quitte le client du client.</span><span class="sxs-lookup"><span data-stu-id="1aed1-112">MAPI providers should implement the [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface to carry out timely and necessary steps to avoid data loss due to the client disconnecting external references before the client exits.</span></span> <span data-ttu-id="1aed1-113">Un fournisseur doit différer tout est non essentiels pour l’enregistrement de données à la base de données principale.</span><span class="sxs-lookup"><span data-stu-id="1aed1-113">A provider should postpone everything else that is nonessential to saving data to its primary data store.</span></span> <span data-ttu-id="1aed1-114">Par exemple, un fournisseur de transport doit différer des opérations en arrière-plan inutiles vérifier de nouveau courrier, qu'un fournisseur de carnet d’adresses doit reporter le téléchargement des modifications récentes apportées à partir de son serveur et un fournisseur de magasins doit différer tels que des tâches de maintenance le compactage ou l’indexation.</span><span class="sxs-lookup"><span data-stu-id="1aed1-114">For example, a transport provider should postpone unnecessary background operations that check for new mail, an address book provider should postpone downloading recent changes from its server, and a store provider should postpone maintenance tasks such as compacting or indexing.</span></span> 
    
- <span data-ttu-id="1aed1-115">Les utilisateurs qui souhaitent des clients MAPI pour quitter dès qu’ils ferment doivent utiliser le paramètre de Registre par défaut qui permet à l’arrêt rapide, sauf si un fournisseur exclut.</span><span class="sxs-lookup"><span data-stu-id="1aed1-115">Users who want MAPI clients to exit as soon as they close them should use the default registry setting that enables fast shutdown unless a provider opts out.</span></span>
    
- <span data-ttu-id="1aed1-116">Une fois qu’un client MAPI appelle **IMAPIClientShutdown::DoFastShutdown**, il ne doit pas faire des appels MAPI, y compris la fonction [MAPIUninitialize](mapiuninitialize.md) supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="1aed1-116">Once a MAPI client calls **IMAPIClientShutdown::DoFastShutdown**, it should not make any additional calls to MAPI, including the [MAPIUninitialize](mapiuninitialize.md) function.</span></span> <span data-ttu-id="1aed1-117">Le client ne doit pas utiliser MAPI pour le reste de la durée de vie du processus client.</span><span class="sxs-lookup"><span data-stu-id="1aed1-117">The client should not use MAPI for the rest of the client process's lifetime.</span></span> 
    
- <span data-ttu-id="1aed1-118">Un client MAPI doit appeler jamais directement l’interface de **IMAPIProviderShutdown** d’un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1aed1-118">A MAPI client should never directly call a provider's **IMAPIProviderShutdown** interface.</span></span> <span data-ttu-id="1aed1-119">Clients MAPI doivent toujours utiliser le [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span><span class="sxs-lookup"><span data-stu-id="1aed1-119">MAPI clients should always use the [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span></span> 
    
- <span data-ttu-id="1aed1-120">Si un fournisseur MAPI doit s’assurer qu’un arrêt rapide n’est pas utilisé pendant son chargement, il doit implémenter l’interface **IMAPIProviderShutdown** et MAPI_E_NO_SUPPORT de la méthode **IMAPIProviderShutdown::QueryFastShutdown** .</span><span class="sxs-lookup"><span data-stu-id="1aed1-120">If a MAPI provider needs to ensure that fast shutdown is not used while it is loaded, it should implement the **IMAPIProviderShutdown** interface and return MAPI_E_NO_SUPPORT for the **IMAPIProviderShutdown::QueryFastShutdown** method.</span></span> <span data-ttu-id="1aed1-121">Toutefois, pour les clients MAPI comme Outlook, cela entraînera le client à abandonner arrêt rapide et prendre plus de temps à arrêter.</span><span class="sxs-lookup"><span data-stu-id="1aed1-121">However, for MAPI clients such as Outlook, this will cause the client to abandon fast shutdown and take a longer time to shut down.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="1aed1-122">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1aed1-122">See also</span></span>



[<span data-ttu-id="1aed1-123">Arrêt du client dans MAPI</span><span class="sxs-lookup"><span data-stu-id="1aed1-123">Client Shutdown in MAPI</span></span>](client-shutdown-in-mapi.md)
  
[<span data-ttu-id="1aed1-124">Vue d’ensemble de l’arrêt rapide</span><span class="sxs-lookup"><span data-stu-id="1aed1-124">Fast Shutdown Overview</span></span>](fast-shutdown-overview.md)
  
[<span data-ttu-id="1aed1-125">Options utilisateur d’arrêt rapide</span><span class="sxs-lookup"><span data-stu-id="1aed1-125">Fast Shutdown User Options</span></span>](fast-shutdown-user-options.md)

