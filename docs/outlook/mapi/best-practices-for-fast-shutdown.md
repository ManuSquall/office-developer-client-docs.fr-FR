---
title: Meilleures pratiques en matière d’arrêt rapide
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ae8a9214-e53f-4c57-8dbe-aa7cc6903aa8
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 8c7225427b80d89c6dd8adfa85f7d91885850365
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33426967"
---
# <a name="best-practices-for-fast-shutdown"></a><span data-ttu-id="a0605-103">Meilleures pratiques en matière d’arrêt rapide</span><span class="sxs-lookup"><span data-stu-id="a0605-103">Best Practices for Fast Shutdown</span></span>

  
  
<span data-ttu-id="a0605-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a0605-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a0605-105">Cette rubrique recommande aux administrateurs, clients MAPI et fournisseurs MAPI d’utiliser les paramètres de Registre Windows et les interfaces d’arrêt rapide pour minimiser la perte de données pendant l’arrêt du client.</span><span class="sxs-lookup"><span data-stu-id="a0605-105">This topic recommends best practices for administrators, MAPI clients, and MAPI providers to use Windows registry settings and the fast shutdown interfaces to minimize data loss during client shutdown.</span></span>
  
- <span data-ttu-id="a0605-106">Pour qu’un client MAPI effectue un arrêt rapide afin que les processus fournisseurs n’encourent pas de perte de données, le client MAPI doit d’abord appeler la méthode [IMAPIClientShutdown::QueryFastShutdown.](imapiclientshutdown-queryfastshutdown.md)</span><span class="sxs-lookup"><span data-stu-id="a0605-106">For a MAPI client to carry out fast shutdown successfully so that provider processes do not incur data loss, the MAPI client should first call the [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) method.</span></span> <span data-ttu-id="a0605-107">Le client doit ensuite poursuivre avec les méthodes [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) et [IMAPIClientShutdown::D oFastShutdown](imapiclientshutdown-dofastshutdown.md) en fonction de la prise en charge de l’arrêt rapide du sous-système MAPI, comme indiqué par la valeur de retour de **IMAPIClientShutdown::QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="a0605-107">The client should then proceed with the [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) and [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) methods based on the MAPI subsystem's support for fast shutdown, as indicated by the return value of **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="a0605-108">En tant que client MAPI, Microsoft Outlook n’appelle pas **IMAPIClientShutdown::NotifyProcessShutdown** ou **IMAPIClientShutdown::D oFastShutdown** si **IMAPIClientShutdown::QueryFastShutdown** renvoie une erreur.</span><span class="sxs-lookup"><span data-stu-id="a0605-108">As a MAPI client, Microsoft Outlook does not call **IMAPIClientShutdown::NotifyProcessShutdown** or **IMAPIClientShutdown::DoFastShutdown** if **IMAPIClientShutdown::QueryFastShutdown** returns an error.</span></span> <span data-ttu-id="a0605-109">Si l’administrateur a désactivé l’arrêt rapide dans le Registre Windows, le sous-système MAPI retourne MAPI_E_NO_SUPPORT à **IMAPIClientShutdown::QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="a0605-109">If the administrator has disabled fast shutdown in the Windows registry, the MAPI subsystem would return MAPI_E_NO_SUPPORT to **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="a0605-110">Dans ce cas, le sous-système MAPI n’informe pas les fournisseurs MAPI d’une sortie immédiate du processus client.</span><span class="sxs-lookup"><span data-stu-id="a0605-110">In this case, the MAPI subsystem would not inform MAPI providers of an immediate client process exit.</span></span> <span data-ttu-id="a0605-111">Par conséquent, si un client MAPI ignore ce code de retour d’erreur, procède à un arrêt rapide et déconnecte toutes les références externes, tous les fournisseurs MAPI chargés auront une perte de données.</span><span class="sxs-lookup"><span data-stu-id="a0605-111">Therefore, if a MAPI client disregards this error return code, proceeds to do fast shutdown, and disconnects all external references, all loaded MAPI providers will have data loss.</span></span> 
    
- <span data-ttu-id="a0605-112">Les fournisseurs MAPI doivent implémenter l’interface [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) pour effectuer les étapes nécessaires et en temps voulu afin d’éviter la perte de données en raison de la déconnexion des références externes par le client avant la sortie du client.</span><span class="sxs-lookup"><span data-stu-id="a0605-112">MAPI providers should implement the [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface to carry out timely and necessary steps to avoid data loss due to the client disconnecting external references before the client exits.</span></span> <span data-ttu-id="a0605-113">Un fournisseur doit différer tout autre chose qui n’est pas essentiel à l’enregistrement des données dans son magasin de données principal.</span><span class="sxs-lookup"><span data-stu-id="a0605-113">A provider should postpone everything else that is nonessential to saving data to its primary data store.</span></span> <span data-ttu-id="a0605-114">Par exemple, un fournisseur de transport doit reporter les opérations en arrière-plan inutiles qui recherchent de nouveaux messages, un fournisseur de carnet d’adresses doit différer le téléchargement des modifications récentes à partir de son serveur et un fournisseur de magasin doit reporter les tâches de maintenance telles que le compactage ou l’indexation.</span><span class="sxs-lookup"><span data-stu-id="a0605-114">For example, a transport provider should postpone unnecessary background operations that check for new mail, an address book provider should postpone downloading recent changes from its server, and a store provider should postpone maintenance tasks such as compacting or indexing.</span></span> 
    
- <span data-ttu-id="a0605-115">Les utilisateurs qui souhaitent que les clients MAPI se ferment dès qu’ils les ferment doivent utiliser le paramètre de Registre par défaut qui active l’arrêt rapide, sauf si un fournisseur le désintique.</span><span class="sxs-lookup"><span data-stu-id="a0605-115">Users who want MAPI clients to exit as soon as they close them should use the default registry setting that enables fast shutdown unless a provider opts out.</span></span>
    
- <span data-ttu-id="a0605-116">Une fois qu’un client MAPI appelle **IMAPIClientShutdown::D oFastShutdown,** il ne doit pas effectuer d’appels supplémentaires à MAPI, y compris la fonction [MAPIUninitialize.](mapiuninitialize.md)</span><span class="sxs-lookup"><span data-stu-id="a0605-116">Once a MAPI client calls **IMAPIClientShutdown::DoFastShutdown**, it should not make any additional calls to MAPI, including the [MAPIUninitialize](mapiuninitialize.md) function.</span></span> <span data-ttu-id="a0605-117">Le client ne doit pas utiliser MAPI pour le reste de la durée de vie du processus client.</span><span class="sxs-lookup"><span data-stu-id="a0605-117">The client should not use MAPI for the rest of the client process's lifetime.</span></span> 
    
- <span data-ttu-id="a0605-118">Un client MAPI ne doit jamais appeler directement l’interface **IMAPIProviderShutdown d’un** fournisseur.</span><span class="sxs-lookup"><span data-stu-id="a0605-118">A MAPI client should never directly call a provider's **IMAPIProviderShutdown** interface.</span></span> <span data-ttu-id="a0605-119">Les clients MAPI doivent toujours utiliser l’interface [IMAPIClientShutdown : IUnknown.](imapiclientshutdowniunknown.md)</span><span class="sxs-lookup"><span data-stu-id="a0605-119">MAPI clients should always use the [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span></span> 
    
- <span data-ttu-id="a0605-120">Si un fournisseur MAPI doit s’assurer que l’arrêt rapide n’est pas utilisé pendant son chargement, il doit implémenter l’interface **IMAPIProviderShutdown** et renvoyer MAPI_E_NO_SUPPORT pour la méthode **IMAPIProviderShutdown::QueryFastShutdown.**</span><span class="sxs-lookup"><span data-stu-id="a0605-120">If a MAPI provider needs to ensure that fast shutdown is not used while it is loaded, it should implement the **IMAPIProviderShutdown** interface and return MAPI_E_NO_SUPPORT for the **IMAPIProviderShutdown::QueryFastShutdown** method.</span></span> <span data-ttu-id="a0605-121">Toutefois, pour les clients MAPI tels que Outlook, le client abandonnera l’arrêt rapide et prendra plus de temps à s’arrêter.</span><span class="sxs-lookup"><span data-stu-id="a0605-121">However, for MAPI clients such as Outlook, this will cause the client to abandon fast shutdown and take a longer time to shut down.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="a0605-122">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a0605-122">See also</span></span>



[<span data-ttu-id="a0605-123">Arrêt du client dans MAPI</span><span class="sxs-lookup"><span data-stu-id="a0605-123">Client Shutdown in MAPI</span></span>](client-shutdown-in-mapi.md)
  
[<span data-ttu-id="a0605-124">Présentation de l’arrêt rapide</span><span class="sxs-lookup"><span data-stu-id="a0605-124">Fast Shutdown Overview</span></span>](fast-shutdown-overview.md)
  
[<span data-ttu-id="a0605-125">Options utilisateur d’arrêt rapide</span><span class="sxs-lookup"><span data-stu-id="a0605-125">Fast Shutdown User Options</span></span>](fast-shutdown-user-options.md)

