---
title: MAPI re�oivent des dossiers
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2e1287a3-0f15-4d9a-b7ee-738fce9cd51f
description: 'Derni�re modification�: lundi 9 mars 2015'
ms.openlocfilehash: b22b8641d55037d3755fc9ae32b97455223bbd12
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33431938"
---
# <a name="mapi-receive-folders"></a><span data-ttu-id="1d8c1-103">MAPI re�oivent des dossiers</span><span class="sxs-lookup"><span data-stu-id="1d8c1-103">MAPI Receive Folders</span></span>

  
  
<span data-ttu-id="1d8c1-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="1d8c1-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="1d8c1-p101">Un dossier de r�ception conserve les messages entrants d'une classe de message particulier. Recevoir le dossier associations peuvent �tre �tablies par les clients, par le fournisseur de banque de messages ou MAPI. MAPI a deux par d�faut � recevoir des dossiers : le dossier racine de la banque de messages et le dossier bo�te de r�ception de la sous-arborescence message interpersonnel (IPM). Le dossier racine de la banque de messages est le dossier pour tous les messages de communication interprocessus (IPC) de r�ception de la valeur par d�faut.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p101">A receive folder holds inbound messages of a particular message class. Receive folder associations can be established by clients, by the message store provider, or by MAPI. MAPI has two default receive folders: the root folder of the message store, and the Inbox folder of the interpersonal message (IPM) subtree. The root folder of the message store is the default receive folder for all interprocess communication (IPC) messages.</span></span>
  
 <span data-ttu-id="1d8c1-109">Le dossier bo�te de r�ception est cr�� par MAPI pour chaque nouvelle banque de messages et agit en tant que valeur par d�faut recevoir des dossiers pour les classes de message suivants :</span><span class="sxs-lookup"><span data-stu-id="1d8c1-109">The Inbox folder is created by MAPI for every new message store and acts as the default receive folder for the following message classes:</span></span> 
  
- <span data-ttu-id="1d8c1-110">La classe de message IPM.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-110">The IPM message class.</span></span>
    
- <span data-ttu-id="1d8c1-111">La classe de message de rapport.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-111">The report message class.</span></span>
    
- <span data-ttu-id="1d8c1-112">Une classe vide ou manquante.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-112">An empty, or missing, class.</span></span>
    
<span data-ttu-id="1d8c1-p102">Tous les messages d'�tat, y compris ceux envoy�s en r�ponse � un message IPC, sont plac�s dans le dossier bo�te de r�ception. Les applications clientes IPC qui traitent leurs propres rapports doivent ajouter explicitement un dossier de r�ception pour la classe sp�cifique du rapport. Par exemple, si un client attend de recevoir des messages avec la classe IPC. Paper.Order, elle doit appeler la m�thode [IMsgStore::SetReceiveFolder](imsgstore-setreceivefolder.md) pour �tablir un dossier de r�ception des rapports avec la classe Report.IPC.Paper.Order.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p102">All report messages, even those sent in response to an IPC message, are placed in the Inbox folder. IPC client applications that process their own reports must explicitly add a receive folder for the particular class of report. For example, if a client expects to receive messages with the class IPC.Paper.Order, it should call the [IMsgStore::SetReceiveFolder](imsgstore-setreceivefolder.md) method to establish a receive folder for reports with the class Report.IPC.Paper.Order.</span></span> 
  
<span data-ttu-id="1d8c1-p103">Dossier associations sont bas�es sur la structure hi�rarchique des classes de message de r�ception. Les clients peuvent explicitement �tablir une association entre un dossier de r�ception et une classe de message ou utiliser les dossiers de r�ception par d�faut MAPI. En r�gle g�n�rale, les clients d�signer un dossier de recevoir des messages pour une classe de base et toutes ses sous-classes. Par exemple, un client typique permettrait d'�tablir une association pour les messages avec la classe **MyClass**. Si le client a re�u les messages avec les classes **MyClass.Home** ou **MyClass.Home.Kitchen.Computer**, ces messages seraient acc�dez au dossier de r�ception pour la classe de base, **MyClass**.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p103">Receive folder associations are based on the hierarchical organization of message classes. Clients can explicitly establish an association between a receive folder and a message class or use the MAPI default receive folders. Typically, clients designate one folder to receive messages for a base class and all of its subclasses. For example, a typical client would establish an association for messages with the class **MyClass**. Then if the client received messages with classes **MyClass.Home** or **MyClass.Home.Kitchen.Computer**, these messages would go to the receive folder for the base class, **MyClass**.</span></span>
  
<span data-ttu-id="1d8c1-121">Il existe trois message m�thodes magasin que les clients utilisent pour travailler avec re�oivent des dossiers :</span><span class="sxs-lookup"><span data-stu-id="1d8c1-121">There are three message store methods that clients use to work with receive folders:</span></span>
  
- [<span data-ttu-id="1d8c1-122">IMsgStore::GetReceiveFolderTable</span><span class="sxs-lookup"><span data-stu-id="1d8c1-122">IMsgStore::GetReceiveFolderTable</span></span>](imsgstore-getreceivefoldertable.md)
    
- [<span data-ttu-id="1d8c1-123">IMsgStore::GetReceiveFolder</span><span class="sxs-lookup"><span data-stu-id="1d8c1-123">IMsgStore::GetReceiveFolder</span></span>](imsgstore-getreceivefolder.md)
    
- [<span data-ttu-id="1d8c1-124">IMsgStore::SetReceiveFolder</span><span class="sxs-lookup"><span data-stu-id="1d8c1-124">IMsgStore::SetReceiveFolder</span></span>](imsgstore-setreceivefolder.md)
    
<span data-ttu-id="1d8c1-p104">Le tableau de dossier de r�ception vous trouverez des informations sur tous les dossiers de r�ception �tablis pour une banque de messages. Son jeu de colonne obligatoire inclut la classe de message, la cl� d'enregistrement et identificateur d'entr�e.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p104">The receive folder table is a listing of information about all of the receive folders established for a message store. Its required column set includes the message class, record key, and entry identifier.</span></span>
  
<span data-ttu-id="1d8c1-p105">To retrieve a receive folder for a particular message class, clients pass the message class string to the [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) method. The message store provider returns an entry identifier for the corresponding folder. To implement **GetReceiveFolder**, a message store provider should use an algorithm that selects the folder whose associated message class matches the longest possible prefix of the specified message class. For example, assume the message store has the following associations between receive folders and message classes in its receive folder table:</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p105">To retrieve a receive folder for a particular message class, clients pass the message class string to the [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) method. The message store provider returns an entry identifier for the corresponding folder. To implement **GetReceiveFolder**, a message store provider should use an algorithm that selects the folder whose associated message class matches the longest possible prefix of the specified message class. For example, assume the message store has the following associations between receive folders and message classes in its receive folder table:</span></span>
  
- <span data-ttu-id="1d8c1-131">**IPM** les messages sont plac�s dans le dossier bo�te de r�ception.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-131">**IPM** messages are placed in the Inbox folder.</span></span> 
    
- <span data-ttu-id="1d8c1-132">**IPM.Note.Sample** les messages sont plac�s dans le dossier Samples.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-132">**IPM.Note.Sample** messages are placed in the Samples folder.</span></span> 
    
<span data-ttu-id="1d8c1-133">Le tableau suivant montre comment les messages avec plusieurs classes doivent �tre achemin�s vers appropri�s re�oit un dossier.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-133">The following table shows how messages with various classes would be routed to the appropriate receive folder.</span></span>
  
|<span data-ttu-id="1d8c1-134">**Classe de message entrant**</span><span class="sxs-lookup"><span data-stu-id="1d8c1-134">**Inbound message class**</span></span>|<span data-ttu-id="1d8c1-135">**Dossier de r�ception**</span><span class="sxs-lookup"><span data-stu-id="1d8c1-135">**Receive folder**</span></span>|
|:-----|:-----|
|<span data-ttu-id="1d8c1-136">**Mn. Note. Sample. simple**</span><span class="sxs-lookup"><span data-stu-id="1d8c1-136">**IPM.Note.Sample.Simple**</span></span> <br/> |<span data-ttu-id="1d8c1-137">Dossier d'exemples</span><span class="sxs-lookup"><span data-stu-id="1d8c1-137">Samples folder</span></span>  <br/> |
|<span data-ttu-id="1d8c1-138">**Mn. Note**</span><span class="sxs-lookup"><span data-stu-id="1d8c1-138">**IPM.Note**</span></span> <br/> |<span data-ttu-id="1d8c1-139">Dossier bo�te de r�ception</span><span class="sxs-lookup"><span data-stu-id="1d8c1-139">Inbox folder</span></span>  <br/> |
|<span data-ttu-id="1d8c1-140">**Mn. Présence**</span><span class="sxs-lookup"><span data-stu-id="1d8c1-140">**IPM.Timecard**</span></span> <br/> |<span data-ttu-id="1d8c1-141">Dossier bo�te de r�ception</span><span class="sxs-lookup"><span data-stu-id="1d8c1-141">Inbox folder</span></span>  <br/> |
|<span data-ttu-id="1d8c1-142">**Mn. Note. Sample. simple. totalement**</span><span class="sxs-lookup"><span data-stu-id="1d8c1-142">**IPM.Note.Sample.Simple.Totally**</span></span> <br/> |<span data-ttu-id="1d8c1-143">Dossier d'exemples</span><span class="sxs-lookup"><span data-stu-id="1d8c1-143">Samples folder</span></span>  <br/> |
   
<span data-ttu-id="1d8c1-p106">Clients appellent la m�thode **SetReceiveFolder** pour �mettre une association entre une classe de message particuli�re explicite et recevoir des dossiers. Lorsqu'un message est remis � une classe de message vide, MAPI place le message dans le dossier de r�ception n'est d�fini pour un pr�fixe de la classe vide. Par exemple, si votre client dispose d'un dossier de r�ception �tabli pour les messages avec la classe **IPM** et la remise d'un message avec la classe **IPM.Note.Test**, ce message sera plac� dans le dossier de r�ception pour la classe de message **IPM**.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p106">Clients call the **SetReceiveFolder** method to make an explicit association between a particular message class and receive folder. When a message is delivered to an empty message class, MAPI places the message in the receive folder that is defined for a prefix of the empty class. For example, if your client has a receive folder established for messages with class **IPM** and a message with class **IPM.Note.Test** is delivered, this message will be placed in the receive folder for the **IPM** message class.</span></span> 
  
<span data-ttu-id="1d8c1-p107">Dans l'appel **SetReceiveFolder**, clients transmettre g�n�ralement une cha�ne de classe de message et l'identificateur d'entr�e du nouveau dossier de r�ception. Toutefois, les clients peuvent passer de NULL pour une ou deux de ces param�tres. Le tableau suivant d�crit le comportement qui se traduit � partir de la sp�cification NULL pour les param�tres d'identificateur de classe et d'entr�e de message.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p107">In calling **SetReceiveFolder**, clients typically pass a message class string and the entry identifier of the new receive folder. However, clients can pass in NULL for one or both of these parameters. The following table describes the behavior that results from specifying NULL for the message class and entry identifier parameters.</span></span> 
  
|<span data-ttu-id="1d8c1-150">**param�tre de  _SetReceiveFolder_**</span><span class="sxs-lookup"><span data-stu-id="1d8c1-150">**_SetReceiveFolder_ parameter**</span></span>|<span data-ttu-id="1d8c1-151">**Comportement r�sultant**</span><span class="sxs-lookup"><span data-stu-id="1d8c1-151">**Resulting behavior**</span></span>|
|:-----|:-----|
|<span data-ttu-id="1d8c1-152">Identificateur d'entr�e la valeur NULL</span><span class="sxs-lookup"><span data-stu-id="1d8c1-152">Entry identifier set to NULL</span></span>  <br/> |<span data-ttu-id="1d8c1-p108">La banque de messages supprime l'association entre le texte sp�cifi� de classe et de ses existants de dossier de r�ception de message. Recevoir un nouveau dossier n'est pas �tablie. </span><span class="sxs-lookup"><span data-stu-id="1d8c1-p108">The message store deletes the association between the specified message class and its existing receive folder. A new receive folder is not established.  </span></span><br/> <span data-ttu-id="1d8c1-155">Les appels ult�rieurs � **GetReceiveFolder** � cette classe de message renverra le dossier de r�ception pour un pr�fixe de la classe de message ; de nouvelles banques de message, **GetReceiveFolder** retournera la bo�te de r�ception dans la sous-arborescence IPM.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-155">Subsequent calls to **GetReceiveFolder** with this message class will return the receive folder for a prefix of the message class; for new message stores, **GetReceiveFolder** will return the Inbox in the IPM subtree.</span></span>  <br/> |
|<span data-ttu-id="1d8c1-156">Classe de message la valeur NULL</span><span class="sxs-lookup"><span data-stu-id="1d8c1-156">Message class set to NULL</span></span>  <br/> |<span data-ttu-id="1d8c1-p109">La banque de messages modifie l'association de la classe de message vide dans le dossier indiqu�. Les messages entrants dont la classe n'est pas reconnue dans le cas contraire seront dirig�s vers ce dossier.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p109">The message store changes the association for the empty message class to the indicated folder. Incoming messages whose class is otherwise unrecognized will go to this folder.</span></span>  <br/> |
|<span data-ttu-id="1d8c1-159">Identificateur d'entr�e et de la classe de message la valeur NULL</span><span class="sxs-lookup"><span data-stu-id="1d8c1-159">Entry identifier and message class set to NULL</span></span>  <br/> |<span data-ttu-id="1d8c1-p110">La banque de messages supprime l'association de la classe/dossier pour la classe de message vide. Vous ne devez pas d�finir les deux param�tres � la valeur NULL, car elle r�duit g�n�ralement dans les messages entrants plac�es dans le dossier racine de la banque de messages, un dossier qui est invisible dans le client.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p110">The message store deletes the class/folder association for the empty message class. You should not set both parameters to NULL, because it typically results in inbound messages being placed in the root folder of the message store, a folder that is invisible to the client.</span></span>  <br/> |
   
<span data-ttu-id="1d8c1-p111">Bien que les classes d'un message ne doivent jamais �tre vide, une classe de message vide peut se produire. Il incombe de la banque de messages pour affecter la classe de message � **IPM** pour les nouveaux messages sortants qui ont une classe vide ; Il incombe du fournisseur de transport pour affecter **IPM.Note** comme classe pour les messages entrants ayant n'importe quelle classe vide.</span><span class="sxs-lookup"><span data-stu-id="1d8c1-p111">Although a message's class should never be empty, an empty message class can occur. It is the message store's responsibility to assign the message class to **IPM** for new outbound messages that have an empty class; it is the transport provider's responsibility to assign **IPM.Note** as the class for inbound messages that have any empty class.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="1d8c1-164">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1d8c1-164">See also</span></span>



[<span data-ttu-id="1d8c1-165">Dossiers MAPI</span><span class="sxs-lookup"><span data-stu-id="1d8c1-165">MAPI Folders</span></span>](mapi-folders.md)

