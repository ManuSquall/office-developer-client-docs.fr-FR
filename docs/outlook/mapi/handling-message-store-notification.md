---
title: Gestion des notifications de la banque de messages
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3e0cc2f9-a88d-4cec-bef5-b60f2ec80f1c
description: Dernière modification le 9 mars 2015
ms.openlocfilehash: d370603dc7cfc015fe7b2757d1cf0525b3092c5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428024"
---
# <a name="handling-message-store-notification"></a><span data-ttu-id="ec254-103">Gestion des notifications de la banque de messages</span><span class="sxs-lookup"><span data-stu-id="ec254-103">Handling message store notification</span></span>
  
<span data-ttu-id="ec254-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ec254-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ec254-105">Pour vous inscrire aux notifications de banque de messages, appelez la méthode [IMAPISession:: Advise](imapisession-advise.md) ou [IMsgStore:: Advise](imsgstore-advise.md) et spécifiez une banque de messages, un dossier ou un identificateur d'entrée de message dans le contenu du paramètre _lpEntryID_ .</span><span class="sxs-lookup"><span data-stu-id="ec254-105">To register for message store notifications, call either the [IMAPISession::Advise](imapisession-advise.md) or [IMsgStore::Advise](imsgstore-advise.md) method and specify a message store, folder, or message entry identifier in the contents of the  _lpEntryID_ parameter.</span></span> <span data-ttu-id="ec254-106">Les fournisseurs de banques de messages prennent en charge les notifications d'objet et de table.</span><span class="sxs-lookup"><span data-stu-id="ec254-106">Message store providers support both object and table notifications.</span></span> <span data-ttu-id="ec254-107">Que vous vous inscriviez avec des objets de banque de messages particuliers, avec les tables de hiérarchie de dossiers et de contenu qui décrivent ces objets, ou avec les objets et les tables, dépend des notifications que vous vous attendez à voir, des appels que vous effectuez pour effectuer des opérations et de la procédure le fournisseur de banque de messages prend en charge la notification.</span><span class="sxs-lookup"><span data-stu-id="ec254-107">Whether you register with particular message store objects, with the folder hierarchy and contents tables that describe these objects, or with both objects and tables depends on the notifications you expect to see, the calls you make to perform operations, and how the message store provider supports notification.</span></span> 
  
<span data-ttu-id="ec254-108">Étant donné que MAPI autorise la flexibilité de la prise en charge des notifications par les fournisseurs, sachez que vous ne recevrez pas toujours le même type de notification en réponse à un événement particulier de tous les fournisseurs de banques de messages.</span><span class="sxs-lookup"><span data-stu-id="ec254-108">Because MAPI allows flexibility in how providers support notifications, be aware that you will not always receive the same type of notification in response to a particular event from all message store providers.</span></span> <span data-ttu-id="ec254-109">Certains fournisseurs de banques de messages ne prennent pas en charge les notifications.</span><span class="sxs-lookup"><span data-stu-id="ec254-109">Some message store providers do not support notifications at all.</span></span> <span data-ttu-id="ec254-110">Pour déterminer si la Banque de messages que vous utilisez prend en charge la notification, recherchez le bit STORE_NOTIFY_OK dans sa propriété **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="ec254-110">To determine if the message store you are using supports notification, look for the STORE_NOTIFY_OK bit in its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="ec254-111">À une extrémité du spectre des fournisseurs de banques de messages qui prennent en charge la notification sont les fournisseurs qui génèrent des notifications «enrichies»; ces fournisseurs envoient des notifications descriptives pour toutes les sources de notification enregistrées.</span><span class="sxs-lookup"><span data-stu-id="ec254-111">At one end of the spectrum of message store providers that support notification are the providers that generate "rich" notifications; these providers send descriptive notifications for all registered advise sources.</span></span> <span data-ttu-id="ec254-112">Aux autres terminaisons sont les fournisseurs de banques de messages qui prennent en charge les notifications limitées; ces fournisseurs envoient des notifications générales pour un nombre restreint de sources de notification.</span><span class="sxs-lookup"><span data-stu-id="ec254-112">At the other end are the message store providers that support limited notifications; these providers send general notifications for a restricted number of advise sources.</span></span> 
  
<span data-ttu-id="ec254-113">Par exemple, si vous copiez un message dans un dossier avec lequel vous avez été inscrit pour recevoir des notifications de déplacement d'objets et d'objet, il se peut que vous receviez ou non la notification copiée d'objet.</span><span class="sxs-lookup"><span data-stu-id="ec254-113">For example, if you copy a message to a folder with which you have registered to receive both object copied and object moved notifications, you may or may not receive the object copied notification.</span></span> <span data-ttu-id="ec254-114">Le fait que vous le receviez ou non dépend des éléments suivants:</span><span class="sxs-lookup"><span data-stu-id="ec254-114">Whether or not you receive it depends on:</span></span>
  
- <span data-ttu-id="ec254-115">La méthode que vous avez appelée pour effectuer la copie.</span><span class="sxs-lookup"><span data-stu-id="ec254-115">The method that you called to perform the copy.</span></span> <span data-ttu-id="ec254-116">Il peut s'agir de [IMAPIFolder:: CopyMessages](imapifolder-copymessages.md), [IMAPIProp:: CopyTo](imapiprop-copyto.md)ou [IMAPIProp:: CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="ec254-116">This could be [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md), or [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="ec254-117">Implémentation par le fournisseur de banque de messages de la méthode de copie.</span><span class="sxs-lookup"><span data-stu-id="ec254-117">How the message store provider implements the copy method.</span></span>
    
- <span data-ttu-id="ec254-118">Si le fournisseur de banque de messages prend ou non en charge les notifications copiées par l'objet sur les dossiers.</span><span class="sxs-lookup"><span data-stu-id="ec254-118">Whether or not the message store provider supports object copied notifications on folders.</span></span>
    
<span data-ttu-id="ec254-119">Étant donné qu'il n'existe pas de recommandations strictes qui décrivent la manière d'implémenter la notification d'événement pour les fournisseurs de banques de messages, les clients ne peuvent pas être cohérents.</span><span class="sxs-lookup"><span data-stu-id="ec254-119">Because there are no strict guidelines that describe how to implement event notification for message store providers, clients cannot expect consistent behavior.</span></span> <span data-ttu-id="ec254-120">MAPI effectue des recommandations sur la façon dont les fournisseurs de banque de messages implémentent la notification d'événement et le tableau suivant présente ces recommandations.</span><span class="sxs-lookup"><span data-stu-id="ec254-120">MAPI does make recommendations as to how message store providers implement event notification and the following table outlines these recommendations.</span></span> <span data-ttu-id="ec254-121">Lisez le tableau comme suit: une fois que vous avez effectué l'opération dans la première colonne, attendez la réception d'une notification du type indiqué dans la deuxième colonne si vous avez inscrit pour ce type avec l'objet répertorié dans la troisième colonne.</span><span class="sxs-lookup"><span data-stu-id="ec254-121">Read the table as follows: after you perform the operation in the first column, expect to receive a notification of the type listed in the second column if you have registered for that type with the object listed in the third column.</span></span> <span data-ttu-id="ec254-122">Par exemple, une fois que vous avez créé un dossier, vous ne recevrez une notification _fnevObjectCreated_ que si vous vous êtes inscrit pour les notifications de _fnevObjectCreated_ avec la Banque de messages.</span><span class="sxs-lookup"><span data-stu-id="ec254-122">For example, after you have created a folder, you will receive an  _fnevObjectCreated_ notification only if you have registered for  _fnevObjectCreated_ notifications with the message store.</span></span> 
  
|<span data-ttu-id="ec254-123">**Opération**</span><span class="sxs-lookup"><span data-stu-id="ec254-123">**Operation**</span></span>|<span data-ttu-id="ec254-124">**Type d’événement**</span><span class="sxs-lookup"><span data-stu-id="ec254-124">**Event type**</span></span>|<span data-ttu-id="ec254-125">**Source de notification**</span><span class="sxs-lookup"><span data-stu-id="ec254-125">**Advise source**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="ec254-126">Créer un dossier</span><span class="sxs-lookup"><span data-stu-id="ec254-126">Create a folder</span></span>  <br/> | <span data-ttu-id="ec254-127">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="ec254-127">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="ec254-128">Banque de messages</span><span class="sxs-lookup"><span data-stu-id="ec254-128">Message store</span></span>  <br/> |
|<span data-ttu-id="ec254-129">Supprimer un dossier</span><span class="sxs-lookup"><span data-stu-id="ec254-129">Delete a folder</span></span>  <br/> | <span data-ttu-id="ec254-130">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="ec254-130">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="ec254-131">Dossier supprimé de la Banque de messages</span><span class="sxs-lookup"><span data-stu-id="ec254-131">Message store Deleted folder</span></span>  <br/> |
|<span data-ttu-id="ec254-132">Déplacer un dossier d'un dossier à un autre</span><span class="sxs-lookup"><span data-stu-id="ec254-132">Move a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="ec254-133">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="ec254-133">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="ec254-134">Dossier déplacé dans la Banque de messages</span><span class="sxs-lookup"><span data-stu-id="ec254-134">Message store Moved folder</span></span>  <br/> |
|<span data-ttu-id="ec254-135">Copier un dossier d'un dossier à un autre</span><span class="sxs-lookup"><span data-stu-id="ec254-135">Copy a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="ec254-136">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="ec254-136">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="ec254-137">Banque de messages et dossier copié (aucune notification _fnevObjectCreated_ envoyée pour la nouvelle copie du dossier)</span><span class="sxs-lookup"><span data-stu-id="ec254-137">Message store and copied folder (no  _fnevObjectCreated_ notification sent for the new copy of the folder)</span></span>  <br/> |
|<span data-ttu-id="ec254-138">Modification d'une propriété de dossier calculée (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ec254-138">Change in a computed folder property (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> | <span data-ttu-id="ec254-139">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="ec254-139">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="ec254-140">Dossier de la Banque de messages modifiée (aucune notification au dossier parent)</span><span class="sxs-lookup"><span data-stu-id="ec254-140">Message store Changed folder (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="ec254-141">Créer un message</span><span class="sxs-lookup"><span data-stu-id="ec254-141">Create a message</span></span>  <br/> | <span data-ttu-id="ec254-142">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="ec254-142">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="ec254-143">Banque de messages</span><span class="sxs-lookup"><span data-stu-id="ec254-143">Message store</span></span>  <br/> |
|<span data-ttu-id="ec254-144">Supprimer un message, entraînant une modification dans la propriété **PR_CONTENT_COUNT** du dossier parent</span><span class="sxs-lookup"><span data-stu-id="ec254-144">Delete a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="ec254-145">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="ec254-145">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="ec254-146">Message de magasin de messages supprimé</span><span class="sxs-lookup"><span data-stu-id="ec254-146">Message store Deleted message</span></span>  <br/> |
|<span data-ttu-id="ec254-147">Déplacer un message d'un dossier à un autre</span><span class="sxs-lookup"><span data-stu-id="ec254-147">Move a message from one folder to another</span></span>  <br/> | <span data-ttu-id="ec254-148">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="ec254-148">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="ec254-149">Message déplacé de banque de messages</span><span class="sxs-lookup"><span data-stu-id="ec254-149">Message store Moved message</span></span>  <br/> |
|<span data-ttu-id="ec254-150">Copier un message d'un dossier à un autre</span><span class="sxs-lookup"><span data-stu-id="ec254-150">Copy a message from one folder to another</span></span>  <br/> | <span data-ttu-id="ec254-151">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="ec254-151">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="ec254-152">Message copié de la Banque de messages (aucune notification _fnevObjectCreated_ pour la nouvelle copie du message)</span><span class="sxs-lookup"><span data-stu-id="ec254-152">Message store Copied message (No  _fnevObjectCreated_ notification for new copy of the message)</span></span>  <br/> |
|<span data-ttu-id="ec254-153">Enregistrer un message, entraînant une modification dans la propriété **PR_CONTENT_COUNT** du dossier parent</span><span class="sxs-lookup"><span data-stu-id="ec254-153">Save a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="ec254-154">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="ec254-154">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="ec254-155">Banque de messages lors du premier enregistrement uniquement</span><span class="sxs-lookup"><span data-stu-id="ec254-155">Message store on first save only</span></span>  <br/> |
|<span data-ttu-id="ec254-156">Enregistrer un message</span><span class="sxs-lookup"><span data-stu-id="ec254-156">Save a message</span></span>  <br/> | <span data-ttu-id="ec254-157">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="ec254-157">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="ec254-158">Banque de messages lors des enregistrements après le premier message enregistrement modifié (aucune notification au dossier parent)</span><span class="sxs-lookup"><span data-stu-id="ec254-158">Message store on saves after the first save Changed message (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="ec254-159">Effectuer une opération de recherche</span><span class="sxs-lookup"><span data-stu-id="ec254-159">Complete a search operation</span></span>  <br/> | <span data-ttu-id="ec254-160">_fnevSearchComplete_</span><span class="sxs-lookup"><span data-stu-id="ec254-160">_fnevSearchComplete_</span></span> <br/> |<span data-ttu-id="ec254-161">Dossier de recherche de banque de messages</span><span class="sxs-lookup"><span data-stu-id="ec254-161">Message store Search folder</span></span>  <br/> |
|<span data-ttu-id="ec254-162">Nouveau message</span><span class="sxs-lookup"><span data-stu-id="ec254-162">New message</span></span>  <br/> | <span data-ttu-id="ec254-163">_fnevNewMail_</span><span class="sxs-lookup"><span data-stu-id="ec254-163">_fnevNewMail_</span></span> <br/> |<span data-ttu-id="ec254-164">Banque de messages</span><span class="sxs-lookup"><span data-stu-id="ec254-164">Message store</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="ec254-165">Lorsque vous recevez une notification de modification d'objet, n'oubliez pas que la partie de tableau de la balise de propriété de la structure [OBJECT_NOTIFICATION](object_notification.md) vers laquelle pointe le paramètre _lpNotifications_ dans l'appel **OnNotify** peut être null ou non.</span><span class="sxs-lookup"><span data-stu-id="ec254-165">When you receive an object modified notification, remember that the property tag array portion of the [OBJECT_NOTIFICATION](object_notification.md) structure pointed to by the  _lpNotifications_ parameter in the **OnNotify** call may or may not be NULL.</span></span> <span data-ttu-id="ec254-166">Les fournisseurs de banque de messages ne sont pas requis pour insérer des informations de propriété dans ce tableau, et la plupart ne le font pas.</span><span class="sxs-lookup"><span data-stu-id="ec254-166">Message store providers are not required to insert property information in this array and most do not.</span></span> <span data-ttu-id="ec254-167">Assurez-vous que votre méthode **OnNotify** peut gérer le cas où le pointeur _lpPropTagArray_ est null.</span><span class="sxs-lookup"><span data-stu-id="ec254-167">Make sure your **OnNotify** method can handle the case where the  _lpPropTagArray_ pointer is NULL.</span></span> 
  
<span data-ttu-id="ec254-168">Pour la plupart, si ce n'est pas toutes les notifications d'objet, mettez à jour l'affichage du dossier ou des dossiers affectés.</span><span class="sxs-lookup"><span data-stu-id="ec254-168">For most, if not all object notifications, update the view of the affected folder or folders.</span></span>
  

