---
title: Gestion de notification de banque de messages
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3e0cc2f9-a88d-4cec-bef5-b60f2ec80f1c
description: 'Derni�re modification�: lundi 9 mars 2015'
ms.openlocfilehash: 898f8b6ff3d0b0dd42a670596b54171f18b4a5e3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19783433"
---
# <a name="handling-message-store-notification"></a><span data-ttu-id="6a0de-103">Gestion de notification de banque de messages</span><span class="sxs-lookup"><span data-stu-id="6a0de-103">Handling message store notification</span></span>
  
<span data-ttu-id="6a0de-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="6a0de-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="6a0de-105">Pour vous inscrire pour les notifications de banque de messages, appelez le [IMAPISession::Advise](imapisession-advise.md) ou le [IMsgStore::Advise](imsgstore-advise.md) et spécifiez une banque de messages, un dossier ou un identificateur d’entrée du message dans le contenu du paramètre _lpEntryID_ .</span><span class="sxs-lookup"><span data-stu-id="6a0de-105">To register for message store notifications, call either the [IMAPISession::Advise](imapisession-advise.md) or [IMsgStore::Advise](imsgstore-advise.md) method and specify a message store, folder, or message entry identifier in the contents of the  _lpEntryID_ parameter.</span></span> <span data-ttu-id="6a0de-106">Fournisseurs de banque de messages prennent en charge les notifications d’objet et de tableau.</span><span class="sxs-lookup"><span data-stu-id="6a0de-106">Message store providers support both object and table notifications.</span></span> <span data-ttu-id="6a0de-107">Si vous enregistrez avec les objets de banque de message particulier, les tables de hiérarchie et le contenu de dossier qui décrivent ces objets ou les deux objets et tables varie selon les notifications, vous devriez voir, les appels pour effectuer des opérations, et comment le fournisseur de banque de message prend en charge la notification.</span><span class="sxs-lookup"><span data-stu-id="6a0de-107">Whether you register with particular message store objects, with the folder hierarchy and contents tables that describe these objects, or with both objects and tables depends on the notifications you expect to see, the calls you make to perform operations, and how the message store provider supports notification.</span></span> 
  
<span data-ttu-id="6a0de-108">Étant donné que MAPI permet une grande flexibilité comment fournisseurs prennent en charge les notifications, sachez que vous ne recevrez pas toujours de même type de notification en réponse à un événement spécifique à partir de tous les fournisseurs de banque de messages.</span><span class="sxs-lookup"><span data-stu-id="6a0de-108">Because MAPI allows flexibility in how providers support notifications, be aware that you will not always receive the same type of notification in response to a particular event from all message store providers.</span></span> <span data-ttu-id="6a0de-109">Certains fournisseurs de banque de messages n’acceptent pas les notifications.</span><span class="sxs-lookup"><span data-stu-id="6a0de-109">Some message store providers do not support notifications at all.</span></span> <span data-ttu-id="6a0de-110">Pour déterminer si la banque de messages que vous utilisez prend en charge la notification, recherchez le bit STORE_NOTIFY_OK dans sa propriété **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="6a0de-110">To determine if the message store you are using supports notification, look for the STORE_NOTIFY_OK bit in its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="6a0de-111">Une des extrémités du spectre de banque de messages fournisseurs qui prennent en charge les notifications sont les fournisseurs qui génèrent des notifications « riches » ; Ces fournisseurs envoient des notifications descriptives pour tous les inscrit conseiller sources.</span><span class="sxs-lookup"><span data-stu-id="6a0de-111">At one end of the spectrum of message store providers that support notification are the providers that generate "rich" notifications; these providers send descriptive notifications for all registered advise sources.</span></span> <span data-ttu-id="6a0de-112">À l’autre extrémité est le message de fournisseurs de magasins qui prennent en charge les notifications limitées ; Ces fournisseurs d’envoyer des notifications générales pour un nombre limité de sources advise.</span><span class="sxs-lookup"><span data-stu-id="6a0de-112">At the other end are the message store providers that support limited notifications; these providers send general notifications for a restricted number of advise sources.</span></span> 
  
<span data-ttu-id="6a0de-113">Par exemple, si vous copiez un message dans un dossier avec lequel vous avez enregistré pour recevoir les deux objet copié et l’objet déplacé notifications, mais peut ne pas recevoir la notification de l’objet copié.</span><span class="sxs-lookup"><span data-stu-id="6a0de-113">For example, if you copy a message to a folder with which you have registered to receive both object copied and object moved notifications, you may or may not receive the object copied notification.</span></span> <span data-ttu-id="6a0de-114">Si vous recevez cela dépend :</span><span class="sxs-lookup"><span data-stu-id="6a0de-114">Whether or not you receive it depends on:</span></span>
  
- <span data-ttu-id="6a0de-115">La méthode que vous avez appelée pour effectuer la copie.</span><span class="sxs-lookup"><span data-stu-id="6a0de-115">The method that you called to perform the copy.</span></span> <span data-ttu-id="6a0de-116">Cela peut être [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md)ou [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="6a0de-116">This could be [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md), or [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="6a0de-117">Comment la banque de messages fournisseur implémente la méthode copy.</span><span class="sxs-lookup"><span data-stu-id="6a0de-117">How the message store provider implements the copy method.</span></span>
    
- <span data-ttu-id="6a0de-118">Ou non le fournisseur de banque de message prend en charge les notifications de l’objet copié dans les dossiers.</span><span class="sxs-lookup"><span data-stu-id="6a0de-118">Whether or not the message store provider supports object copied notifications on folders.</span></span>
    
<span data-ttu-id="6a0de-119">Étant donné qu’aucun recommandations formelles qui décrivent comment implémenter la notification d’événement pour un message ne stockent les fournisseurs, clients ne peuvent pas s’attendent un comportement cohérent.</span><span class="sxs-lookup"><span data-stu-id="6a0de-119">Because there are no strict guidelines that describe how to implement event notification for message store providers, clients cannot expect consistent behavior.</span></span> <span data-ttu-id="6a0de-120">MAPI rend des recommandations quant à la banque de messages notification d’événement fournisseurs implémenter et le tableau suivant indique les recommandations suivantes.</span><span class="sxs-lookup"><span data-stu-id="6a0de-120">MAPI does make recommendations as to how message store providers implement event notification and the following table outlines these recommendations.</span></span> <span data-ttu-id="6a0de-121">Le tableau comme suit : après avoir effectué l’opération dans la première colonne, vous attendre à recevoir une notification du type répertorié dans la deuxième colonne si vous avez enregistré pour ce type de l’objet figurant dans la troisième colonne.</span><span class="sxs-lookup"><span data-stu-id="6a0de-121">Read the table as follows: after you perform the operation in the first column, expect to receive a notification of the type listed in the second column if you have registered for that type with the object listed in the third column.</span></span> <span data-ttu-id="6a0de-122">Par exemple, une fois que vous avez créé un dossier, vous recevrez une notification _fnevObjectCreated_ uniquement si vous avez enregistré les notifications de _fnevObjectCreated_ avec la banque de messages.</span><span class="sxs-lookup"><span data-stu-id="6a0de-122">For example, after you have created a folder, you will receive an  _fnevObjectCreated_ notification only if you have registered for  _fnevObjectCreated_ notifications with the message store.</span></span> 
  
|<span data-ttu-id="6a0de-123">**Opération**</span><span class="sxs-lookup"><span data-stu-id="6a0de-123">**Operation**</span></span>|<span data-ttu-id="6a0de-124">**Type d’événement**</span><span class="sxs-lookup"><span data-stu-id="6a0de-124">**Event type**</span></span>|<span data-ttu-id="6a0de-125">**Source de notification**</span><span class="sxs-lookup"><span data-stu-id="6a0de-125">**Advise source**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="6a0de-126">Créez un dossier</span><span class="sxs-lookup"><span data-stu-id="6a0de-126">Create a folder</span></span>  <br/> | <span data-ttu-id="6a0de-127">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="6a0de-127">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="6a0de-128">Banque de messages</span><span class="sxs-lookup"><span data-stu-id="6a0de-128">Message store</span></span>  <br/> |
|<span data-ttu-id="6a0de-129">Supprimer un dossier</span><span class="sxs-lookup"><span data-stu-id="6a0de-129">Delete a folder</span></span>  <br/> | <span data-ttu-id="6a0de-130">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="6a0de-130">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="6a0de-131">Banque de messages dossier supprimés</span><span class="sxs-lookup"><span data-stu-id="6a0de-131">Message store Deleted folder</span></span>  <br/> |
|<span data-ttu-id="6a0de-132">Déplacer un dossier d’un dossier à un autre</span><span class="sxs-lookup"><span data-stu-id="6a0de-132">Move a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="6a0de-133">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="6a0de-133">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="6a0de-134">Dossier de déplacement de banque de messages</span><span class="sxs-lookup"><span data-stu-id="6a0de-134">Message store Moved folder</span></span>  <br/> |
|<span data-ttu-id="6a0de-135">Copier un dossier d’un dossier à un autre</span><span class="sxs-lookup"><span data-stu-id="6a0de-135">Copy a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="6a0de-136">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="6a0de-136">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="6a0de-137">Message stocker et copié le dossier (aucune notification _fnevObjectCreated_ envoyé pour la nouvelle copie du dossier)</span><span class="sxs-lookup"><span data-stu-id="6a0de-137">Message store and copied folder (no  _fnevObjectCreated_ notification sent for the new copy of the folder)</span></span>  <br/> |
|<span data-ttu-id="6a0de-138">Modifier une propriété de dossier calculé (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6a0de-138">Change in a computed folder property (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> | <span data-ttu-id="6a0de-139">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="6a0de-139">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="6a0de-140">Banque de messages dossier Changed (aucune notification au dossier parent)</span><span class="sxs-lookup"><span data-stu-id="6a0de-140">Message store Changed folder (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="6a0de-141">Créer un message</span><span class="sxs-lookup"><span data-stu-id="6a0de-141">Create a message</span></span>  <br/> | <span data-ttu-id="6a0de-142">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="6a0de-142">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="6a0de-143">Banque de messages</span><span class="sxs-lookup"><span data-stu-id="6a0de-143">Message store</span></span>  <br/> |
|<span data-ttu-id="6a0de-144">Supprimer un message, entraînant une modification dans l’objet parent **PR_CONTENT_COUNT** , propriété du folder</span><span class="sxs-lookup"><span data-stu-id="6a0de-144">Delete a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="6a0de-145">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="6a0de-145">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="6a0de-146">Banque de messages supprimés message</span><span class="sxs-lookup"><span data-stu-id="6a0de-146">Message store Deleted message</span></span>  <br/> |
|<span data-ttu-id="6a0de-147">Déplacer un message d’un dossier à un autre</span><span class="sxs-lookup"><span data-stu-id="6a0de-147">Move a message from one folder to another</span></span>  <br/> | <span data-ttu-id="6a0de-148">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="6a0de-148">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="6a0de-149">Message de déplacement de banque de messages</span><span class="sxs-lookup"><span data-stu-id="6a0de-149">Message store Moved message</span></span>  <br/> |
|<span data-ttu-id="6a0de-150">Copier un message d’un dossier à un autre</span><span class="sxs-lookup"><span data-stu-id="6a0de-150">Copy a message from one folder to another</span></span>  <br/> | <span data-ttu-id="6a0de-151">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="6a0de-151">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="6a0de-152">Banque de messages copiés message (aucun _fnevObjectCreated_ notification de la nouvelle copie du message)</span><span class="sxs-lookup"><span data-stu-id="6a0de-152">Message store Copied message (No  _fnevObjectCreated_ notification for new copy of the message)</span></span>  <br/> |
|<span data-ttu-id="6a0de-153">Enregistrer un message, entraînant une modification dans l’objet parent **PR_CONTENT_COUNT** , propriété du folder</span><span class="sxs-lookup"><span data-stu-id="6a0de-153">Save a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="6a0de-154">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="6a0de-154">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="6a0de-155">Banque de messages sur le premier enregistrement uniquement</span><span class="sxs-lookup"><span data-stu-id="6a0de-155">Message store on first save only</span></span>  <br/> |
|<span data-ttu-id="6a0de-156">Enregistrer un message</span><span class="sxs-lookup"><span data-stu-id="6a0de-156">Save a message</span></span>  <br/> | <span data-ttu-id="6a0de-157">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="6a0de-157">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="6a0de-158">Banque de messages sur enregistre après le premier enregistrement Changed message (aucune notification au dossier parent)</span><span class="sxs-lookup"><span data-stu-id="6a0de-158">Message store on saves after the first save Changed message (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="6a0de-159">Effectuer une opération de recherche</span><span class="sxs-lookup"><span data-stu-id="6a0de-159">Complete a search operation</span></span>  <br/> | <span data-ttu-id="6a0de-160">_fnevSearchComplete_</span><span class="sxs-lookup"><span data-stu-id="6a0de-160">_fnevSearchComplete_</span></span> <br/> |<span data-ttu-id="6a0de-161">Dossier de recherche de banque de messages</span><span class="sxs-lookup"><span data-stu-id="6a0de-161">Message store Search folder</span></span>  <br/> |
|<span data-ttu-id="6a0de-162">Nouveau message</span><span class="sxs-lookup"><span data-stu-id="6a0de-162">New message</span></span>  <br/> | <span data-ttu-id="6a0de-163">_fnevNewMail_</span><span class="sxs-lookup"><span data-stu-id="6a0de-163">_fnevNewMail_</span></span> <br/> |<span data-ttu-id="6a0de-164">Banque de messages</span><span class="sxs-lookup"><span data-stu-id="6a0de-164">Message store</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="6a0de-165">Lorsque vous recevez une notification de l’objet modifié, n’oubliez pas que la partie de tableau de balise de propriété de la structure [OBJECT_NOTIFICATION](object_notification.md) désignée par le paramètre _lpNotifications_ dans l’appel de **OnNotify** peut ou ne peut pas être NULL.</span><span class="sxs-lookup"><span data-stu-id="6a0de-165">When you receive an object modified notification, remember that the property tag array portion of the [OBJECT_NOTIFICATION](object_notification.md) structure pointed to by the  _lpNotifications_ parameter in the **OnNotify** call may or may not be NULL.</span></span> <span data-ttu-id="6a0de-166">Fournisseurs de banque de messages ne sont pas nécessaire à insérer des informations sur la propriété dans ce tableau plus mais pas.</span><span class="sxs-lookup"><span data-stu-id="6a0de-166">Message store providers are not required to insert property information in this array and most do not.</span></span> <span data-ttu-id="6a0de-167">Assurez-vous que votre méthode **OnNotify** peut gérer le cas où le pointeur _lpPropTagArray_ est NULL.</span><span class="sxs-lookup"><span data-stu-id="6a0de-167">Make sure your **OnNotify** method can handle the case where the  _lpPropTagArray_ pointer is NULL.</span></span> 
  
<span data-ttu-id="6a0de-168">Pour la plupart, si pas toutes les notifications d’objet, mettre à jour l’affichage de l’ou les dossiers concernés.</span><span class="sxs-lookup"><span data-stu-id="6a0de-168">For most, if not all object notifications, update the view of the affected folder or folders.</span></span>
  

