---
title: Gestion des notifications de la banque de messages
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3e0cc2f9-a88d-4cec-bef5-b60f2ec80f1c
description: Dernière modification le 9 mars 2015
ms.openlocfilehash: d370603dc7cfc015fe7b2757d1cf0525b3092c5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428024"
---
# <a name="handling-message-store-notification"></a><span data-ttu-id="4dbc5-103">Gestion des notifications de la banque de messages</span><span class="sxs-lookup"><span data-stu-id="4dbc5-103">Handling message store notification</span></span>
  
<span data-ttu-id="4dbc5-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4dbc5-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4dbc5-105">Pour vous inscrire aux notifications de la boutique de messages, appelez la méthode [IMAPISession::Advise](imapisession-advise.md) ou [IMsgStore::Advise](imsgstore-advise.md) et spécifiez un identificateur d’entrée, de dossier ou de magasin de messages dans le contenu du paramètre _lpEntryID._</span><span class="sxs-lookup"><span data-stu-id="4dbc5-105">To register for message store notifications, call either the [IMAPISession::Advise](imapisession-advise.md) or [IMsgStore::Advise](imsgstore-advise.md) method and specify a message store, folder, or message entry identifier in the contents of the  _lpEntryID_ parameter.</span></span> <span data-ttu-id="4dbc5-106">Les fournisseurs de magasins de messages supportent à la fois les notifications d’objet et de table.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-106">Message store providers support both object and table notifications.</span></span> <span data-ttu-id="4dbc5-107">Que vous vous enregistriez avec des objets de magasin de messages particuliers, avec la hiérarchie de dossiers et les tables de contenu qui décrivent ces objets, ou avec les deux objets et tables dépend des notifications que vous prévoyez de voir, des appels que vous effectuez pour effectuer des opérations et de la façon dont le fournisseur de magasin de messages prend en charge la notification.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-107">Whether you register with particular message store objects, with the folder hierarchy and contents tables that describe these objects, or with both objects and tables depends on the notifications you expect to see, the calls you make to perform operations, and how the message store provider supports notification.</span></span> 
  
<span data-ttu-id="4dbc5-108">Étant donné que MAPI offre de la flexibilité dans la prise en charge des notifications par les fournisseurs, sachez que vous ne recevrez pas toujours le même type de notification en réponse à un événement particulier de la part de tous les fournisseurs de magasins de messages.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-108">Because MAPI allows flexibility in how providers support notifications, be aware that you will not always receive the same type of notification in response to a particular event from all message store providers.</span></span> <span data-ttu-id="4dbc5-109">Certains fournisseurs de magasins de messages ne supportent pas du tout les notifications.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-109">Some message store providers do not support notifications at all.</span></span> <span data-ttu-id="4dbc5-110">Pour déterminer si la boutique de messages que vous utilisez prend en charge la notification, recherchez le bit STORE_NOTIFY_OK dans sa propriété **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask).](pidtagstoresupportmask-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="4dbc5-110">To determine if the message store you are using supports notification, look for the STORE_NOTIFY_OK bit in its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="4dbc5-111">À une extrémité de la gamme des fournisseurs de magasins de messages qui supportent la notification sont les fournisseurs qui génèrent des notifications « enrichies » ; ces fournisseurs envoient des notifications descriptives pour toutes les sources de conseil enregistrées.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-111">At one end of the spectrum of message store providers that support notification are the providers that generate "rich" notifications; these providers send descriptive notifications for all registered advise sources.</span></span> <span data-ttu-id="4dbc5-112">À l’autre extrémité, les fournisseurs de magasins de messages qui supportent des notifications limitées ; ces fournisseurs envoient des notifications générales pour un nombre restreint de sources de conseil.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-112">At the other end are the message store providers that support limited notifications; these providers send general notifications for a restricted number of advise sources.</span></span> 
  
<span data-ttu-id="4dbc5-113">Par exemple, si vous copiez un message dans un dossier avec lequel vous vous êtes inscrit pour recevoir des notifications d’objet copié et de déplacé d’objet, vous pouvez recevoir ou non la notification copiée d’objet.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-113">For example, if you copy a message to a folder with which you have registered to receive both object copied and object moved notifications, you may or may not receive the object copied notification.</span></span> <span data-ttu-id="4dbc5-114">La réception ou non dépend des cas ci-après :</span><span class="sxs-lookup"><span data-stu-id="4dbc5-114">Whether or not you receive it depends on:</span></span>
  
- <span data-ttu-id="4dbc5-115">Méthode que vous avez appelée pour effectuer la copie.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-115">The method that you called to perform the copy.</span></span> <span data-ttu-id="4dbc5-116">Cela peut être [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md)ou [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="4dbc5-116">This could be [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md), or [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="4dbc5-117">Comment le fournisseur de la boutique de messages implémente la méthode de copie.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-117">How the message store provider implements the copy method.</span></span>
    
- <span data-ttu-id="4dbc5-118">Si le fournisseur de magasin de messages prend en charge les notifications copiées d’objet sur les dossiers.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-118">Whether or not the message store provider supports object copied notifications on folders.</span></span>
    
<span data-ttu-id="4dbc5-119">Étant donné qu’il n’existe aucune directive stricte décrivent comment implémenter la notification d’événement pour les fournisseurs de magasins de messages, les clients ne peuvent pas s’attendre à un comportement cohérent.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-119">Because there are no strict guidelines that describe how to implement event notification for message store providers, clients cannot expect consistent behavior.</span></span> <span data-ttu-id="4dbc5-120">MAPI fait des recommandations sur la façon dont les fournisseurs de magasins de messages implémentent la notification d’événement et le tableau suivant décrit ces recommandations.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-120">MAPI does make recommendations as to how message store providers implement event notification and the following table outlines these recommendations.</span></span> <span data-ttu-id="4dbc5-121">Lisez le tableau comme suit : après avoir effectué l’opération dans la première colonne, attendez-vous à recevoir une notification du type répertorié dans la deuxième colonne si vous vous êtes inscrit pour ce type avec l’objet répertorié dans la troisième colonne.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-121">Read the table as follows: after you perform the operation in the first column, expect to receive a notification of the type listed in the second column if you have registered for that type with the object listed in the third column.</span></span> <span data-ttu-id="4dbc5-122">Par exemple, une fois que vous avez créé un dossier, vous recevrez une notification  _fnevObjectCreated_ uniquement si vous vous êtes inscrit aux notifications  _fnevObjectCreated_ dans la magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-122">For example, after you have created a folder, you will receive an  _fnevObjectCreated_ notification only if you have registered for  _fnevObjectCreated_ notifications with the message store.</span></span> 
  
|<span data-ttu-id="4dbc5-123">**Opération**</span><span class="sxs-lookup"><span data-stu-id="4dbc5-123">**Operation**</span></span>|<span data-ttu-id="4dbc5-124">**Type d’événement**</span><span class="sxs-lookup"><span data-stu-id="4dbc5-124">**Event type**</span></span>|<span data-ttu-id="4dbc5-125">**Source de conseil**</span><span class="sxs-lookup"><span data-stu-id="4dbc5-125">**Advise source**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="4dbc5-126">Créer un dossier</span><span class="sxs-lookup"><span data-stu-id="4dbc5-126">Create a folder</span></span>  <br/> | <span data-ttu-id="4dbc5-127">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-127">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="4dbc5-128">Magasin de messages</span><span class="sxs-lookup"><span data-stu-id="4dbc5-128">Message store</span></span>  <br/> |
|<span data-ttu-id="4dbc5-129">Supprimer un dossier</span><span class="sxs-lookup"><span data-stu-id="4dbc5-129">Delete a folder</span></span>  <br/> | <span data-ttu-id="4dbc5-130">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-130">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="4dbc5-131">Dossier supprimé de la boutique de messages</span><span class="sxs-lookup"><span data-stu-id="4dbc5-131">Message store Deleted folder</span></span>  <br/> |
|<span data-ttu-id="4dbc5-132">Déplacer un dossier d’un dossier vers un autre</span><span class="sxs-lookup"><span data-stu-id="4dbc5-132">Move a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="4dbc5-133">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-133">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="4dbc5-134">Dossier déplacé de la boutique de messages</span><span class="sxs-lookup"><span data-stu-id="4dbc5-134">Message store Moved folder</span></span>  <br/> |
|<span data-ttu-id="4dbc5-135">Copier un dossier d’un dossier vers un autre</span><span class="sxs-lookup"><span data-stu-id="4dbc5-135">Copy a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="4dbc5-136">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-136">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="4dbc5-137">Magasin de messages et dossier copié (aucune notification  _fnevObjectCreated_ envoyée pour la nouvelle copie du dossier)</span><span class="sxs-lookup"><span data-stu-id="4dbc5-137">Message store and copied folder (no  _fnevObjectCreated_ notification sent for the new copy of the folder)</span></span>  <br/> |
|<span data-ttu-id="4dbc5-138">Modification dans une propriété de dossier calculée (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4dbc5-138">Change in a computed folder property (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> | <span data-ttu-id="4dbc5-139">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-139">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="4dbc5-140">Dossier modifié de la boutique de messages (aucune notification au dossier parent)</span><span class="sxs-lookup"><span data-stu-id="4dbc5-140">Message store Changed folder (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="4dbc5-141">Créer un message</span><span class="sxs-lookup"><span data-stu-id="4dbc5-141">Create a message</span></span>  <br/> | <span data-ttu-id="4dbc5-142">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-142">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="4dbc5-143">Magasin de messages</span><span class="sxs-lookup"><span data-stu-id="4dbc5-143">Message store</span></span>  <br/> |
|<span data-ttu-id="4dbc5-144">Supprimer un message, entraînant une modification de la propriété de PR_CONTENT_COUNT **parent**</span><span class="sxs-lookup"><span data-stu-id="4dbc5-144">Delete a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="4dbc5-145">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-145">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="4dbc5-146">Message supprimé de la boutique de messages</span><span class="sxs-lookup"><span data-stu-id="4dbc5-146">Message store Deleted message</span></span>  <br/> |
|<span data-ttu-id="4dbc5-147">Déplacer un message d’un dossier vers un autre</span><span class="sxs-lookup"><span data-stu-id="4dbc5-147">Move a message from one folder to another</span></span>  <br/> | <span data-ttu-id="4dbc5-148">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-148">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="4dbc5-149">Message déplacé de la boutique de messages</span><span class="sxs-lookup"><span data-stu-id="4dbc5-149">Message store Moved message</span></span>  <br/> |
|<span data-ttu-id="4dbc5-150">Copier un message d’un dossier vers un autre</span><span class="sxs-lookup"><span data-stu-id="4dbc5-150">Copy a message from one folder to another</span></span>  <br/> | <span data-ttu-id="4dbc5-151">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-151">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="4dbc5-152">Message stocké dans un message copié (aucune notification  _fnevObjectCreated_ pour la nouvelle copie du message)</span><span class="sxs-lookup"><span data-stu-id="4dbc5-152">Message store Copied message (No  _fnevObjectCreated_ notification for new copy of the message)</span></span>  <br/> |
|<span data-ttu-id="4dbc5-153">Enregistrer un message, entraînant une modification de la propriété PR_CONTENT_COUNT dossier **parent**</span><span class="sxs-lookup"><span data-stu-id="4dbc5-153">Save a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="4dbc5-154">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-154">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="4dbc5-155">Magasin de messages lors du premier sauvegarde uniquement</span><span class="sxs-lookup"><span data-stu-id="4dbc5-155">Message store on first save only</span></span>  <br/> |
|<span data-ttu-id="4dbc5-156">Enregistrer un message</span><span class="sxs-lookup"><span data-stu-id="4dbc5-156">Save a message</span></span>  <br/> | <span data-ttu-id="4dbc5-157">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-157">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="4dbc5-158">Message store on saves after the first save Changed message (No notification to parent folder)</span><span class="sxs-lookup"><span data-stu-id="4dbc5-158">Message store on saves after the first save Changed message (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="4dbc5-159">Effectuer une opération de recherche</span><span class="sxs-lookup"><span data-stu-id="4dbc5-159">Complete a search operation</span></span>  <br/> | <span data-ttu-id="4dbc5-160">_fnevSearchComplete_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-160">_fnevSearchComplete_</span></span> <br/> |<span data-ttu-id="4dbc5-161">Dossier de recherche de la boutique de messages</span><span class="sxs-lookup"><span data-stu-id="4dbc5-161">Message store Search folder</span></span>  <br/> |
|<span data-ttu-id="4dbc5-162">Nouveau message</span><span class="sxs-lookup"><span data-stu-id="4dbc5-162">New message</span></span>  <br/> | <span data-ttu-id="4dbc5-163">_fnevNewMail_</span><span class="sxs-lookup"><span data-stu-id="4dbc5-163">_fnevNewMail_</span></span> <br/> |<span data-ttu-id="4dbc5-164">Magasin de messages</span><span class="sxs-lookup"><span data-stu-id="4dbc5-164">Message store</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="4dbc5-165">Lorsque vous recevez une notification de modification d’objet, n’oubliez pas que la partie tableau de balises de propriété de la structure [OBJECT_NOTIFICATION](object_notification.md) pointée par le paramètre  _lpNotifications_ dans l’appel **OnNotify** peut ou non être NULL.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-165">When you receive an object modified notification, remember that the property tag array portion of the [OBJECT_NOTIFICATION](object_notification.md) structure pointed to by the  _lpNotifications_ parameter in the **OnNotify** call may or may not be NULL.</span></span> <span data-ttu-id="4dbc5-166">Les fournisseurs de magasins de messages ne sont pas obligés d’insérer des informations de propriété dans ce tableau et la plupart d’entre eux ne le font pas.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-166">Message store providers are not required to insert property information in this array and most do not.</span></span> <span data-ttu-id="4dbc5-167">Assurez-vous **que votre méthode OnNotify** peut gérer le cas où le pointeur  _lpPropTagArray_ est NULL.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-167">Make sure your **OnNotify** method can handle the case where the  _lpPropTagArray_ pointer is NULL.</span></span> 
  
<span data-ttu-id="4dbc5-168">Pour la plupart, si ce n’est toutes les notifications d’objet, mettez à jour l’affichage du ou des dossiers affectés.</span><span class="sxs-lookup"><span data-stu-id="4dbc5-168">For most, if not all object notifications, update the view of the affected folder or folders.</span></span>
  

