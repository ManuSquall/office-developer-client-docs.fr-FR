---
title: Gestion d’un message entrant
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d45d5ed9-41cd-4aaf-91d2-1e4a27bb16d4
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: d6ec40005683cc67c51a63d6b186c042c8e170d7
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22568174"
---
# <a name="handling-an-incoming-message"></a><span data-ttu-id="33086-103">Gestion d’un message entrant</span><span class="sxs-lookup"><span data-stu-id="33086-103">Handling an incoming message</span></span>

<span data-ttu-id="33086-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="33086-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="33086-105">Un message entrant est un message qui a été envoyé entre un ou plusieurs systèmes de messagerie.</span><span class="sxs-lookup"><span data-stu-id="33086-105">An incoming message is a message that has been sent across one or more messaging systems.</span></span> <span data-ttu-id="33086-106">Il peut avoir envoyé qu’à vous ou à plusieurs autres destinataires.</span><span class="sxs-lookup"><span data-stu-id="33086-106">It may have been sent only to you or to many other recipients.</span></span> <span data-ttu-id="33086-107">Les messages entrants sont placés dans un dossier de réception conçu pour stocker les messages d’une classe particulière.</span><span class="sxs-lookup"><span data-stu-id="33086-107">Incoming messages are placed in a receive folder designated to hold messages of a particular class.</span></span> <span data-ttu-id="33086-108">Vous pouvez configurer un autre dossier pour chaque classe de message que vous gérez ou utilisez un dossier pour toutes les classes de réception.</span><span class="sxs-lookup"><span data-stu-id="33086-108">You can set up a different receive folder for each message class that you handle or use one folder for all of the classes.</span></span>
  
<span data-ttu-id="33086-109">Si vous êtes inscrit pour les notifications de nouveau courrier avec la banque d’informations, vous serez averti chaque fois qu’un message est placé dans un dossier de réception.</span><span class="sxs-lookup"><span data-stu-id="33086-109">If you have registered for new mail notifications with the message store, you will be notified whenever a message is placed in a receive folder.</span></span> <span data-ttu-id="33086-110">Si vous n’avez pas enregistré pour les notifications de nouveau courrier, vous devez ouvrir le dossier régulièrement pour vérifier manuellement l’arrivée de nouveaux messages de réception.</span><span class="sxs-lookup"><span data-stu-id="33086-110">If you have not registered for new mail notifications, you must open the appropriate receive folder periodically to manually check for the arrival of new messages.</span></span>
  
<span data-ttu-id="33086-111">Clients s’inscrire pour les notifications de nouveau courrier en définissant les paramètres pour [IMsgStore::Advise](imsgstore-advise.md) comme suit :</span><span class="sxs-lookup"><span data-stu-id="33086-111">Clients register for new mail notifications by setting the parameters to [IMsgStore::Advise](imsgstore-advise.md) as follows:</span></span> 
  
- <span data-ttu-id="33086-112">Définissez _cbEntryID_ sur 0.</span><span class="sxs-lookup"><span data-stu-id="33086-112">Set  _cbEntryID_ to 0.</span></span> 
    
- <span data-ttu-id="33086-113">_LpEntryID_ la valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="33086-113">Set  _lpEntryID_ to NULL.</span></span> 
    
- <span data-ttu-id="33086-114">La valeur _ulEventMask_ fnevNewMail.</span><span class="sxs-lookup"><span data-stu-id="33086-114">Set  _ulEventMask_ to fnevNewMail.</span></span> 
    
<span data-ttu-id="33086-115">Le paramètre _lpNotifications_ dans l’appel à la méthode **IMAPIAdviseSink::OnNotify** pointe vers un **NEWMAIL\_NOTIFICATION** structure qui contient des informations sur le message entrant, telles que sa classe de message, son entrée identificateur de l’identificateur d’entrée de son dossier parent et le contenu de sa propriété **PR_MESSAGE_FLAGS** .</span><span class="sxs-lookup"><span data-stu-id="33086-115">The  _lpNotifications_ parameter in the call to your **IMAPIAdviseSink::OnNotify** method points to a **NEWMAIL\_NOTIFICATION** structure that contains information about the incoming message, such as its message class, its entry identifier, the entry identifier of its parent folder, and the contents of its **PR_MESSAGE_FLAGS** property.</span></span> <span data-ttu-id="33086-116">Pour plus d’informations sur l’enregistrement pour et gestion des notifications, voir [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) et [Gestion des Notifications](handling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="33086-116">For more information about registering for and handling notifications, see [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)), and [Handling Notifications](handling-notifications.md).</span></span> 
  
<span data-ttu-id="33086-117">Avant d’afficher un message entrant à un utilisateur, déterminez si sa classe de message est une classe qui prend en charge de votre client.</span><span class="sxs-lookup"><span data-stu-id="33086-117">Before displaying an incoming message to a user, determine if its message class is a class that your client supports.</span></span> <span data-ttu-id="33086-118">Si ce n’est pas le cas, ignorez le message.</span><span class="sxs-lookup"><span data-stu-id="33086-118">If not, ignore the message.</span></span> <span data-ttu-id="33086-119">Si la classe est pris en charge, vous pouvez ouvrir et afficher le message avec un formulaire qui est approprié pour la classe de message du message.</span><span class="sxs-lookup"><span data-stu-id="33086-119">If the class is one that you support, you can open and display the message with a form that is appropriate for the message class of the message.</span></span> <span data-ttu-id="33086-120">Le choix de formulaires est basé sur la classe de message.</span><span class="sxs-lookup"><span data-stu-id="33086-120">The choice of forms is based on message class.</span></span> <span data-ttu-id="33086-121">Les messages qui appartiennent à la classe IPM utiliser un formulaire par défaut implémenté par MAPI.</span><span class="sxs-lookup"><span data-stu-id="33086-121">Messages that belong to the IPM class use a default form implemented by MAPI.</span></span> <span data-ttu-id="33086-122">Les messages qui appartiennent à des classes personnalisées définies par les clients peuvent utiliser pour les formulaires spécialisés défini par le client ou le formulaire par défaut MAPI.</span><span class="sxs-lookup"><span data-stu-id="33086-122">Messages that belong to custom classes defined by clients can use either client-defined specialized forms or the MAPI default form.</span></span>
  
## <a name="open-and-display-an-incoming-message"></a><span data-ttu-id="33086-123">Ouvrir et afficher un message entrant</span><span class="sxs-lookup"><span data-stu-id="33086-123">Open and display an incoming message</span></span>
  
1. <span data-ttu-id="33086-124">Appelez **IMsgStore::GetReceiveFolder** pour récupérer l’identificateur d’entrée du dossier de réception pour la classe de message du message et le secret de cet identificateur d’entrée pour **IMsgStore::OpenEntry** pour ouvrir le dossier.</span><span class="sxs-lookup"><span data-stu-id="33086-124">Call **IMsgStore::GetReceiveFolder** to retrieve the entry identifier of the receive folder for the message class of the message and pass this entry identifier to **IMsgStore::OpenEntry** to open the folder.</span></span> <span data-ttu-id="33086-125">Pour plus d’informations, voir [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore::OpenEntry](imsgstore-openentry.md)et [l’ouverture d’un dossier de la banque de messages](opening-a-message-store-folder.md).</span><span class="sxs-lookup"><span data-stu-id="33086-125">For more information, see [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore::OpenEntry](imsgstore-openentry.md), and [Opening a Message Store Folder](opening-a-message-store-folder.md).</span></span>
    
2. <span data-ttu-id="33086-126">Appelez la méthode de **IMAPIContainer::GetContentsTable** de réception du dossier pour récupérer la table des matières.</span><span class="sxs-lookup"><span data-stu-id="33086-126">Call the receive folder's **IMAPIContainer::GetContentsTable** method to retrieve its contents table.</span></span> <span data-ttu-id="33086-127">Pour plus d’informations, voir [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span><span class="sxs-lookup"><span data-stu-id="33086-127">For more information, see [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span></span> <span data-ttu-id="33086-128">Appelez la méthode la table **IMAPITable::QueryRows** pour récupérer toutes les lignes dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="33086-128">Call the table's **IMAPITable::QueryRows** method to retrieve all the rows in the table.</span></span> <span data-ttu-id="33086-129">Pour plus d’informations, voir [IMAPITable::QueryRows](imapitable-queryrows.md) et les [Tables des matières](contents-tables.md).</span><span class="sxs-lookup"><span data-stu-id="33086-129">For more information see [IMAPITable::QueryRows](imapitable-queryrows.md) and [Contents Tables](contents-tables.md).</span></span> <span data-ttu-id="33086-130">Pour plus d’informations sur l’affichage d’une table des matières, voir [affichage d’une Table de contenu de dossier](displaying-a-folder-contents-table.md).</span><span class="sxs-lookup"><span data-stu-id="33086-130">For more information about displaying a contents table, see [Displaying a Folder Contents Table](displaying-a-folder-contents-table.md).</span></span>
    
3. <span data-ttu-id="33086-131">Si votre client est interactive, autorise l’utilisateur à sélectionner un message dans la table et de déterminer le formulaire à utiliser pour afficher ce message.</span><span class="sxs-lookup"><span data-stu-id="33086-131">If your client is interactive, allow the user to select a message from the table and determine the form to be used to display that message.</span></span> <span data-ttu-id="33086-132">Clients peuvent utiliser le formulaire par défaut fourni par MAPI ou d’un formulaire personnalisé.</span><span class="sxs-lookup"><span data-stu-id="33086-132">Clients can use the default form provided by MAPI or a custom form.</span></span> <span data-ttu-id="33086-133">Pour plus d’informations, voir [Gestion des formulaires MAPI](handling-mapi-forms.md).</span><span class="sxs-lookup"><span data-stu-id="33086-133">For more information, see [Handling MAPI Forms](handling-mapi-forms.md).</span></span>
    
4. <span data-ttu-id="33086-134">Appelez **IMsgStore::OpenEntry** pour ouvrir le message.</span><span class="sxs-lookup"><span data-stu-id="33086-134">Call **IMsgStore::OpenEntry** to open the message.</span></span> <span data-ttu-id="33086-135">Pour plus d’informations, consultez [ouverture d’un Message](opening-a-message.md).</span><span class="sxs-lookup"><span data-stu-id="33086-135">For more information, see [Opening a Message](opening-a-message.md).</span></span>
    
5. <span data-ttu-id="33086-136">Traiter le texte du message.</span><span class="sxs-lookup"><span data-stu-id="33086-136">Process the message text.</span></span> <span data-ttu-id="33086-137">Pour plus d’informations, voir [L’ouverture du message](opening-message-text.md).</span><span class="sxs-lookup"><span data-stu-id="33086-137">For more information, see [Opening Message Text](opening-message-text.md).</span></span>
    
6. <span data-ttu-id="33086-138">Rendu de chacune des pièces jointes des messages.</span><span class="sxs-lookup"><span data-stu-id="33086-138">Render each of the message attachments.</span></span> <span data-ttu-id="33086-139">Pour plus d’informations, voir [rendu d’une pièce jointe en texte brut](rendering-an-attachment-in-plain-text.md) ou le [rendu d’une pièce jointe dans le texte RTF](rendering-an-attachment-in-rtf-text.md).</span><span class="sxs-lookup"><span data-stu-id="33086-139">For more information, see [Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md) or [Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md).</span></span>
    
7. <span data-ttu-id="33086-140">Ouvrez une pièce jointe si vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="33086-140">Open an attachment if desired.</span></span> <span data-ttu-id="33086-141">Pour plus d’informations, voir [l’ouverture d’une pièce jointe](opening-an-attachment.md).</span><span class="sxs-lookup"><span data-stu-id="33086-141">For more information see [Opening an Attachment](opening-an-attachment.md).</span></span>
    
## <a name="in-this-section"></a><span data-ttu-id="33086-142">Dans cette section</span><span class="sxs-lookup"><span data-stu-id="33086-142">In this section</span></span>

- <span data-ttu-id="33086-143">[Texte du Message d’ouverture](opening-message-text.md): décrit comment ouvrir le texte du message.</span><span class="sxs-lookup"><span data-stu-id="33086-143">[Opening Message Text](opening-message-text.md): Describes how to open the message text.</span></span>
    
- <span data-ttu-id="33086-144">[Rendu d’une pièce jointe en texte brut](rendering-an-attachment-in-plain-text.md): décrit comment afficher une pièce jointe en texte brut.</span><span class="sxs-lookup"><span data-stu-id="33086-144">[Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md): Describes how to render an attachment in plain text.</span></span>
    
- <span data-ttu-id="33086-145">[Rendu d’une pièce jointe dans le texte RTF](rendering-an-attachment-in-rtf-text.md): décrit comment afficher une pièce jointe dans le texte mis en forme.</span><span class="sxs-lookup"><span data-stu-id="33086-145">[Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md): Describes how to render an attachment in formatted text.</span></span>
    
- <span data-ttu-id="33086-146">[L’ouverture d’une pièce jointe](opening-an-attachment.md): décrit comment ouvrir une pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="33086-146">[Opening an Attachment](opening-an-attachment.md): Describes how to open an attachment.</span></span>
    

