---
title: Sessions MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c5a7c137-393e-40ff-a2b9-afe02da2435a
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: 45dc993c337249ed7d4dffbd5324267de82981d0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19784705"
---
# <a name="mapi-sessions"></a><span data-ttu-id="40fd6-103">Sessions MAPI</span><span class="sxs-lookup"><span data-stu-id="40fd6-103">MAPI sessions</span></span>

<span data-ttu-id="40fd6-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="40fd6-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="40fd6-105">Avant que l'application cliente peut appeler un syst�me de messagerie sous-jacent, il doit �tablir une connexion avec le sous-syst�me MAPI ou session.</span><span class="sxs-lookup"><span data-stu-id="40fd6-105">Before the client application can call an underlying messaging system, it must establish a session, or connection, with the MAPI subsystem.</span></span>
  
<span data-ttu-id="40fd6-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span><span class="sxs-lookup"><span data-stu-id="40fd6-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span></span> 
  
<span data-ttu-id="40fd6-p102">Configuration du service de message est un des �l�ments plus importants du processus d'ouverture de session. Le profil est la source initiale pour les informations de configuration. Si les informations d'un service de message particulier sont absent, le processus d'ouverture de session tente de demander � l'utilisateur de lui. Cela n'est pas toujours r�ussie pour deux raisons : tout d'abord, inviter l'utilisateur requiert l'affichage d'une bo�te de dialogue. Il est possible pour les clients pour ne pas autoriser l'affichage de l'interface utilisateur en passant un indicateur � l'appel d'ouverture de session. Deuxi�mement, l'utilisateur peut annuler la bo�te de dialogue avant de pouvoir ajouter les informations n�cessaires.</span><span class="sxs-lookup"><span data-stu-id="40fd6-p102">Message service configuration is one of the most important parts of the logon process. The profile is the initial source for configuration information. If information for a particular message service is missing, the logon process tries to prompt the user to supply it. This is not always successful for two reasons: First, prompting the user requires the display of a dialog box. It is possible for clients to disallow the display of a user interface by passing a flag into the logon call. Second, the user could cancel the dialog box before the needed information can be added.</span></span>
  
<span data-ttu-id="40fd6-p103">Lorsqu'un processus d'ouverture de session �choue une fois, l'utilisateur est inform� de l'�chec et la possibilit� de recommencer ou corriger la condition d'erreur. Une fois encore, une interface utilisateur s'affichera, si le client lui permet, et l'utilisateur sera invit� � entrer les donn�es sont manquantes. Si ce bloc try deuxi�me �choue, MAPI d�sactive tous les fournisseurs de service dans le service de message pour la dur�e de la session. En effet, le service de l'ensemble du message est d�sactiv�. Cela signifie qu'aucun des fournisseurs de service dans le service de message peuvent travailler. Cette op�ration est effectu�e, car si le fournisseur d'un �chec d'ouverture de session, les autres fournisseurs g�n�ralement �galement �chouent. Le processus d'ouverture de session peut �chouer en raison d'un chemin d'acc�s non valide pour une ressource n�cessaire, une version incompatible de MAPI, un serveur de messagerie non disponible ou corruption des donn�es.</span><span class="sxs-lookup"><span data-stu-id="40fd6-p103">When a logon process fails one time, the user is informed of the failure and given the chance to retry or correct the error condition. Once again, a user interface will be displayed, if the client allows it, and the user will be prompted to enter whatever data is missing. If this second try is unsuccessful, MAPI disables all service providers in the message service for the duration of the session. In effect, the whole message service is disabled. This means that none of the service providers in the message service can work. This is done because if one provider fails logon, the other providers usually also fail. The logon process can fail due to an invalid path for a necessary resource, an incompatible version of MAPI, an unavailable messaging server, or data corruption.</span></span> 
  
<span data-ttu-id="40fd6-p104">Les clients peuvent sp�cifier un des deux types de sessions �tablies lors de l'appel d'ouverture de session : une session individuelle ou une session partag�e. Sessions individuelles sont les connexions priv�es ; Il existe une relation entre une application cliente et la session qu'il utilise. Par cons�quent, les applications clientes qui partagent une session �galement en partager un profil. Les sessions partag�es sont �tablies une seule fois, mais peuvent �tre utilis�es par d'autres applications client ayant besoin d'utiliser leur. Le profil et les informations d'identification sont sp�cifi�es uniquement avec les param�tres de connexion initiale.</span><span class="sxs-lookup"><span data-stu-id="40fd6-p104">Clients can specify one of two types of sessions to be established in the logon call: an individual session or a shared session. Individual sessions are private connections; there is a one-to-one relationship between a client application and the session it is using. As a consequence, client applications that share a session also share a profile. Shared sessions are established once but can be used by other client applications that need to use them. The profile and credentials are specified only with the initial logon.</span></span> 
  
<span data-ttu-id="40fd6-p105">Clients peuvent ouvrir une session plusieurs fois en tant que le m�me utilisateur ou plusieurs utilisateurs. MAPI n'emp�che pas cela. Certains fournisseurs de services, cependant, peuvent ne pas �tre aussi souples, renvoient la valeur d'erreur MAPI_E_SESSION_LIMIT lors de tentatives de connexion ult�rieures. Fournisseurs de services avec des restrictions de mat�riel sous-jacent peuvent �tre n�cessaire pour appliquer une limite de session.</span><span class="sxs-lookup"><span data-stu-id="40fd6-p105">Clients can log on multiple times as the same user or as multiple users. MAPI does not prevent this. Some service providers, however, might not be as flexible, returning the error value MAPI_E_SESSION_LIMIT on subsequent logon attempts. Service providers with underlying hardware limitations can be required to enforce a session limit.</span></span>
  
<span data-ttu-id="40fd6-p106">Les appels de fonction permettant d'�tablir une session poss�dent une collection de param�tres et des indicateurs qui contr�lent la cr�ation de la session. Le client sp�cifie un nom de profil facultatif et un handle de fen�tre qui sert � la fen�tre parent pour toutes les bo�tes de dialogue qui s'affichent. Les indicateurs incluent MAPI_NEW_SESSION, qui demande une nouvelle session individuelle (plut�t qu'une session partag�e) �tablis, et l'indicateur d'interface utilisateur MAPI_LOGON_UI. L'indicateur d'interface utilisateur est d�finie pour demander une bo�te de dialogue d'ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="40fd6-p106">The function calls for establishing a session have a collection of flags and parameters that control how the session is created. The client specifies an optional profile name and a window handle that acts as the parent window for any dialog boxes that are displayed. The flags include MAPI_NEW_SESSION, which requests that a new, individual session (rather than a shared session) be established, and the MAPI_LOGON_UI user interface flag. The user interface flag is set to request a logon dialog box.</span></span>
  
<span data-ttu-id="40fd6-136">L'illustration suivante montre comment ces param�tres et des indicateurs diff�rents �tablissent une session MAPI.</span><span class="sxs-lookup"><span data-stu-id="40fd6-136">The following illustration shows how these various parameters and flags establish a MAPI session.</span></span>
  
<span data-ttu-id="40fd6-137">**Diagramme de flux de session�MAPI**</span><span class="sxs-lookup"><span data-stu-id="40fd6-137">**MAPI session flowchart**</span></span>
  
<span data-ttu-id="40fd6-138">![Organigramme de session MAPI] (media/amapi_47.gif "Organigramme de session MAPI")</span><span class="sxs-lookup"><span data-stu-id="40fd6-138">![MAPI session flowchart](media/amapi_47.gif "MAPI session flowchart")</span></span>
  
<span data-ttu-id="40fd6-139">For information about handling sessions from within a client application, see [Gestion de Session MAPI](mapi-session-handling.md)</span><span class="sxs-lookup"><span data-stu-id="40fd6-139">For information about handling sessions from within a client application, see [MAPI Session Handling](mapi-session-handling.md)</span></span>
  
## <a name="see-also"></a><span data-ttu-id="40fd6-140">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="40fd6-140">See also</span></span>

- [<span data-ttu-id="40fd6-141">MAPILogonEx</span><span class="sxs-lookup"><span data-stu-id="40fd6-141">MAPILogonEx</span></span>](mapilogonex.md)  
- [<span data-ttu-id="40fd6-142">IMAPISession : IUnknown</span><span class="sxs-lookup"><span data-stu-id="40fd6-142">IMAPISession : IUnknown</span></span>](imapisessioniunknown.md)
- [<span data-ttu-id="40fd6-143">Gestion de Session MAPI</span><span class="sxs-lookup"><span data-stu-id="40fd6-143">MAPI Session Handling</span></span>](mapi-session-handling.md)  
- [<span data-ttu-id="40fd6-144">Vue d'ensemble de la programmation MAPI</span><span class="sxs-lookup"><span data-stu-id="40fd6-144">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

