---
title: Envoi de Messages  T�ches du fournisseur de Transport
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bd722f48-b166-4670-8dba-897ac50caf37
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: 4625d9d09b067d064dac7ca67b7c79ebb818bcce
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19787120"
---
# <a name="sending-messages-transport-provider-tasks"></a><span data-ttu-id="29a61-103">Envoi de Messages : T�ches du fournisseur de Transport</span><span class="sxs-lookup"><span data-stu-id="29a61-103">Sending Messages: Transport Provider Tasks</span></span>

  
  
<span data-ttu-id="29a61-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="29a61-104">**Applies to**: Outlook</span></span> 
  
 <span data-ttu-id="29a61-105">**Pour transmettre un message, les fournisseurs de transport**</span><span class="sxs-lookup"><span data-stu-id="29a61-105">**To transmit a message, transport providers**</span></span>
  
- <span data-ttu-id="29a61-106">Définissez la propriété du message **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) sur TRUE une fois que le fournisseur de transport a envoyé le message ou tenté d’envoyer le message.</span><span class="sxs-lookup"><span data-stu-id="29a61-106">Set the message's **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property to TRUE after the transport provider has either sent the message or attempted to send the message.</span></span> <span data-ttu-id="29a61-107">If an attempt to send a message fails, transport providers should call [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) to generate a nondelivery report.</span><span class="sxs-lookup"><span data-stu-id="29a61-107">If an attempt to send a message fails, transport providers should call [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) to generate a nondelivery report.</span></span> <span data-ttu-id="29a61-108">Si le message est envoyé avec succès et que la propriété **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) est définie sur TRUE, créez une structure [ADRLIST](adrlist.md) contenant les destinataires réussis, la propriété **PR_DELIVER_TIME** ([PidTagDeliverTime](pidtagdelivertime-canonical-property.md)) pour chacun et appelez **StatusRecips** pour générer un rapport de remise.</span><span class="sxs-lookup"><span data-stu-id="29a61-108">If the message is sent successfully and the **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) property is set to TRUE, create an [ADRLIST](adrlist.md) structure containing the successful recipients, setting the **PR_DELIVER_TIME** ([PidTagDeliverTime](pidtagdelivertime-canonical-property.md)) property for each, and call **StatusRecips** to generate a delivery report.</span></span> <span data-ttu-id="29a61-109">For more information about creating delivery and non-delivery reports, see the following topics: [Messages de rapport MAPI](mapi-report-messages.md), [Propri�t�s de Message de rapport requis](required-report-message-properties.md), [Propri�t�s de Message d'�tat facultatives](optional-report-message-properties.md), and [Envoi de rapports de remise de Message](sending-message-delivery-reports.md).</span><span class="sxs-lookup"><span data-stu-id="29a61-109">For more information about creating delivery and non-delivery reports, see the following topics: [MAPI Report Messages](mapi-report-messages.md), [Required Report Message Properties](required-report-message-properties.md), [Optional Report Message Properties](optional-report-message-properties.md), and [Sending Message Delivery Reports](sending-message-delivery-reports.md).</span></span>
    
- <span data-ttu-id="29a61-110">D�finir le groupe de **PR_SENDER** du message de propri�t�s � l'identit� de l'utilisateur qui a ouvert une session.</span><span class="sxs-lookup"><span data-stu-id="29a61-110">Set the message's **PR_SENDER** group of properties to the identity of the user that has logged on.</span></span> <span data-ttu-id="29a61-111">Ce groupe comprend : **PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)), **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md)), **PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md)), **PR_SENDER_ADDRTYPE** ([ PidTagSenderAddressType](pidtagsenderaddresstype-canonical-property.md)) et **PR_SENDER_EMAIL_ADDRESS** ([PidTagSenderEmailAddress](pidtagsenderemailaddress-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="29a61-111">This group includes: **PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)), **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md)), **PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md)), **PR_SENDER_ADDRTYPE** ([PidTagSenderAddressType](pidtagsenderaddresstype-canonical-property.md)), and **PR_SENDER_EMAIL_ADDRESS** ([PidTagSenderEmailAddress](pidtagsenderemailaddress-canonical-property.md)).</span></span>
    
- <span data-ttu-id="29a61-p103">D�finir les propri�t�s de message **PR_SENT_REPRESENTING**, dans la mesure du possible, soit l'identit� de l'utilisateur qui a ouvert une session ou une identit� de d�l�gu� valide. Les propri�t�s **PR_SENT_REPRESENTING** sont utilis�es pour impl�menter l'envoi de messages par un utilisateur au nom d'un autre utilisateur. Fournisseurs de transport qui ne prennent pas en charge ces propri�t�s doivent ignorer les messages sortants.</span><span class="sxs-lookup"><span data-stu-id="29a61-p103">Set the message's **PR_SENT_REPRESENTING** properties, if possible, to either the identity of the user that has logged on or to a valid delegate identity. The **PR_SENT_REPRESENTING** properties are used to implement the sending of messages by one user on behalf of another user. Transport providers that do not support these properties should ignore them on outbound messages.</span></span> 
    
- <span data-ttu-id="29a61-115">Définissez la propriété du message **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) pour indiquer si le client appelé [IMessage::SubmitMessage](imessage-submitmessage.md).</span><span class="sxs-lookup"><span data-stu-id="29a61-115">Set the message's **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) property to indicate when the client called [IMessage::SubmitMessage](imessage-submitmessage.md).</span></span>
    
- <span data-ttu-id="29a61-116">Définissez la propriété du message **PR_PROVIDER_SUBMIT_TIME** ([PidTagProviderSubmitTime](pidtagprovidersubmittime-canonical-property.md)) pour indiquer la date et l’heure auxquelles le fournisseur de banque de messages a marqué le message comme ayant été envoyé.</span><span class="sxs-lookup"><span data-stu-id="29a61-116">Set the message's **PR_PROVIDER_SUBMIT_TIME** ([PidTagProviderSubmitTime](pidtagprovidersubmittime-canonical-property.md)) property to indicate the date and time that the message store provider marked the message as having been sent.</span></span> 
    
<span data-ttu-id="29a61-117">Lorsqu'un message est envoy� � plusieurs destinataires avec plusieurs syst�mes de messagerie, chaque copie transmis aura une identit� diff�rente de l'exp�diteur.</span><span class="sxs-lookup"><span data-stu-id="29a61-117">When a message is sent to a variety of recipients with several messaging systems, each transmitted copy will have a different sender identity.</span></span> 
  
<span data-ttu-id="29a61-p104">Le fournisseur de transport ou de banque de messages �troitement coupl�s et de transport est �galement responsable de la d�finition des informations de l'exp�diteur et de r�ponse. Informations de l'exp�diteur sont stock�es dans les propri�t�s **PR_ORIGINATOR** et r�pondre � des informations sont stock�es dans les propri�t�s de PR_REPLY. Le client peut d�finir ces propri�t�s ; Toutefois, le fournisseur de transport est autoris� � ignorer et remplacer les param�tres du client.</span><span class="sxs-lookup"><span data-stu-id="29a61-p104">The transport provider or tightly coupled message store and transport is also responsible for setting originator and reply-to information. Originator information is stored in the **PR_ORIGINATOR** properties and reply-to information is stored in the PR_REPLY properties. The client can set these properties; however, the transport provider is allowed to ignore and overwrite the client's settings.</span></span> 
  

