---
title: Fournisseurs de magasin d’envoi de messages à l’aide de message
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7632d784-00d8-48fd-a73b-73778efbef7f
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: e29b909e90d2767bcf1bb9382a46e6f2c1cd9f2a
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22569798"
---
# <a name="sending-messages-by-using-message-store-providers"></a><span data-ttu-id="adea3-103">Fournisseurs de magasin d’envoi de messages à l’aide de message</span><span class="sxs-lookup"><span data-stu-id="adea3-103">Sending messages by using message store providers</span></span>

<span data-ttu-id="adea3-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="adea3-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="adea3-105">Fournisseurs de banque de messages ne sont pas nécessaire pour prendre en charge les envois de messages sortants (autrement dit, la possibilité pour les applications clientes à utiliser le fournisseur de banque de messages pour envoyer des messages).</span><span class="sxs-lookup"><span data-stu-id="adea3-105">Message store providers are not required to support outgoing message submissions (that is, the ability for client applications to use the message store provider to send messages).</span></span> <span data-ttu-id="adea3-106">Applications clientes doivent utiliser une banque de messages lors de l’envoi de messages, car les données du message doivent être stockée dans un endroit entre le moment où l’utilisateur a terminé compose il et l’heure à laquelle le spouleur MAPI donne le message à un fournisseur de transport pour envoi au système de messagerie sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="adea3-106">Client applications need to use a message store while sending messages, because the message's data must be stored somewhere between the time that the user is finished composing it and the time that the MAPI spooler gives the message to a transport provider for submission to the underlying messaging system.</span></span> <span data-ttu-id="adea3-107">Si votre fournisseur de banque de messages n’accepte pas les envois de messages sortants, il ne peut être utilisé en tant que la banque de messages par défaut.</span><span class="sxs-lookup"><span data-stu-id="adea3-107">If your message store provider does not support outgoing message submissions, it cannot be used as the default message store.</span></span>
  
<span data-ttu-id="adea3-108">Pour prendre en charge d’envoi de messages, votre fournisseur de magasin de message procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="adea3-108">To support sending messages, your message store provider must do the following:</span></span>
  
- <span data-ttu-id="adea3-109">Implémenter une file d’attente de messages sortants.</span><span class="sxs-lookup"><span data-stu-id="adea3-109">Implement an outgoing message queue.</span></span>
    
- <span data-ttu-id="adea3-110">Prise en charge de la méthode [IMessage::SubmitMessage](imessage-submitmessage.md) sur les objets de message dans la banque de messages.</span><span class="sxs-lookup"><span data-stu-id="adea3-110">Support the [IMessage::SubmitMessage](imessage-submitmessage.md) method on message objects created in the message store.</span></span> 
    
- <span data-ttu-id="adea3-111">Prendre en charge les méthodes **IMsgStore** qui sont spécifiques au spouleur MAPI : [IMsgStore::FinishedMsg](imsgstore-finishedmsg.md), [IMsgStore::GetOutgoingQueue](imsgstore-getoutgoingqueue.md), [IMsgStore::NotifyNewMail](imsgstore-notifynewmail.md)et [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span><span class="sxs-lookup"><span data-stu-id="adea3-111">Support the **IMsgStore** methods that are specific to the MAPI spooler: [IMsgStore::FinishedMsg](imsgstore-finishedmsg.md), [IMsgStore::GetOutgoingQueue](imsgstore-getoutgoingqueue.md), [IMsgStore::NotifyNewMail](imsgstore-notifynewmail.md), and [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span></span>
    
<span data-ttu-id="adea3-112">La méthode **SetLockState** est importante pour l’interopérabilité appropriée entre les clients et le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="adea3-112">The **SetLockState** method is important for proper interoperation between the MAPI spooler and clients.</span></span> <span data-ttu-id="adea3-113">Lorsque le spouleur MAPI appelle **SetLockState** sur un message sortant, le fournisseur de banque de message ne doit pas permettre aux clients d’ouvrir le message.</span><span class="sxs-lookup"><span data-stu-id="adea3-113">When the MAPI spooler calls **SetLockState** on an outgoing message, the message store provider must not let clients open the message.</span></span> <span data-ttu-id="adea3-114">Si un client essaie d’ouvrir un message qui est verrouillé par le spouleur MAPI, le fournisseur de banque de message doit renvoyer MAPI_E_NO_ACCESS.</span><span class="sxs-lookup"><span data-stu-id="adea3-114">If a client does try to open a message that is locked by the MAPI spooler, the message store provider should return MAPI_E_NO_ACCESS.</span></span> <span data-ttu-id="adea3-115">L’état de verrouillage d’un message ne dispose pas être persistante en cas d’arrêt de la banque d’informations pendant que le message est verrouillé par le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="adea3-115">The locked state of a message does not have to be persistent in case the store is shut down while the message is locked by the MAPI spooler.</span></span> 
  
<span data-ttu-id="adea3-116">Quel que soit ou non le spouleur MAPI a verrouillé un message sortant, le fournisseur de banque de messages n’autorisez pas un message dans la file d’attente de message sortant pour être ouvert en écriture.</span><span class="sxs-lookup"><span data-stu-id="adea3-116">Regardless of whether the MAPI spooler has locked an outgoing message, the message store provider should not allow a message in the outgoing message queue to be opened for writing.</span></span> <span data-ttu-id="adea3-117">Si un client appelle la méthode [IMSgStore::OpenEntry](imsgstore-openentry.md) sur un message sortant avec l’indicateur ne, l’appel doit échouer et retourner MAPI_E_SUBMITTED.</span><span class="sxs-lookup"><span data-stu-id="adea3-117">If a client calls the [IMSgStore::OpenEntry](imsgstore-openentry.md) method on an outgoing message with the MAPI_MODIFY flag, the call should fail and return MAPI_E_SUBMITTED.</span></span> <span data-ttu-id="adea3-118">Si une application cliente appelle **OpenEntry** sur un message sortant avec l’indicateur MAPI_BEST_ACCESS, le fournisseur de banque de message doit autoriser l’accès en lecture seule au message.</span><span class="sxs-lookup"><span data-stu-id="adea3-118">If a client application calls **OpenEntry** on an outgoing message with the MAPI_BEST_ACCESS flag, the message store provider should allow read-only access to the message.</span></span> 
  
<span data-ttu-id="adea3-119">Lorsqu’un message doit être gérés par le spouleur MAPI, le fournisseur de banque de messages définit la propriété du message **PR_SUBMIT_FLAGS** ([PidTagSubmitFlags](pidtagsubmitflags-canonical-property.md)) sur SUBMITFLAG_LOCKED.</span><span class="sxs-lookup"><span data-stu-id="adea3-119">When a message is to be handled by the MAPI spooler, the message store provider sets the message's **PR_SUBMIT_FLAGS** ([PidTagSubmitFlags](pidtagsubmitflags-canonical-property.md)) property to SUBMITFLAG_LOCKED.</span></span> <span data-ttu-id="adea3-120">La valeur SUBMITFLAG_LOCKED indique que le spouleur MAPI a verrouillé le message pour son usage exclusif.</span><span class="sxs-lookup"><span data-stu-id="adea3-120">The SUBMITFLAG_LOCKED value indicates that the MAPI spooler has locked the message for its exclusive use.</span></span> <span data-ttu-id="adea3-121">L’autre valeur pour **PR_SUBMIT_FLAGS**, SUBMITFLAG_PREPROCESS, est définie lorsque le message nécessite un prétraitement par une ou plusieurs fonctions préprocesseur enregistrées par un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="adea3-121">The other value for **PR_SUBMIT_FLAGS**, SUBMITFLAG_PREPROCESS, is set when the message requires preprocessing by one or more preprocessor functions registered by a transport provider.</span></span>
  
<span data-ttu-id="adea3-122">Les procédures suivantes décrivent l’interagissent entre la banque de messages, de transport et spouleur MAPI pour envoyer un message à partir d’un client à un ou plusieurs destinataires.</span><span class="sxs-lookup"><span data-stu-id="adea3-122">The following procedures describe how the message store, transport, and MAPI spooler interact to send a message from a client to one or more recipients.</span></span> 
  
<span data-ttu-id="adea3-123">L’application cliente appelle la méthode [IMessage::SubmitMessage](imessage-submitmessage.md) .</span><span class="sxs-lookup"><span data-stu-id="adea3-123">The client application calls the [IMessage::SubmitMessage](imessage-submitmessage.md) method.</span></span> <span data-ttu-id="adea3-124">Dans **SubmitMessage**, le fournisseur de banque de messages effectue les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="adea3-124">In **SubmitMessage**, the message store provider does the following:</span></span>
  
1. <span data-ttu-id="adea3-125">Appelle [IMAPISupport::PrepareSubmit](imapisupport-preparesubmit.md).</span><span class="sxs-lookup"><span data-stu-id="adea3-125">Calls [IMAPISupport::PrepareSubmit](imapisupport-preparesubmit.md).</span></span> <span data-ttu-id="adea3-126">Si MAPI renvoie une erreur, le fournisseur de banque de message renvoie cette erreur au client.</span><span class="sxs-lookup"><span data-stu-id="adea3-126">If MAPI returns an error, the message store provider returns that error to the client.</span></span>
    
2. <span data-ttu-id="adea3-127">Définit le bit dans la propriété **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) du message MSGFLAG_SUBMIT.</span><span class="sxs-lookup"><span data-stu-id="adea3-127">Sets the MSGFLAG_SUBMIT bit in the **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) property of the message.</span></span>
    
3. <span data-ttu-id="adea3-128">S’assurer qu’il est une colonne de la propriété **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) dans la table de destinataires et lui affecte la valeur FALSE pour indiquer qu’aucun transport n’a encore la responsabilité de transmission de message.</span><span class="sxs-lookup"><span data-stu-id="adea3-128">Ensures that there is a column for the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property in the recipient table and sets it to FALSE to indicate that no transport has yet assumed responsibility for transmitting the message.</span></span>
    
4. <span data-ttu-id="adea3-129">Définit la date et l’heure d’origine dans la propriété **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="adea3-129">Sets the date and time of origination in the **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) property.</span></span>
    
5. <span data-ttu-id="adea3-130">Appelle [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md) pour effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="adea3-130">Calls [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md) to do the following:</span></span> 
    
    1. <span data-ttu-id="adea3-131">D�veloppez toutes les listes de distribution personnelles et des destinataires personnalis�s et remplacez tous les noms d'affichage modifi� par leur nom d'origine.</span><span class="sxs-lookup"><span data-stu-id="adea3-131">Expand all personal distribution lists and custom recipients and replace all changed display names with their original names.</span></span>
        
    2. <span data-ttu-id="adea3-132">Supprimer les doublons.</span><span class="sxs-lookup"><span data-stu-id="adea3-132">Remove duplicate names.</span></span>
        
    3. <span data-ttu-id="adea3-133">Recherchez tout prétraitement requis et, si le prétraitement est requise, définir l’indicateur NEEDS_PREPROCESSING et la propriété **PR_PREPROCESS** ([PidTagPreprocess](pidtagpreprocess-canonical-property.md)), qui est réservée pour MAPI.</span><span class="sxs-lookup"><span data-stu-id="adea3-133">Check for any required preprocessing and, if preprocessing is required, set the NEEDS_PREPROCESSING flag and the **PR_PREPROCESS** ([PidTagPreprocess](pidtagpreprocess-canonical-property.md)) property, which is reserved for MAPI.</span></span> 
        
    4. <span data-ttu-id="adea3-134">D�finir l'indicateur NEEDS_SPOOLER si la banque de messages est fortement coupl�e � un type de transport et qu'il ne peut pas g�rer tous les destinataires.</span><span class="sxs-lookup"><span data-stu-id="adea3-134">Set the NEEDS_SPOOLER flag if the message store is tightly coupled with a transport and it cannot handle all of the recipients.</span></span> 
    
6. <span data-ttu-id="adea3-135">Ex�cute les t�ches suivantes si l'indicateur de message NEEDS_PREPROCESSING est d�fini :</span><span class="sxs-lookup"><span data-stu-id="adea3-135">Performs the following tasks if the NEEDS_PREPROCESSING message flag is set:</span></span>
    
    1. <span data-ttu-id="adea3-136">Place le message dans la file d’attente sortant avec le bit SUBMITFLAG_PREPROCESS défini dans la propriété **PR_SUBMIT_FLAGS** .</span><span class="sxs-lookup"><span data-stu-id="adea3-136">Puts the message in the outgoing queue with the SUBMITFLAG_PREPROCESS bit set in the **PR_SUBMIT_FLAGS** property.</span></span> 
        
    2. <span data-ttu-id="adea3-137">Avertit le spouleur MAPI que la file d'attente a �t� modifi�e.</span><span class="sxs-lookup"><span data-stu-id="adea3-137">Notifies the MAPI spooler that the queue has changed.</span></span>
        
    3. <span data-ttu-id="adea3-138">Rend le contr�le au client et le flux de messages continue dans le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="adea3-138">Returns control to the client, and message flow continues in the MAPI spooler.</span></span> <span data-ttu-id="adea3-139">Le spouleur MAPI effectue les t�ches suivantes :</span><span class="sxs-lookup"><span data-stu-id="adea3-139">The MAPI spooler performs the following tasks:</span></span> 
    
       1. <span data-ttu-id="adea3-140">Verrouille le message en appelant [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span><span class="sxs-lookup"><span data-stu-id="adea3-140">Locks the message by calling [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span></span>
            
       2. <span data-ttu-id="adea3-141">Effectue le prétraitement nécessaires en appelant toutes les fonctions de prétraitement dans l’ordre d’inscription.</span><span class="sxs-lookup"><span data-stu-id="adea3-141">Performs the needed preprocessing by calling all of the preprocessing functions in the order of registration.</span></span> <span data-ttu-id="adea3-142">Fournisseurs de transport appellent [IMAPISupport::RegisterPreprocessor](imapisupport-registerpreprocessor.md) pour enregistrer les fonctions de prétraitement.</span><span class="sxs-lookup"><span data-stu-id="adea3-142">Transport providers call [IMAPISupport::RegisterPreprocessor](imapisupport-registerpreprocessor.md) to register preprocessing functions.</span></span> 
            
       3. <span data-ttu-id="adea3-143">Appels [IMessage::SubmitMessage](imessage-submitmessage.md) sur le message pour indiquer au message ouvert stocker ce prétraitement est terminée.</span><span class="sxs-lookup"><span data-stu-id="adea3-143">Calls [IMessage::SubmitMessage](imessage-submitmessage.md) on the open message to indicate to the message store that preprocessing is complete.</span></span> 
    
<span data-ttu-id="adea3-144">Si il n’a pas de prétraitement, ou il a été prétraitement et le spouleur MAPI appelé **SubmitMessage**, le fournisseur de banque de messages effectue les opérations suivantes dans le processus client :</span><span class="sxs-lookup"><span data-stu-id="adea3-144">If there was no preprocessing, or there was preprocessing and the MAPI spooler called **SubmitMessage**, the message store provider does the following in the client process:</span></span> 
  
- <span data-ttu-id="adea3-145">Performs the following tasks if the message store is tightly coupled to a transport and the NEEDS_SPOOLER flag was returned from [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md):</span><span class="sxs-lookup"><span data-stu-id="adea3-145">Performs the following tasks if the message store is tightly coupled to a transport and the NEEDS_SPOOLER flag was returned from [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md):</span></span>
    
   - <span data-ttu-id="adea3-146">G�re tous les destinataires pouvoir prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="adea3-146">Handles any recipients that it can handle.</span></span>
    
   - <span data-ttu-id="adea3-147">D�finit la propri�t� de **PR_RESPONSIBILITY** la valeur True pour tous les destinataires qu'il g�re.</span><span class="sxs-lookup"><span data-stu-id="adea3-147">Sets the **PR_RESPONSIBILITY** property to TRUE for any recipients that it handles.</span></span> 
    
   - <span data-ttu-id="adea3-148">Ex�cute les t�ches suivantes si tous les destinataires sont connus � ce magasin �troitement coupl� et de transport :</span><span class="sxs-lookup"><span data-stu-id="adea3-148">Performs the following tasks if all recipients are known to this tightly coupled store and transport:</span></span> 
    
     - <span data-ttu-id="adea3-149">Appelle [IMAPISupport::CompleteMsg](imapisupport-completemsg.md) si le message a été prétraité ou le fournisseur de banque de messages souhaite le spouleur MAPI au traitement du message terminée.</span><span class="sxs-lookup"><span data-stu-id="adea3-149">Calls [IMAPISupport::CompleteMsg](imapisupport-completemsg.md) if the message was preprocessed or the message store provider wants the MAPI spooler to complete message processing.</span></span> <span data-ttu-id="adea3-150">Flux des messages se poursuit avec le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="adea3-150">Message flow continues with the MAPI spooler.</span></span> 
    
     - <span data-ttu-id="adea3-151">Exécute les tâches suivantes si le message a été prétraité pas ou le fournisseur de banque de messages ne souhaite pas le spouleur MAPI pour effectuer le traitement des messages :</span><span class="sxs-lookup"><span data-stu-id="adea3-151">Performs the following tasks if the message was not preprocessed or the message store provider does not want the MAPI spooler to complete message processing:</span></span>
    
       1. <span data-ttu-id="adea3-152">Copie le message vers le dossier identifié par l’identificateur d’entrée dans la propriété **PR_SENTMAIL_ENTRYID** ([PidTagSentMailEntryId](pidtagsentmailentryid-canonical-property.md)), s’il est défini.</span><span class="sxs-lookup"><span data-stu-id="adea3-152">Copies the message to the folder identified by the entry identifier in the **PR_SENTMAIL_ENTRYID** ([PidTagSentMailEntryId](pidtagsentmailentryid-canonical-property.md)) property, if set.</span></span>
            
       2. <span data-ttu-id="adea3-153">Supprime le message si la propriété **PR_DELETE_AFTER_SUBMIT** ([PidTagDeleteAfterSubmit](pidtagdeleteaftersubmit-canonical-property.md)) a été définie sur TRUE.</span><span class="sxs-lookup"><span data-stu-id="adea3-153">Deletes the message if the **PR_DELETE_AFTER_SUBMIT** ([PidTagDeleteAfterSubmit](pidtagdeleteaftersubmit-canonical-property.md)) property has been set to TRUE.</span></span>
            
       3. <span data-ttu-id="adea3-154">Déverrouille le message s’il est verrouillé.</span><span class="sxs-lookup"><span data-stu-id="adea3-154">Unlocks the message if it is locked.</span></span>
            
       4. <span data-ttu-id="adea3-155">Renvoie au client.</span><span class="sxs-lookup"><span data-stu-id="adea3-155">Returns to the client.</span></span> <span data-ttu-id="adea3-156">Flux de messages est terminé.</span><span class="sxs-lookup"><span data-stu-id="adea3-156">Message flow is complete.</span></span>
    
  - <span data-ttu-id="adea3-157">Exécute les tâches suivantes si le message a été prétraité ou le fournisseur souhaite le spouleur MAPI pour effectuer le traitement des messages :</span><span class="sxs-lookup"><span data-stu-id="adea3-157">Performs the following tasks if the message was preprocessed or the provider wants the MAPI spooler to complete message processing:</span></span>
    
    1. <span data-ttu-id="adea3-158">Appelle [IMAPISupport::CompleteMsg](imapisupport-completemsg.md).</span><span class="sxs-lookup"><span data-stu-id="adea3-158">Calls [IMAPISupport::CompleteMsg](imapisupport-completemsg.md).</span></span> 
          
    2. <span data-ttu-id="adea3-159">Poursuit le flux des messages avec le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="adea3-159">Continues message flow with the MAPI spooler.</span></span> <span data-ttu-id="adea3-160">Pour plus d’informations, voir [envoi de Messages : tâches de spouleur MAPI](sending-messages-mapi-spooler-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="adea3-160">For more information, see [Sending Messages: MAPI Spooler Tasks](sending-messages-mapi-spooler-tasks.md).</span></span>
    
  - <span data-ttu-id="adea3-161">Exécute les tâches suivantes si le message a été prétraité pas ou le fournisseur ne souhaite pas le spouleur pour effectuer le traitement des messages :</span><span class="sxs-lookup"><span data-stu-id="adea3-161">Performs the following tasks if the message was not preprocessed or the provider does not want the spooler to complete message processing:</span></span>
    
    1. <span data-ttu-id="adea3-162">Copie le message vers le dossier identifié par l’identificateur d’entrée dans la propriété **PR_SENTMAIL_ENTRYID** , s’il est défini.</span><span class="sxs-lookup"><span data-stu-id="adea3-162">Copies the message to the folder identified by the entry identifier in the **PR_SENTMAIL_ENTRYID** property, if set.</span></span> 
        
    2. <span data-ttu-id="adea3-163">Supprime le message si la propriété **PR_DELETE_AFTER_SUBMIT** a été définie sur TRUE.</span><span class="sxs-lookup"><span data-stu-id="adea3-163">Deletes the message if the **PR_DELETE_AFTER_SUBMIT** property has been set to TRUE.</span></span> 
        
    3. <span data-ttu-id="adea3-164">Déverrouille le message s’il est verrouillé.</span><span class="sxs-lookup"><span data-stu-id="adea3-164">Unlocks the message if it is locked.</span></span> 
        
    4. <span data-ttu-id="adea3-165">Retourne à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="adea3-165">Returns to the caller.</span></span> <span data-ttu-id="adea3-166">Flux de messages est terminé.</span><span class="sxs-lookup"><span data-stu-id="adea3-166">Message flow is complete.</span></span>
    
- <span data-ttu-id="adea3-167">Ex�cute les t�ches suivantes si la banque de messages n'est pas �troitement coupl�e � un type de transport, pas tous les destinataires ont �t� connus pour la banque de messages ou l'indicateur NEEDS_SPOOLER est d�fini :</span><span class="sxs-lookup"><span data-stu-id="adea3-167">Performs the following tasks if the message store is not tightly coupled to a transport, not all of the recipients were known to the message store, or the NEEDS_SPOOLER flag is set:</span></span>
    
  1. <span data-ttu-id="adea3-168">Le message est plac� dans la file d'attente sortante sans d�finir le bit SUBMITFLAG_PREPROCESS dans la propri�t� **PR_SUBMIT_FLAGS**.</span><span class="sxs-lookup"><span data-stu-id="adea3-168">Puts the message in the outgoing queue without setting the SUBMITFLAG_PREPROCESS bit in the **PR_SUBMIT_FLAGS** property.</span></span> 
    
  2. <span data-ttu-id="adea3-169">Avertit le spouleur MAPI que la file d'attente sortante a chang� en g�n�rant une notification de la table.</span><span class="sxs-lookup"><span data-stu-id="adea3-169">Notifies the MAPI spooler that the outgoing queue has changed by generating a table notification.</span></span> 
    
  3. <span data-ttu-id="adea3-170">Renvoie au client et le flux des messages se poursuit avec un ensemble de t�ches effectu�es par le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="adea3-170">Returns to the client, and message flow continues with a set of tasks performed by the MAPI spooler.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="adea3-171">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="adea3-171">See also</span></span>

- [<span data-ttu-id="adea3-172">Fonctionnalit�s de la banque de messages</span><span class="sxs-lookup"><span data-stu-id="adea3-172">Message Store Features</span></span>](message-store-features.md)

