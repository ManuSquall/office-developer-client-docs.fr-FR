---
title: Fournisseurs de banques de messages étroitement couplés
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2eb493d7-bbd1-45b2-bd82-2bc452b2deab
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 3c9996dad1e9aa8c291f1cd593d9651994d86141
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32330057"
---
# <a name="tightly-coupled-message-store-providers"></a><span data-ttu-id="1882a-103">Fournisseurs de banques de messages étroitement couplés</span><span class="sxs-lookup"><span data-stu-id="1882a-103">Tightly Coupled Message Store Providers</span></span>

  
  
<span data-ttu-id="1882a-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="1882a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="1882a-105">Les fournisseurs de banques de messages peuvent être étroitement couplés à un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="1882a-105">Message store providers can be tightly coupled with a transport provider.</span></span> <span data-ttu-id="1882a-106">Le couplage étroit des fournisseurs de services MAPI implique l'implémentation des deux fournisseurs de sorte que le fournisseur de transport et le fournisseur de transport puissent communiquer pour que le processus d'envoi et de réception des messages soit plus efficace.</span><span class="sxs-lookup"><span data-stu-id="1882a-106">Tightly coupling MAPI service providers means implementing the two providers such that the store provider and transport provider can communicate to make the process of sending and receiving messages more efficient.</span></span> <span data-ttu-id="1882a-107">L'avantage de cette opération est que les améliorations de performances peuvent survenir lorsque deux fournisseurs de services peuvent interagir les uns avec les autres directement au lieu d'utiliser le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="1882a-107">The benefit of doing this is that performance improvements can result when two service providers can interact with each other directly rather than by means of MAPI spooler.</span></span> <span data-ttu-id="1882a-108">Pour associer étroitement un fournisseur de banque de messages à un fournisseur de transport, le fournisseur de transport doit placer l'identificateur d'entrée du fournisseur de banque de messages dans la propriété **PR_OWN_STORE_ENTRYID** ([PidTagOwnStoreEntryId](pidtagownstoreentryid-canonical-property.md)) du fournisseur de transport. ligne dans la table d'État MAPI.</span><span class="sxs-lookup"><span data-stu-id="1882a-108">To tightly couple a message store provider to a transport provider, the transport provider must place the message store provider's entry identifier in the **PR_OWN_STORE_ENTRYID** ([PidTagOwnStoreEntryId](pidtagownstoreentryid-canonical-property.md)) property in the transport provider's row in the MAPI status table.</span></span> <span data-ttu-id="1882a-109">Cela permet au spouleur MAPI de connecter le fournisseur de banque au fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="1882a-109">This enables MAPI spooler to connect the store provider to the transport provider.</span></span>
  
<span data-ttu-id="1882a-110">Il n'est pas nécessaire qu'un fournisseur de banque de messages soit étroitement couplé avec tout autre fournisseur de services.</span><span class="sxs-lookup"><span data-stu-id="1882a-110">There is no requirement that a message store provider ever be tightly coupled with any other service provider.</span></span> <span data-ttu-id="1882a-111">Le fournisseur de services le plus courant à associer étroitement avec un fournisseur de banque de messages est un fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="1882a-111">The most common service provider to tightly couple with a message store provider is a transport provider.</span></span> <span data-ttu-id="1882a-112">Cette opération est généralement effectuée pour permettre l'envoi et la réception de messages sans impliquer le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="1882a-112">This is usually done so that sending and receiving messages can be accomplished without involving the MAPI spooler.</span></span> <span data-ttu-id="1882a-113">Par exemple, lorsque l'utilisateur envoie un message sortant, le fournisseur de banque de messages combiné et le fournisseur de transport peuvent l'envoyer directement.</span><span class="sxs-lookup"><span data-stu-id="1882a-113">For example, when the user submits an outgoing message, the combined message store provider and transport provider can send it directly.</span></span> <span data-ttu-id="1882a-114">Les fournisseurs de services combinés n'ont pas besoin de commencer par informer le spouleur MAPI qu'il y a un nouveau message à traiter, puis d'attendre le spouleur MAPI pour lancer le processus de transfert du message à partir du fournisseur de banque de messages vers le fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="1882a-114">The combined service providers do not have to first notify MAPI spooler that there is a new message to process and then wait for MAPI spooler to initiate the process of transferring the message from the message store provider to the transport provider.</span></span> <span data-ttu-id="1882a-115">Cela présente des avantages particuliers lorsqu'une banque de messages basée sur un serveur est utilisée en minimisant le trafic réseau entre l'ordinateur de l'utilisateur et le serveur.</span><span class="sxs-lookup"><span data-stu-id="1882a-115">This has particular benefits when a server-based message store is being used by minimizing network traffic between the user's computer and the server.</span></span>
  
<span data-ttu-id="1882a-116">En règle générale, il n'existe pas de procédures bien spécifiées pour le couplage étroit des fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="1882a-116">In general, there are no well-specified procedures for tightly coupling service providers.</span></span> <span data-ttu-id="1882a-117">Toutefois, vous devez utiliser les instructions suivantes:</span><span class="sxs-lookup"><span data-stu-id="1882a-117">However, you should use the following guidelines:</span></span>
  
- <span data-ttu-id="1882a-118">Si la raison de l'association étroite des fournisseurs de services est des performances, sachez que le couplage prend des parties du sous-système MAPI en dehors des processus dans lesquels ces composants seraient normalement impliqués.</span><span class="sxs-lookup"><span data-stu-id="1882a-118">If the reason for tightly coupling service providers is performance, be aware that the coupling takes parts of the MAPI subsystem out of the processes that those parts would normally be involved in.</span></span> <span data-ttu-id="1882a-119">Cela signifie que les composants individuels du fournisseur de services combinés doivent interagir les uns avec les autres de manière à simuler l'interaction avec les composants du sous-système MAPI qui ne sont pas utilisés.</span><span class="sxs-lookup"><span data-stu-id="1882a-119">This implies that the individual parts in the combined service provider should interact with each other in a way that simulates the interaction they would normally have with the parts of the MAPI subsystem that are not being used.</span></span>
    
- <span data-ttu-id="1882a-120">Lorsque des fournisseurs de services étroitement couplés interagissent avec d'autres composants MAPI, ils doivent toujours interagir avec eux exactement comme ils le ferait s'ils ne sont pas étroitement couplés.</span><span class="sxs-lookup"><span data-stu-id="1882a-120">When tightly coupled service providers do interact with other MAPI components, they must still interact with them in exactly the way they would if they were not tightly coupled.</span></span> <span data-ttu-id="1882a-121">Par exemple, si un utilisateur utilise un fournisseur de banque de messages et un fournisseur de transport combinés comme banque de messages par défaut, mais utilise un fournisseur de transport distinct pour envoyer des messages, comme cela peut se produire lorsqu'un utilisateur prend un ordinateur en déplacement et bascule vers un RP de transport distant ovider — la partie de la Banque de messages du fournisseur de services étroitement couplé doit toujours interagir avec le spouleur MAPI, comme s'il s'agissait d'un fournisseur de banque de messages autonome.</span><span class="sxs-lookup"><span data-stu-id="1882a-121">For example, if a user is using a combined message store provider and transport provider as their default message store but is using a separate transport provider to send messages — as can happen when a user takes a computer on the road and switches to a remote transport provider — the message store portion of the tightly coupled service provider must still interact with MAPI spooler just as if it were a standalone message store provider.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="1882a-122">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1882a-122">See also</span></span>



[<span data-ttu-id="1882a-123">Développement d’un fournisseur de banque de messages MAPI</span><span class="sxs-lookup"><span data-stu-id="1882a-123">Developing a MAPI Message Store Provider</span></span>](developing-a-mapi-message-store-provider.md)

