---
title: Implémentation d'un objet d'ouverture de session
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 41e5c88c-d79d-4e9f-81f4-c4365cfaa15d
description: 'Derni�re modification�: lundi 9 mars 2015'
ms.openlocfilehash: f9d77313012c2d133dc9352707ebc5e0c69c9973
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332843"
---
# <a name="implementing-a-logon-object"></a><span data-ttu-id="fe58e-103">Implémentation d'un objet d'ouverture de session</span><span class="sxs-lookup"><span data-stu-id="fe58e-103">Implementing a Logon Object</span></span>

  
  
<span data-ttu-id="fe58e-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="fe58e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="fe58e-105">Tous les carnets d'adresses, banques de messages et fournisseurs de transport instancient un objet d'ouverture de session dans le cadre de son implémentation de [IABProvider:: Logon](iabprovider-logon.md), [IMSProvider:: Logon](imsprovider-logon.md)ou [IXPProvider:: TransportLogon](ixpprovider-transportlogon.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-105">Every address book, message store, and transport provider instantiates a logon object as part of its implementation of [IABProvider::Logon](iabprovider-logon.md), [IMSProvider::Logon](imsprovider-logon.md), or [IXPProvider::TransportLogon](ixpprovider-transportlogon.md).</span></span> <span data-ttu-id="fe58e-106">Les objets d'ouverture de session implémentent des méthodes qui aident les demandes client de service MAPI.</span><span class="sxs-lookup"><span data-stu-id="fe58e-106">Logon objects implement methods that help MAPI service client requests.</span></span> <span data-ttu-id="fe58e-107">En fonction de votre type de fournisseur de services, votre objet d'ouverture de session prendra en charge l'une des interfaces suivantes.</span><span class="sxs-lookup"><span data-stu-id="fe58e-107">Depending on your type of service provider, your logon object will support one of the following interfaces.</span></span> 
  
|<span data-ttu-id="fe58e-108">**Interface de l'objet Logon**</span><span class="sxs-lookup"><span data-stu-id="fe58e-108">**Logon object interface**</span></span>|<span data-ttu-id="fe58e-109">**Fournisseur de services**</span><span class="sxs-lookup"><span data-stu-id="fe58e-109">**Service provider**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="fe58e-110">IABLogon : IUnknown</span><span class="sxs-lookup"><span data-stu-id="fe58e-110">IABLogon : IUnknown</span></span>](iablogoniunknown.md) <br/> |<span data-ttu-id="fe58e-111">Fournisseur de carnets d'adresses</span><span class="sxs-lookup"><span data-stu-id="fe58e-111">Address book provider</span></span>  <br/> |
|[<span data-ttu-id="fe58e-112">IMSLogon : IUnknown</span><span class="sxs-lookup"><span data-stu-id="fe58e-112">IMSLogon : IUnknown</span></span>](imslogoniunknown.md) <br/> |<span data-ttu-id="fe58e-113">Fournisseur de banque de messages</span><span class="sxs-lookup"><span data-stu-id="fe58e-113">Message store provider</span></span>  <br/> |
|[<span data-ttu-id="fe58e-114">IXPLogon : IUnknown</span><span class="sxs-lookup"><span data-stu-id="fe58e-114">IXPLogon : IUnknown</span></span>](ixplogoniunknown.md) <br/> |<span data-ttu-id="fe58e-115">Fournisseur de transport</span><span class="sxs-lookup"><span data-stu-id="fe58e-115">Transport provider</span></span>  <br/> |
   
<span data-ttu-id="fe58e-116">Les fournisseurs de carnet d'adresses et de banque de messages implémentent les fonctionnalités suivantes dans leurs objets d'ouverture de session:</span><span class="sxs-lookup"><span data-stu-id="fe58e-116">Address book and message store providers implement the following features in their logon objects:</span></span>
  
- <span data-ttu-id="fe58e-117">Prise en charge des notifications d'événements (méthodes**Advise** et Unadvise). \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="fe58e-117">Support for event notification (**Advise** and **Unadvise** methods).</span></span> <span data-ttu-id="fe58e-118">Pour obtenir une vue d'ensemble de la notification d'événement, consultez la rubrique notifications d' [événements dans MAPI](event-notification-in-mapi.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-118">For an overview of event notification, see [Event Notification in MAPI](event-notification-in-mapi.md).</span></span> <span data-ttu-id="fe58e-119">Pour plus d'informations sur la prise en charge de la notification dans votre objet Logon, consultez la rubrique [prise en charge](supporting-event-notification.md)des notifications d'événements.</span><span class="sxs-lookup"><span data-stu-id="fe58e-119">For more information about supporting notification in your logon object, see [Supporting Event Notification](supporting-event-notification.md).</span></span> 
    
- <span data-ttu-id="fe58e-120">Comparaison d'identificateur d'entrée (méthode**CompareEntryIDs** ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-120">Entry identifier comparison (**CompareEntryIDs** method).</span></span> <span data-ttu-id="fe58e-121">Pour obtenir des informations générales sur les identificateurs d'entrée, consultez la rubrique [MAPI Entry Identifiers](mapi-entry-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-121">For general information about entry identifiers, see [MAPI Entry Identifiers](mapi-entry-identifiers.md).</span></span> <span data-ttu-id="fe58e-122">Pour plus d'informations sur la comparaison des identificateurs d'entrée dans la méthode **CompareEntryIDs** de l'objet Logon, voir [prise en charge de la comparaison et de l'accès aux objets](supporting-object-access-and-comparison.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-122">For more information about comparing entry identifiers in your logon object's **CompareEntryIDs** method, see [Supporting Object Access and Comparison](supporting-object-access-and-comparison.md).</span></span>
    
- <span data-ttu-id="fe58e-123">Accès aux informations supplémentaires sur l'erreur (méthode**GetLastError** ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-123">Access to additional error information (**GetLastError** method).</span></span> <span data-ttu-id="fe58e-124">Pour plus d'informations sur la gestion des erreurs dans MAPI, consultez la rubrique [gestion des erreurs dans MAPI](error-handling-in-mapi.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-124">For more information about handling errors in MAPI, see [Error Handling in MAPI](error-handling-in-mapi.md).</span></span> 
    
- <span data-ttu-id="fe58e-125">Accès aux objets implémentés par le fournisseur de services (méthode**OpenEntry** ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-125">Access to objects implemented by the service provider (**OpenEntry** method).</span></span> <span data-ttu-id="fe58e-126">Pour plus d'informations, consultez la rubrique [prise en charge de l'accès aux objets et comparaison](supporting-object-access-and-comparison.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-126">For more information, see [Supporting Object Access and Comparison](supporting-object-access-and-comparison.md).</span></span>
    
- <span data-ttu-id="fe58e-127">Accès à un objet état (méthode**OpenStatusEntry** ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-127">Access to a status object (**OpenStatusEntry** method).</span></span> <span data-ttu-id="fe58e-128">Pour obtenir des informations générales sur les objets d'État, voir [MAPI Status Objects](mapi-status-objects.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-128">For general information about status objects, see [MAPI Status Objects](mapi-status-objects.md).</span></span> <span data-ttu-id="fe58e-129">Pour plus d'informations sur l'implémentation d'un objet Status, voir [Status implémentation Object](status-object-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-129">For specific information about implementing a status object, see [Status Object Implementation](status-object-implementation.md).</span></span>
    
- <span data-ttu-id="fe58e-130">Un processus de fermeture de session (méthode de**fermeture de session** ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-130">A logoff process (**Logoff** method).</span></span> <span data-ttu-id="fe58e-131">Pour plus d'informations, consultez la rubrique [arrêt d'un fournisseur de services](shutting-down-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-131">For more information, see [Shutting Down a Service Provider](shutting-down-a-service-provider.md).</span></span>
    
<span data-ttu-id="fe58e-132">Si votre fournisseur est un fournisseur de carnets d'adresses, vous implémentez également les méthodes suivantes et les fonctionnalités associées:</span><span class="sxs-lookup"><span data-stu-id="fe58e-132">If your provider is an address book provider, you will also implement the following methods and associated features:</span></span>
  
- <span data-ttu-id="fe58e-133">[IABLogon:: GetOneOffTable](iablogon-getoneofftable.md) pour fournir une liste des modèles que vous prenez en charge pour la création de nouveaux destinataires.</span><span class="sxs-lookup"><span data-stu-id="fe58e-133">[IABLogon::GetOneOffTable](iablogon-getoneofftable.md) to provide a listing of the templates that you support for creating new recipients.</span></span> <span data-ttu-id="fe58e-134">Pour plus d'informations, consultez la rubrique [tables One-Off](one-off-tables.md) ou [implémentation d'une table ponctuelle de fournisseur](implementing-a-provider-one-off-table.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-134">For more information, see [One-Off Tables](one-off-tables.md) or [Implementing a Provider One-Off Table](implementing-a-provider-one-off-table.md).</span></span>
    
- <span data-ttu-id="fe58e-135">[IABLogon:: OpenTemplateID](iablogon-opentemplateid.md) pour fournir l'accès à l'implémentation d'un destinataire dont les données résident dans un fournisseur de carnet d'adresses hôte.</span><span class="sxs-lookup"><span data-stu-id="fe58e-135">[IABLogon::OpenTemplateID](iablogon-opentemplateid.md) to provide access to the implementation of a recipient whose data resides in a host address book provider.</span></span> <span data-ttu-id="fe58e-136">Pour plus d'informations, consultez [la rubrique agir en tant que fournisseur de carnet d'adresses étranger](acting-as-a-foreign-address-book-provider.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-136">For more information, see [Acting as a Foreign Address Book Provider](acting-as-a-foreign-address-book-provider.md).</span></span> 
    
- <span data-ttu-id="fe58e-137">[IABLogon::P reparerecips](iablogon-preparerecips.md) pour vous assurer que les propriétés appropriées sont disponibles pour tous les destinataires d'une liste de destinataires.</span><span class="sxs-lookup"><span data-stu-id="fe58e-137">[IABLogon::PrepareRecips](iablogon-preparerecips.md) to ensure that the appropriate properties are available for all of the recipients in a recipient list.</span></span> <span data-ttu-id="fe58e-138">Pour plus d'informations, consultez la rubrique [IABLogon::P reparerecips](iablogon-preparerecips.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-138">For more information, see [IABLogon::PrepareRecips](iablogon-preparerecips.md).</span></span> 
    
<span data-ttu-id="fe58e-139">L'objet d'ouverture de session d'un fournisseur de transport, qui implémente [IXPLogon: IUnknown](ixplogoniunknown.md), est très différent des objets d'ouverture de session implémentés par les autres types de fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="fe58e-139">A transport provider's logon object, which implements [IXPLogon : IUnknown](ixplogoniunknown.md), is quite different from the logon objects implemented by the other types of service providers.</span></span> <span data-ttu-id="fe58e-140">Il n'a que deux fonctionnalités en commun avec les autres objets Logon: l'accès à un objet Status via la méthode [IXPLogon:: OpenStatusEntry](ixplogon-openstatusentry.md) et une opération de fermeture de session via la méthode [IXPLogon:: TransportLogoff](ixplogon-transportlogoff.md) .</span><span class="sxs-lookup"><span data-stu-id="fe58e-140">It has only two features in common with the other logon objects: access to a status object through the [IXPLogon::OpenStatusEntry](ixplogon-openstatusentry.md) method and a logoff operation through the [IXPLogon::TransportLogoff](ixplogon-transportlogoff.md) method.</span></span> <span data-ttu-id="fe58e-141">Les fournisseurs de transport implémentent les fonctionnalités uniques suivantes dans leurs objets d'ouverture de session:</span><span class="sxs-lookup"><span data-stu-id="fe58e-141">Transport providers implement the following unique features in their logon objects:</span></span> 
  
- <span data-ttu-id="fe58e-142">Inscription pour les types d'adresse (méthode[IXPLogon:: AddressTypes](ixplogon-addresstypes.md) ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-142">Registration for address types ([IXPLogon::AddressTypes](ixplogon-addresstypes.md) method).</span></span> <span data-ttu-id="fe58e-143">Pour plus d'informations sur l'inscription d'un type d'adresse, consultez la rubrique [fournisseur de transport et modèle opérationnel de spouleUR MAPI](transport-provider-and-mapi-spooler-operational-model.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-143">For more information about registering an address type, see [Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span></span>
    
- <span data-ttu-id="fe58e-144">Contrôle de la transmission des messages ([IXPLogon:: StartMessage](ixplogon-startmessage.md), [IXPLogon:: EndMessage](ixplogon-endmessage.md)et [IXPLogon:: SubmitMessage](ixplogon-submitmessage.md) méthodes).</span><span class="sxs-lookup"><span data-stu-id="fe58e-144">Control of message transmission ([IXPLogon::StartMessage](ixplogon-startmessage.md), [IXPLogon::EndMessage](ixplogon-endmessage.md), and [IXPLogon::SubmitMessage](ixplogon-submitmessage.md) methods).</span></span> <span data-ttu-id="fe58e-145">Pour plus d'informations, consultez la rubrique [modèle de réception des messages](message-reception-model.md), [interaction avec le spouleur MAPI](interacting-with-the-mapi-spooler.md)et [modèle de dépôt de messages](message-submission-model.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-145">For more information, see [Message Reception Model](message-reception-model.md), [Interacting with the MAPI Spooler](interacting-with-the-mapi-spooler.md), and [Message Submission Model](message-submission-model.md).</span></span>
    
- <span data-ttu-id="fe58e-146">Validation de l'état interne (méthode[IXPLogon:: ValidateState](ixplogon-validatestate.md) ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-146">Internal state validation ([IXPLogon::ValidateState](ixplogon-validatestate.md) method).</span></span> 
    
- <span data-ttu-id="fe58e-147">Possibilité de télécharger ou de télécharger des messages à la demande (méthode[IXPLogon:: FlushQueues](ixplogon-flushqueues.md) ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-147">Ability to download or upload messages on demand ([IXPLogon::FlushQueues](ixplogon-flushqueues.md) method).</span></span> <span data-ttu-id="fe58e-148">Pour plus d'informations, consultez [la rubrique implémentation de la méthode FlushQueues](implementing-the-flushqueues-method.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-148">For more information, see [Implementing the FlushQueues Method](implementing-the-flushqueues-method.md).</span></span>
    
- <span data-ttu-id="fe58e-149">Possibilité d'interroger les messages en attente ([IXPLogon::P méthode oll](ixplogon-poll.md) ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-149">Ability to query for pending messages ([IXPLogon::Poll](ixplogon-poll.md) method).</span></span> <span data-ttu-id="fe58e-150">Pour plus d'informations, consultez la rubrique [modèle de réception des messages](message-reception-model.md).</span><span class="sxs-lookup"><span data-stu-id="fe58e-150">For more information, see [Message Reception Model](message-reception-model.md).</span></span>
    
- <span data-ttu-id="fe58e-151">Détection d'État inActif (méthode[IXPLogon:: Idle](ixplogon-idle.md) ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-151">Idle state detection ([IXPLogon::Idle](ixplogon-idle.md) method).</span></span> 
    
- <span data-ttu-id="fe58e-152">Interaction avec le spouleur MAPI (méthode[IXPLogon:: TransportNotify](ixplogon-transportnotify.md) ).</span><span class="sxs-lookup"><span data-stu-id="fe58e-152">Interaction with the MAPI spooler ([IXPLogon::TransportNotify](ixplogon-transportnotify.md) method).</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="fe58e-153">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="fe58e-153">See also</span></span>



[<span data-ttu-id="fe58e-154">Implémentation de la connexion au fournisseur de services</span><span class="sxs-lookup"><span data-stu-id="fe58e-154">Implementing Service Provider Logon</span></span>](implementing-service-provider-logon.md)

