---
title: À propos des URL MAPI pour l’indexation basée sur une notification
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 9cb35f0a-267e-2d85-1701-02d52578a0b8
description: 'Dernière modification : 08 novembre 2011'
ms.openlocfilehash: 57868996f95cfb135298378d2638bc57b2e69977
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22583672"
---
# <a name="about-mapi-urls-for-notification-based-indexing"></a><span data-ttu-id="e4bf7-103">À propos des URL MAPI pour l’indexation basée sur une notification</span><span class="sxs-lookup"><span data-stu-id="e4bf7-103">About MAPI URLs for Notification-Based Indexing</span></span>

<span data-ttu-id="e4bf7-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e4bf7-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e4bf7-105">Lorsqu’un fournisseur de magasins signale un indexeur qu’un objet est prêt pour l’indexation, elle génère une URL MAPI qui identifie l’objet dans le Gestionnaire de protocole MAPI.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-105">When a store provider notifies an indexer that an object is ready for indexing, it generates a MAPI URL that uniquely identifies the object to the MAPI Protocol Handler.</span></span> <span data-ttu-id="e4bf7-106">MAPI URL sont codées au format Unicode et présentent le format suivant :</span><span class="sxs-lookup"><span data-stu-id="e4bf7-106">MAPI URLs are encoded in Unicode, and have the following format:</span></span> 
  
`Mapi://SID/StoreDisplayName ($HashNumber)/StoreType/FolderNameA/…/FolderNameN/[EntryIDEncoded[/at=AttachIDEncoded:FileName]]`

<span data-ttu-id="e4bf7-107">Le tableau suivant décrit les différentes parties d’une URL par défaut.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-107">The following table describes the various parts of a typical URL.</span></span>

|<span data-ttu-id="e4bf7-108">Élément</span><span class="sxs-lookup"><span data-stu-id="e4bf7-108">Part</span></span> | <span data-ttu-id="e4bf7-109">Description</span><span class="sxs-lookup"><span data-stu-id="e4bf7-109">Description</span></span>|
|:----|:-----------|  
|<span data-ttu-id="e4bf7-110">*SID*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-110">*SID*</span></span> |<span data-ttu-id="e4bf7-111">Identificateur de sécurité de l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-111">The current user's security identifier.</span></span>| 
|<span data-ttu-id="e4bf7-112">*StoreDisplayName*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-112">*StoreDisplayName*</span></span> |<span data-ttu-id="e4bf7-113">Chaîne qui spécifie le nom complet de l’utilisateur de cette banque.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-113">A string that specifies the display name of the user on that store.</span></span>|
|<span data-ttu-id="e4bf7-114">*Numéro_hachage*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-114">*HashNumber*</span></span> |<span data-ttu-id="e4bf7-115">Une **valeur DWORD** de représentation hexadécimale qui est calculée basé sur l’identificateur d’entrée de magasin ou la signature de mappage de magasin.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-115">A **DWORD** in hexadecimal representation that is calculated based on the store entry ID or the store mapping signature.</span></span> <span data-ttu-id="e4bf7-116">Cette valeur est stockée dans le Registre et servira ensuite à identifier la banque dans le Gestionnaire de protocole MAPI.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-116">This value is stored in the registry and will be used later to identify the store in the MAPI Protocol Handler.</span></span><br/><br/><span data-ttu-id="e4bf7-117">Ce numéro doit être calculé d’une manière qui minimise les collisions avec d’autres magasins.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-117">This number must be calculated in a way that minimizes collisions with other stores.</span></span> <span data-ttu-id="e4bf7-118">Pour l’algorithme que Microsoft Outlook utilise pour calculer le nombre de hachage, voir [algorithme pour calculer le nombre de hachage magasin](algorithm-to-calculate-the-store-hash-number.md).</span><span class="sxs-lookup"><span data-stu-id="e4bf7-118">For the algorithm that Microsoft Outlook uses to calculate the hash number, see [Algorithm to Calculate the Store Hash Number](algorithm-to-calculate-the-store-hash-number.md).</span></span>|
|<span data-ttu-id="e4bf7-119">*StoreType*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-119">*StoreType*</span></span> |<span data-ttu-id="e4bf7-120">Numéro qui identifie le type de la banque qui contient l’objet à indexer.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-120">A number that identifies the type of the store that contains the object to be indexed.</span></span> <span data-ttu-id="e4bf7-121">Les valeurs possibles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="e4bf7-121">The possible values are as follows:</span></span><br/><span data-ttu-id="e4bf7-122">-0 - banque par défaut.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-122">- 0 - Default store.</span></span><br/><br/><span data-ttu-id="e4bf7-123">-1 - banque déléguée, utilisée pour les éléments de délégué mis en cache localement.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-123">- 1 - Delegate store, used for delegate items cached locally.</span></span><br/><br/><span data-ttu-id="e4bf7-124">-2 - les dossiers publics, utilisés pour le dossier public Favoris.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-124">- 2 - Public folders, used for public folder favorites.</span></span><br/><br/><span data-ttu-id="e4bf7-125">**Remarque**: si le magasin est en cours d’analyse au lieu de poussée (push), la valeur qui est utilisée est le caractère*X*.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-125">**NOTE**: If the store is being crawled instead of pushed, the value that is used is the character*X*.</span></span>| 
|<span data-ttu-id="e4bf7-126">*FolderNameA/.../FolderNameN*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-126">*FolderNameA/…/FolderNameN*</span></span> |<span data-ttu-id="e4bf7-127">Le chemin d’accès à la racine de l’arborescence IPM_SUBTREE du dossier ou du message.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-127">The path from the root of the IPM_SUBTREE to the folder or message.</span></span> <span data-ttu-id="e4bf7-128">Par exemple, un message dans le dossier **famille** sous **boîte de réception** **a/Famille de boîte de réception** pour ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-128">For example, a message in the **Family** folder under **Inbox** has **Inbox/Family** for this parameter.</span></span> |
|<span data-ttu-id="e4bf7-129">*EntryIDEncoded*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-129">*EntryIDEncoded*</span></span> |<span data-ttu-id="e4bf7-130">Identificateur d’entrée MAPI pour l’élément codé sous forme de chaîne Unicode.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-130">MAPI entry ID for the item encoded as a Unicode string.</span></span> <span data-ttu-id="e4bf7-131">Voir la section suivante « Caractères spéciaux » pour plus d’informations sur la façon dont certains caractères spéciaux sont codées.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-131">See the following section "Special Characters" for information about how certain special characters are encoded.</span></span> <span data-ttu-id="e4bf7-132">Pour plus d’informations sur l’algorithme pour coder l’identificateur d’entrée, voir [algorithme pour coder les identificateurs d’entrée et des ID de pièce jointe](algorithm-to-encode-entry-ids-and-attachment-ids.md).</span><span class="sxs-lookup"><span data-stu-id="e4bf7-132">For more information about the algorithm to encode the entry ID, see [Algorithm to Encode Entry IDs and Attachment IDs](algorithm-to-encode-entry-ids-and-attachment-ids.md).</span></span><br/><br/><span data-ttu-id="e4bf7-133">**Remarque**: lorsqu’ils sont affichés sous forme de texte, cela codé entrée ID apparaît sous la forme des caractères Hangul en caractères aléatoire ou des zones conformément à l’algorithme, en fonction des polices disponibles.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-133">**NOTE**: When viewed as text, this encoded entry ID appears as random Hangul characters or boxes in compliance with the algorithm, depending on available fonts.</span></span>  |
|<span data-ttu-id="e4bf7-134">*AttachIDEncoded*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-134">*AttachIDEncoded*</span></span> |<span data-ttu-id="e4bf7-135">ID de pièce jointe codé sous forme de chaîne Unicode.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-135">Attachment ID encoded as a Unicode string.</span></span> <span data-ttu-id="e4bf7-136">Voir la section suivante « Caractères spéciaux » pour plus d’informations sur la façon dont certains caractères spéciaux sont codées.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-136">See the following section "Special Characters" for information about how certain special characters are encoded.</span></span> <span data-ttu-id="e4bf7-137">Pour plus d’informations sur l’algorithme pour coder l’identificateur d’entrée, voir [algorithme pour coder les identificateurs d’entrée et des ID de pièce jointe](algorithm-to-encode-entry-ids-and-attachment-ids.md).</span><span class="sxs-lookup"><span data-stu-id="e4bf7-137">For more information about the algorithm to encode the entry ID, see [Algorithm to Encode Entry IDs and Attachment IDs](algorithm-to-encode-entry-ids-and-attachment-ids.md).</span></span><br/><br/><span data-ttu-id="e4bf7-138">**Remarque**: lorsqu’ils sont affichés sous forme de texte, cela codé entrée ID apparaît sous la forme des caractères Hangul en caractères aléatoire ou des zones conformément à l’algorithme, en fonction des polices disponibles.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-138">**NOTE**: When viewed as text, this encoded entry ID appears as random Hangul characters or boxes in compliance with the algorithm, depending on available fonts.</span></span> |
|<span data-ttu-id="e4bf7-139">*FileName*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-139">*FileName*</span></span> |<span data-ttu-id="e4bf7-140">Nom de la pièce jointe du fichier, tel qu’il apparaît dans le message.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-140">Name of the attachment file, as it appears in the message.</span></span>|
    
## <a name="examples-of-mapi-urls"></a><span data-ttu-id="e4bf7-141">Exemples d’URL MAPI</span><span class="sxs-lookup"><span data-stu-id="e4bf7-141">Examples of MAPI URLs</span></span>

<span data-ttu-id="e4bf7-142">Voici quelques exemples d’URL MAPI.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-142">The following are some examples of MAPI URLs.</span></span>
  
- <span data-ttu-id="e4bf7-143">MAPI l’URL d’un dossier :</span><span class="sxs-lookup"><span data-stu-id="e4bf7-143">MAPI URL for a folder:</span></span> 
    
  `mapi://S-1-5-21-2127521184-1604012920-1887927527-71418/Mailbox - Some User ($be19928f)/2/Office`
    
- <span data-ttu-id="e4bf7-144">URL de MAPI pour un message :</span><span class="sxs-lookup"><span data-stu-id="e4bf7-144">MAPI URL for a message:</span></span> 
    
  `mapi://S-1-5-21-2127521184-1604012920-1887927527-71418/Mailbox - Some User ($484efb89)/0/Calendar/곯가가가걍걝걌곌겷걢곒갑겛개가검걟곔걙곾걤곂갠가`
    
- <span data-ttu-id="e4bf7-145">URL de MAPI pour une pièce jointe :</span><span class="sxs-lookup"><span data-stu-id="e4bf7-145">MAPI URL for an attachment:</span></span> 
    
  `mapi://S-1-5-21-2127521184-1604012920-1887927527-71418/Mailbox - Some User ($484efb89)/0/Inbox/곯가가가걍걝걌곌겷걢곒갑겛개가검걟곔걙곾간곷갦가/at=겅걋각가:somefile.txt`
    
## <a name="special-characters"></a><span data-ttu-id="e4bf7-146">Caractères spéciaux</span><span class="sxs-lookup"><span data-stu-id="e4bf7-146">Special characters</span></span>

<span data-ttu-id="e4bf7-147">Certains caractères sont codés s’ils apparaissent dans le message ou d’une pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-147">Certain characters are encoded if they appear in the message or attachment.</span></span> <span data-ttu-id="e4bf7-148">L’exemple suivant montre les caractères sont codés dans une URL MAPI :</span><span class="sxs-lookup"><span data-stu-id="e4bf7-148">The following shows which characters are encoded in a MAPI URL:</span></span>
  
- <span data-ttu-id="e4bf7-149">% > % 25</span><span class="sxs-lookup"><span data-stu-id="e4bf7-149">% > %25</span></span>
    
- <span data-ttu-id="e4bf7-150">/ > % 2F</span><span class="sxs-lookup"><span data-stu-id="e4bf7-150">/ > %2F</span></span> 
    
- <span data-ttu-id="e4bf7-151">\ > 5 % C</span><span class="sxs-lookup"><span data-stu-id="e4bf7-151">\ > %5C</span></span> 
    
- <span data-ttu-id="e4bf7-152">\*> % 2</span><span class="sxs-lookup"><span data-stu-id="e4bf7-152">\* > %2A</span></span> 
    
- <span data-ttu-id="e4bf7-153">?</span><span class="sxs-lookup"><span data-stu-id="e4bf7-153"></span></span> <span data-ttu-id="e4bf7-154">> % 3</span><span class="sxs-lookup"><span data-stu-id="e4bf7-154">> %3F</span></span> 
    
## <a name="blob-associated-with-each-mapi-url"></a><span data-ttu-id="e4bf7-155">BLOB associée à chaque URL MAPI</span><span class="sxs-lookup"><span data-stu-id="e4bf7-155">Blob associated with each MAPI URL</span></span>

<span data-ttu-id="e4bf7-156">Lors de l’envoi d’une URL de MAPI pour un objet à indexer, un fournisseur de magasins crée également un grand BLOB (binary object) qui contient des informations pour le Gestionnaire de protocole MAPI.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-156">When pushing a MAPI URL for an object to be indexed, a store provider also creates a binary large object (BLOB) that contains certain information for the MAPI Protocol Handler.</span></span> <span data-ttu-id="e4bf7-157">Le fournisseur de banque associe ce BLOB à chaque URL MAPI et les envoie lors de la distribution de l’URL de MAPI à l’indexeur.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-157">The store provider associates this BLOB with each MAPI URL and sends it when pushing the MAPI URL to the indexer.</span></span> <span data-ttu-id="e4bf7-158">Le format de l’objet BLOB est comme suit :</span><span class="sxs-lookup"><span data-stu-id="e4bf7-158">The format of the BLOB is as follows:</span></span> 
  
```cpp
DWORD  dwVersion
DWORD  dwFlags
ULONG  cbProfileName
WCHAR  wszProfileName
ULONG  cbProviderItemID
WCHAR  wszProviderItemID
```

<span data-ttu-id="e4bf7-159">Le fournisseur de banque doit écrire ces valeurs dans l’objet BLOB dans l’ordre indiqué.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-159">The store provider must write these values to the BLOB in the order shown.</span></span> <span data-ttu-id="e4bf7-160">Le tableau suivant décrit chaque champ de l’objet BLOB.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-160">The following table describes each field of the BLOB.</span></span>

|<span data-ttu-id="e4bf7-161">Élément</span><span class="sxs-lookup"><span data-stu-id="e4bf7-161">Part</span></span> | <span data-ttu-id="e4bf7-162">Description</span><span class="sxs-lookup"><span data-stu-id="e4bf7-162">Description</span></span>|
|:----|:-----------|  
|<span data-ttu-id="e4bf7-163">*dwVersion*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-163">*dwVersion*</span></span> |<span data-ttu-id="e4bf7-164">Il s’agit de la version des données envoyées.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-164">This is the version of the data being sent.</span></span> <span data-ttu-id="e4bf7-165">Actuellement, cette valeur est 1.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-165">Currently this value is 1.</span></span>|
|<span data-ttu-id="e4bf7-166">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-166">*dwFlags*</span></span> |<span data-ttu-id="e4bf7-167">Réservé à une utilisation ultérieure.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-167">Reserved for future use.</span></span> <span data-ttu-id="e4bf7-168">Actuellement, cette valeur doit être 0.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-168">Currently this value should be 0.</span></span>|
|<span data-ttu-id="e4bf7-169">*cbProfileName*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-169">*cbProfileName*</span></span> |<span data-ttu-id="e4bf7-170">La taille du nom du profil, en octets.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-170">The size of the profile name, in bytes.</span></span> <span data-ttu-id="e4bf7-171">Ces informations sont utiles pour le Gestionnaire de protocole MAPI à connaître le profil à utiliser lors de l’indexation de l’élément.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-171">This information is useful for the MAPI Protocol Handler to know which profile to use when indexing the item.</span></span>|
|<span data-ttu-id="e4bf7-172">*wszProfileName*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-172">*wszProfileName*</span></span> |<span data-ttu-id="e4bf7-173">Unicode chaîne qui contient le nom du profil.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-173">Null-terminated Unicode string that contains the profile name.</span></span>|
|<span data-ttu-id="e4bf7-174">*cbProviderItemID*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-174">*cbProviderItemID*</span></span> |<span data-ttu-id="e4bf7-175">Taille de l’ID d’élément fournisseur, en octets.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-175">Size of the provider item ID, in bytes.</span></span> <span data-ttu-id="e4bf7-176">Le fournisseur de banque doit envoyer uniquement le fournisseur d’ID d’élément pour les dossiers, afin d’empêcher l’ouverture des dossiers supplémentaires pour obtenir ces informations.</span><span class="sxs-lookup"><span data-stu-id="e4bf7-176">The store provider should send only the provider item ID for folders, to prevent opening additional folders to get this information.</span></span>|
|<span data-ttu-id="e4bf7-177">*wszProviderItemID*</span><span class="sxs-lookup"><span data-stu-id="e4bf7-177">*wszProviderItemID*</span></span> |<span data-ttu-id="e4bf7-178">Chaîne Unicode terminée avec l’ID d’élément fournisseur qui identifie l’élément dans le magasin</span><span class="sxs-lookup"><span data-stu-id="e4bf7-178">Null-terminated Unicode string with the provider item ID that uniquely identifies the item in the store.</span></span>|
    
## <a name="see-also"></a><span data-ttu-id="e4bf7-179">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e4bf7-179">See also</span></span>

- [<span data-ttu-id="e4bf7-180">À propos de l’indexation de magasin basée sur une notification</span><span class="sxs-lookup"><span data-stu-id="e4bf7-180">About Notification-Based Store Indexing</span></span>](about-notification-based-store-indexing.md)
- [<span data-ttu-id="e4bf7-181">Constantes MAPI</span><span class="sxs-lookup"><span data-stu-id="e4bf7-181">MAPI Constants</span></span>](mapi-constants.md)

