---
title: À propos des URL MAPI pour l'indexation basée sur les notifications
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 9cb35f0a-267e-2d85-1701-02d52578a0b8
description: 'Dernière modification: 08 08, 2011'
ms.openlocfilehash: 5a3e45809f36b71968560a4b239e268addf00474
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422480"
---
# <a name="about-mapi-urls-for-notification-based-indexing"></a><span data-ttu-id="788e2-103">À propos des URL MAPI pour l'indexation basée sur les notifications</span><span class="sxs-lookup"><span data-stu-id="788e2-103">About MAPI URLs for Notification-Based Indexing</span></span>

<span data-ttu-id="788e2-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="788e2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="788e2-105">Lorsqu'un fournisseur de banque avertit un indexeur qu'un objet est prêt pour l'indexation, il génère une URL MAPI qui identifie de manière unique l'objet dans le gestionnaire de protocole MAPI.</span><span class="sxs-lookup"><span data-stu-id="788e2-105">When a store provider notifies an indexer that an object is ready for indexing, it generates a MAPI URL that uniquely identifies the object to the MAPI Protocol Handler.</span></span> <span data-ttu-id="788e2-106">Les URL MAPI sont codées au format Unicode et ont le format suivant:</span><span class="sxs-lookup"><span data-stu-id="788e2-106">MAPI URLs are encoded in Unicode, and have the following format:</span></span> 
  
`Mapi://SID/StoreDisplayName ($HashNumber)/StoreType/FolderNameA/…/FolderNameN/[EntryIDEncoded[/at=AttachIDEncoded:FileName]]`

<span data-ttu-id="788e2-107">Le tableau suivant décrit les différentes parties d'une URL standard.</span><span class="sxs-lookup"><span data-stu-id="788e2-107">The following table describes the various parts of a typical URL.</span></span>

|<span data-ttu-id="788e2-108">Quitter</span><span class="sxs-lookup"><span data-stu-id="788e2-108">Part</span></span> | <span data-ttu-id="788e2-109">Description</span><span class="sxs-lookup"><span data-stu-id="788e2-109">Description</span></span>|
|:----|:-----------|  
|<span data-ttu-id="788e2-110">*SID*</span><span class="sxs-lookup"><span data-stu-id="788e2-110">*SID*</span></span> |<span data-ttu-id="788e2-111">Identificateur de sécurité de l'utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="788e2-111">The current user's security identifier.</span></span>| 
|<span data-ttu-id="788e2-112">*StoreDisplayName*</span><span class="sxs-lookup"><span data-stu-id="788e2-112">*StoreDisplayName*</span></span> |<span data-ttu-id="788e2-113">Valeur de type String qui spécifie le nom d'affichage de l'utilisateur sur ce magasin.</span><span class="sxs-lookup"><span data-stu-id="788e2-113">A string that specifies the display name of the user on that store.</span></span>|
|<span data-ttu-id="788e2-114">*HashNumber*</span><span class="sxs-lookup"><span data-stu-id="788e2-114">*HashNumber*</span></span> |<span data-ttu-id="788e2-115">**DWORD** en représentation hexadécimale calculée en fonction de l'ID d'entrée de banque ou de la signature de mappage de banque.</span><span class="sxs-lookup"><span data-stu-id="788e2-115">A **DWORD** in hexadecimal representation that is calculated based on the store entry ID or the store mapping signature.</span></span> <span data-ttu-id="788e2-116">Cette valeur est stockée dans le registre et sera utilisée ultérieurement pour identifier le magasin dans le gestionnaire de protocole MAPI.</span><span class="sxs-lookup"><span data-stu-id="788e2-116">This value is stored in the registry and will be used later to identify the store in the MAPI Protocol Handler.</span></span><br/><br/><span data-ttu-id="788e2-117">Ce nombre doit être calculé d'une manière qui minimise les conflits avec d'autres magasins.</span><span class="sxs-lookup"><span data-stu-id="788e2-117">This number must be calculated in a way that minimizes collisions with other stores.</span></span> <span data-ttu-id="788e2-118">Pour l'algorithme que Microsoft Outlook utilise pour calculer le numéro de hachage, voir [algorithme pour calculer le numéro de hachage de magasin](algorithm-to-calculate-the-store-hash-number.md).</span><span class="sxs-lookup"><span data-stu-id="788e2-118">For the algorithm that Microsoft Outlook uses to calculate the hash number, see [Algorithm to Calculate the Store Hash Number](algorithm-to-calculate-the-store-hash-number.md).</span></span>|
|<span data-ttu-id="788e2-119">*StoreType*</span><span class="sxs-lookup"><span data-stu-id="788e2-119">*StoreType*</span></span> |<span data-ttu-id="788e2-120">Numéro qui identifie le type de la Banque contenant l'objet à indexer.</span><span class="sxs-lookup"><span data-stu-id="788e2-120">A number that identifies the type of the store that contains the object to be indexed.</span></span> <span data-ttu-id="788e2-121">Les valeurs possibles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="788e2-121">The possible values are as follows:</span></span><br/><span data-ttu-id="788e2-122">-0-Banque par défaut.</span><span class="sxs-lookup"><span data-stu-id="788e2-122">- 0 - Default store.</span></span><br/><br/><span data-ttu-id="788e2-123">-1-Banque de délégués, utilisée pour les éléments délégués mis en cache localement.</span><span class="sxs-lookup"><span data-stu-id="788e2-123">- 1 - Delegate store, used for delegate items cached locally.</span></span><br/><br/><span data-ttu-id="788e2-124">-2-dossiers publics, utilisés pour les favoris des dossiers publics.</span><span class="sxs-lookup"><span data-stu-id="788e2-124">- 2 - Public folders, used for public folder favorites.</span></span><br/><br/><span data-ttu-id="788e2-125">**Remarque**: si la Banque est en cours d'analyse au lieu d'être envoyée, la valeur utilisée est le caractère*X*.</span><span class="sxs-lookup"><span data-stu-id="788e2-125">**NOTE**: If the store is being crawled instead of pushed, the value that is used is the character*X*.</span></span>| 
|<span data-ttu-id="788e2-126">*FolderNameA/.../FolderNameN*</span><span class="sxs-lookup"><span data-stu-id="788e2-126">*FolderNameA/…/FolderNameN*</span></span> |<span data-ttu-id="788e2-127">Chemin d'accès à la racine de l'arborescence IPM_SUBTREE vers le dossier ou le message.</span><span class="sxs-lookup"><span data-stu-id="788e2-127">The path from the root of the IPM_SUBTREE to the folder or message.</span></span> <span data-ttu-id="788e2-128">Par exemple, un message dans le dossier **famille** sous **boîte de réception** dispose de la boîte de **réception/famille** de ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="788e2-128">For example, a message in the **Family** folder under **Inbox** has **Inbox/Family** for this parameter.</span></span> |
|<span data-ttu-id="788e2-129">*EntryIDEncoded*</span><span class="sxs-lookup"><span data-stu-id="788e2-129">*EntryIDEncoded*</span></span> |<span data-ttu-id="788e2-130">ID d'entrée MAPI pour l'élément encodé en tant que chaîne Unicode.</span><span class="sxs-lookup"><span data-stu-id="788e2-130">MAPI entry ID for the item encoded as a Unicode string.</span></span> <span data-ttu-id="788e2-131">Consultez la section suivante «caractères spéciaux» pour plus d'informations sur la façon dont certains caractères spéciaux sont codés.</span><span class="sxs-lookup"><span data-stu-id="788e2-131">See the following section "Special Characters" for information about how certain special characters are encoded.</span></span> <span data-ttu-id="788e2-132">Pour plus d'informations sur l'algorithme permettant de coder l'ID d'entrée, voir [algorithme pour coder les ID d'entrée et les ID de pièces jointes](algorithm-to-encode-entry-ids-and-attachment-ids.md).</span><span class="sxs-lookup"><span data-stu-id="788e2-132">For more information about the algorithm to encode the entry ID, see [Algorithm to Encode Entry IDs and Attachment IDs](algorithm-to-encode-entry-ids-and-attachment-ids.md).</span></span><br/><br/><span data-ttu-id="788e2-133">**Remarque**: lorsqu'il est affiché en tant que texte, cet ID d'entrée codé apparaît sous la forme de caractères Hangul aléatoires ou de zones conformes à l'algorithme, en fonction des polices disponibles.</span><span class="sxs-lookup"><span data-stu-id="788e2-133">**NOTE**: When viewed as text, this encoded entry ID appears as random Hangul characters or boxes in compliance with the algorithm, depending on available fonts.</span></span>  |
|<span data-ttu-id="788e2-134">*AttachIDEncoded*</span><span class="sxs-lookup"><span data-stu-id="788e2-134">*AttachIDEncoded*</span></span> |<span data-ttu-id="788e2-135">ID de la pièce jointe codée en tant que chaîne Unicode.</span><span class="sxs-lookup"><span data-stu-id="788e2-135">Attachment ID encoded as a Unicode string.</span></span> <span data-ttu-id="788e2-136">Consultez la section suivante «caractères spéciaux» pour plus d'informations sur la façon dont certains caractères spéciaux sont codés.</span><span class="sxs-lookup"><span data-stu-id="788e2-136">See the following section "Special Characters" for information about how certain special characters are encoded.</span></span> <span data-ttu-id="788e2-137">Pour plus d'informations sur l'algorithme permettant de coder l'ID d'entrée, voir [algorithme pour coder les ID d'entrée et les ID de pièces jointes](algorithm-to-encode-entry-ids-and-attachment-ids.md).</span><span class="sxs-lookup"><span data-stu-id="788e2-137">For more information about the algorithm to encode the entry ID, see [Algorithm to Encode Entry IDs and Attachment IDs](algorithm-to-encode-entry-ids-and-attachment-ids.md).</span></span><br/><br/><span data-ttu-id="788e2-138">**Remarque**: lorsqu'il est affiché en tant que texte, cet ID d'entrée codé apparaît sous la forme de caractères Hangul aléatoires ou de zones conformes à l'algorithme, en fonction des polices disponibles.</span><span class="sxs-lookup"><span data-stu-id="788e2-138">**NOTE**: When viewed as text, this encoded entry ID appears as random Hangul characters or boxes in compliance with the algorithm, depending on available fonts.</span></span> |
|<span data-ttu-id="788e2-139">*FileName*</span><span class="sxs-lookup"><span data-stu-id="788e2-139">*FileName*</span></span> |<span data-ttu-id="788e2-140">Nom du fichier de pièce jointe, tel qu'il apparaît dans le message.</span><span class="sxs-lookup"><span data-stu-id="788e2-140">Name of the attachment file, as it appears in the message.</span></span>|
    
## <a name="examples-of-mapi-urls"></a><span data-ttu-id="788e2-141">Exemples d'URL MAPI</span><span class="sxs-lookup"><span data-stu-id="788e2-141">Examples of MAPI URLs</span></span>

<span data-ttu-id="788e2-142">Voici quelques exemples d'URL MAPI.</span><span class="sxs-lookup"><span data-stu-id="788e2-142">The following are some examples of MAPI URLs.</span></span>
  
- <span data-ttu-id="788e2-143">URL MAPI pour un dossier:</span><span class="sxs-lookup"><span data-stu-id="788e2-143">MAPI URL for a folder:</span></span> 
    
  `mapi://S-1-5-21-2127521184-1604012920-1887927527-71418/Mailbox - Some User ($be19928f)/2/Office`
    
- <span data-ttu-id="788e2-144">URL MAPI pour un message:</span><span class="sxs-lookup"><span data-stu-id="788e2-144">MAPI URL for a message:</span></span> 
    
  `mapi://S-1-5-21-2127521184-1604012920-1887927527-71418/Mailbox - Some User ($484efb89)/0/Calendar/곯가가가걍걝걌곌겷걢곒갑겛개가검걟곔걙곾걤곂갠가`
    
- <span data-ttu-id="788e2-145">URL MAPI pour une pièce jointe:</span><span class="sxs-lookup"><span data-stu-id="788e2-145">MAPI URL for an attachment:</span></span> 
    
  `mapi://S-1-5-21-2127521184-1604012920-1887927527-71418/Mailbox - Some User ($484efb89)/0/Inbox/곯가가가걍걝걌곌겷걢곒갑겛개가검걟곔걙곾간곷갦가/at=겅걋각가:somefile.txt`
    
## <a name="special-characters"></a><span data-ttu-id="788e2-146">Caractères spéciaux</span><span class="sxs-lookup"><span data-stu-id="788e2-146">Special characters</span></span>

<span data-ttu-id="788e2-147">Certains caractères sont encodés s'ils apparaissent dans le message ou dans une pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="788e2-147">Certain characters are encoded if they appear in the message or attachment.</span></span> <span data-ttu-id="788e2-148">Les caractères suivants sont codés dans une URL MAPI:</span><span class="sxs-lookup"><span data-stu-id="788e2-148">The following shows which characters are encoded in a MAPI URL:</span></span>
  
- <span data-ttu-id="788e2-149">% >% 25</span><span class="sxs-lookup"><span data-stu-id="788e2-149">% > %25</span></span>
    
- <span data-ttu-id="788e2-150">/>% 2F</span><span class="sxs-lookup"><span data-stu-id="788e2-150">/ > %2F</span></span> 
    
- <span data-ttu-id="788e2-151">\ >% 5C</span><span class="sxs-lookup"><span data-stu-id="788e2-151">\ > %5C</span></span> 
    
- <span data-ttu-id="788e2-152">\*>% 2A</span><span class="sxs-lookup"><span data-stu-id="788e2-152">\* > %2A</span></span> 
    
- <span data-ttu-id="788e2-153">?</span><span class="sxs-lookup"><span data-stu-id="788e2-153"></span></span> <span data-ttu-id="788e2-154">>% 3F</span><span class="sxs-lookup"><span data-stu-id="788e2-154">> %3F</span></span> 
    
## <a name="blob-associated-with-each-mapi-url"></a><span data-ttu-id="788e2-155">Objet BLOB associé à chaque URL MAPI</span><span class="sxs-lookup"><span data-stu-id="788e2-155">Blob associated with each MAPI URL</span></span>

<span data-ttu-id="788e2-156">Lors du push d'une URL MAPI pour qu'un objet soit indexé, un fournisseur de banque d'informations crée également un objet BLOB (Binary Large Object) contenant certaines informations pour le gestionnaire de protocole MAPI.</span><span class="sxs-lookup"><span data-stu-id="788e2-156">When pushing a MAPI URL for an object to be indexed, a store provider also creates a binary large object (BLOB) that contains certain information for the MAPI Protocol Handler.</span></span> <span data-ttu-id="788e2-157">Le fournisseur de banque d'adresses associe cet objet BLOB à chaque URL MAPI et l'envoie lors du transfert de l'URL MAPI vers l'indexeur.</span><span class="sxs-lookup"><span data-stu-id="788e2-157">The store provider associates this BLOB with each MAPI URL and sends it when pushing the MAPI URL to the indexer.</span></span> <span data-ttu-id="788e2-158">Le format de l'objet BLOB est le suivant:</span><span class="sxs-lookup"><span data-stu-id="788e2-158">The format of the BLOB is as follows:</span></span> 
  
```cpp
DWORD  dwVersion
DWORD  dwFlags
ULONG  cbProfileName
WCHAR  wszProfileName
ULONG  cbProviderItemID
WCHAR  wszProviderItemID
```

<span data-ttu-id="788e2-159">Le fournisseur de banque d'données doit écrire ces valeurs dans l'objet BLOB dans l'ordre indiqué.</span><span class="sxs-lookup"><span data-stu-id="788e2-159">The store provider must write these values to the BLOB in the order shown.</span></span> <span data-ttu-id="788e2-160">Le tableau suivant décrit chaque champ du BLOB.</span><span class="sxs-lookup"><span data-stu-id="788e2-160">The following table describes each field of the BLOB.</span></span>

|<span data-ttu-id="788e2-161">Quitter</span><span class="sxs-lookup"><span data-stu-id="788e2-161">Part</span></span> | <span data-ttu-id="788e2-162">Description</span><span class="sxs-lookup"><span data-stu-id="788e2-162">Description</span></span>|
|:----|:-----------|  
|<span data-ttu-id="788e2-163">*dwVersion*</span><span class="sxs-lookup"><span data-stu-id="788e2-163">*dwVersion*</span></span> |<span data-ttu-id="788e2-164">Il s'agit de la version des données envoyées.</span><span class="sxs-lookup"><span data-stu-id="788e2-164">This is the version of the data being sent.</span></span> <span data-ttu-id="788e2-165">Actuellement, cette valeur est 1.</span><span class="sxs-lookup"><span data-stu-id="788e2-165">Currently this value is 1.</span></span>|
|<span data-ttu-id="788e2-166">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="788e2-166">*dwFlags*</span></span> |<span data-ttu-id="788e2-167">Réservé à une utilisation future.</span><span class="sxs-lookup"><span data-stu-id="788e2-167">Reserved for future use.</span></span> <span data-ttu-id="788e2-168">Actuellement, cette valeur doit être égale à 0.</span><span class="sxs-lookup"><span data-stu-id="788e2-168">Currently this value should be 0.</span></span>|
|<span data-ttu-id="788e2-169">*cbProfileName*</span><span class="sxs-lookup"><span data-stu-id="788e2-169">*cbProfileName*</span></span> |<span data-ttu-id="788e2-170">Taille du nom de profil, en octets.</span><span class="sxs-lookup"><span data-stu-id="788e2-170">The size of the profile name, in bytes.</span></span> <span data-ttu-id="788e2-171">Ces informations sont utiles pour que le gestionnaire de protocole MAPI sache quel profil utiliser lors de l'indexation de l'élément.</span><span class="sxs-lookup"><span data-stu-id="788e2-171">This information is useful for the MAPI Protocol Handler to know which profile to use when indexing the item.</span></span>|
|<span data-ttu-id="788e2-172">*wszProfileName*</span><span class="sxs-lookup"><span data-stu-id="788e2-172">*wszProfileName*</span></span> |<span data-ttu-id="788e2-173">Chaîne Unicode terminée par un caractère null qui contient le nom du profil.</span><span class="sxs-lookup"><span data-stu-id="788e2-173">Null-terminated Unicode string that contains the profile name.</span></span>|
|<span data-ttu-id="788e2-174">*cbProviderItemID*</span><span class="sxs-lookup"><span data-stu-id="788e2-174">*cbProviderItemID*</span></span> |<span data-ttu-id="788e2-175">Taille de l'ID d'élément de fournisseur, en octets.</span><span class="sxs-lookup"><span data-stu-id="788e2-175">Size of the provider item ID, in bytes.</span></span> <span data-ttu-id="788e2-176">Le fournisseur de banque d'informations doit envoyer uniquement l'ID d'élément de fournisseur pour les dossiers, afin d'empêcher l'ouverture de dossiers supplémentaires pour obtenir ces informations.</span><span class="sxs-lookup"><span data-stu-id="788e2-176">The store provider should send only the provider item ID for folders, to prevent opening additional folders to get this information.</span></span>|
|<span data-ttu-id="788e2-177">*wszProviderItemID*</span><span class="sxs-lookup"><span data-stu-id="788e2-177">*wszProviderItemID*</span></span> |<span data-ttu-id="788e2-178">Chaîne Unicode terminée par un caractère NULL avec l'ID d'élément de fournisseur qui identifie de façon unique l'élément dans le magasin.</span><span class="sxs-lookup"><span data-stu-id="788e2-178">Null-terminated Unicode string with the provider item ID that uniquely identifies the item in the store.</span></span>|
    
## <a name="see-also"></a><span data-ttu-id="788e2-179">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="788e2-179">See also</span></span>

- [<span data-ttu-id="788e2-180">À propos de l'indexation du magasin basé sur les notifications</span><span class="sxs-lookup"><span data-stu-id="788e2-180">About Notification-Based Store Indexing</span></span>](about-notification-based-store-indexing.md)
- [<span data-ttu-id="788e2-181">Constantes MAPI</span><span class="sxs-lookup"><span data-stu-id="788e2-181">MAPI Constants</span></span>](mapi-constants.md)

