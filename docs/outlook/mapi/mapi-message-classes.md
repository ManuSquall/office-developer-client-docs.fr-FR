---
title: MAPI Message Classes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 64ef2bbb-585c-4908-8ad4-a1c954057e9b
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: b2ab5d56c53216152a83ca207ff5ba1d53c9049d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412085"
---
# <a name="mapi-message-classes"></a><span data-ttu-id="f88ef-103">MAPI Message Classes</span><span class="sxs-lookup"><span data-stu-id="f88ef-103">MAPI Message Classes</span></span>

  
  
<span data-ttu-id="f88ef-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="f88ef-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="f88ef-105">Chaque message possède une propriété de classe de message, **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)), qui identifie le type, l’objectif ou le contenu du message.</span><span class="sxs-lookup"><span data-stu-id="f88ef-105">Every message has a message class property, **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)), which identifies the type, purpose, or content of the message.</span></span> <span data-ttu-id="f88ef-106">**PR_MESSAGE_CLASS** est une propriété obligatoire sur tous les nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="f88ef-106">**PR_MESSAGE_CLASS** is a required property on all new messages.</span></span> <span data-ttu-id="f88ef-107">La classe d’un message détermine le formulaire utilisé pour présenter le message à l’utilisateur et le dossier pour le placement des messages entrants.</span><span class="sxs-lookup"><span data-stu-id="f88ef-107">A message's class determines the form that is used to present the message to the user and the folder for placing incoming messages.</span></span> 
  
<span data-ttu-id="f88ef-108">Les classes de message sont des chaînes de caractères sensibles à la cas qui contiennent des caractères ASCII 32 à 127 et sont délimitées par des périodes, mais elles ne peuvent pas se terminer par un point.</span><span class="sxs-lookup"><span data-stu-id="f88ef-108">Message classes are case-sensitive character strings that contain ASCII characters 32 through 127 and are delimited by periods, but they cannot end with a period.</span></span> <span data-ttu-id="f88ef-109">Chaque chaîne représente un niveau de sous-classe et le nombre de niveaux autorisé n’est pas limité.</span><span class="sxs-lookup"><span data-stu-id="f88ef-109">Each string represents a level of subclassing, and there is no limit to the number of levels allowed.</span></span> 
  
<span data-ttu-id="f88ef-110">Par exemple, la plupart des messages que les applications clientes envoient et reçoivent relèvent de la classe de message **IPM,** une catégorie large qui décrit tous les messages interpersonnels (c’est-à-dire, les messages destinés à être lus par un utilisateur humain, plutôt que par programme par un ordinateur).</span><span class="sxs-lookup"><span data-stu-id="f88ef-110">For example, most messages that client applications send and receive fall into the **IPM** message class, a broad category that describes all interpersonal messages (that is, messages that are meant to be read by a human user, rather than programmatically by a computer).</span></span> <span data-ttu-id="f88ef-111">Les fournisseurs de magasins de messages décrivent plus précisément un message IPM en créant une **sous-classe IPM.**</span><span class="sxs-lookup"><span data-stu-id="f88ef-111">Message store providers more precisely describe an IPM message by creating an **IPM** subclass.</span></span> <span data-ttu-id="f88ef-112">La **sous-classe IPM** hérite des propriétés de la classe de message **IPM.**</span><span class="sxs-lookup"><span data-stu-id="f88ef-112">The **IPM** subclass inherits the properties of the **IPM** message class.</span></span> <span data-ttu-id="f88ef-113">Les sous-classes de la **classe IPM** sont nommées en concatenant d’autres chaînes de caractères sur l’identificateur **IPM, comme IPM. Remarque** pour décrire un message de note et **un IPM. Contactez** pour décrire un message de contact.</span><span class="sxs-lookup"><span data-stu-id="f88ef-113">Subclasses of the **IPM** class are named by concatenating other character strings onto the IPM identifier, such as **IPM.Note** to describe a note message and **IPM.Contact** to describe a contact message.</span></span> 
  
<span data-ttu-id="f88ef-114">Pour gérer l’affichage et la gestion des messages IPM, les clients peuvent utiliser un formulaire standard que MAPI fournit.</span><span class="sxs-lookup"><span data-stu-id="f88ef-114">To handle the display and management of IPM messages, clients can use a standard form that MAPI provides.</span></span> <span data-ttu-id="f88ef-115">Pour gérer l’affichage et la gestion de nouvelles classes de messages, en tant que développeur d’applications clientes, vous avez deux options :</span><span class="sxs-lookup"><span data-stu-id="f88ef-115">To handle the display and management of new message classes, you as a client application developer have two options:</span></span>
  
1. <span data-ttu-id="f88ef-116">Vous pouvez créer un formulaire à l’aide de l’ensemble d’interfaces de formulaire définies par MAPI qu’un client standard peut utiliser.</span><span class="sxs-lookup"><span data-stu-id="f88ef-116">You can create a new form by using the set of MAPI-defined form interfaces that a standard client can use.</span></span>
    
2. <span data-ttu-id="f88ef-117">Vous pouvez écrire votre propre client en implémentant une application complète et autonome.</span><span class="sxs-lookup"><span data-stu-id="f88ef-117">You can write your own client by implementing a complete, standalone application.</span></span> 
    
<span data-ttu-id="f88ef-118">Bien que les clients doivent définir la propriété PR_MESSAGE_CLASS pour chaque message sortant sur une sous-classe **IPM** ou **IPC,** le fournisseur de magasin de messages **a** la responsabilité finale de le définir.</span><span class="sxs-lookup"><span data-stu-id="f88ef-118">Although clients should set the **PR_MESSAGE_CLASS** property for every outgoing message to a subclass of either **IPM** or **IPC**, the message store provider has the ultimate responsibility for setting it.</span></span> <span data-ttu-id="f88ef-119">Par conséquent, si un client envoie un message sans définir sa classe de message, le fournisseur de magasin de messages le définit sur la valeur par défaut appropriée pour le type approprié de client.</span><span class="sxs-lookup"><span data-stu-id="f88ef-119">Therefore, if a client sends a message without setting its message class, the message store provider sets it to the appropriate default value for the appropriate type of client.</span></span> <span data-ttu-id="f88ef-120">La classe de message par défaut pour les clients de messagerie interpersonnel est **IPM**; la classe de message par défaut pour les clients de communication interprocessus est **IPC**.</span><span class="sxs-lookup"><span data-stu-id="f88ef-120">The default message class for interpersonal messaging clients is **IPM**; the default message class for interprocess communication clients is **IPC**.</span></span> 
  
<span data-ttu-id="f88ef-121">Les classes de message ont une restriction de longueur de 255 caractères.</span><span class="sxs-lookup"><span data-stu-id="f88ef-121">Message classes have a length restriction of 255 characters.</span></span> <span data-ttu-id="f88ef-122">Toutefois, les classes de message ne doivent pas dépasser 127 caractères pour prendre en charge les classes de message utilisées dans les états.</span><span class="sxs-lookup"><span data-stu-id="f88ef-122">However, message classes should not exceed 127 characters to support the message classes used in reports.</span></span> <span data-ttu-id="f88ef-123">Les classes de message de rapport sont basées sur la classe du message d’origine, avec deux ajouts : un préfixe et un suffixe.</span><span class="sxs-lookup"><span data-stu-id="f88ef-123">Report message classes are based on the class of the original message, with two additions: a prefix and a suffix.</span></span> <span data-ttu-id="f88ef-124">Le préfixe REPORT indique que le message est un rapport et que le suffixe indique le type de rapport : DR (rapport de remise), NDR (rapport de non remise), IPNRN (rapport de lecture) ou IPNNRN (rapport non lu).</span><span class="sxs-lookup"><span data-stu-id="f88ef-124">The prefix REPORT indicates that the message is a report, and the suffix indicates the type of report: DR (delivery report), NDR (nondelivery report), IPNRN (read report), or IPNNRN (nonread report).</span></span> <span data-ttu-id="f88ef-125">Notez que ces restrictions de longueur sont données en caractères ; sur les plateformes qui utilisent un jeu de caractères sur deux sur deux caractères, le nombre d’byte réel peut être supérieur.</span><span class="sxs-lookup"><span data-stu-id="f88ef-125">Note that these length restrictions are given in characters; on platforms that use a double-byte character set, the actual byte count might be higher.</span></span> 
  
<span data-ttu-id="f88ef-126">Les fournisseurs de magasins de messages doivent renvoyer des MAPI_E_INVALID_PARAMETER à partir de leurs implémentations de méthode [IMAPIProp::SetProps](imapiprop-setprops.md) lorsqu’un client tente d’affecter une chaîne qui dépasse la limite autorisée pour sa classe de message.</span><span class="sxs-lookup"><span data-stu-id="f88ef-126">Message store providers should return MAPI_E_INVALID_PARAMETER from their [IMAPIProp::SetProps](imapiprop-setprops.md) method implementations when a client attempts to assign a string that exceeds the allowable limit for their message class.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="f88ef-127">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f88ef-127">See also</span></span>



[<span data-ttu-id="f88ef-128">MAPI Messages</span><span class="sxs-lookup"><span data-stu-id="f88ef-128">MAPI Messages</span></span>](mapi-messages.md)

