---
title: Cache de surnoms
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Last modified: January 30, 2013'
ms.openlocfilehash: 841b01ae8dfcf841b0a1d64113ce7258c4c61583
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334516"
---
# <a name="nickname-cache"></a><span data-ttu-id="b0b63-103">Cache de surnoms</span><span class="sxs-lookup"><span data-stu-id="b0b63-103">Nickname cache</span></span>

 
  
<span data-ttu-id="b0b63-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="b0b63-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="b0b63-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010 et Microsoft Outlook 2013 interagissent avec le cache de surnoms, également appelé « flux de mise à jour automatique ».</span><span class="sxs-lookup"><span data-stu-id="b0b63-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010, and Microsoft Outlook 2013 interact with the nickname cache, also known as the "autocomplete stream."</span></span> <span data-ttu-id="b0b63-106">Le flux de la mise à jour automatique est l’endroit où Outlook fait persister la liste de la mise à jour automatique, qui est la liste des noms qui s’affiche dans les zones d’édition **À**, **Cc** et **Cci** pendant qu’un utilisateur compose un e-mail.</span><span class="sxs-lookup"><span data-stu-id="b0b63-106">The autocomplete stream is where Outlook persists the autocomplete list, which is the list of names that displays in the **To**, **Cc**, and **Bcc** edit boxes while a user is composing an email.</span></span> <span data-ttu-id="b0b63-107">Cette rubrique décrit la façon dont Outlook 2007, Outlook 2010 et Outlook 2013 interagissent avec le flux de la mise àcomplet automatique et traite également du format binaire du fichier et des méthodes recommandées pour interagir avec le flux de la mise à la place automatique.</span><span class="sxs-lookup"><span data-stu-id="b0b63-107">This topic describes how Outlook 2007, Outlook 2010, and Outlook 2013 interact with the autocomplete stream and also discusses the binary format of the file and the recommended ways for interacting with the autocomplete stream.</span></span> 
  
<span data-ttu-id="b0b63-108">Pour les applications qui interagissent avec Outlook 2010 ou Outlook 2013, le flux de mise à jour automatique est stocké en tant que propriété MAPI et peut être modifié à l’aide de l’objet MAPI ou **PropertyAccessor** du message.</span><span class="sxs-lookup"><span data-stu-id="b0b63-108">For applications that interact with Outlook 2010 or Outlook 2013, the autocomplete stream is stored as a MAPI property and can be modified using the MAPI or the **PropertyAccessor** object of the message.</span></span> <span data-ttu-id="b0b63-109">**L’objet PropertyAccessor** est exposé dans les modèles objet Outlook 2010 ou Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="b0b63-109">The **PropertyAccessor** object is exposed in the Outlook 2010 or Outlook 2013 object models.</span></span> 
  
<span data-ttu-id="b0b63-110">Il n’existe aucune dépendance sur le modèle objet Outlook 2007 ou les API MAPI.</span><span class="sxs-lookup"><span data-stu-id="b0b63-110">There are no dependencies on the Outlook 2007 object model or MAPI APIs.</span></span> <span data-ttu-id="b0b63-111">Par conséquent, les applications qui modifient le flux de la mise à jour automatique dans Outlook 2007 peuvent être écrites à l’aide de n’importe quel langage de programmation.</span><span class="sxs-lookup"><span data-stu-id="b0b63-111">Therefore, applications that make changes to the autocomplete stream within Outlook 2007 can be written using any programming language.</span></span>
  
## <a name="interacting-with-the-autocomplete-stream"></a><span data-ttu-id="b0b63-112">Interaction avec le flux decomplet automatique</span><span class="sxs-lookup"><span data-stu-id="b0b63-112">Interacting with the Autocomplete Stream</span></span>

<span data-ttu-id="b0b63-113">Lorsque les zones d’édition **À,** **Cc** ou **Cci** sont accessibles sur un message, le flux de mise à jour automatique est chargé et la liste des noms d’utilisateurs s’affiche.</span><span class="sxs-lookup"><span data-stu-id="b0b63-113">When the **To**, **Cc**, or **Bcc** edit boxes are accessed on a message, the autocomplete stream is loaded and the list of user names is displayed.</span></span> <span data-ttu-id="b0b63-114">Outlook interagit avec le flux de la mise à jour automatique de deux manières :</span><span class="sxs-lookup"><span data-stu-id="b0b63-114">Outlook interacts with the autocomplete stream in two ways:</span></span> 
  
1. <span data-ttu-id="b0b63-115">Chargement du flux de lacomplete automatique</span><span class="sxs-lookup"><span data-stu-id="b0b63-115">Loading the autocomplete stream</span></span> 
    
2. <span data-ttu-id="b0b63-116">Enregistrement des modifications apportées aux données dans le flux decomplet automatique</span><span class="sxs-lookup"><span data-stu-id="b0b63-116">Saving changes to the data in the autocomplete stream</span></span>
    
<span data-ttu-id="b0b63-117">Les moyens de stockage des données de la mise à jour automatique diffèrent entre Outlook 2007 et Outlook 2010 ou Outlook 2013 comme suit :</span><span class="sxs-lookup"><span data-stu-id="b0b63-117">The means of storing the autocomplete data differs between Outlook 2007 and Outlook 2010 or Outlook 2013 as follows:</span></span> 
  
 <span data-ttu-id="b0b63-118">**Outlook 2007**</span><span class="sxs-lookup"><span data-stu-id="b0b63-118">**Outlook 2007**</span></span>
  
<span data-ttu-id="b0b63-119">Pour Outlook 2007, le flux de la mise à jour automatique est stocké dans un fichier avec le même nom que le profil et une extension de .nk2.</span><span class="sxs-lookup"><span data-stu-id="b0b63-119">For Outlook 2007, the autocomplete stream is stored in a file with the same name as the profile and an extension of .nk2.</span></span> <span data-ttu-id="b0b63-120">Par exemple, si le profil par défaut de « outlook » est utilisé, le fichier sera appelé « outlook.nk2 ».</span><span class="sxs-lookup"><span data-stu-id="b0b63-120">For example, if the default profile of "outlook" is used, the file will be called "outlook.nk2".</span></span> <span data-ttu-id="b0b63-121">Le fichier .nk2 est stocké dans %APPDATA%\Microsoft\Outlook.</span><span class="sxs-lookup"><span data-stu-id="b0b63-121">The .nk2 file is stored in %APPDATA%\Microsoft\Outlook.</span></span> <span data-ttu-id="b0b63-122">Pour plus d’informations sur le format de fichier binaire du cache de surnoms, voir [Outlook 2003/2007 NK2 File Format and Developer Guidelines](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span><span class="sxs-lookup"><span data-stu-id="b0b63-122">For more information about the nickname cache binary file format, see [Outlook 2003/2007 NK2 File Format and Developer Guidelines](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span></span>
  
 <span data-ttu-id="b0b63-123">**Outlook 2010 et Outlook 2013**</span><span class="sxs-lookup"><span data-stu-id="b0b63-123">**Outlook 2010 and Outlook 2013**</span></span>
  
<span data-ttu-id="b0b63-124">Outlook 2010 ou Outlook 2013 lit le flux de la mise encomplet automatique à partir d’un message dans la table Contenu associé de la boîte de réception de la banque de remise du compte de messagerie.</span><span class="sxs-lookup"><span data-stu-id="b0b63-124">Outlook 2010 or Outlook 2013 reads the autocomplete stream from a message in the Associated Contents table of the Inbox of the mail account's delivery store.</span></span> <span data-ttu-id="b0b63-125">Ce message masqué a une classe de message et l’objet de IPM.Configuration. Autocomplete.</span><span class="sxs-lookup"><span data-stu-id="b0b63-125">This hidden message has a message class and subject of IPM.Configuration.Autocomplete.</span></span> <span data-ttu-id="b0b63-126">Le flux de mise à jour automatique est stocké sur ce message dans la propriété PR_ROAMING_BINARYSTREAM ( Propriété canonique[PidTagRoamingBinary](pidtagroamingbinary-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="b0b63-126">The autocomplete stream is stored on this message in the PR_ROAMING_BINARYSTREAM property ([PidTagRoamingBinary Canonical Property](pidtagroamingbinary-canonical-property.md)).</span></span> <span data-ttu-id="b0b63-127">Les données de la mise en cache automatique peuvent être temporairement mises en cache dans un fichier .dat de mise à jour automatique situé dans %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span><span class="sxs-lookup"><span data-stu-id="b0b63-127">The autocomplete data may be temporarily cached in an autocomplete .dat file located in %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span></span> <span data-ttu-id="b0b63-128">Toutefois, le fichier .dat est uniquement un cache et n’est pas utilisé pour écrire dans le magasin de remise lorsque l’utilisateur quitte Outlook 2010 ou Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="b0b63-128">However, the .dat file is only a cache and is not used to write back to the delivery store when the user exits Outlook 2010 or Outlook 2013.</span></span>
  
## <a name="loading-the-autocomplete-stream"></a><span data-ttu-id="b0b63-129">Chargement du flux de la mise àcomplet automatique</span><span class="sxs-lookup"><span data-stu-id="b0b63-129">Loading the Autocomplete Stream</span></span>

<span data-ttu-id="b0b63-130">Outlook charge le flux de saisiecomplet automatique chaque fois qu’un élément avec la fonctionnalité d’adressaing est initialisé.</span><span class="sxs-lookup"><span data-stu-id="b0b63-130">Outlook loads the autocomplete stream whenever an item with addressing functionality is initialized.</span></span> <span data-ttu-id="b0b63-131">Par exemple, les adresses de messagerie sont utilisées dans un nouveau courrier, une réponse aux messages, un élément de contact, une demande de réunion, etc.</span><span class="sxs-lookup"><span data-stu-id="b0b63-131">For example, email addresses are used in a new mail, a mail reply, a contact item, a meeting request, and so on.</span></span> <span data-ttu-id="b0b63-132">Pour charger les données, Outlook lit tout le contenu du flux dans la mémoire.</span><span class="sxs-lookup"><span data-stu-id="b0b63-132">To load the data, Outlook reads all of the contents of the stream into memory.</span></span>
  
<span data-ttu-id="b0b63-133">Pour les opérations de mise à jour automatique, Outlook interagit exclusivement avec cette structure en mémoire pendant toute la durée outlook.exe durée de vie du processus.</span><span class="sxs-lookup"><span data-stu-id="b0b63-133">For autocomplete operations, Outlook interacts exclusively with this in-memory structure for the duration of the outlook.exe process lifetime.</span></span> <span data-ttu-id="b0b63-134">Outlook enregistre uniquement la structure à l’arrêt.</span><span class="sxs-lookup"><span data-stu-id="b0b63-134">Outlook only saves the structure on shutdown.</span></span> <span data-ttu-id="b0b63-135">Pour plus d’informations sur ce processus, voir la section suivante « Enregistrement du flux de mise à jour automatique ».</span><span class="sxs-lookup"><span data-stu-id="b0b63-135">See the following section "Saving the Autocomplete Stream" for more information on this process.</span></span>
  
## <a name="saving-the-autocomplete-stream"></a><span data-ttu-id="b0b63-136">Enregistrement du flux de la mise àcomplet automatique</span><span class="sxs-lookup"><span data-stu-id="b0b63-136">Saving the Autocomplete Stream</span></span>

<span data-ttu-id="b0b63-137">Outlook enregistre le flux de mise à jour automatique à l’arrêt si la liste de la mise à jour automatique a été modifiée de l’une des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="b0b63-137">Outlook saves the autocomplete stream on shutdown if the autocomplete list has changed in any of the following ways:</span></span>
  
- <span data-ttu-id="b0b63-138">Une nouvelle entrée de surnom est ajoutée en résolvant un nom, en sélectionnant un destinataire dans la boîte de dialogue du carnet d’adresses ou en envoyant un message à un destinataire qui n’était pas déjà dans la liste.</span><span class="sxs-lookup"><span data-stu-id="b0b63-138">A new nickname entry is added through resolving a name, picking a recipient from the address book dialog, or sending mail to a recipient that was not already in the list.</span></span>
    
- <span data-ttu-id="b0b63-139">Une entrée est modifiée en envoyant un message électronique à un destinataire existant dans la liste.</span><span class="sxs-lookup"><span data-stu-id="b0b63-139">An entry is modified by sending mail to an existing recipient in the list.</span></span>
    
- <span data-ttu-id="b0b63-140">Une entrée est supprimée par l’utilisateur via l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b0b63-140">An entry is removed by the user through the UI.</span></span>
    
- <span data-ttu-id="b0b63-141">Autres scénarios mineurs non pertinents pour cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="b0b63-141">Other minor scenarios not relevant to this topic.</span></span>
    
<span data-ttu-id="b0b63-142">L’enregistrement des modifications apportées aux données de la mise àcomplet automatique implique l’écriture de la structure en mémoire dans un flux [de mise àcomplet automatique.](autocomplete-stream.md)</span><span class="sxs-lookup"><span data-stu-id="b0b63-142">Saving changes to the autocomplete data involves writing the in-memory structure back to an [Autocomplete Stream](autocomplete-stream.md).</span></span> <span data-ttu-id="b0b63-143">Lors de l’interaction avec Outlook 2007, le flux est enregistré dans un fichier .nk2 local.</span><span class="sxs-lookup"><span data-stu-id="b0b63-143">When interacting with Outlook 2007, the stream is saved to a local .nk2 file.</span></span> <span data-ttu-id="b0b63-144">Pour Outlook 2010 ou Outlook 2013, le flux decomplet automatique écrit dans la table Contenu associé de la boîte de réception de la banque de remise du compte de messagerie.</span><span class="sxs-lookup"><span data-stu-id="b0b63-144">For Outlook 2010 or Outlook 2013, the autocomplete stream writes back to the Associated Contents table of the Inbox of the mail account's delivery store.</span></span>
  
## <a name="recommendations"></a><span data-ttu-id="b0b63-145">Recommandations</span><span class="sxs-lookup"><span data-stu-id="b0b63-145">Recommendations</span></span>

- <span data-ttu-id="b0b63-146">Ne modifiez jamais partiellement le flux decomplet automatique.</span><span class="sxs-lookup"><span data-stu-id="b0b63-146">Never partially modify the autocomplete stream.</span></span> <span data-ttu-id="b0b63-147">L’interaction prise en charge est de 1) lire l’intégralité du flux de lacomplete automatique dans la mémoire, 2) modifier la structure de la mémoire et 3) écrire l’intégralité du flux dans la table Contenu associé de la boîte de réception de la banque de remise du compte de messagerie (pour Outlook 2010 ou Outlook 2013) ou dans le fichier .nk2 local (Outlook 2007).</span><span class="sxs-lookup"><span data-stu-id="b0b63-147">The supported interaction is to 1) read the entire autocomplete stream into memory, 2) modify the memory structure, and 3) write the entire stream back to either the Associated Contents table of the Inbox of the mail account's delivery store (for Outlook 2010 or Outlook 2013) or to the local .nk2 file (Outlook 2007).</span></span>
    
- <span data-ttu-id="b0b63-148">N’interagissez pas avec le flux decomplet automatique pendant l’exécution d’Outlook.</span><span class="sxs-lookup"><span data-stu-id="b0b63-148">Do not interact with the autocomplete stream while Outlook is running.</span></span> <span data-ttu-id="b0b63-149">Si Outlook est en cours d’exécution pendant que vous modifiez le flux, il est probable qu’il est susceptible de modifier vos modifications lors de son arrêt.</span><span class="sxs-lookup"><span data-stu-id="b0b63-149">If Outlook is running while you modify the stream, it will likely overwrite your changes when it shuts down.</span></span>
    
- <span data-ttu-id="b0b63-150">N’écrivez pas les propriétés de type PT_MV_UNICODE et PR_MV_STRING8 dans un flux de mise àcomplet automatique à consommer par Microsoft Outlook 2003.</span><span class="sxs-lookup"><span data-stu-id="b0b63-150">Do not write properties of type PT_MV_UNICODE and PR_MV_STRING8 into an autocomplete stream to be consumed by Microsoft Outlook 2003.</span></span> <span data-ttu-id="b0b63-151">Ces propriétés sont comprises uniquement par Outlook 2007, Outlook 2010 et Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="b0b63-151">These properties are only understood by Outlook 2007, Outlook 2010, and Outlook 2013.</span></span>
    
- <span data-ttu-id="b0b63-152">Lorsque vous développez du code qui interagit avec Outlook 2007, nous vous recommandons de verrouiller le fichier .nk2 d’une modification par d’autres processus pendant que vous l’lisez et l’écrivez à l’aide des API de verrouillage de fichier standard (par exemple, **LockFile** en C/C++ et **FileStream.Lock** en C#).</span><span class="sxs-lookup"><span data-stu-id="b0b63-152">When developing code that interacts with Outlook 2007, we recommend that you lock the .nk2 file from modification by other processes while you are reading and writing it using standard file locking APIs (for example, **LockFile** in C/C++ and **FileStream.Lock** in C#).</span></span> 
    
- <span data-ttu-id="b0b63-153">Modifiez uniquement les propriétés des types qui sont issus du jeu de lignes du flux de mise à jour automatique.</span><span class="sxs-lookup"><span data-stu-id="b0b63-153">Only modify the properties of types that are from the row-set of the autocomplete stream.</span></span> <span data-ttu-id="b0b63-154">Pour plus d’informations sur les propriétés de flux de lacomplete automatique et les types de propriétés, voir [Flux de lacomplet automatique.](autocomplete-stream.md)</span><span class="sxs-lookup"><span data-stu-id="b0b63-154">For more information about the autocomplete stream properties and property types, see [Autocomplete Stream](autocomplete-stream.md).</span></span>
    
## <a name="see-also"></a><span data-ttu-id="b0b63-155">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b0b63-155">See also</span></span>



[<span data-ttu-id="b0b63-156">Autocomplete Stream</span><span class="sxs-lookup"><span data-stu-id="b0b63-156">Autocomplete Stream</span></span>](autocomplete-stream.md)
  
[<span data-ttu-id="b0b63-157">Profils MAPI</span><span class="sxs-lookup"><span data-stu-id="b0b63-157">MAPI Profiles</span></span>](mapi-profiles.md)


[<span data-ttu-id="b0b63-158">Outlook 2003/2007 NK2 File Format and Developer Guidelines</span><span class="sxs-lookup"><span data-stu-id="b0b63-158">Outlook 2003/2007 NK2 File Format and Developer Guidelines</span></span>](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)

