---
title: Cache du surnom dans
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Dernière modification : 30 janvier 2013'
ms.openlocfilehash: 1ea1d3e6f636cf6a3ad47b6fdfe88d0f7130a5f3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19784907"
---
# <a name="nickname-cache"></a><span data-ttu-id="c772a-103">Cache du surnom dans</span><span class="sxs-lookup"><span data-stu-id="c772a-103">Nickname cache</span></span>

 
  
<span data-ttu-id="c772a-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="c772a-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="c772a-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010 et Microsoft Outlook 2013 interagissent avec le cache du surnom, également appelé « saisie semi-automatique flux. »</span><span class="sxs-lookup"><span data-stu-id="c772a-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010, and Microsoft Outlook 2013 interact with the nickname cache, also known as the "autocomplete stream."</span></span> <span data-ttu-id="c772a-106">Le flux de saisie semi-automatique est où Outlook persiste la liste de saisie semi-automatique, qui est la liste de noms qui s’affiche dans la zone **à**, **Cc**et **Cci** des zones d’édition pendant un utilisateur compose un message électronique.</span><span class="sxs-lookup"><span data-stu-id="c772a-106">The autocomplete stream is where Outlook persists the autocomplete list, which is the list of names that displays in the **To**, **Cc**, and **Bcc** edit boxes while a user is composing an email.</span></span> <span data-ttu-id="c772a-107">Cette rubrique décrit comment Outlook 2007, Outlook 2010 et Outlook 2013 interagissent avec le flux de saisie semi-automatique et traite également le format binaire du fichier et les méthodes recommandées pour interagir avec le flux de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="c772a-107">This topic describes how Outlook 2007, Outlook 2010, and Outlook 2013 interact with the autocomplete stream and also discusses the binary format of the file and the recommended ways for interacting with the autocomplete stream.</span></span> 
  
<span data-ttu-id="c772a-108">Pour les applications qui interagissent avec Outlook 2010 ou Outlook 2013, le flux de saisie semi-automatique est stocké sous forme d’une propriété MAPI et peut être modifié à l’aide de l’interface MAPI ou l’objet **PropertyAccessor** du message.</span><span class="sxs-lookup"><span data-stu-id="c772a-108">For applications that interact with Outlook 2010 or Outlook 2013, the autocomplete stream is stored as a MAPI property and can be modified using the MAPI or the **PropertyAccessor** object of the message.</span></span> <span data-ttu-id="c772a-109">L’objet **PropertyAccessor** est exposé dans les modèles objet Outlook 2010 ou Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="c772a-109">The **PropertyAccessor** object is exposed in the Outlook 2010 or Outlook 2013 object models.</span></span> 
  
<span data-ttu-id="c772a-110">Il n’existe aucune dépendance sur le modèle objet Outlook 2007 ou des API de MAPI.</span><span class="sxs-lookup"><span data-stu-id="c772a-110">There are no dependencies on the Outlook 2007 object model or MAPI APIs.</span></span> <span data-ttu-id="c772a-111">Par conséquent, les applications qui effectuent des modifications dans le flux de saisie semi-automatique dans Outlook 2007 peuvent être écrites à l’aide de n’importe quel langage de programmation.</span><span class="sxs-lookup"><span data-stu-id="c772a-111">Therefore, applications that make changes to the autocomplete stream within Outlook 2007 can be written using any programming language.</span></span>
  
## <a name="interacting-with-the-autocomplete-stream"></a><span data-ttu-id="c772a-112">Interaction avec le flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="c772a-112">Interacting with the Autocomplete Stream</span></span>

<span data-ttu-id="c772a-113">Lorsque les zones d’édition **à**, **Cc**ou **Cci** sont accessibles dans un message, le flux de saisie semi-automatique est chargé et la liste des noms d’utilisateur s’affiche.</span><span class="sxs-lookup"><span data-stu-id="c772a-113">When the **To**, **Cc**, or **Bcc** edit boxes are accessed on a message, the autocomplete stream is loaded and the list of user names is displayed.</span></span> <span data-ttu-id="c772a-114">Outlook interagit avec le flux de saisie semi-automatique de deux manières :</span><span class="sxs-lookup"><span data-stu-id="c772a-114">Outlook interacts with the autocomplete stream in two ways:</span></span> 
  
1. <span data-ttu-id="c772a-115">Chargement du flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="c772a-115">Loading the autocomplete stream</span></span> 
    
2. <span data-ttu-id="c772a-116">Enregistrer les modifications de données dans le flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="c772a-116">Saving changes to the data in the autocomplete stream</span></span>
    
<span data-ttu-id="c772a-117">Le moyen de stocker les données de saisie semi-automatique diffère entre Outlook 2007 et Outlook 2010 ou Outlook 2013 comme suit :</span><span class="sxs-lookup"><span data-stu-id="c772a-117">The means of storing the autocomplete data differs between Outlook 2007 and Outlook 2010 or Outlook 2013 as follows:</span></span> 
  
 <span data-ttu-id="c772a-118">**Outlook 2007**</span><span class="sxs-lookup"><span data-stu-id="c772a-118">**Outlook 2007**</span></span>
  
<span data-ttu-id="c772a-119">Pour Outlook 2007, le flux de saisie semi-automatique est stocké dans un fichier avec le même nom que le profil et d’une extension .nk2.</span><span class="sxs-lookup"><span data-stu-id="c772a-119">For Outlook 2007, the autocomplete stream is stored in a file with the same name as the profile and an extension of .nk2.</span></span> <span data-ttu-id="c772a-120">Par exemple, si le profil par défaut de « outlook » est utilisé, le fichier sera appelé « outlook.nk2 ».</span><span class="sxs-lookup"><span data-stu-id="c772a-120">For example, if the default profile of "outlook" is used, the file will be called "outlook.nk2".</span></span> <span data-ttu-id="c772a-121">Le fichier .nk2 est stocké dans % APPDATA%\Microsoft\Outlook.</span><span class="sxs-lookup"><span data-stu-id="c772a-121">The .nk2 file is stored in %APPDATA%\Microsoft\Outlook.</span></span> <span data-ttu-id="c772a-122">Pour plus d’informations sur le format de fichier binaire surnom du cache, voir [Format de fichier NK2 Outlook 2003/2007 et des instructions pour les développeurs](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span><span class="sxs-lookup"><span data-stu-id="c772a-122">For more information about the nickname cache binary file format, see [Outlook 2003/2007 NK2 File Format and Developer Guidelines](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span></span>
  
 <span data-ttu-id="c772a-123">**Outlook 2010 et Outlook 2013**</span><span class="sxs-lookup"><span data-stu-id="c772a-123">**Outlook 2010 and Outlook 2013**</span></span>
  
<span data-ttu-id="c772a-124">Outlook 2010 ou Outlook 2013 lit le flux de saisie semi-automatique à partir d’un message dans le tableau contenu associé de la boîte de réception de la banque de remise du compte de messagerie.</span><span class="sxs-lookup"><span data-stu-id="c772a-124">Outlook 2010 or Outlook 2013 reads the autocomplete stream from a message in the Associated Contents table of the Inbox of the mail account's delivery store.</span></span> <span data-ttu-id="c772a-125">Ce message masqué a une classe de message et l’objet de IPM. Configuration.Autocomplete.</span><span class="sxs-lookup"><span data-stu-id="c772a-125">This hidden message has a message class and subject of IPM.Configuration.Autocomplete.</span></span> <span data-ttu-id="c772a-126">Le flux de saisie semi-automatique est stocké sur ce message dans la propriété PR_ROAMING_BINARYSTREAM ([Propriété canonique PidTagRoamingBinary](pidtagroamingbinary-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="c772a-126">The autocomplete stream is stored on this message in the PR_ROAMING_BINARYSTREAM property ([PidTagRoamingBinary Canonical Property](pidtagroamingbinary-canonical-property.md)).</span></span> <span data-ttu-id="c772a-127">Les données de saisie semi-automatique peuvent être temporairement mis en cache dans un fichier .dat de saisie semi-automatique dans % USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span><span class="sxs-lookup"><span data-stu-id="c772a-127">The autocomplete data may be temporarily cached in an autocomplete .dat file located in %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span></span> <span data-ttu-id="c772a-128">Toutefois, le fichier .dat uniquement un cache et n’est pas utilisé pour écrire dans la banque de remise lorsque l’utilisateur quitte Outlook 2010 ou Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="c772a-128">However, the .dat file is only a cache and is not used to write back to the delivery store when the user exits Outlook 2010 or Outlook 2013.</span></span>
  
## <a name="loading-the-autocomplete-stream"></a><span data-ttu-id="c772a-129">Chargement du flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="c772a-129">Loading the Autocomplete Stream</span></span>

<span data-ttu-id="c772a-130">Outlook charge le flux de saisie semi-automatique chaque fois qu’un élément avec la fonctionnalité d’adressage est initialisé.</span><span class="sxs-lookup"><span data-stu-id="c772a-130">Outlook loads the autocomplete stream whenever an item with addressing functionality is initialized.</span></span> <span data-ttu-id="c772a-131">Par exemple, les adresses de messagerie sont utilisés dans un nouveau message, une réponse à un message, un élément de contact, une demande de réunion et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="c772a-131">For example, email addresses are used in a new mail, a mail reply, a contact item, a meeting request, and so on.</span></span> <span data-ttu-id="c772a-132">Pour charger les données, il lit tout le contenu de l’objet stream en mémoire.</span><span class="sxs-lookup"><span data-stu-id="c772a-132">To load the data, Outlook reads all of the contents of the stream into memory.</span></span>
  
<span data-ttu-id="c772a-133">Pour les opérations de saisie semi-automatique, Outlook interagit avec cette structure en mémoire uniquement pendant la durée de la durée du processus outlook.exe.</span><span class="sxs-lookup"><span data-stu-id="c772a-133">For autocomplete operations, Outlook interacts exclusively with this in-memory structure for the duration of the outlook.exe process lifetime.</span></span> <span data-ttu-id="c772a-134">Outlook enregistre uniquement la structure de l’arrêt.</span><span class="sxs-lookup"><span data-stu-id="c772a-134">Outlook only saves the structure on shutdown.</span></span> <span data-ttu-id="c772a-135">Voir la section suivante « L’enregistrement du flux de saisie semi-automatique » pour plus d’informations sur ce processus.</span><span class="sxs-lookup"><span data-stu-id="c772a-135">See the following section "Saving the Autocomplete Stream" for more information on this process.</span></span>
  
## <a name="saving-the-autocomplete-stream"></a><span data-ttu-id="c772a-136">L’enregistrement du flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="c772a-136">Saving the Autocomplete Stream</span></span>

<span data-ttu-id="c772a-137">Outlook enregistre le flux de saisie semi-automatique lors de l’arrêt si la liste de saisie semi-automatique a changé dans une des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="c772a-137">Outlook saves the autocomplete stream on shutdown if the autocomplete list has changed in any of the following ways:</span></span>
  
- <span data-ttu-id="c772a-138">Une nouvelle entrée de surnom est ajoutée par le biais de résolution d’un nom, sélectionner un destinataire à partir de la boîte de dialogue de carnet d’adresse ou l’envoi du courrier à un destinataire qui n’est pas déjà dans la liste.</span><span class="sxs-lookup"><span data-stu-id="c772a-138">A new nickname entry is added through resolving a name, picking a recipient from the address book dialog, or sending mail to a recipient that was not already in the list.</span></span>
    
- <span data-ttu-id="c772a-139">Une entrée est modifiée en envoyant un message à un destinataire existant dans la liste.</span><span class="sxs-lookup"><span data-stu-id="c772a-139">An entry is modified by sending mail to an existing recipient in the list.</span></span>
    
- <span data-ttu-id="c772a-140">Suppression d’une entrée par l’utilisateur via l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c772a-140">An entry is removed by the user through the UI.</span></span>
    
- <span data-ttu-id="c772a-141">Autres scénarios secondaires non pertinents pour cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="c772a-141">Other minor scenarios not relevant to this topic.</span></span>
    
<span data-ttu-id="c772a-142">Enregistrer les modifications dans les données de saisie semi-automatique implique la réécriture de la structure en mémoire à un [flux de saisie semi-automatique](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="c772a-142">Saving changes to the autocomplete data involves writing the in-memory structure back to an [Autocomplete Stream](autocomplete-stream.md).</span></span> <span data-ttu-id="c772a-143">Lors de l’interaction avec Outlook 2007, le flux est enregistré dans un fichier local .nk2.</span><span class="sxs-lookup"><span data-stu-id="c772a-143">When interacting with Outlook 2007, the stream is saved to a local .nk2 file.</span></span> <span data-ttu-id="c772a-144">Pour Outlook 2010 ou Outlook 2013, le flux de saisie semi-automatique écrit dans le tableau contenu associé de la boîte de réception de la banque de remise du compte de messagerie.</span><span class="sxs-lookup"><span data-stu-id="c772a-144">For Outlook 2010 or Outlook 2013, the autocomplete stream writes back to the Associated Contents table of the Inbox of the mail account's delivery store.</span></span>
  
## <a name="recommendations"></a><span data-ttu-id="c772a-145">Recommandations</span><span class="sxs-lookup"><span data-stu-id="c772a-145">Recommendations</span></span>

- <span data-ttu-id="c772a-146">Ne jamais partiellement modifier le flux de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="c772a-146">Never partially modify the autocomplete stream.</span></span> <span data-ttu-id="c772a-147">L’interaction pris en charge est de 1) lire le flux de saisie semi-automatique entier en mémoire, (2) modifier la structure de la mémoire et (3) réécrire l’intégralité du flux soit le tableau associé le contenu de la boîte de réception de la banque de remise du compte de messagerie (pour Outlook 2010 ou Outlook 2013) ou sur le fichier .nk2 local (Outlook 2007).</span><span class="sxs-lookup"><span data-stu-id="c772a-147">The supported interaction is to 1) read the entire autocomplete stream into memory, 2) modify the memory structure, and 3) write the entire stream back to either the Associated Contents table of the Inbox of the mail account's delivery store (for Outlook 2010 or Outlook 2013) or to the local .nk2 file (Outlook 2007).</span></span>
    
- <span data-ttu-id="c772a-148">Sans interaction avec le flux de saisie semi-automatique pendant l’exécution d’Outlook.</span><span class="sxs-lookup"><span data-stu-id="c772a-148">Do not interact with the autocomplete stream while Outlook is running.</span></span> <span data-ttu-id="c772a-149">Si Outlook est en cours d’exécution lors de la modification du flux, il remplace probablement vos modifications lorsqu’il arrête.</span><span class="sxs-lookup"><span data-stu-id="c772a-149">If Outlook is running while you modify the stream, it will likely overwrite your changes when it shuts down.</span></span>
    
- <span data-ttu-id="c772a-150">Ne pas les propriétés d’écriture de tapent PT_MV_UNICODE et PR_MV_STRING8 dans un flux de saisie semi-automatique pour être utilisées par Microsoft Outlook 2003.</span><span class="sxs-lookup"><span data-stu-id="c772a-150">Do not write properties of type PT_MV_UNICODE and PR_MV_STRING8 into an autocomplete stream to be consumed by Microsoft Outlook 2003.</span></span> <span data-ttu-id="c772a-151">Ces propriétés sont uniquement comprises par Outlook 2007, Outlook 2010 et Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="c772a-151">These properties are only understood by Outlook 2007, Outlook 2010, and Outlook 2013.</span></span>
    
- <span data-ttu-id="c772a-152">Lors du développement de code qui interagit avec Outlook 2007, nous vous recommandons de verrouiller le fichier .nk2 contre toute modification par d’autres processus pendant que vous êtes lecture et écriture à l’aide des API (par exemple, **fichier de verrouillage** dans C/C++ et **le verrouillage de fichier standard FileStream.Lock** en c#).</span><span class="sxs-lookup"><span data-stu-id="c772a-152">When developing code that interacts with Outlook 2007, we recommend that you lock the .nk2 file from modification by other processes while you are reading and writing it using standard file locking APIs (for example, **LockFile** in C/C++ and **FileStream.Lock** in C#).</span></span> 
    
- <span data-ttu-id="c772a-153">Uniquement modifier les propriétés des types de l’ensemble de lignes de l’objet stream de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="c772a-153">Only modify the properties of types that are from the row-set of the autocomplete stream.</span></span> <span data-ttu-id="c772a-154">Pour plus d’informations sur les propriétés de flux de saisie semi-automatique et les types de propriétés, voir [flux de saisie semi-automatique](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="c772a-154">For more information about the autocomplete stream properties and property types, see [Autocomplete Stream](autocomplete-stream.md).</span></span>
    
## <a name="see-also"></a><span data-ttu-id="c772a-155">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c772a-155">See also</span></span>



[<span data-ttu-id="c772a-156">Flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="c772a-156">Autocomplete Stream</span></span>](autocomplete-stream.md)
  
[<span data-ttu-id="c772a-157">Profils MAPI</span><span class="sxs-lookup"><span data-stu-id="c772a-157">MAPI Profiles</span></span>](mapi-profiles.md)


[<span data-ttu-id="c772a-158">Format de fichier NK2 Outlook 2003/2007 et des instructions pour les développeurs</span><span class="sxs-lookup"><span data-stu-id="c772a-158">Outlook 2003/2007 NK2 File Format and Developer Guidelines</span></span>](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)

