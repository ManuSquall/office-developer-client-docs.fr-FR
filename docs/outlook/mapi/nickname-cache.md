---
title: Cache de surnoms
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Dernière modification: 30 janvier 2013'
ms.openlocfilehash: 841b01ae8dfcf841b0a1d64113ce7258c4c61583
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334516"
---
# <a name="nickname-cache"></a><span data-ttu-id="cfd79-103">Cache de surnoms</span><span class="sxs-lookup"><span data-stu-id="cfd79-103">Nickname cache</span></span>

 
  
<span data-ttu-id="cfd79-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="cfd79-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="cfd79-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010 et Microsoft Outlook 2013 interagissent avec le cache des surnoms, également appelé «flux de saisie semi-automatique».</span><span class="sxs-lookup"><span data-stu-id="cfd79-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010, and Microsoft Outlook 2013 interact with the nickname cache, also known as the "autocomplete stream."</span></span> <span data-ttu-id="cfd79-106">Le flux de saisie semi-automatique est l'emplacement où Outlook conserve la liste de saisie semi-automatique, qui est la liste des noms qui s'affichent dans les zones **d'édition à**, **CC**et **CCI** pendant qu'un utilisateur compose un message électronique.</span><span class="sxs-lookup"><span data-stu-id="cfd79-106">The autocomplete stream is where Outlook persists the autocomplete list, which is the list of names that displays in the **To**, **Cc**, and **Bcc** edit boxes while a user is composing an email.</span></span> <span data-ttu-id="cfd79-107">Cette rubrique décrit comment Outlook 2007, Outlook 2010 et Outlook 2013 interagissent avec le flux de saisie semi-automatique et décrit également le format binaire du fichier et les méthodes recommandées pour interagir avec le flux de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="cfd79-107">This topic describes how Outlook 2007, Outlook 2010, and Outlook 2013 interact with the autocomplete stream and also discusses the binary format of the file and the recommended ways for interacting with the autocomplete stream.</span></span> 
  
<span data-ttu-id="cfd79-108">Pour les applications qui interagissent avec Outlook 2010 ou Outlook 2013, le flux de saisie semi-automatique est stocké en tant que propriété MAPI et peut être modifié à l'aide de l'objet MAPI ou **propertyAccessor** du message.</span><span class="sxs-lookup"><span data-stu-id="cfd79-108">For applications that interact with Outlook 2010 or Outlook 2013, the autocomplete stream is stored as a MAPI property and can be modified using the MAPI or the **PropertyAccessor** object of the message.</span></span> <span data-ttu-id="cfd79-109">L'objet **propertyAccessor** est exposé dans les modèles d'objet Outlook 2010 ou Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="cfd79-109">The **PropertyAccessor** object is exposed in the Outlook 2010 or Outlook 2013 object models.</span></span> 
  
<span data-ttu-id="cfd79-110">Il n'existe aucune dépendance vis-à-vis du modèle objet ou des API MAPI Outlook 2007.</span><span class="sxs-lookup"><span data-stu-id="cfd79-110">There are no dependencies on the Outlook 2007 object model or MAPI APIs.</span></span> <span data-ttu-id="cfd79-111">Par conséquent, les applications qui apportent des modifications au flux de saisie semi-automatique dans Outlook 2007 peuvent être écrites à l'aide de n'importe quel langage de programmation.</span><span class="sxs-lookup"><span data-stu-id="cfd79-111">Therefore, applications that make changes to the autocomplete stream within Outlook 2007 can be written using any programming language.</span></span>
  
## <a name="interacting-with-the-autocomplete-stream"></a><span data-ttu-id="cfd79-112">Interaction avec le flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="cfd79-112">Interacting with the Autocomplete Stream</span></span>

<span data-ttu-id="cfd79-113">Lorsque vous accédez aux zones **d'édition à**, **CC**ou **CCI** sur un message, le flux de saisie semi-automatique est chargé et la liste des noms d'utilisateur s'affiche.</span><span class="sxs-lookup"><span data-stu-id="cfd79-113">When the **To**, **Cc**, or **Bcc** edit boxes are accessed on a message, the autocomplete stream is loaded and the list of user names is displayed.</span></span> <span data-ttu-id="cfd79-114">Outlook interagit avec le flux de saisie semi-automatique de deux manières:</span><span class="sxs-lookup"><span data-stu-id="cfd79-114">Outlook interacts with the autocomplete stream in two ways:</span></span> 
  
1. <span data-ttu-id="cfd79-115">Chargement du flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="cfd79-115">Loading the autocomplete stream</span></span> 
    
2. <span data-ttu-id="cfd79-116">Enregistrement des modifications apportées aux données dans le flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="cfd79-116">Saving changes to the data in the autocomplete stream</span></span>
    
<span data-ttu-id="cfd79-117">Les moyens de stocker les données de saisie semi-automatique diffèrent entre Outlook 2007 et Outlook 2010 ou Outlook 2013 comme suit:</span><span class="sxs-lookup"><span data-stu-id="cfd79-117">The means of storing the autocomplete data differs between Outlook 2007 and Outlook 2010 or Outlook 2013 as follows:</span></span> 
  
 <span data-ttu-id="cfd79-118">**Outlook 2007**</span><span class="sxs-lookup"><span data-stu-id="cfd79-118">**Outlook 2007**</span></span>
  
<span data-ttu-id="cfd79-119">Pour Outlook 2007, le flux de saisie semi-automatique est stocké dans un fichier portant le même nom que le profil et une extension. NK2.</span><span class="sxs-lookup"><span data-stu-id="cfd79-119">For Outlook 2007, the autocomplete stream is stored in a file with the same name as the profile and an extension of .nk2.</span></span> <span data-ttu-id="cfd79-120">Par exemple, si le profil par défaut «Outlook» est utilisé, le fichier est appelé «Outlook. NK2».</span><span class="sxs-lookup"><span data-stu-id="cfd79-120">For example, if the default profile of "outlook" is used, the file will be called "outlook.nk2".</span></span> <span data-ttu-id="cfd79-121">Le fichier. nk2 est stocké dans%APPDATA%\Microsoft\Outlook.</span><span class="sxs-lookup"><span data-stu-id="cfd79-121">The .nk2 file is stored in %APPDATA%\Microsoft\Outlook.</span></span> <span data-ttu-id="cfd79-122">Pour plus d'informations sur le format de fichier binaire du cache des surnoms, consultez le [format de fichier NK2 Outlook 2003/2007 et les instructions](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)pour les développeurs.</span><span class="sxs-lookup"><span data-stu-id="cfd79-122">For more information about the nickname cache binary file format, see [Outlook 2003/2007 NK2 File Format and Developer Guidelines](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span></span>
  
 <span data-ttu-id="cfd79-123">**Outlook 2010 et Outlook 2013**</span><span class="sxs-lookup"><span data-stu-id="cfd79-123">**Outlook 2010 and Outlook 2013**</span></span>
  
<span data-ttu-id="cfd79-124">Outlook 2010 ou Outlook 2013 lit le flux de saisie semi-automatique à partir d'un message dans le tableau contenu associé de la boîte de réception du magasin de remise du compte de messagerie.</span><span class="sxs-lookup"><span data-stu-id="cfd79-124">Outlook 2010 or Outlook 2013 reads the autocomplete stream from a message in the Associated Contents table of the Inbox of the mail account's delivery store.</span></span> <span data-ttu-id="cfd79-125">Ce message masqué a une classe de message et l'objet de IPM. Configuration. AutoComplete.</span><span class="sxs-lookup"><span data-stu-id="cfd79-125">This hidden message has a message class and subject of IPM.Configuration.Autocomplete.</span></span> <span data-ttu-id="cfd79-126">Le flux de saisie semi-automatique est stocké sur ce message dans la propriété PR_ROAMING_BINARYSTREAM ([propriété canonique PidTagRoamingBinary](pidtagroamingbinary-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="cfd79-126">The autocomplete stream is stored on this message in the PR_ROAMING_BINARYSTREAM property ([PidTagRoamingBinary Canonical Property](pidtagroamingbinary-canonical-property.md)).</span></span> <span data-ttu-id="cfd79-127">Les données de saisie semi-automatique peuvent être temporairement mises en cache dans un fichier AutoComplete. dat situé dans%USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span><span class="sxs-lookup"><span data-stu-id="cfd79-127">The autocomplete data may be temporarily cached in an autocomplete .dat file located in %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span></span> <span data-ttu-id="cfd79-128">Toutefois, le fichier. dat n'est qu'un cache et n'est pas utilisé pour effectuer une réécriture dans le magasin de remise lorsque l'utilisateur quitte Outlook 2010 ou Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="cfd79-128">However, the .dat file is only a cache and is not used to write back to the delivery store when the user exits Outlook 2010 or Outlook 2013.</span></span>
  
## <a name="loading-the-autocomplete-stream"></a><span data-ttu-id="cfd79-129">Chargement du flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="cfd79-129">Loading the Autocomplete Stream</span></span>

<span data-ttu-id="cfd79-130">Outlook charge le flux de saisie semi-automatique chaque fois qu'un élément avec une fonctionnalité d'adressage est initialisé.</span><span class="sxs-lookup"><span data-stu-id="cfd79-130">Outlook loads the autocomplete stream whenever an item with addressing functionality is initialized.</span></span> <span data-ttu-id="cfd79-131">Par exemple, les adresses de messagerie sont utilisées dans un nouveau message électronique, une réponse de messagerie, un élément de contact, une demande de réunion, etc.</span><span class="sxs-lookup"><span data-stu-id="cfd79-131">For example, email addresses are used in a new mail, a mail reply, a contact item, a meeting request, and so on.</span></span> <span data-ttu-id="cfd79-132">Pour charger les données, Outlook lit tout le contenu du flux dans la mémoire.</span><span class="sxs-lookup"><span data-stu-id="cfd79-132">To load the data, Outlook reads all of the contents of the stream into memory.</span></span>
  
<span data-ttu-id="cfd79-133">Pour les opérations de saisie semi-automatique, Outlook interagit exclusivement avec cette structure en mémoire pendant la durée de la durée de vie du processus Outlook. exe.</span><span class="sxs-lookup"><span data-stu-id="cfd79-133">For autocomplete operations, Outlook interacts exclusively with this in-memory structure for the duration of the outlook.exe process lifetime.</span></span> <span data-ttu-id="cfd79-134">Outlook enregistre uniquement la structure lors de l'arrêt.</span><span class="sxs-lookup"><span data-stu-id="cfd79-134">Outlook only saves the structure on shutdown.</span></span> <span data-ttu-id="cfd79-135">Consultez la section suivante «enregistrement du flux de saisie semi-automatique» pour plus d'informations sur ce processus.</span><span class="sxs-lookup"><span data-stu-id="cfd79-135">See the following section "Saving the Autocomplete Stream" for more information on this process.</span></span>
  
## <a name="saving-the-autocomplete-stream"></a><span data-ttu-id="cfd79-136">Enregistrement du flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="cfd79-136">Saving the Autocomplete Stream</span></span>

<span data-ttu-id="cfd79-137">Outlook enregistre le flux de saisie semi-automatique lors de l'arrêt si la liste de saisie semi-automatique a été modifiée de l'une des manières suivantes:</span><span class="sxs-lookup"><span data-stu-id="cfd79-137">Outlook saves the autocomplete stream on shutdown if the autocomplete list has changed in any of the following ways:</span></span>
  
- <span data-ttu-id="cfd79-138">Une nouvelle entrée de surnom est ajoutée par la résolution d'un nom, le choix d'un destinataire dans la boîte de dialogue Carnet d'adresses ou l'envoi d'un message à un destinataire qui ne figure pas déjà dans la liste.</span><span class="sxs-lookup"><span data-stu-id="cfd79-138">A new nickname entry is added through resolving a name, picking a recipient from the address book dialog, or sending mail to a recipient that was not already in the list.</span></span>
    
- <span data-ttu-id="cfd79-139">Une entrée est modifiée par l'envoi d'un courrier électronique à un destinataire existant dans la liste.</span><span class="sxs-lookup"><span data-stu-id="cfd79-139">An entry is modified by sending mail to an existing recipient in the list.</span></span>
    
- <span data-ttu-id="cfd79-140">Une entrée est supprimée par l'utilisateur via l'interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cfd79-140">An entry is removed by the user through the UI.</span></span>
    
- <span data-ttu-id="cfd79-141">Autres scénarios mineurs non pertinents pour cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="cfd79-141">Other minor scenarios not relevant to this topic.</span></span>
    
<span data-ttu-id="cfd79-142">L'enregistrement des modifications apportées aux données de saisie semi-automatique implique l'écriture de la structure en mémoire dans un [flux de saisie semi-automatique](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="cfd79-142">Saving changes to the autocomplete data involves writing the in-memory structure back to an [Autocomplete Stream](autocomplete-stream.md).</span></span> <span data-ttu-id="cfd79-143">Lors de l'interaction avec Outlook 2007, le flux est enregistré dans un fichier. nk2 local.</span><span class="sxs-lookup"><span data-stu-id="cfd79-143">When interacting with Outlook 2007, the stream is saved to a local .nk2 file.</span></span> <span data-ttu-id="cfd79-144">Pour Outlook 2010 ou Outlook 2013, le flux de saisie semi-automatique est réécrit dans le tableau contenu associé de la boîte de réception du magasin de remise du compte de messagerie.</span><span class="sxs-lookup"><span data-stu-id="cfd79-144">For Outlook 2010 or Outlook 2013, the autocomplete stream writes back to the Associated Contents table of the Inbox of the mail account's delivery store.</span></span>
  
## <a name="recommendations"></a><span data-ttu-id="cfd79-145">Recommandations</span><span class="sxs-lookup"><span data-stu-id="cfd79-145">Recommendations</span></span>

- <span data-ttu-id="cfd79-146">Ne modifiez jamais partiellement le flux de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="cfd79-146">Never partially modify the autocomplete stream.</span></span> <span data-ttu-id="cfd79-147">L'interaction prise en charge est de 1) lire l'intégralité du flux de saisie semi-automatique dans la mémoire, 2) modifier la structure de la mémoire et 3) écrire l'ensemble du flux dans le tableau contenu associé de la boîte de réception du magasin de remise du compte de messagerie (pour Outlook 2010 ou Outlook 2013) ou au fichier. nk2 local (Outlook 2007).</span><span class="sxs-lookup"><span data-stu-id="cfd79-147">The supported interaction is to 1) read the entire autocomplete stream into memory, 2) modify the memory structure, and 3) write the entire stream back to either the Associated Contents table of the Inbox of the mail account's delivery store (for Outlook 2010 or Outlook 2013) or to the local .nk2 file (Outlook 2007).</span></span>
    
- <span data-ttu-id="cfd79-148">N'interagissez pas avec le flux de saisie semi-automatique Quand Outlook est en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="cfd79-148">Do not interact with the autocomplete stream while Outlook is running.</span></span> <span data-ttu-id="cfd79-149">Si Outlook est en cours d'exécution pendant que vous modifiez le flux, il remplacera probablement vos modifications lors de l'arrêt.</span><span class="sxs-lookup"><span data-stu-id="cfd79-149">If Outlook is running while you modify the stream, it will likely overwrite your changes when it shuts down.</span></span>
    
- <span data-ttu-id="cfd79-150">N'écrivez pas les propriétés de type PT_MV_UNICODE et PR_MV_STRING8 dans un flux de saisie semi-automatique devant être utilisé par Microsoft Outlook 2003.</span><span class="sxs-lookup"><span data-stu-id="cfd79-150">Do not write properties of type PT_MV_UNICODE and PR_MV_STRING8 into an autocomplete stream to be consumed by Microsoft Outlook 2003.</span></span> <span data-ttu-id="cfd79-151">Ces propriétés sont uniquement comprises par Outlook 2007, Outlook 2010 et Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="cfd79-151">These properties are only understood by Outlook 2007, Outlook 2010, and Outlook 2013.</span></span>
    
- <span data-ttu-id="cfd79-152">Lorsque vous développez du code qui interagit avec Outlook 2007, nous vous recommandons de verrouiller le fichier. nk2 contre les modifications apportées par d'autres processus lors de la lecture et de l'écriture à l'aide d'API de verrouillage de fichier standard (par exemple, **lockfile** dans C/C++ et \*\* FileStream. Lock\*\* en C#).</span><span class="sxs-lookup"><span data-stu-id="cfd79-152">When developing code that interacts with Outlook 2007, we recommend that you lock the .nk2 file from modification by other processes while you are reading and writing it using standard file locking APIs (for example, **LockFile** in C/C++ and **FileStream.Lock** in C#).</span></span> 
    
- <span data-ttu-id="cfd79-153">Modifiez uniquement les propriétés des types provenant de l'ensemble de lignes du flux de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="cfd79-153">Only modify the properties of types that are from the row-set of the autocomplete stream.</span></span> <span data-ttu-id="cfd79-154">Pour plus d'informations sur les propriétés et les types de propriétés du flux de saisie semi-automatique, voir AutoComplete [Stream](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="cfd79-154">For more information about the autocomplete stream properties and property types, see [Autocomplete Stream](autocomplete-stream.md).</span></span>
    
## <a name="see-also"></a><span data-ttu-id="cfd79-155">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="cfd79-155">See also</span></span>



[<span data-ttu-id="cfd79-156">Flux de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="cfd79-156">Autocomplete Stream</span></span>](autocomplete-stream.md)
  
[<span data-ttu-id="cfd79-157">Profils MAPI</span><span class="sxs-lookup"><span data-stu-id="cfd79-157">MAPI Profiles</span></span>](mapi-profiles.md)


[<span data-ttu-id="cfd79-158">Format de fichier NK2 Outlook 2003/2007 et conseils pour les développeurs</span><span class="sxs-lookup"><span data-stu-id="cfd79-158">Outlook 2003/2007 NK2 File Format and Developer Guidelines</span></span>](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)

