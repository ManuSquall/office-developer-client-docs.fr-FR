---
title: Structures de flux de champs de dossier
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: 'Derni�re modification�: lundi 9 mars 2015'
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336889"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="ee85a-103">Structures de flux de champs de dossier</span><span class="sxs-lookup"><span data-stu-id="ee85a-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="ee85a-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ee85a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ee85a-105">La propriété [PidTagUserFields](pidtaguserfields-canonical-property.md) d'un message contient un flux binaire, FolderUserFields, qui contient les définitions de champ de dossier définies par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee85a-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="ee85a-106">Cette rubrique décrit les structures de flux pour les définitions de champ de dossier définies par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee85a-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="ee85a-107">Une structure de flux FolderUserFields se compose soit d'une structure FolderUserFieldsA, soit d'une structure FolderUserFieldsA suivie d'une structure FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="ee85a-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="ee85a-108">Les éléments de données dans ce flux sont stockés immédiatement les uns les autres dans l'ordre spécifié suivant:</span><span class="sxs-lookup"><span data-stu-id="ee85a-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ee85a-109">**FolderUserFieldsAnsi**: une structure de flux de FolderUserFieldsA.</span><span class="sxs-lookup"><span data-stu-id="ee85a-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="ee85a-110">**FolderUserFieldsUnicode** (facultatif): une structure de flux FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="ee85a-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="ee85a-111">La présence de FolderUserFieldsUnicode est détectée par la longueur totale de la FolderUserFields supérieure à la longueur de FolderUserFieldsAnsi.</span><span class="sxs-lookup"><span data-stu-id="ee85a-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="ee85a-112">FolderUserFieldsAnsi est utilisé pour la compatibilité avec les versions antérieures, non Unicode, des clients MAPI, par conséquent si FolderUserFieldsUnicode est présent, le contenu de FolderUserFieldsAnsi est ignoré.</span><span class="sxs-lookup"><span data-stu-id="ee85a-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="ee85a-113">Pour éviter toute perte de données possible dans la conversion ANSI, lors de la création d'un flux FolderUserFields, vous devez toujours inclure le composant FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="ee85a-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="ee85a-114">Structure de flux FolderUserFieldsA</span><span class="sxs-lookup"><span data-stu-id="ee85a-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="ee85a-115">Une structure de flux FolderUserFieldsA est un tableau de structures de flux FolderFieldDefinitionA contenant les définitions de tous les champs définis par l'utilisateur dans un dossier Outlook, sauf en cas de substitution par la partie FolderUserFieldsW de la structure FolderUserFields.</span><span class="sxs-lookup"><span data-stu-id="ee85a-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="ee85a-116">Dans ce flux, les éléments de données sont stockés dans un ordre de primauté des octets de poids faible, immédiatement suivant l'ordre spécifié:</span><span class="sxs-lookup"><span data-stu-id="ee85a-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ee85a-117">**FieldDefinitionCount**: DWORD (4 octets), le nombre de définitions de champ dans ce flux.</span><span class="sxs-lookup"><span data-stu-id="ee85a-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="ee85a-118">Il s'agit du nombre d'éléments dans le tableau **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="ee85a-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="ee85a-119">**FieldDefinitions**: tableau de structures de flux FolderFieldDefinitionA.</span><span class="sxs-lookup"><span data-stu-id="ee85a-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="ee85a-120">Le nombre de ce tableau est égal à l'élément de données **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="ee85a-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="ee85a-121">Sauf si cette FolderUserFieldsA est remplacée par la partie FolderUserFieldsW de la structure FolderUserFields, le tableau **FieldDefinitions** doit avoir la valeur «null-terminé» dont le dernier champ Common. FieldType de l'élément FolderFieldDefinitionA est égal vers ftNull.</span><span class="sxs-lookup"><span data-stu-id="ee85a-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="ee85a-122">Structure de flux FolderUserFieldsW</span><span class="sxs-lookup"><span data-stu-id="ee85a-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="ee85a-123">Une structure de flux FolderUserFieldsW est un tableau de structures de flux FolderFieldDefinitionW contenant des définitions pour tous les champs définis par l'utilisateur dans un dossier Outlook.</span><span class="sxs-lookup"><span data-stu-id="ee85a-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="ee85a-124">Dans ce flux, les éléments de données sont stockés dans un ordre de primauté des octets de poids faible, immédiatement suivant l'ordre spécifié:</span><span class="sxs-lookup"><span data-stu-id="ee85a-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ee85a-125">**FieldDefinitionCount**: DWORD (4 octets), le nombre de définitions de champ dans ce flux.</span><span class="sxs-lookup"><span data-stu-id="ee85a-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="ee85a-126">Il s'agit du nombre d'éléments dans le tableau **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="ee85a-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="ee85a-127">**FieldDefinitions**: tableau de structures de flux FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="ee85a-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="ee85a-128">Le nombre de ce tableau est égal à l'élément de données **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="ee85a-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="ee85a-129">Le tableau **FieldDefinitions** doit avoir la valeur «null-terminé» dont le champ Common. FieldType de l'élément FolderFieldDefinitionW a la valeur ftNull.</span><span class="sxs-lookup"><span data-stu-id="ee85a-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="ee85a-130">Structure de flux FolderFieldDefinitionA</span><span class="sxs-lookup"><span data-stu-id="ee85a-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="ee85a-131">Une structure de flux FolderFieldDefinitionA contient une définition d'un champ défini par l'utilisateur dont le nom de champ est stocké dans ANSI.</span><span class="sxs-lookup"><span data-stu-id="ee85a-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="ee85a-132">Dans ce flux, les éléments de données sont stockés dans un ordre de primauté des octets de poids faible, immédiatement suivant l'ordre spécifié:</span><span class="sxs-lookup"><span data-stu-id="ee85a-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ee85a-133">**FieldType**: FldType (4 octets), le type de ce champ.</span><span class="sxs-lookup"><span data-stu-id="ee85a-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="ee85a-134">**FieldNameLength**: Word (2 octets), le nombre d'éléments dans le tableau **fieldName** .</span><span class="sxs-lookup"><span data-stu-id="ee85a-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="ee85a-135">**FieldName**: tableau de char.</span><span class="sxs-lookup"><span data-stu-id="ee85a-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="ee85a-136">Il s'agit de la représentation de la page de codes ANSI CP_ACP du nom de champ.</span><span class="sxs-lookup"><span data-stu-id="ee85a-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="ee85a-137">Le nombre de ce tableau est égal à **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="ee85a-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="ee85a-138">Le nom du champ doit satisfaire aux restrictions sur le paramètre Name comme spécifié dans la méthode [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="ee85a-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="ee85a-139">Pour des raisons de compatibilité héritée, Outlook peut être en mesure de gérer certaines valeurs **fieldName** qui ne satisfont pas ces restrictions, mais ces cas ne sont pas abordés dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="ee85a-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="ee85a-140">**Commun**: une structure de flux FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="ee85a-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="ee85a-141">Structure de flux FolderFieldDefinitionW</span><span class="sxs-lookup"><span data-stu-id="ee85a-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="ee85a-142">Une structure de flux FolderFieldDefinitionW contient une définition d'un champ défini par l'utilisateur dont le nom de champ est stocké au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="ee85a-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="ee85a-143">Dans ce flux, les éléments de données sont stockés dans un ordre de primauté des octets de poids faible, immédiatement suivant l'ordre spécifié:</span><span class="sxs-lookup"><span data-stu-id="ee85a-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ee85a-144">**FieldType**: FldType (4 octets), le type de ce champ.</span><span class="sxs-lookup"><span data-stu-id="ee85a-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="ee85a-145">**FieldNameLength**: Word (2 octets), le nombre d'éléments dans le tableau **fieldName** .</span><span class="sxs-lookup"><span data-stu-id="ee85a-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="ee85a-146">**FieldName**: tableau de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="ee85a-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="ee85a-147">Il s'agit de la représentation Unicode (UTF-16) du nom de champ.</span><span class="sxs-lookup"><span data-stu-id="ee85a-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="ee85a-148">Le nombre de ce tableau est égal à **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="ee85a-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="ee85a-149">Le nom du champ doit satisfaire aux restrictions sur le paramètre Name comme spécifié dans la méthode [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="ee85a-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="ee85a-150">Pour des raisons de compatibilité héritée, Outlook peut être en mesure de gérer certaines valeurs **fieldName** qui ne satisfont pas ces restrictions, mais ces cas ne sont pas abordés dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="ee85a-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="ee85a-151">**Commun**: une structure de flux FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="ee85a-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="ee85a-152">FldType, énumération</span><span class="sxs-lookup"><span data-stu-id="ee85a-152">FldType Enumeration</span></span>

<span data-ttu-id="ee85a-153">Les valeurs d'énumération **FldType** sont répertoriées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="ee85a-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="ee85a-154">Nom</span><span class="sxs-lookup"><span data-stu-id="ee85a-154">Name</span></span>|<span data-ttu-id="ee85a-155">Valeur</span><span class="sxs-lookup"><span data-stu-id="ee85a-155">Value</span></span>|<span data-ttu-id="ee85a-156">Signification</span><span class="sxs-lookup"><span data-stu-id="ee85a-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="ee85a-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="ee85a-157">ftNull</span></span>  <br/> |<span data-ttu-id="ee85a-158">0x0</span><span class="sxs-lookup"><span data-stu-id="ee85a-158">0x0</span></span>  <br/> |<span data-ttu-id="ee85a-159">Ce type de champ est utilisé pour terminer par null un tableau de définitions de champs.</span><span class="sxs-lookup"><span data-stu-id="ee85a-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="ee85a-160">ftString</span><span class="sxs-lookup"><span data-stu-id="ee85a-160">ftString</span></span>  <br/> |<span data-ttu-id="ee85a-161">0x1</span><span class="sxs-lookup"><span data-stu-id="ee85a-161">0x1</span></span>  <br/> |<span data-ttu-id="ee85a-162">Texte</span><span class="sxs-lookup"><span data-stu-id="ee85a-162">Text</span></span>  <br/> |
|<span data-ttu-id="ee85a-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="ee85a-163">ftInteger</span></span>  <br/> |<span data-ttu-id="ee85a-164">0x3</span><span class="sxs-lookup"><span data-stu-id="ee85a-164">0x3</span></span>  <br/> |<span data-ttu-id="ee85a-165">Entier</span><span class="sxs-lookup"><span data-stu-id="ee85a-165">Integer</span></span>  <br/> |
|<span data-ttu-id="ee85a-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="ee85a-166">ftTime</span></span>  <br/> |<span data-ttu-id="ee85a-167">0x5</span><span class="sxs-lookup"><span data-stu-id="ee85a-167">0x5</span></span>  <br/> |<span data-ttu-id="ee85a-168">Date/Heure</span><span class="sxs-lookup"><span data-stu-id="ee85a-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="ee85a-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="ee85a-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="ee85a-170">0x6</span><span class="sxs-lookup"><span data-stu-id="ee85a-170">0x6</span></span>  <br/> |<span data-ttu-id="ee85a-171">Oui/Non</span><span class="sxs-lookup"><span data-stu-id="ee85a-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="ee85a-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="ee85a-172">ftDuration</span></span>  <br/> |<span data-ttu-id="ee85a-173">0x7</span><span class="sxs-lookup"><span data-stu-id="ee85a-173">0x7</span></span>  <br/> |<span data-ttu-id="ee85a-174">Duration</span><span class="sxs-lookup"><span data-stu-id="ee85a-174">Duration</span></span>  <br/> |
|<span data-ttu-id="ee85a-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="ee85a-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="ee85a-176">0xB</span><span class="sxs-lookup"><span data-stu-id="ee85a-176">0xB</span></span>  <br/> |<span data-ttu-id="ee85a-177">Mots clés</span><span class="sxs-lookup"><span data-stu-id="ee85a-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="ee85a-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="ee85a-178">ftFloat</span></span>  <br/> |<span data-ttu-id="ee85a-179">0xC</span><span class="sxs-lookup"><span data-stu-id="ee85a-179">0xC</span></span>  <br/> |<span data-ttu-id="ee85a-180">Nombre ou pourcentage</span><span class="sxs-lookup"><span data-stu-id="ee85a-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="ee85a-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="ee85a-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="ee85a-182">0xE</span><span class="sxs-lookup"><span data-stu-id="ee85a-182">0xE</span></span>  <br/> |<span data-ttu-id="ee85a-183">Devise</span><span class="sxs-lookup"><span data-stu-id="ee85a-183">Currency</span></span>  <br/> |
|<span data-ttu-id="ee85a-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="ee85a-184">ftCalc</span></span>  <br/> |<span data-ttu-id="ee85a-185">0x12</span><span class="sxs-lookup"><span data-stu-id="ee85a-185">0x12</span></span>  <br/> |<span data-ttu-id="ee85a-186">Formule</span><span class="sxs-lookup"><span data-stu-id="ee85a-186">Formula</span></span>  <br/> |
|<span data-ttu-id="ee85a-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="ee85a-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="ee85a-188">0x13</span><span class="sxs-lookup"><span data-stu-id="ee85a-188">0x13</span></span>  <br/> |<span data-ttu-id="ee85a-189">Combinaison de type affichant uniquement le premier champ non vide, en ignorant les suivants.</span><span class="sxs-lookup"><span data-stu-id="ee85a-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="ee85a-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="ee85a-190">ftConcat</span></span>  <br/> |<span data-ttu-id="ee85a-191">0x17</span><span class="sxs-lookup"><span data-stu-id="ee85a-191">0x17</span></span>  <br/> |<span data-ttu-id="ee85a-192">Combinaison de champs de jonction de type et de fragments de texte.</span><span class="sxs-lookup"><span data-stu-id="ee85a-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="ee85a-193">Structure de flux FolderFieldDefinitionCommon</span><span class="sxs-lookup"><span data-stu-id="ee85a-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="ee85a-194">Une structure de flux FolderFieldDefinitionCommon contient les données d'une définition de champ définie par l'utilisateur qui est commune à la fois à un FolderFieldDefinitionA et à un FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="ee85a-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="ee85a-195">Dans ce flux, les éléments de données sont stockés dans un ordre de primauté des octets de poids faible, immédiatement suivant l'ordre spécifié:</span><span class="sxs-lookup"><span data-stu-id="ee85a-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ee85a-196">**PropSetGuid**: GUID (16 octets), le GUID de jeu de propriétés du nom de propriété MAPI correspondant du champ de dossier.</span><span class="sxs-lookup"><span data-stu-id="ee85a-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="ee85a-197">La valeur de ce champ doit être égale à PS_PUBLIC_STRINGS, sauf si le type de champ est **ftNone** , auquel cas la valeur de ce champ doit être égale à GUID_NULL.</span><span class="sxs-lookup"><span data-stu-id="ee85a-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="ee85a-198">Pour des raisons de compatibilité héritée, Outlook peut être en mesure de gérer certaines valeurs **PropSetGuid** qui ne satisfont pas à cette restriction, mais ces cas ne sont pas abordés dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="ee85a-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="ee85a-199">**fcapm**: DWORD (4 octets), une combinaison de zéro ou plusieurs indicateurs dont les valeurs et significations sont répertoriées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="ee85a-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="ee85a-200">Les indicateurs dont la valeur est identique ont une signification dépendante du type de champ, autrement dit, valeur FldType.</span><span class="sxs-lookup"><span data-stu-id="ee85a-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="ee85a-201">Nom de l'indicateur</span><span class="sxs-lookup"><span data-stu-id="ee85a-201">Flag name</span></span>|<span data-ttu-id="ee85a-202">Valeur</span><span class="sxs-lookup"><span data-stu-id="ee85a-202">Value</span></span>|<span data-ttu-id="ee85a-203">Signification</span><span class="sxs-lookup"><span data-stu-id="ee85a-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="ee85a-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="ee85a-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="ee85a-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="ee85a-205">0x00000001</span></span>  <br/> |<span data-ttu-id="ee85a-206">Le champ est modifiable.</span><span class="sxs-lookup"><span data-stu-id="ee85a-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="ee85a-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="ee85a-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="ee85a-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="ee85a-208">0x00000002</span></span>  <br/> |<span data-ttu-id="ee85a-209">Le champ peut être trié.</span><span class="sxs-lookup"><span data-stu-id="ee85a-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="ee85a-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="ee85a-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="ee85a-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="ee85a-211">0x00000004</span></span>  <br/> |<span data-ttu-id="ee85a-212">Le champ peut être groupé.</span><span class="sxs-lookup"><span data-stu-id="ee85a-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="ee85a-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="ee85a-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="ee85a-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="ee85a-214">0x00000100</span></span>  <br/> |<span data-ttu-id="ee85a-215">Le champ peut contenir plusieurs lignes de texte.</span><span class="sxs-lookup"><span data-stu-id="ee85a-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="ee85a-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="ee85a-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="ee85a-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="ee85a-217">0x01000000</span></span>  <br/> |<span data-ttu-id="ee85a-218">Ce champ de type ftFloat est un champ pourcentage.</span><span class="sxs-lookup"><span data-stu-id="ee85a-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="ee85a-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="ee85a-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="ee85a-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="ee85a-220">0x01000000</span></span>  <br/> |<span data-ttu-id="ee85a-221">Ce champ de type ftTime est un champ date/heure uniquement.</span><span class="sxs-lookup"><span data-stu-id="ee85a-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="ee85a-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="ee85a-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="ee85a-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="ee85a-223">0x01000000</span></span>  <br/> |<span data-ttu-id="ee85a-224">Pour ce champ de type ftInteger, aucune unité n'est autorisée en format d'affichage; par exemple, les formats «ordinateur-640 K... non autorisés.</span><span class="sxs-lookup"><span data-stu-id="ee85a-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="ee85a-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="ee85a-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="ee85a-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="ee85a-226">0x80000000</span></span>  <br/> |<span data-ttu-id="ee85a-227">Le champ peut être modifié dans l'élément: il s'agit spécifiquement des formulaires personnalisés.</span><span class="sxs-lookup"><span data-stu-id="ee85a-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="ee85a-228">**dwString**: DWORD (4 octets).</span><span class="sxs-lookup"><span data-stu-id="ee85a-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="ee85a-229">Consultez la première note suivante.</span><span class="sxs-lookup"><span data-stu-id="ee85a-229">See the first following Note.</span></span>
    
- <span data-ttu-id="ee85a-230">**dwBitmap**: DWORD (4 octets).</span><span class="sxs-lookup"><span data-stu-id="ee85a-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="ee85a-231">Consultez la première note suivante.</span><span class="sxs-lookup"><span data-stu-id="ee85a-231">See the first following Note.</span></span>
    
- <span data-ttu-id="ee85a-232">**dwDisplay**: DWORD (4 octets).</span><span class="sxs-lookup"><span data-stu-id="ee85a-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="ee85a-233">Consultez la première note suivante.</span><span class="sxs-lookup"><span data-stu-id="ee85a-233">See the first following Note.</span></span>
    
- <span data-ttu-id="ee85a-234">**iFmt**: int (4 octets).</span><span class="sxs-lookup"><span data-stu-id="ee85a-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="ee85a-235">Pour les types de champs qui contiennent la zone de liste déroulante «Format:» dans les boîtes de dialogue «nouveau champ», «modifier le champ» et «propriétés du champ», l'index de base 0 du format sélectionné dans cette zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="ee85a-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="ee85a-236">Pour les types de champs sans cette zone de liste déroulante, il doit être égal à 0.</span><span class="sxs-lookup"><span data-stu-id="ee85a-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="ee85a-237">La valeur du champ ainsi que le type de champ déterminent de manière unique les valeurs des champs **dwString**, **dwBitmap**et **dwDisplay** , reportez-vous à la première note suivante.</span><span class="sxs-lookup"><span data-stu-id="ee85a-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="ee85a-238">**wszFormulaLength**: Word (2 octets), le nombre d'éléments dans le tableau **wszFormulaLength** .</span><span class="sxs-lookup"><span data-stu-id="ee85a-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="ee85a-239">**wszFormulaLength**: un tableau de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="ee85a-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="ee85a-240">Il s'agit de la représentation Unicode (UTF-16) de la formule du champ dans son format standard.</span><span class="sxs-lookup"><span data-stu-id="ee85a-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="ee85a-241">Consultez la deuxième note suivante pour obtenir la description des formats standard et UI de la formule d'un champ.</span><span class="sxs-lookup"><span data-stu-id="ee85a-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="ee85a-242">Le nombre de ce tableau est égal à **wszFormulaLength**.</span><span class="sxs-lookup"><span data-stu-id="ee85a-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="ee85a-243">La chaîne de formule doit être une chaîne vide, sauf si le type de champ est **ftCalc**, **ftSwitch** ou **ftConcat**.</span><span class="sxs-lookup"><span data-stu-id="ee85a-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="ee85a-244">Bien que les valeurs de **dwString**, **dwBitmap**et **dwDisplay** soient déterminées de manière unique en fonction de la valeur **FldType** et de la valeur **iFmt** , qui sont redondantes, leurs valeurs correctes sont toujours nécessaires pour corriger traitement de la définition de champ par Outlook.</span><span class="sxs-lookup"><span data-stu-id="ee85a-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="ee85a-245">Il n'existe aucune description simple de l'algorithme qui effectue cette détermination.</span><span class="sxs-lookup"><span data-stu-id="ee85a-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="ee85a-246">Par conséquent, pour savoir quelles valeurs **dwString**, **dwBitmap**et **DwDisplay** correspondent à une valeur **FldType** donnée et à une valeur **iFmt** , effectuez un test en créant un champ défini par l'utilisateur de ce type et avec ce format sélectionné. dans la zone de liste déroulante **format** , en supposant qu'il s'agit d'une applicabilité, inspectez le flux de **FolderUserFields** résultant créé par Outlook pour ce champ défini par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee85a-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="ee85a-247">La formule du champ dans son format d'interface utilisateur est modifiée dans la zone de texte **formule** des boîtes de dialogue **nouveau champ**, **champ de modification**et **Propriétés** du champ pour le champ défini par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee85a-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="ee85a-248">L'algorithme de conversion d'une formule du format d'interface utilisateur au format standard dépend du type de champ décrit dans les rubriques suivantes:</span><span class="sxs-lookup"><span data-stu-id="ee85a-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="ee85a-249">Pour les champs de types **ftCalc** et **ftSwitch**, le format standard pour les champs intégrés, qui correspondent aux propriétés MAPI qui ne sont pas des propriétés nommées de la chaîne Kind MNID\_, est obtenu en remplaçant les fragments de nom de champ, c'est-à-dire `[<field_name>]` avec des fragments `[_<field_dispid_decimal>]`.</span><span class="sxs-lookup"><span data-stu-id="ee85a-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="ee85a-250">Par exemple, si le format de l'interface utilisateur d'une formule pour un champ de la **formule**de type, c'est-à-dire **ftCalc**, avec la langue de l'interface utilisateur `[Business Phone] & [My custom field]`Office en `My custom field` anglais, est anglais (États-Unis), est, où est le nom d'un champ défini par l'utilisateur, le format standard de cette formule est `[_14856] & [My custom field]`.</span><span class="sxs-lookup"><span data-stu-id="ee85a-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="ee85a-251">Pour les champs de type **ftConcat**, le format standard est obtenu en procédant comme suit:</span><span class="sxs-lookup"><span data-stu-id="ee85a-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="ee85a-252">Tronque les espaces de début et de fin.</span><span class="sxs-lookup"><span data-stu-id="ee85a-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="ee85a-253">Analysez la formule dans une séquence de fragments des deux genres suivants:</span><span class="sxs-lookup"><span data-stu-id="ee85a-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="ee85a-254">Nom de champ entre crochets, c'est-à-dire `[<field_name>]`.</span><span class="sxs-lookup"><span data-stu-id="ee85a-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="ee85a-255">Sous-chaîne ne contenant pas de crochets.</span><span class="sxs-lookup"><span data-stu-id="ee85a-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="ee85a-256">Assurez-vous qu'aucun fragment du deuxième type n'est adjacent dans la séquence.</span><span class="sxs-lookup"><span data-stu-id="ee85a-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="ee85a-257">Si la formule ne peut pas être analysée de cette façon, elle est considérée comme non valide.</span><span class="sxs-lookup"><span data-stu-id="ee85a-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="ee85a-258">Effectuez les mêmes remplacements pour les fragments du premier type que pour les champs **ftCalc** et **ftSwitch** .</span><span class="sxs-lookup"><span data-stu-id="ee85a-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="ee85a-259">Pour chaque fragment du deuxième type, tous les caractères guillemets doubles ("" "), le cas échéant, avec deux guillemets consécutifs, sont placés entre guillemets doubles.</span><span class="sxs-lookup"><span data-stu-id="ee85a-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="ee85a-260">Insérez une esperluette (`&`) entre chaque paire de fragments adjacents.</span><span class="sxs-lookup"><span data-stu-id="ee85a-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="ee85a-261">Par exemple, à l'aide de la langue de l'interface utilisateur Office anglais (États-Unis), si le format de l' `text1 [Business Phone] "text2" [My custom field]`interface utilisateur `My custom field` d'une formule pour un champ de type **ftConcat** est, où est le nom d'un champ défini `""text1" & [_14856] & """text2""" & [My custom field]"`par l'utilisateur, le format standard de cette formule serait.</span><span class="sxs-lookup"><span data-stu-id="ee85a-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="ee85a-262">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ee85a-262">See also</span></span>

- [<span data-ttu-id="ee85a-263">Exemple de flux FolderUserFields</span><span class="sxs-lookup"><span data-stu-id="ee85a-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="ee85a-264">Ajouter une définition pour un nouveau champ défini par l'utilisateur</span><span class="sxs-lookup"><span data-stu-id="ee85a-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)

