---
title: Structures de flux de champs de dossier
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: Dernière modification le 09 mars 2015
ms.openlocfilehash: 1ba4be04e7241a9c58138ec6b4ef72f7e0f14105
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22567159"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="830cb-103">Structures de flux de champs de dossier</span><span class="sxs-lookup"><span data-stu-id="830cb-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="830cb-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="830cb-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="830cb-105">Propriété de [PidTagUserFields](pidtaguserfields-canonical-property.md) d’un message contient un flux binaire, FolderUserFields, qui contient les définitions de champ défini par l’utilisateur du dossier.</span><span class="sxs-lookup"><span data-stu-id="830cb-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="830cb-106">Cette rubrique décrit les structures de flux de données pour les définitions de champ défini par l’utilisateur de dossier.</span><span class="sxs-lookup"><span data-stu-id="830cb-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="830cb-107">Une structure de flux de données FolderUserFields se compose d’une structure FolderUserFieldsA ou une structure FolderUserFieldsA suivie d’une structure FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="830cb-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="830cb-108">Éléments de données dans ce flux de données sont stockées immédiatement après l’autre dans l’ordre spécifié suivant :</span><span class="sxs-lookup"><span data-stu-id="830cb-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="830cb-109">**FolderUserFieldsAnsi**: un FolderUserFieldsA flux structure.</span><span class="sxs-lookup"><span data-stu-id="830cb-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="830cb-110">**FolderUserFieldsUnicode** (facultatif) : un FolderUserFieldsW flux structure.</span><span class="sxs-lookup"><span data-stu-id="830cb-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="830cb-111">La présence de FolderUserFieldsUnicode est détectée par la longueur totale de la FolderUserFields est supérieure à la longueur de FolderUserFieldsAnsi.</span><span class="sxs-lookup"><span data-stu-id="830cb-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="830cb-112">FolderUserFieldsAnsi est utilisé pour la compatibilité avec les ancienne, non-Unicode, les versions des clients MAPI, par conséquent, si FolderUserFieldsUnicode est présent, le contenu de FolderUserFieldsAnsi est ignorée.</span><span class="sxs-lookup"><span data-stu-id="830cb-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="830cb-113">Pour éviter les données possibles la perte de conversion ANSI, lors de la création d’un flux de FolderUserFields toujours inclure le composant FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="830cb-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="830cb-114">Structure de flux FolderUserFieldsA</span><span class="sxs-lookup"><span data-stu-id="830cb-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="830cb-115">Une structure de flux FolderUserFieldsA est un tableau de structures de flux FolderFieldDefinitionA qui contiennent des définitions pour tous les champs définis par l’utilisateur dans un dossier Outlook, sauf si le composant FolderUserFieldsW de la structure FolderUserFields.</span><span class="sxs-lookup"><span data-stu-id="830cb-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="830cb-116">Éléments de données dans ce flux de données sont stockées dans l’ordre de primauté des octets, immédiatement après l’autre dans l’ordre spécifié suivant :</span><span class="sxs-lookup"><span data-stu-id="830cb-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="830cb-117">**FieldDefinitionCount**: DWORD (4 octets), le nombre de définitions de champ dans ce flux.</span><span class="sxs-lookup"><span data-stu-id="830cb-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="830cb-118">Il s’agit du nombre d’éléments dans le tableau **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="830cb-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="830cb-119">**FieldDefinitions**: un tableau de FolderFieldDefinitionA stream structures.</span><span class="sxs-lookup"><span data-stu-id="830cb-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="830cb-120">Le nombre de ce tableau est égal à l’élément de données **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="830cb-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="830cb-121">À moins que ce FolderUserFieldsA est remplacé par le composant FolderUserFieldsW de la structure FolderUserFields, le tableau de **FieldDefinitions** doit être « nul » en champ de Common.FieldType son dernier FolderFieldDefinitionA élément égal pour ftNull.</span><span class="sxs-lookup"><span data-stu-id="830cb-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="830cb-122">Structure de flux FolderUserFieldsW</span><span class="sxs-lookup"><span data-stu-id="830cb-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="830cb-123">Une structure de flux FolderUserFieldsW est un tableau de structures de flux FolderFieldDefinitionW qui contiennent des définitions pour tous les champs définis par l’utilisateur dans un dossier Outlook.</span><span class="sxs-lookup"><span data-stu-id="830cb-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="830cb-124">Éléments de données dans ce flux de données sont stockées dans l’ordre de primauté des octets, immédiatement après l’autre dans l’ordre spécifié suivant :</span><span class="sxs-lookup"><span data-stu-id="830cb-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="830cb-125">**FieldDefinitionCount**: DWORD (4 octets), le nombre de définitions de champ dans ce flux.</span><span class="sxs-lookup"><span data-stu-id="830cb-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="830cb-126">Il s’agit du nombre d’éléments dans le tableau **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="830cb-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="830cb-127">**FieldDefinitions**: un tableau de FolderFieldDefinitionW stream structures.</span><span class="sxs-lookup"><span data-stu-id="830cb-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="830cb-128">Le nombre de ce tableau est égal à l’élément de données **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="830cb-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="830cb-129">Le tableau **FieldDefinitions** doit être « nul » en champ de Common.FieldType de son dernier élément FolderFieldDefinitionW égale à ftNull.</span><span class="sxs-lookup"><span data-stu-id="830cb-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="830cb-130">Structure de flux FolderFieldDefinitionA</span><span class="sxs-lookup"><span data-stu-id="830cb-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="830cb-131">Une structure de flux FolderFieldDefinitionA contient une définition d’un champ défini par l’utilisateur portant le nom de champ stocké au format ANSI.</span><span class="sxs-lookup"><span data-stu-id="830cb-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="830cb-132">Éléments de données dans ce flux de données sont stockées dans l’ordre de primauté des octets, immédiatement après l’autre dans l’ordre spécifié suivant :</span><span class="sxs-lookup"><span data-stu-id="830cb-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="830cb-133">**FieldType**: FldType (4 octets), le type de ce champ.</span><span class="sxs-lookup"><span data-stu-id="830cb-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="830cb-134">**FieldNameLength**: mot (2 octets), le nombre d’éléments dans le tableau **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="830cb-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="830cb-135">**FieldName**: un tableau de CHAR.</span><span class="sxs-lookup"><span data-stu-id="830cb-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="830cb-136">Il s’agit de la représentation sous forme de page de codes ANSI CP_ACP du nom du champ.</span><span class="sxs-lookup"><span data-stu-id="830cb-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="830cb-137">Le nombre de ce tableau est égal à **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="830cb-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="830cb-138">Le nom de champ doit satisfaire les restrictions du paramètre de nom tel que spécifié dans la méthode [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="830cb-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="830cb-139">Pour des raisons de compatibilité héritée, Outlook peut être en mesure de gérer certaines valeurs **FieldName** ne répondant ne pas ces restrictions, mais ces cas ne sont pas couvertes par cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="830cb-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="830cb-140">**Courantes**: stream, un FolderFieldDefinitionCommon structure.</span><span class="sxs-lookup"><span data-stu-id="830cb-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="830cb-141">Structure de flux FolderFieldDefinitionW</span><span class="sxs-lookup"><span data-stu-id="830cb-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="830cb-142">Une structure de flux FolderFieldDefinitionW contient une définition d’un champ défini par l’utilisateur portant le nom de champ stocké en Unicode.</span><span class="sxs-lookup"><span data-stu-id="830cb-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="830cb-143">Éléments de données dans ce flux de données sont stockées dans l’ordre de primauté des octets, immédiatement après l’autre dans l’ordre spécifié suivant :</span><span class="sxs-lookup"><span data-stu-id="830cb-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="830cb-144">**FieldType**: FldType (4 octets), le type de ce champ.</span><span class="sxs-lookup"><span data-stu-id="830cb-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="830cb-145">**FieldNameLength**: mot (2 octets), le nombre d’éléments dans le tableau **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="830cb-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="830cb-146">**FieldName**: un tableau de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="830cb-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="830cb-147">Il s’agit de la représentation Unicode (UTF-16) du nom du champ.</span><span class="sxs-lookup"><span data-stu-id="830cb-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="830cb-148">Le nombre de ce tableau est égal à **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="830cb-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="830cb-149">Le nom de champ doit satisfaire les restrictions du paramètre de nom tel que spécifié dans la méthode [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="830cb-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="830cb-150">Pour des raisons de compatibilité héritée, Outlook peut être en mesure de gérer certaines valeurs **FieldName** ne répondant ne pas ces restrictions, mais celles-ci n’est pas couvertes par cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="830cb-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="830cb-151">**Courantes**: stream, un FolderFieldDefinitionCommon structure.</span><span class="sxs-lookup"><span data-stu-id="830cb-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="830cb-152">Énumération FldType</span><span class="sxs-lookup"><span data-stu-id="830cb-152">FldType Enumeration</span></span>

<span data-ttu-id="830cb-153">Valeurs d’énumération **FldType** sont répertoriés dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="830cb-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="830cb-154">Nom</span><span class="sxs-lookup"><span data-stu-id="830cb-154">Name</span></span>|<span data-ttu-id="830cb-155">Valeur</span><span class="sxs-lookup"><span data-stu-id="830cb-155">Value</span></span>|<span data-ttu-id="830cb-156">Signification</span><span class="sxs-lookup"><span data-stu-id="830cb-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="830cb-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="830cb-157">ftNull</span></span>  <br/> |<span data-ttu-id="830cb-158">0 x 0</span><span class="sxs-lookup"><span data-stu-id="830cb-158">0x0</span></span>  <br/> |<span data-ttu-id="830cb-159">Ce type de champ est utilisé pour mettre fin à null un tableau des définitions de champ.</span><span class="sxs-lookup"><span data-stu-id="830cb-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="830cb-160">ftString</span><span class="sxs-lookup"><span data-stu-id="830cb-160">ftString</span></span>  <br/> |<span data-ttu-id="830cb-161">0 x 1</span><span class="sxs-lookup"><span data-stu-id="830cb-161">0x1</span></span>  <br/> |<span data-ttu-id="830cb-162">Texte</span><span class="sxs-lookup"><span data-stu-id="830cb-162">Text</span></span>  <br/> |
|<span data-ttu-id="830cb-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="830cb-163">ftInteger</span></span>  <br/> |<span data-ttu-id="830cb-164">0 x 3</span><span class="sxs-lookup"><span data-stu-id="830cb-164">0x3</span></span>  <br/> |<span data-ttu-id="830cb-165">Entier</span><span class="sxs-lookup"><span data-stu-id="830cb-165">Integer</span></span>  <br/> |
|<span data-ttu-id="830cb-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="830cb-166">ftTime</span></span>  <br/> |<span data-ttu-id="830cb-167">0 x 5</span><span class="sxs-lookup"><span data-stu-id="830cb-167">0x5</span></span>  <br/> |<span data-ttu-id="830cb-168">Date/Heure</span><span class="sxs-lookup"><span data-stu-id="830cb-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="830cb-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="830cb-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="830cb-170">0 x 6</span><span class="sxs-lookup"><span data-stu-id="830cb-170">0x6</span></span>  <br/> |<span data-ttu-id="830cb-171">Oui/Non</span><span class="sxs-lookup"><span data-stu-id="830cb-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="830cb-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="830cb-172">ftDuration</span></span>  <br/> |<span data-ttu-id="830cb-173">0 x 7</span><span class="sxs-lookup"><span data-stu-id="830cb-173">0x7</span></span>  <br/> |<span data-ttu-id="830cb-174">Duration</span><span class="sxs-lookup"><span data-stu-id="830cb-174">Duration</span></span>  <br/> |
|<span data-ttu-id="830cb-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="830cb-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="830cb-176">0xB</span><span class="sxs-lookup"><span data-stu-id="830cb-176">0xB</span></span>  <br/> |<span data-ttu-id="830cb-177">Keywords</span><span class="sxs-lookup"><span data-stu-id="830cb-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="830cb-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="830cb-178">ftFloat</span></span>  <br/> |<span data-ttu-id="830cb-179">0xC</span><span class="sxs-lookup"><span data-stu-id="830cb-179">0xC</span></span>  <br/> |<span data-ttu-id="830cb-180">Nombre ou le pourcentage</span><span class="sxs-lookup"><span data-stu-id="830cb-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="830cb-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="830cb-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="830cb-182">0xE</span><span class="sxs-lookup"><span data-stu-id="830cb-182">0xE</span></span>  <br/> |<span data-ttu-id="830cb-183">Monnaie</span><span class="sxs-lookup"><span data-stu-id="830cb-183">Currency</span></span>  <br/> |
|<span data-ttu-id="830cb-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="830cb-184">ftCalc</span></span>  <br/> |<span data-ttu-id="830cb-185">0 x 12</span><span class="sxs-lookup"><span data-stu-id="830cb-185">0x12</span></span>  <br/> |<span data-ttu-id="830cb-186">Formule</span><span class="sxs-lookup"><span data-stu-id="830cb-186">Formula</span></span>  <br/> |
|<span data-ttu-id="830cb-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="830cb-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="830cb-188">0 x 13</span><span class="sxs-lookup"><span data-stu-id="830cb-188">0x13</span></span>  <br/> |<span data-ttu-id="830cb-189">Combinaison de type afficher uniquement le premier champ non vide - ignorer les suivants.</span><span class="sxs-lookup"><span data-stu-id="830cb-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="830cb-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="830cb-190">ftConcat</span></span>  <br/> |<span data-ttu-id="830cb-191">0 x 17</span><span class="sxs-lookup"><span data-stu-id="830cb-191">0x17</span></span>  <br/> |<span data-ttu-id="830cb-192">Combinaison de type de participer à des champs et des fragments de texte à l’autre.</span><span class="sxs-lookup"><span data-stu-id="830cb-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="830cb-193">Structure de flux FolderFieldDefinitionCommon</span><span class="sxs-lookup"><span data-stu-id="830cb-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="830cb-194">Une structure de flux FolderFieldDefinitionCommon contienne les données d’une définition de champ défini par l’utilisateur qui est souvent à la fois un FolderFieldDefinitionA et un FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="830cb-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="830cb-195">Éléments de données dans ce flux de données sont stockées dans l’ordre de primauté des octets, immédiatement après l’autre dans l’ordre spécifié suivant :</span><span class="sxs-lookup"><span data-stu-id="830cb-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="830cb-196">**PropSetGuid**: GUID (16 octets), la propriété la valeur GUID de nom de la propriété du champ dossier correspondant MAPI.</span><span class="sxs-lookup"><span data-stu-id="830cb-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="830cb-197">Valeur de ce champ doit être égale à PS_PUBLIC_STRINGS, sauf si le type de champ est **ftNone** dans ce cas la valeur de ce champ doit être égale à la valeur GUID_NULL.</span><span class="sxs-lookup"><span data-stu-id="830cb-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="830cb-198">Pour des raisons de compatibilité héritée, Outlook peut être en mesure de gérer certaines valeurs **PropSetGuid** ne répondant ne pas cette restriction, mais ces cas ne sont pas couvertes par cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="830cb-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="830cb-199">**fcapm**: DWORD (4 octets), une combinaison de zéro ou plusieurs indicateurs, les valeurs qui et significations sont répertoriés dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="830cb-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="830cb-200">Indicateurs avec la même valeur ont des significations VARIES selon le type de champ, c'est-à-dire FldType valeur.</span><span class="sxs-lookup"><span data-stu-id="830cb-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="830cb-201">Nom de l’indicateur</span><span class="sxs-lookup"><span data-stu-id="830cb-201">Flag name</span></span>|<span data-ttu-id="830cb-202">Valeur  </span><span class="sxs-lookup"><span data-stu-id="830cb-202">Value</span></span>|<span data-ttu-id="830cb-203">Signification</span><span class="sxs-lookup"><span data-stu-id="830cb-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="830cb-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="830cb-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="830cb-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="830cb-205">0x00000001</span></span>  <br/> |<span data-ttu-id="830cb-206">Le champ est modifiable.</span><span class="sxs-lookup"><span data-stu-id="830cb-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="830cb-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="830cb-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="830cb-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="830cb-208">0x00000002</span></span>  <br/> |<span data-ttu-id="830cb-209">Le champ ne peut être trié.</span><span class="sxs-lookup"><span data-stu-id="830cb-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="830cb-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="830cb-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="830cb-211">0 x 00000004</span><span class="sxs-lookup"><span data-stu-id="830cb-211">0x00000004</span></span>  <br/> |<span data-ttu-id="830cb-212">Le champ est être groupée.</span><span class="sxs-lookup"><span data-stu-id="830cb-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="830cb-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="830cb-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="830cb-214">0 x 00000100</span><span class="sxs-lookup"><span data-stu-id="830cb-214">0x00000100</span></span>  <br/> |<span data-ttu-id="830cb-215">Le champ peut contenir plusieurs lignes de texte.</span><span class="sxs-lookup"><span data-stu-id="830cb-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="830cb-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="830cb-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="830cb-217">0 x 01000000</span><span class="sxs-lookup"><span data-stu-id="830cb-217">0x01000000</span></span>  <br/> |<span data-ttu-id="830cb-218">Ce champ de la ftFloat de type est un champ de pourcentage.</span><span class="sxs-lookup"><span data-stu-id="830cb-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="830cb-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="830cb-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="830cb-220">0 x 01000000</span><span class="sxs-lookup"><span data-stu-id="830cb-220">0x01000000</span></span>  <br/> |<span data-ttu-id="830cb-221">Ce champ de la ftTime de type est un champ d’heure date uniquement.</span><span class="sxs-lookup"><span data-stu-id="830cb-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="830cb-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="830cb-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="830cb-223">0 x 01000000</span><span class="sxs-lookup"><span data-stu-id="830cb-223">0x01000000</span></span>  <br/> |<span data-ttu-id="830cb-224">Pour ce champ de la ftInteger type, aucune unité n’est autorisée dans le format d’affichage ; par exemple les formats « ordinateur - 640 k... » ne sont pas autorisés.</span><span class="sxs-lookup"><span data-stu-id="830cb-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="830cb-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="830cb-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="830cb-226">0 x 80000000</span><span class="sxs-lookup"><span data-stu-id="830cb-226">0x80000000</span></span>  <br/> |<span data-ttu-id="830cb-227">Le champ peut être modifié dans l’élément : il s’agit notamment des formulaires personnalisés.</span><span class="sxs-lookup"><span data-stu-id="830cb-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="830cb-228">**dwString**: DWORD (4 octets).</span><span class="sxs-lookup"><span data-stu-id="830cb-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="830cb-229">Voir la remarque suivante premier.</span><span class="sxs-lookup"><span data-stu-id="830cb-229">See the first following Note.</span></span>
    
- <span data-ttu-id="830cb-230">**dwBitmap**: DWORD (4 octets).</span><span class="sxs-lookup"><span data-stu-id="830cb-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="830cb-231">Voir la remarque suivante premier.</span><span class="sxs-lookup"><span data-stu-id="830cb-231">See the first following Note.</span></span>
    
- <span data-ttu-id="830cb-232">**dwDisplay**: DWORD (4 octets).</span><span class="sxs-lookup"><span data-stu-id="830cb-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="830cb-233">Voir la remarque suivante premier.</span><span class="sxs-lookup"><span data-stu-id="830cb-233">See the first following Note.</span></span>
    
- <span data-ttu-id="830cb-234">**iFmt**: INT (4 octets).</span><span class="sxs-lookup"><span data-stu-id="830cb-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="830cb-235">Pour les types de champs qui ont le « Format : « zone de liste déroulante dans les « Nouveau champ », « Modification du champ » et « Propriétés du champ » boîtes de dialogue de l’index de base 0 du format sélectionné dans cette zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="830cb-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="830cb-236">Pour les types de champs sans cette zone de liste déroulante, il doit être 0.</span><span class="sxs-lookup"><span data-stu-id="830cb-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="830cb-237">La valeur du champ avec le type de champ déterminent uniquement les valeurs de la **dwString**, **dwBitmap**, et **dwDisplay** champs, voir la remarque suivante premier.</span><span class="sxs-lookup"><span data-stu-id="830cb-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="830cb-238">**wszFormulaLength**: mot (2 octets), le nombre d’éléments dans le tableau **wszFormulaLength** .</span><span class="sxs-lookup"><span data-stu-id="830cb-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="830cb-239">**wszFormulaLength**: un tableau de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="830cb-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="830cb-240">Il s’agit de la représentation Unicode (UTF-16) de la chaîne de la formule du champ dans son format standard.</span><span class="sxs-lookup"><span data-stu-id="830cb-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="830cb-241">Voir la remarque suivante deuxième pour la description de la norme et les formats de l’interface utilisateur de la formule d’un champ.</span><span class="sxs-lookup"><span data-stu-id="830cb-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="830cb-242">Le nombre de ce tableau est égal à **wszFormulaLength**.</span><span class="sxs-lookup"><span data-stu-id="830cb-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="830cb-243">La chaîne de la formule doit être une chaîne vide, sauf si le type de champ est **ftCalc**, **ftSwitch** ou **ftConcat**.</span><span class="sxs-lookup"><span data-stu-id="830cb-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="830cb-244">Bien que les valeurs de **dwString**, **dwBitmap**et **dwDisplay** sont déterminées unique en fonction de la valeur **FldType** et la valeur **iFmt** , qui sont redondants, leurs valeurs correctes sont toujours nécessaires pour correct traitement de la définition de champ par Outlook.</span><span class="sxs-lookup"><span data-stu-id="830cb-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="830cb-245">Il n’existe aucune description de l’algorithme qui effectue cette détermination simple.</span><span class="sxs-lookup"><span data-stu-id="830cb-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="830cb-246">Par conséquent, pour trouver les valeurs de **dwString**, **dwBitmap**et **dwDisplay** correspondent à une valeur de **FldType** donné et **iFmt** , effectuez un test en créant un champ défini par l’utilisateur de ce type et ce format sélectionné dans la zone de liste déroulante **Format** , en supposant que son application, vérifiez que le flux résultant **FolderUserFields** créé par Outlook pour ce champ défini par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="830cb-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="830cb-247">La formule du champ dans son format de l’interface utilisateur est modifiée dans la zone de texte **formule** du **Nouveau champ** **Modification du champ**et boîtes de dialogue **Propriétés de champ** pour le champ défini par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="830cb-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="830cb-248">L’algorithme pour convertir une formule du format de l’interface utilisateur au format standard varie selon le type de champ comme décrit dans les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="830cb-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="830cb-249">Pour les champs de types **ftCalc** et **ftSwitch**, le format standard pour les champs intégrés, qui ne sont pas des propriétés MAPI correspondantes propriétés nommées de la nature MNID\_chaîne, est obtenu en remplaçant les fragments de nom de champ, c'est-à-dire `[<field_name>]` avec fragments `[_<field_dispid_decimal>]`.</span><span class="sxs-lookup"><span data-stu-id="830cb-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="830cb-250">Par exemple, si le format de l’interface utilisateur d’une formule pour un champ de type **formule**, qui est **ftCalc**, avec la langue de l’interface utilisateur Office en cours anglais américain, est `[Business Phone] & [My custom field]`, où `My custom field` est le nom d’un champ défini par l’utilisateur, le format standard d’une formule de ce type est `[_14856] & [My custom field]`.</span><span class="sxs-lookup"><span data-stu-id="830cb-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="830cb-251">Pour les champs de la **ftConcat**de type, le format standard est obtenu en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="830cb-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="830cb-252">Tronquer les espaces de début et de fin.</span><span class="sxs-lookup"><span data-stu-id="830cb-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="830cb-253">Analyser la formule dans une séquence de fragments les deux types suivants :</span><span class="sxs-lookup"><span data-stu-id="830cb-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="830cb-254">Un nom de champ entre crochets, autrement dit, `[<field_name>]`.</span><span class="sxs-lookup"><span data-stu-id="830cb-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="830cb-255">Une sous-chaîne ne contenant ne pas les crochets.</span><span class="sxs-lookup"><span data-stu-id="830cb-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="830cb-256">S’assurer qu’aucune deux fragments du deuxième ne sont adjacents dans l’ordre.</span><span class="sxs-lookup"><span data-stu-id="830cb-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="830cb-257">Si la formule ne peut pas être analysée de cette manière, il est considéré comme non valide.</span><span class="sxs-lookup"><span data-stu-id="830cb-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="830cb-258">Effectuer le remplacement même des fragments de premier type que pour les champs **ftCalc** et **ftSwitch** .</span><span class="sxs-lookup"><span data-stu-id="830cb-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="830cb-259">Pour chaque fragment du deuxième, tous les guillemet d’échappement (« « ») caractères, le cas échéant, avec deux caractères consécutifs guillemet double et mettez-le entre guillemets doubles.</span><span class="sxs-lookup"><span data-stu-id="830cb-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="830cb-260">Insérer une chaîne « et commercial » (`&`) entre chaque paire de fragments adjacentes.</span><span class="sxs-lookup"><span data-stu-id="830cb-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="830cb-261">Par exemple, à l’aide de la langue de l’interface utilisateur Office anglais (États-Unis), si le format de l’interface utilisateur d’une formule pour un champ de la type **ftConcat** est `text1 [Business Phone] "text2" [My custom field]`, où `My custom field` est le nom d’un champ défini par l’utilisateur, le format standard pour une telle formule serait `""text1" & [_14856] & """text2""" & [My custom field]"`.</span><span class="sxs-lookup"><span data-stu-id="830cb-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="830cb-262">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="830cb-262">See also</span></span>

- [<span data-ttu-id="830cb-263">Exemple de flux FolderUserFields</span><span class="sxs-lookup"><span data-stu-id="830cb-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="830cb-264">Ajout d’une définition pour un nouveau champ défini par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="830cb-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)

