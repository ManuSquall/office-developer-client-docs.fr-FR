---
title: Agir en tant que fournisseur de carnets d'adresses hôte
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 202d4b4391de7553e39e50dc527df5502ebcefb3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406464"
---
# <a name="acting-as-a-host-address-book-provider"></a><span data-ttu-id="e1f20-103">Agir en tant que fournisseur de carnets d'adresses hôte</span><span class="sxs-lookup"><span data-stu-id="e1f20-103">Acting as a Host Address Book Provider</span></span>

  
  
<span data-ttu-id="e1f20-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e1f20-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e1f20-105">Un fournisseur hôte est un fournisseur de carnets d'adresses qui inclut des destinataires d'autres fournisseurs dans ses conteneurs et s'appuie sur l'implémentation des destinataires par les autres fournisseurs pour contrôler partiellement leur maintenance.</span><span class="sxs-lookup"><span data-stu-id="e1f20-105">A host provider is an address book provider that includes recipients from other providers in its containers and relies on the implementation of the recipients by the other providers to partially control their maintenance.</span></span> <span data-ttu-id="e1f20-106">Un fournisseur d'hôte utilise les identificateurs de modèle de ces destinataires étrangers pour lier les données de ces destinataires au code dans le fournisseur étranger.</span><span class="sxs-lookup"><span data-stu-id="e1f20-106">A host provider uses the template identifiers of these foreign recipients to bind the data for these recipients to code in the foreign provider.</span></span> <span data-ttu-id="e1f20-107">Ce processus de liaison est initié lorsque votre fournisseur récupère la propriété **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) d'un destinataire et la transmet dans un appel à [IMAPISupport:: OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="e1f20-107">This binding process is initiated when your provider retrieves the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property of a recipient and passes it in a call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
  
<span data-ttu-id="e1f20-108">Lorsque votre fournisseur appelle **IMAPISupport:: OpenTemplateID**, MAPI établit une correspondance avec l' **MAPIUID** dans l'identificateur de modèle avec un **MAPIUID** enregistré par un fournisseur et appelle la méthode [IABLogon:: OpenTemplateID](iablogon-opentemplateid.md) du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="e1f20-108">When your provider calls **IMAPISupport::OpenTemplateID**, MAPI matches the **MAPIUID** within the template identifier with a **MAPIUID** registered by a provider and calls the provider's [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) method.</span></span> <span data-ttu-id="e1f20-109">Le fournisseur étranger peut renvoyer un pointeur vers l'objet Property de votre fournisseur, vers sa propre implémentation d'objet Property ou vers une implémentation qui encapsule l'objet de votre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="e1f20-109">The foreign provider might return a pointer to your provider's property object, to its own property object implementation, or to an implementation that wraps your provider's object.</span></span> <span data-ttu-id="e1f20-110">Le pointeur renvoyé est placé dans le contenu du paramètre _lppMAPIPropNew_ .</span><span class="sxs-lookup"><span data-stu-id="e1f20-110">The returned pointer is placed in the contents of the  _lppMAPIPropNew_ parameter.</span></span> 
  
<span data-ttu-id="e1f20-111">Votre fournisseur peut choisir d'appeler **IMAPISupport:: OpenTemplateID** avec l'indicateur FILL_ENTRY défini.</span><span class="sxs-lookup"><span data-stu-id="e1f20-111">Your provider can choose whether or not to call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag set.</span></span> <span data-ttu-id="e1f20-112">Définissez cet indicateur lorsque le destinataire est en cours de création ou lorsqu'un long moment s'est écoulé depuis que votre fournisseur a actualisé les propriétés du destinataire.</span><span class="sxs-lookup"><span data-stu-id="e1f20-112">Set this flag when the recipient is being created or when a long time has passed since your provider has refreshed the recipient's properties.</span></span> <span data-ttu-id="e1f20-113">Une utilisation courante de l'indicateur FILL_ENTRY est de maintenir la synchronisation d'un destinataire de votre fournisseur avec l'original.</span><span class="sxs-lookup"><span data-stu-id="e1f20-113">A common use of the FILL_ENTRY flag is to keep a recipient in your provider synchronized with the original.</span></span> <span data-ttu-id="e1f20-114">L'implémentation de ce type de planification de synchronisation améliore les performances.</span><span class="sxs-lookup"><span data-stu-id="e1f20-114">Implementing this type of synchronization schedule enhances performance.</span></span> 
  
 <span data-ttu-id="e1f20-115">**Pour conserver la synchronisation d'un destinataire étranger**</span><span class="sxs-lookup"><span data-stu-id="e1f20-115">**To keep a foreign recipient synchronized**</span></span>
  
1. <span data-ttu-id="e1f20-116">Déterminez un intervalle approprié pour les mises à jour périodiques.</span><span class="sxs-lookup"><span data-stu-id="e1f20-116">Determine an appropriate interval for periodic updates.</span></span> 
    
2. <span data-ttu-id="e1f20-117">Estampillez chaque appel à [IMAPISupport:: OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="e1f20-117">Timestamp each call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
    
3. <span data-ttu-id="e1f20-118">Évaluez s'il est nécessaire ou non d'effectuer une mise à jour complète en fonction de la durée écoulée depuis le dernier appel.</span><span class="sxs-lookup"><span data-stu-id="e1f20-118">Evaluate whether or not it is necessary to perform a full update based on the amount of time that has expired since the last call.</span></span> <span data-ttu-id="e1f20-119">Si une mise à jour complète est nécessaire, appelez **IMAPISupport:: OpenTemplateID** avec l'indicateur FILL_ENTRY.</span><span class="sxs-lookup"><span data-stu-id="e1f20-119">If a full update is necessary, call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag.</span></span> <span data-ttu-id="e1f20-120">Si ce n'est pas nécessaire, ne définissez pas l'indicateur sur l'appel.</span><span class="sxs-lookup"><span data-stu-id="e1f20-120">If it is not necessary, do not set the flag on the call.</span></span> 
    
<span data-ttu-id="e1f20-121">Lorsqu'un client envoie une demande pour l'une des propriétés du destinataire copié, votre fournisseur peut choisir de gérer la demande lui-même ou d'utiliser le code fourni par le fournisseur étranger.</span><span class="sxs-lookup"><span data-stu-id="e1f20-121">When a client makes a request for one of the copied recipient's properties, your provider can choose whether to handle the request itself or use the code supplied by the foreign provider.</span></span> <span data-ttu-id="e1f20-122">Votre fournisseur peut s'attendre à ce que le fournisseur étranger intercepte la plupart des appels à **IMAPIProp** , à l'exception de [IMAPIProp:: OpenProperty](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="e1f20-122">Your provider can expect the foreign provider to intercept most, if not all, calls to **IMAPIProp** except for [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="e1f20-123">Un appel à **OpenProperty** qui demande la propriété **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) est toujours transféré à votre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="e1f20-123">A call to **OpenProperty** requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property is always forwarded to your provider.</span></span>
  
 <span data-ttu-id="e1f20-124">**Pour accéder au code d'identificateur de modèle**</span><span class="sxs-lookup"><span data-stu-id="e1f20-124">**To access template identifier code**</span></span>
  
1. <span data-ttu-id="e1f20-125">Ouvrez le destinataire et appelez sa méthode [IMAPIProp:: GetProps](imapiprop-getprops.md) pour récupérer la propriété **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="e1f20-125">Open the recipient and call its [IMAPIProp::GetProps](imapiprop-getprops.md) method to retrieve the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property.</span></span> <span data-ttu-id="e1f20-126">Si **GetProps** échoue car **PR_TEMPLATEID** n'est pas disponible, le fournisseur étranger ne prend pas en charge un identificateur de modèle et le code associé pour ce destinataire.</span><span class="sxs-lookup"><span data-stu-id="e1f20-126">If **GetProps** fails because **PR_TEMPLATEID** is unavailable, the foreign provider does not support a template identifier and related code for this recipient.</span></span> <span data-ttu-id="e1f20-127">Votre fournisseur doit utiliser son implémentation du destinataire pour toutes les opérations de maintenance.</span><span class="sxs-lookup"><span data-stu-id="e1f20-127">Your provider will need to use its implementation of the recipient for all maintenance.</span></span> 
    
2. <span data-ttu-id="e1f20-128">Si l'identificateur de modèle est renvoyé depuis **GetProps**, transmettez-le et un pointeur vers l'implémentation **IMAPIProp** du destinataire dans un appel à la méthode **IMAPISupport:: OpenTemplateID** .</span><span class="sxs-lookup"><span data-stu-id="e1f20-128">If the template identifier is returned from **GetProps**, pass it and a pointer to the recipient's **IMAPIProp** implementation in a call to the **IMAPISupport::OpenTemplateID** method.</span></span> <span data-ttu-id="e1f20-129">Définissez l'indicateur FILL_ENTRY si la plupart ou la totalité des propriétés du destinataire doivent être mises à jour, par exemple lors de la création ou si elles n'ont pas été mises à jour pendant un certain temps.</span><span class="sxs-lookup"><span data-stu-id="e1f20-129">Set the FILL_ENTRY flag if most or all of the recipient's properties need to be updated, such as at creation time or if they have not been updated for a while.</span></span> 
    
3. <span data-ttu-id="e1f20-130">Si **OpenTemplateID** renvoie l'implémentation **IMAPIProp** du fournisseur étranger, revenez au client un pointeur vers cette implémentation.</span><span class="sxs-lookup"><span data-stu-id="e1f20-130">If **OpenTemplateID** returns the foreign provider's **IMAPIProp** implementation, return to the client a pointer to this implementation.</span></span> 
    
4. <span data-ttu-id="e1f20-131">Si **OpenTemplateID** ne retourne pas d'implémentation, généralement parce que le fournisseur étranger n'est pas dans le profil, revenez au client un pointeur vers l'implémentation de **IMAPIProp** de votre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="e1f20-131">If **OpenTemplateID** does not return an implementation, typically because the foreign provider is not in the profile, return to the client a pointer to your provider's **IMAPIProp** implementation.</span></span> <span data-ttu-id="e1f20-132">Le client doit pouvoir utiliser les propriétés de l'objet à l'aide de l'une ou l'autre des interfaces.</span><span class="sxs-lookup"><span data-stu-id="e1f20-132">The client should be able to work with the object's properties using either interface.</span></span> 
    

