---
title: Développement d’un fournisseur de magasin de message MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 36233d51f47c53d6a69494c0fcd799a7c83add29
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22567873"
---
# <a name="developing-a-mapi-message-store-provider"></a><span data-ttu-id="58885-103">Développement d’un fournisseur de magasin de message MAPI</span><span class="sxs-lookup"><span data-stu-id="58885-103">Developing a MAPI message store provider</span></span>
  
<span data-ttu-id="58885-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="58885-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="58885-105">Comme les autres fournisseurs de services MAPI, les banques de messages sont des bibliothèques de liens dynamiques (DLL) qui présentent les services d’un mécanisme de stockage sous-jacent pour les applications clientes MAPI et le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="58885-105">Like other MAPI service providers, message stores are dynamic-link libraries (DLLs) that present the services of an underlying storage mechanism to MAPI client applications and the MAPI spooler.</span></span> <span data-ttu-id="58885-106">Le fournisseur de banque de message présente le mécanisme de stockage sous-jacent comme un ensemble hiérarchique de dossiers et messages utilisable par les clients MAPI et le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="58885-106">The message store provider presents the underlying storage mechanism as a hierarchical set of folders and messages that MAPI clients and the MAPI spooler can use.</span></span>
  
<span data-ttu-id="58885-107">L’illustration suivante montre l’architecture de banque de message MAPI base.</span><span class="sxs-lookup"><span data-stu-id="58885-107">The following illustration shows the basic MAPI message store architecture.</span></span>
  
<span data-ttu-id="58885-108">**Architecture de banque de messages**</span><span class="sxs-lookup"><span data-stu-id="58885-108">**Message store architecture**</span></span>
  
<span data-ttu-id="58885-109">![Architecture de banque de messages] (media/storearc.gif "Architecture de banque de messages")</span><span class="sxs-lookup"><span data-stu-id="58885-109">![Message store architecture](media/storearc.gif "Message store architecture")</span></span>
  
<span data-ttu-id="58885-110">Vous pouvez implémenter un fournisseur de banque de messages à l’aide de n’importe quel type de mécanisme de stockage sous-jacent que.</span><span class="sxs-lookup"><span data-stu-id="58885-110">You can implement a message store provider by using any sort of underlying storage mechanism you like.</span></span> <span data-ttu-id="58885-111">Toutefois, vous devez être conscient des problèmes de performances.</span><span class="sxs-lookup"><span data-stu-id="58885-111">However, you need to be aware of performance concerns.</span></span> <span data-ttu-id="58885-112">En outre, le mécanisme de stockage sous-jacent doit être présenté comme un ensemble hiérarchique d’objets MAPI.</span><span class="sxs-lookup"><span data-stu-id="58885-112">In addition, the underlying storage mechanism must be presented as a hierarchical collection of MAPI objects.</span></span> <span data-ttu-id="58885-113">Ces exigences signifient que les banques de messages sont généralement implémentés à l’aide d’un produit de base de données existant qui prend en charge le stockage hiérarchique d’objets dans la base de données et qui a une interface de programmation ou une structure de fichier bien définie.</span><span class="sxs-lookup"><span data-stu-id="58885-113">These requirements mean that message stores are typically implemented by using an existing database product that supports hierarchical storage of objects in the database and that has a programming interface or well-defined file structure.</span></span> <span data-ttu-id="58885-114">Par exemple, les bases de données Microsoft Office Access, SQL et Oracle peuvent servir le mécanisme de stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="58885-114">For example, Microsoft Office Access, SQL, and Oracle databases can be used as the underlying storage mechanism.</span></span> <span data-ttu-id="58885-115">Certains produits de base de données ont des jeux de fonctionnalités qui facilitent la mettre en œuvre des fonctionnalités MAPI, votre choix de la base de données peut-être être affectée par les fonctionnalités de votre fournisseur de magasin de message doit prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="58885-115">Some database products have feature sets that make it easier to implement MAPI features, so your choice of database product may be affected by the features that your message store provider needs to support.</span></span>
  
<span data-ttu-id="58885-116">À l’aide d’une base de données en tant que l’enregistre de mécanisme de stockage sous-jacent que vous travaillez, car il est généralement plus facile de présenter les objets de base de données aux clients MAPI en tant qu’objets MAPI que d’implémenter votre propre mécanisme de stockage hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="58885-116">Using an existing database as the underlying storage mechanism saves you work because it is usually easier to present database objects to MAPI clients as MAPI objects than to implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="58885-117">Cela vous permet de traiter des opérations MAPI à un niveau supérieur si vous implémentez votre propre mécanisme de stockage hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="58885-117">Doing this enables you to treat MAPI operations at a higher level than if you implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="58885-118">Par exemple, recherche d’un message avec une ligne de sujet particulier est assez simple de construction et soumettre une requête de base de données appropriée, plutôt que l’implémentation de routines complexes pour rechercher votre mécanisme de stockage hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="58885-118">For example, searching for a message with a particular subject line becomes a fairly simple matter of constructing and submitting an appropriate database query, rather than implementing complex routines to search your hierarchical storage mechanism.</span></span>
  
<span data-ttu-id="58885-119">Fournisseurs de magasins message communiquent avec les clients MAPI et le spouleur MAPI pour effectuer des opérations sur les dossiers et les objets.</span><span class="sxs-lookup"><span data-stu-id="58885-119">Message store providers communicate with MAPI clients and the MAPI spooler to perform operations on folders and objects.</span></span> <span data-ttu-id="58885-120">Le fournisseur de banque de messages traduit ces opérations en opérations de bas niveau sur le mécanisme de stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="58885-120">The message store provider translates those operations into lower level operations on the underlying storage mechanism.</span></span> <span data-ttu-id="58885-121">Le spouleur MAPI généralement communique avec le fournisseur de banque de message lors de l’envoi et réception de messages.</span><span class="sxs-lookup"><span data-stu-id="58885-121">The MAPI spooler typically communicates with the message store provider while sending and receiving messages.</span></span> <span data-ttu-id="58885-122">En règle générale, les clients MAPI communiquent avec des fournisseurs de banque de messages pour manipuler la hiérarchie de dossiers et pour lire, modifier, supprimer et envoyer des messages.</span><span class="sxs-lookup"><span data-stu-id="58885-122">MAPI clients typically communicate with message store providers to manipulate the folder hierarchy and to read, edit, delete, and send messages.</span></span>
  
<span data-ttu-id="58885-123">Le spouleur MAPI et clients MAPI communiquent avec le fournisseur de banque de messages pour créer de nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="58885-123">Both the MAPI spooler and MAPI clients communicate with the message store provider to create new messages.</span></span> <span data-ttu-id="58885-124">Applications clientes cela lorsque l’utilisateur compose un message.</span><span class="sxs-lookup"><span data-stu-id="58885-124">Client applications do this when users compose a message.</span></span> <span data-ttu-id="58885-125">Le spouleur MAPI cela lorsqu’il reçoit un message entrant.</span><span class="sxs-lookup"><span data-stu-id="58885-125">The MAPI spooler does this when it receives an incoming message.</span></span> <span data-ttu-id="58885-126">Dans les deux cas, le nouveau message est généralement créé dans le dossier boîte de réception de la banque de messages, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="58885-126">In either case, the new message is usually created in the Inbox folder of the message store, if there is one.</span></span>
  
<span data-ttu-id="58885-127">Fournisseurs de banque de message utilisent beaucoup de tables, les dossiers, les messages et les propriétés MAPI.</span><span class="sxs-lookup"><span data-stu-id="58885-127">Message store providers make heavy use of MAPI tables, folders, messages, and properties.</span></span> <span data-ttu-id="58885-128">Les détails d’implémentation de ces objets sont documentées dans les [Tableaux MAPI](mapi-tables.md), [Dossiers MAPI](mapi-folders.md), [Messages MAPI](mapi-messages.md)et [Vue d’ensemble de la propriété MAPI](mapi-property-overview.md).</span><span class="sxs-lookup"><span data-stu-id="58885-128">The implementation details for those objects are documented in [MAPI Tables](mapi-tables.md), [MAPI Folders](mapi-folders.md), [MAPI Messages](mapi-messages.md), and [MAPI Property Overview](mapi-property-overview.md).</span></span> <span data-ttu-id="58885-129">Vous devez vous familiariser avec cette documentation avant d’essayer d’implémenter un fournisseur de magasin de message.</span><span class="sxs-lookup"><span data-stu-id="58885-129">You should familiarize yourself with that material before attempting to implement a message store provider.</span></span>
  
<span data-ttu-id="58885-130">Il existe deux types d’importantes de fournisseurs de magasins de message : ceux qui peut agir comme valeur par défaut d’un utilisateur de message store et ceux qui ne peuvent pas.</span><span class="sxs-lookup"><span data-stu-id="58885-130">There are two important types of message store providers: those that can act as a user's default message store and those that cannot.</span></span> <span data-ttu-id="58885-131">Une banque de messages par défaut est 1 dans laquelle les applications et le spouleur MAPI peuvent effectuer toute tâche de messagerie, tels que la réception de messages ou en créant des dossiers.</span><span class="sxs-lookup"><span data-stu-id="58885-131">A default message store is one in which client applications and the MAPI spooler can perform any messaging task, such as receiving messages or creating folders.</span></span> <span data-ttu-id="58885-132">Un fournisseur de magasins de message par défaut doit prendre en charge plusieurs fonctionnalités plus que le nombre minimal requis pour tous les fournisseurs de banque de messages.</span><span class="sxs-lookup"><span data-stu-id="58885-132">A default message store provider must support several more features than the minimum number required for all message store providers.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="58885-133">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="58885-133">See also</span></span>

- [<span data-ttu-id="58885-134">Concepts MAPI</span><span class="sxs-lookup"><span data-stu-id="58885-134">MAPI concepts</span></span>](mapi-concepts.md)

