---
title: Développement d’un fournisseur de banques de messages MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Dernière modification : 23 juillet 2011'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32316758"
---
# <a name="developing-a-mapi-message-store-provider"></a><span data-ttu-id="f771a-103">Développement d’un fournisseur de banques de messages MAPI</span><span class="sxs-lookup"><span data-stu-id="f771a-103">Developing a MAPI message store provider</span></span>
  
<span data-ttu-id="f771a-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="f771a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="f771a-105">Comme les autres fournisseurs de services MAPI, les banques de messages sont des bibliothèques de liens dynamiques (dll) qui présentent les services d'un mécanisme de stockage sous-jacent aux applications clientes MAPI et au spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="f771a-105">Like other MAPI service providers, message stores are dynamic-link libraries (DLLs) that present the services of an underlying storage mechanism to MAPI client applications and the MAPI spooler.</span></span> <span data-ttu-id="f771a-106">Le fournisseur de banque de messages présente le mécanisme de stockage sous la forme d'un ensemble hiérarchique de dossiers et de messages que les clients MAPI et le spouleur MAPI peuvent utiliser.</span><span class="sxs-lookup"><span data-stu-id="f771a-106">The message store provider presents the underlying storage mechanism as a hierarchical set of folders and messages that MAPI clients and the MAPI spooler can use.</span></span>
  
<span data-ttu-id="f771a-107">L'illustration suivante montre l'architecture de base des messages MAPI de base.</span><span class="sxs-lookup"><span data-stu-id="f771a-107">The following illustration shows the basic MAPI message store architecture.</span></span>
  
<span data-ttu-id="f771a-108">**Architecture de banque de messages**</span><span class="sxs-lookup"><span data-stu-id="f771a-108">**Message store architecture**</span></span>
  
<span data-ttu-id="f771a-109">![Architecture] de la Banque de messages (media/storearc.gif "Architecture") de la Banque de messages</span><span class="sxs-lookup"><span data-stu-id="f771a-109">![Message store architecture](media/storearc.gif "Message store architecture")</span></span>
  
<span data-ttu-id="f771a-110">Vous pouvez implémenter un fournisseur de banque de messages à l'aide de n'importe quel type de mécanisme de stockage sous-jacent de votre choix.</span><span class="sxs-lookup"><span data-stu-id="f771a-110">You can implement a message store provider by using any sort of underlying storage mechanism you like.</span></span> <span data-ttu-id="f771a-111">Toutefois, vous devez tenir compte des problèmes de performances.</span><span class="sxs-lookup"><span data-stu-id="f771a-111">However, you need to be aware of performance concerns.</span></span> <span data-ttu-id="f771a-112">En outre, le mécanisme de stockage sous-jacent doit être présenté sous la forme d'une collection hiérarchique d'objets MAPI.</span><span class="sxs-lookup"><span data-stu-id="f771a-112">In addition, the underlying storage mechanism must be presented as a hierarchical collection of MAPI objects.</span></span> <span data-ttu-id="f771a-113">Ces exigences signifient que les banques de messages sont généralement implémentées à l'aide d'un produit de base de données existant qui prend en charge le stockage hiérarchique des objets dans la base de données et qui possède une interface de programmation ou une structure de fichiers bien définie.</span><span class="sxs-lookup"><span data-stu-id="f771a-113">These requirements mean that message stores are typically implemented by using an existing database product that supports hierarchical storage of objects in the database and that has a programming interface or well-defined file structure.</span></span> <span data-ttu-id="f771a-114">Par exemple, les bases de données Microsoft Office Access, SQL et Oracle peuvent être utilisées comme mécanisme de stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="f771a-114">For example, Microsoft Office Access, SQL, and Oracle databases can be used as the underlying storage mechanism.</span></span> <span data-ttu-id="f771a-115">Certains produits de base de données disposent de jeux de fonctionnalités qui facilitent l'implémentation des fonctionnalités MAPI, de sorte que votre choix de produit de base de données peut être affecté par les fonctionnalités que votre fournisseur de banque de messages doit prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="f771a-115">Some database products have feature sets that make it easier to implement MAPI features, so your choice of database product may be affected by the features that your message store provider needs to support.</span></span>
  
<span data-ttu-id="f771a-116">L'utilisation d'une base de données existante comme mécanisme de stockage sous-jacent vous permet d'économiser du travail, car il est généralement plus facile de présenter des objets de base de données à des clients MAPI que d'implémenter votre propre mécanisme de stockage hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="f771a-116">Using an existing database as the underlying storage mechanism saves you work because it is usually easier to present database objects to MAPI clients as MAPI objects than to implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="f771a-117">Cette opération vous permet de traiter les opérations MAPI à un niveau plus élevé que si vous implémentez votre propre mécanisme de stockage hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="f771a-117">Doing this enables you to treat MAPI operations at a higher level than if you implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="f771a-118">Par exemple, la recherche d'un message avec une ligne d'objet particulière devient une question assez simple de création et d'envoi d'une requête de base de données appropriée, plutôt que d'implémenter des routines complexes pour effectuer une recherche dans votre mécanisme de stockage hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="f771a-118">For example, searching for a message with a particular subject line becomes a fairly simple matter of constructing and submitting an appropriate database query, rather than implementing complex routines to search your hierarchical storage mechanism.</span></span>
  
<span data-ttu-id="f771a-119">Les fournisseurs de banques de messages communiquent avec les clients MAPI et le spouleur MAPI pour effectuer des opérations sur des dossiers et des objets.</span><span class="sxs-lookup"><span data-stu-id="f771a-119">Message store providers communicate with MAPI clients and the MAPI spooler to perform operations on folders and objects.</span></span> <span data-ttu-id="f771a-120">Le fournisseur de banque de messages traduit ces opérations en opérations de niveau inférieur sur le mécanisme de stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="f771a-120">The message store provider translates those operations into lower level operations on the underlying storage mechanism.</span></span> <span data-ttu-id="f771a-121">Le spouleur MAPI communique généralement avec le fournisseur de banque de messages lors de l'envoi et de la réception des messages.</span><span class="sxs-lookup"><span data-stu-id="f771a-121">The MAPI spooler typically communicates with the message store provider while sending and receiving messages.</span></span> <span data-ttu-id="f771a-122">Les clients MAPI communiquent généralement avec des fournisseurs de banques de messages pour manipuler la hiérarchie de dossiers et pour lire, modifier, supprimer et envoyer des messages.</span><span class="sxs-lookup"><span data-stu-id="f771a-122">MAPI clients typically communicate with message store providers to manipulate the folder hierarchy and to read, edit, delete, and send messages.</span></span>
  
<span data-ttu-id="f771a-123">Le spouleur MAPI et les clients MAPI communiquent avec le fournisseur de banque de messages pour créer de nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="f771a-123">Both the MAPI spooler and MAPI clients communicate with the message store provider to create new messages.</span></span> <span data-ttu-id="f771a-124">Les applications clientes effectuent cette opération lorsque les utilisateurs composent un message.</span><span class="sxs-lookup"><span data-stu-id="f771a-124">Client applications do this when users compose a message.</span></span> <span data-ttu-id="f771a-125">Le spouleur MAPI effectue cette opération lorsqu'il reçoit un message entrant.</span><span class="sxs-lookup"><span data-stu-id="f771a-125">The MAPI spooler does this when it receives an incoming message.</span></span> <span data-ttu-id="f771a-126">Dans les deux cas, le nouveau message est généralement créé dans le dossier boîte de réception de la Banque de messages, s'il en existe un.</span><span class="sxs-lookup"><span data-stu-id="f771a-126">In either case, the new message is usually created in the Inbox folder of the message store, if there is one.</span></span>
  
<span data-ttu-id="f771a-127">Les fournisseurs de banques de messages utilisent intensivement les tables, les dossiers, les messages et les propriétés MAPI.</span><span class="sxs-lookup"><span data-stu-id="f771a-127">Message store providers make heavy use of MAPI tables, folders, messages, and properties.</span></span> <span data-ttu-id="f771a-128">Les détails de l'implémentation de ces objets sont documentés dans les [tableaux MAPI](mapi-tables.md), les [dossiers MAPI](mapi-folders.md), [les messages MAPI](mapi-messages.md)et la [vue d'ensemble des propriétés MAPI](mapi-property-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f771a-128">The implementation details for those objects are documented in [MAPI Tables](mapi-tables.md), [MAPI Folders](mapi-folders.md), [MAPI Messages](mapi-messages.md), and [MAPI Property Overview](mapi-property-overview.md).</span></span> <span data-ttu-id="f771a-129">Vous devez vous familiariser avec cette documentation avant de tenter d'implémenter un fournisseur de banque de messages.</span><span class="sxs-lookup"><span data-stu-id="f771a-129">You should familiarize yourself with that material before attempting to implement a message store provider.</span></span>
  
<span data-ttu-id="f771a-130">Il existe deux types importants de fournisseurs de banques de messages: ceux qui peuvent agir comme banque de messages par défaut d'un utilisateur et ceux qui ne le sont pas.</span><span class="sxs-lookup"><span data-stu-id="f771a-130">There are two important types of message store providers: those that can act as a user's default message store and those that cannot.</span></span> <span data-ttu-id="f771a-131">Une banque de messages par défaut est une banque dans laquelle les applications clientes et le spouleur MAPI peuvent effectuer n'importe quelle tâche de messagerie, telle que la réception de messages ou la création de dossiers.</span><span class="sxs-lookup"><span data-stu-id="f771a-131">A default message store is one in which client applications and the MAPI spooler can perform any messaging task, such as receiving messages or creating folders.</span></span> <span data-ttu-id="f771a-132">Un fournisseur de banque de messages par défaut doit prendre en charge plusieurs fonctionnalités supplémentaires par rapport au nombre minimal requis pour tous les fournisseurs de banques de messages.</span><span class="sxs-lookup"><span data-stu-id="f771a-132">A default message store provider must support several more features than the minimum number required for all message store providers.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="f771a-133">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f771a-133">See also</span></span>

- [<span data-ttu-id="f771a-134">Concepts MAPI</span><span class="sxs-lookup"><span data-stu-id="f771a-134">MAPI concepts</span></span>](mapi-concepts.md)

