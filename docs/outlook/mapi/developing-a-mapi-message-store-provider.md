---
title: Développement d’un fournisseur de banques de messages MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412610"
---
# <a name="developing-a-mapi-message-store-provider"></a><span data-ttu-id="edaf8-103">Développement d’un fournisseur de banques de messages MAPI</span><span class="sxs-lookup"><span data-stu-id="edaf8-103">Developing a MAPI message store provider</span></span>
  
<span data-ttu-id="edaf8-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="edaf8-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="edaf8-105">Comme d’autres fournisseurs de services MAPI, les magasins de messages sont des bibliothèques de liens dynamiques (DLL) qui présentent les services d’un mécanisme de stockage sous-jacent aux applications clientes MAPI et aupooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="edaf8-105">Like other MAPI service providers, message stores are dynamic-link libraries (DLLs) that present the services of an underlying storage mechanism to MAPI client applications and the MAPI spooler.</span></span> <span data-ttu-id="edaf8-106">Le fournisseur de magasin de messages présente le mécanisme de stockage sous-jacent sous la forme d’un ensemble hiérarchique de dossiers et de messages que les clients MAPI et lepoolur MAPI peuvent utiliser.</span><span class="sxs-lookup"><span data-stu-id="edaf8-106">The message store provider presents the underlying storage mechanism as a hierarchical set of folders and messages that MAPI clients and the MAPI spooler can use.</span></span>
  
<span data-ttu-id="edaf8-107">L’illustration suivante illustre l’architecture de base de la boutique de messages MAPI.</span><span class="sxs-lookup"><span data-stu-id="edaf8-107">The following illustration shows the basic MAPI message store architecture.</span></span>
  
<span data-ttu-id="edaf8-108">**Architecture de banque de messages**</span><span class="sxs-lookup"><span data-stu-id="edaf8-108">**Message store architecture**</span></span>
  
<span data-ttu-id="edaf8-109">![Architecture de la boutique de messages -]Architecture de la boutique de(media/storearc.gif "messages")</span><span class="sxs-lookup"><span data-stu-id="edaf8-109">![Message store architecture](media/storearc.gif "Message store architecture")</span></span>
  
<span data-ttu-id="edaf8-110">Vous pouvez implémenter un fournisseur de magasins de messages à l’aide de n’importe quel type de mécanisme de stockage sous-jacent que vous aimez.</span><span class="sxs-lookup"><span data-stu-id="edaf8-110">You can implement a message store provider by using any sort of underlying storage mechanism you like.</span></span> <span data-ttu-id="edaf8-111">Toutefois, vous devez être conscient des problèmes de performances.</span><span class="sxs-lookup"><span data-stu-id="edaf8-111">However, you need to be aware of performance concerns.</span></span> <span data-ttu-id="edaf8-112">En outre, le mécanisme de stockage sous-jacent doit être présenté comme une collection hiérarchique d’objets MAPI.</span><span class="sxs-lookup"><span data-stu-id="edaf8-112">In addition, the underlying storage mechanism must be presented as a hierarchical collection of MAPI objects.</span></span> <span data-ttu-id="edaf8-113">Ces exigences signifient que les banques de messages sont généralement implémentées à l’aide d’un produit de base de données existant qui prend en charge le stockage hiérarchique des objets dans la base de données et qui possède une interface de programmation ou une structure de fichiers bien définie.</span><span class="sxs-lookup"><span data-stu-id="edaf8-113">These requirements mean that message stores are typically implemented by using an existing database product that supports hierarchical storage of objects in the database and that has a programming interface or well-defined file structure.</span></span> <span data-ttu-id="edaf8-114">Par exemple, Microsoft Office bases de données Access, SQL et Oracle peuvent être utilisées comme mécanisme de stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="edaf8-114">For example, Microsoft Office Access, SQL, and Oracle databases can be used as the underlying storage mechanism.</span></span> <span data-ttu-id="edaf8-115">Certains produits de base de données ont des ensembles de fonctionnalités qui facilitent l’implémenter des fonctionnalités MAPI, de sorte que votre choix de produit de base de données peut être affecté par les fonctionnalités que votre fournisseur de banque de messages doit prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="edaf8-115">Some database products have feature sets that make it easier to implement MAPI features, so your choice of database product may be affected by the features that your message store provider needs to support.</span></span>
  
<span data-ttu-id="edaf8-116">L’utilisation d’une base de données existante comme mécanisme de stockage sous-jacent vous permet de gagner du travail, car il est généralement plus facile de présenter des objets de base de données aux clients MAPI en tant qu’objets MAPI que d’implémenter votre propre mécanisme de stockage hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="edaf8-116">Using an existing database as the underlying storage mechanism saves you work because it is usually easier to present database objects to MAPI clients as MAPI objects than to implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="edaf8-117">Cela vous permet de traiter les opérations MAPI à un niveau plus élevé que si vous implémentez votre propre mécanisme de stockage hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="edaf8-117">Doing this enables you to treat MAPI operations at a higher level than if you implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="edaf8-118">Par exemple, la recherche d’un message avec une ligne d’objet particulière devient une question relativement simple de construction et d’envoi d’une requête de base de données appropriée, plutôt que d’implémenter des routines complexes pour rechercher votre mécanisme de stockage hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="edaf8-118">For example, searching for a message with a particular subject line becomes a fairly simple matter of constructing and submitting an appropriate database query, rather than implementing complex routines to search your hierarchical storage mechanism.</span></span>
  
<span data-ttu-id="edaf8-119">Les fournisseurs de magasins de messages communiquent avec les clients MAPI et lepooler MAPI pour effectuer des opérations sur des dossiers et des objets.</span><span class="sxs-lookup"><span data-stu-id="edaf8-119">Message store providers communicate with MAPI clients and the MAPI spooler to perform operations on folders and objects.</span></span> <span data-ttu-id="edaf8-120">Le fournisseur de magasin de messages traduit ces opérations en opérations de niveau inférieur sur le mécanisme de stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="edaf8-120">The message store provider translates those operations into lower level operations on the underlying storage mechanism.</span></span> <span data-ttu-id="edaf8-121">Lepooler MAPI communique généralement avec le fournisseur de la boutique de messages lors de l’envoi et de la réception de messages.</span><span class="sxs-lookup"><span data-stu-id="edaf8-121">The MAPI spooler typically communicates with the message store provider while sending and receiving messages.</span></span> <span data-ttu-id="edaf8-122">Les clients MAPI communiquent généralement avec les fournisseurs de magasins de messages pour manipuler la hiérarchie de dossiers et pour lire, modifier, supprimer et envoyer des messages.</span><span class="sxs-lookup"><span data-stu-id="edaf8-122">MAPI clients typically communicate with message store providers to manipulate the folder hierarchy and to read, edit, delete, and send messages.</span></span>
  
<span data-ttu-id="edaf8-123">Lepooler MAPI et les clients MAPI communiquent avec le fournisseur de magasins de messages pour créer de nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="edaf8-123">Both the MAPI spooler and MAPI clients communicate with the message store provider to create new messages.</span></span> <span data-ttu-id="edaf8-124">Les applications clientes le font lorsque les utilisateurs composent un message.</span><span class="sxs-lookup"><span data-stu-id="edaf8-124">Client applications do this when users compose a message.</span></span> <span data-ttu-id="edaf8-125">Lepooler MAPI le fait lorsqu’il reçoit un message entrant.</span><span class="sxs-lookup"><span data-stu-id="edaf8-125">The MAPI spooler does this when it receives an incoming message.</span></span> <span data-ttu-id="edaf8-126">Dans les deux cas, le nouveau message est généralement créé dans le dossier Boîte de réception de la boutique de messages, s’il en existe un.</span><span class="sxs-lookup"><span data-stu-id="edaf8-126">In either case, the new message is usually created in the Inbox folder of the message store, if there is one.</span></span>
  
<span data-ttu-id="edaf8-127">Les fournisseurs de magasins de messages utilisent beaucoup les tables, dossiers, messages et propriétés MAPI.</span><span class="sxs-lookup"><span data-stu-id="edaf8-127">Message store providers make heavy use of MAPI tables, folders, messages, and properties.</span></span> <span data-ttu-id="edaf8-128">Les détails d’implémentation de ces objets sont documentés dans les tableaux [MAPI,](mapi-tables.md)les [dossiers MAPI,](mapi-folders.md)les [messages MAPI](mapi-messages.md)et la vue d’ensemble de la propriété [MAPI.](mapi-property-overview.md)</span><span class="sxs-lookup"><span data-stu-id="edaf8-128">The implementation details for those objects are documented in [MAPI Tables](mapi-tables.md), [MAPI Folders](mapi-folders.md), [MAPI Messages](mapi-messages.md), and [MAPI Property Overview](mapi-property-overview.md).</span></span> <span data-ttu-id="edaf8-129">Vous devez vous familiariser avec ce document avant d’essayer d’implémenter un fournisseur de magasins de messages.</span><span class="sxs-lookup"><span data-stu-id="edaf8-129">You should familiarize yourself with that material before attempting to implement a message store provider.</span></span>
  
<span data-ttu-id="edaf8-130">Il existe deux types importants de fournisseurs de magasins de messages : ceux qui peuvent agir en tant que magasin de messages par défaut d’un utilisateur et ceux qui ne le peuvent pas.</span><span class="sxs-lookup"><span data-stu-id="edaf8-130">There are two important types of message store providers: those that can act as a user's default message store and those that cannot.</span></span> <span data-ttu-id="edaf8-131">Une magasin de messages par défaut est celle dans laquelle les applications clientes et lepooler MAPI peuvent effectuer n’importe quelle tâche de messagerie, telle que la réception de messages ou la création de dossiers.</span><span class="sxs-lookup"><span data-stu-id="edaf8-131">A default message store is one in which client applications and the MAPI spooler can perform any messaging task, such as receiving messages or creating folders.</span></span> <span data-ttu-id="edaf8-132">Un fournisseur de magasin de messages par défaut doit prendre en charge plusieurs fonctionnalités supplémentaires que le nombre minimal requis pour tous les fournisseurs de magasins de messages.</span><span class="sxs-lookup"><span data-stu-id="edaf8-132">A default message store provider must support several more features than the minimum number required for all message store providers.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="edaf8-133">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="edaf8-133">See also</span></span>

- [<span data-ttu-id="edaf8-134">Concepts MAPI</span><span class="sxs-lookup"><span data-stu-id="edaf8-134">MAPI concepts</span></span>](mapi-concepts.md)

