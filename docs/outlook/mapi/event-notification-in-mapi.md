---
title: Notification d’événement MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7b3b625b-6dea-4b12-99a9-152935bdfe39
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: 9c1fd58a31481d8666ca931408c16bd73aaba660
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19783279"
---
# <a name="event-notification-in-mapi"></a><span data-ttu-id="eee6a-103">Notification d’événement MAPI</span><span class="sxs-lookup"><span data-stu-id="eee6a-103">Event notification in MAPI</span></span>

<span data-ttu-id="eee6a-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="eee6a-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="eee6a-105">Notification d’événements est la communication des informations entre deux objets MAPI.</span><span class="sxs-lookup"><span data-stu-id="eee6a-105">Event notification is the communication of information between two MAPI objects.</span></span> <span data-ttu-id="eee6a-106">Par le biais d’un des objets, un client ou fournisseur de services s’inscrit pour la notification d’une modification ou d’erreur, appelée un événement, qui peut-être être effectuées dans l’autre objet.</span><span class="sxs-lookup"><span data-stu-id="eee6a-106">Through one of the objects, a client or service provider registers for notification of a change or error, called an event, which may take place in the other object.</span></span> <span data-ttu-id="eee6a-107">Une fois que l’événement se produit, le premier objet est informé de la modification ou l’erreur.</span><span class="sxs-lookup"><span data-stu-id="eee6a-107">After the event occurs, the first object is notified of the change or error.</span></span> <span data-ttu-id="eee6a-108">L’objet qui reçoit la notification est appelé le récepteur de notifications ; l’objet responsable de la notification est appelé source advise.</span><span class="sxs-lookup"><span data-stu-id="eee6a-108">The object receiving the notification is called the advise sink; the object responsible for the notification is called the advise source.</span></span>
  
<span data-ttu-id="eee6a-109">Il existe trois types de notifications pour les objets de récepteur (tous les types sont des objets MAPI standard) :</span><span class="sxs-lookup"><span data-stu-id="eee6a-109">There are three types of advise sink objects (all types are standard MAPI objects):</span></span>
  
- <span data-ttu-id="eee6a-110">Objets de récepteur de notification.</span><span class="sxs-lookup"><span data-stu-id="eee6a-110">Advise sink objects.</span></span>   
- <span data-ttu-id="eee6a-111">Objets de récepteur de notification de formulaire.</span><span class="sxs-lookup"><span data-stu-id="eee6a-111">Form advise sink objects.</span></span>  
- <span data-ttu-id="eee6a-112">Affichage de notification objets récepteur.</span><span class="sxs-lookup"><span data-stu-id="eee6a-112">View advise sink objects.</span></span>
    
<span data-ttu-id="eee6a-113">Informez les objets récepteurs sont du type les plus courantes.</span><span class="sxs-lookup"><span data-stu-id="eee6a-113">Advise sink objects are the most common type.</span></span> <span data-ttu-id="eee6a-114">Récepteurs sont généralement implémentés par les applications clientes pour recevoir le carnet d’adresses et de prise en charge et de notifications de banque de messages de notification du [IMAPIAdviseSink : IUnknown](imapiadvisesinkiunknown.md) interface.</span><span class="sxs-lookup"><span data-stu-id="eee6a-114">Advise sinks are typically implemented by client applications to receive address book and message store notifications and support the [IMAPIAdviseSink : IUnknown](imapiadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="eee6a-115">**IMAPIAdviseSink** contient une seule méthode, [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md).</span><span class="sxs-lookup"><span data-stu-id="eee6a-115">**IMAPIAdviseSink** contains a single method, [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md).</span></span> <span data-ttu-id="eee6a-116">Formulaire et en mode de notification récepteurs sont moins courantes ; ils sont implémentés pour recevoir des notifications sur les modifications apportées à des formulaires personnalisés.</span><span class="sxs-lookup"><span data-stu-id="eee6a-116">Form and view advise sinks are less common; they are implemented to receive notifications about changes to custom forms.</span></span> <span data-ttu-id="eee6a-117">Prise en charge des récepteurs de notification du formulaire la [IMAPIFormAdviseSink : IUnknown](imapiformadvisesinkiunknown.md) prise en charge des récepteurs de notification interface et afficher la [IMAPIViewAdviseSink : IUnknown](imapiviewadvisesinkiunknown.md) interface.</span><span class="sxs-lookup"><span data-stu-id="eee6a-117">Form advise sinks support the [IMAPIFormAdviseSink : IUnknown](imapiformadvisesinkiunknown.md) interface and view advise sinks support the [IMAPIViewAdviseSink : IUnknown](imapiviewadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="eee6a-118">Étant donné que les objets de récepteur de notification standard de mettre en œuvre la plupart des clients, supposons que discussions de notifications par rapport au carnet d’adresses et notifications de banque de messages plutôt que les notifications de formulaires.</span><span class="sxs-lookup"><span data-stu-id="eee6a-118">Because most clients implement standard advise sink objects, assume that discussions of notifications relate to address book and message store notifications rather than forms notifications.</span></span> <span data-ttu-id="eee6a-119">Pour plus d’informations sur les notifications de formulaires, voir [Notifications de formulaires MAPI](mapi-forms-notifications.md) et [L’écriture de Code de formulaire serveur](writing-form-server-code.md).</span><span class="sxs-lookup"><span data-stu-id="eee6a-119">For more information about forms notifications, see [MAPI Forms Notifications](mapi-forms-notifications.md) and [Writing Form Server Code](writing-form-server-code.md).</span></span>
  
<span data-ttu-id="eee6a-120">Avertir la source d’objets sont implémentés par les fournisseurs de services et MAPI.</span><span class="sxs-lookup"><span data-stu-id="eee6a-120">Advise source objects are implemented by service providers and by MAPI.</span></span> <span data-ttu-id="eee6a-121">Tous les fournisseurs de service prennent en charge la notification d’événement ; Il est facultatif, mais fortement recommandé.</span><span class="sxs-lookup"><span data-stu-id="eee6a-121">Not all service providers support event notification; it is optional, but strongly recommended.</span></span> <span data-ttu-id="eee6a-122">Adresse et la banque de messages du livre fournisseurs généralement prise en charge les notifications d’objet sur plusieurs de leurs objets et les notifications de tableau sur leur contenu et les tables de hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="eee6a-122">Message store and address book providers usually support object notifications on several of their objects and table notifications on their contents and hierarchy tables.</span></span> <span data-ttu-id="eee6a-123">Fournisseurs de transport ne prennent pas en charge les notifications directement ; ils s’appuient sur les autres méthodes de communication avec les clients.</span><span class="sxs-lookup"><span data-stu-id="eee6a-123">Transport providers do not support notifications directly; they rely on alternative methods of communication with clients.</span></span>
  
<span data-ttu-id="eee6a-124">Contrairement aux récepteurs de notifications, conseiller objets source ne sont pas un type unique de l’objet MAPI.</span><span class="sxs-lookup"><span data-stu-id="eee6a-124">Unlike advise sinks, advise source objects are not a unique type of MAPI object.</span></span> <span data-ttu-id="eee6a-125">Plusieurs objets MAPI, tels que les banques de messages et des tableaux, peuvent prendre le rôle de source advise.</span><span class="sxs-lookup"><span data-stu-id="eee6a-125">Many MAPI objects, such as message stores and tables, can take on the role of advise source.</span></span> <span data-ttu-id="eee6a-126">Une source advise est n’importe quel objet MAPI qui effectue les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="eee6a-126">An advise source is any MAPI object that does the following:</span></span>
  
- <span data-ttu-id="eee6a-127">Implémente une méthode **Advise** pour recevoir des inscriptions des notifications.</span><span class="sxs-lookup"><span data-stu-id="eee6a-127">Implements an **Advise** method to receive notification registrations.</span></span> 
    
- <span data-ttu-id="eee6a-128">Implémente une méthode **Unadvise** pour recevoir des annulations de notification.</span><span class="sxs-lookup"><span data-stu-id="eee6a-128">Implements an **Unadvise** method to receive notification cancellations.</span></span> 
    
- <span data-ttu-id="eee6a-129">Génère des notifications de type approprié pour les objets de récepteur advise approprié qui se sont inscrits en appelant leurs méthodes **IMAPIAdviseSink::OnNotify** .</span><span class="sxs-lookup"><span data-stu-id="eee6a-129">Generates notifications of the appropriate type to the appropriate advise sink objects that have registered by calling their **IMAPIAdviseSink::OnNotify** methods.</span></span> 
    
<span data-ttu-id="eee6a-130">Objets de récepteur d’appel **Advise** lorsqu’ils veulent s’inscrire pour une notification, dans la plupart des cas, en passant l’identificateur d’entrée de l’objet dont l’inscription doit avoir lieu et **Unadvise** lorsqu’ils souhaitent annuler de notification de clients qui implémentent le inscription.</span><span class="sxs-lookup"><span data-stu-id="eee6a-130">Clients that implement advise sink objects call **Advise** when they want to register for a notification, in most cases passing in the entry identifier of the object with which registration should occur, and **Unadvise** when they want to cancel the registration.</span></span> <span data-ttu-id="eee6a-131">Clients passez un paramètre à **Advise** qui indique les types d’événements à contrôler.</span><span class="sxs-lookup"><span data-stu-id="eee6a-131">Clients pass a parameter to **Advise** that indicates which of the several types of events they want to monitor.</span></span> <span data-ttu-id="eee6a-132">**Advise** renvoie un nombre différent de zéro qui représente une connexion entre le récepteur de notifications et advise source.</span><span class="sxs-lookup"><span data-stu-id="eee6a-132">**Advise** returns a nonzero number that represents a successful connection between the advise sink and advise source.</span></span> 
  
<span data-ttu-id="eee6a-133">Avant d’appeler **Advise**, les clients peuvent déterminer si un fournisseur de magasin de message prend en charge la notification en vérifiant que l’indicateur STORE_NOTIFY_OK est défini dans **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) du magasin message propriété.</span><span class="sxs-lookup"><span data-stu-id="eee6a-133">Before calling **Advise**, clients can determine whether a message store provider supports notification by checking that the STORE_NOTIFY_OK flag is set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span> <span data-ttu-id="eee6a-134">Il n’existe aucun moyen pour les clients déterminer à l’avance ou non un fournisseur de carnet d’adresses prend en charge les notifications.</span><span class="sxs-lookup"><span data-stu-id="eee6a-134">There is no way for clients to determine ahead of time whether or not an address book provider supports notifications.</span></span> <span data-ttu-id="eee6a-135">Les clients doivent essayez d’enregistrer et si la tentative échoue, ils peuvent supposent que les notifications sont non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="eee6a-135">Clients must attempt to register and if the attempt fails, they can assume notifications are unsupported.</span></span>
  
<span data-ttu-id="eee6a-136">Lorsque cet événement se produit un événement pour lequel un client a enregistré, la source advise avertit le récepteur de notifications en appelant la méthode [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) avec une structure de données de notification qui contient des informations sur l’événement.</span><span class="sxs-lookup"><span data-stu-id="eee6a-136">When an event for which a client has registered occurs, the advise source notifies the advise sink by calling its [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method with a notification data structure that contains information about the event.</span></span> <span data-ttu-id="eee6a-137">Implémentation d’un récepteur de notifications de **OnNotify** peut effectuer des tâches en réponse à la notification, telles que la mise à jour des données dans la mémoire ou l’actualisation d’un affichage de l’écran.</span><span class="sxs-lookup"><span data-stu-id="eee6a-137">An advise sink's implementation of **OnNotify** can perform tasks in response to the notification, such as updating data in memory or refreshing a screen display.</span></span> 
  
<span data-ttu-id="eee6a-138">Fournisseurs de services peuvent implémenter la prise en charge pour les notifications manuellement ou tirer parti de l’aide fournie dans trois méthodes **IMAPISupport** : [IMAPISupport::Subscribe](imapisupport-subscribe.md), [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md)et [IMAPISupport::Notify ](imapisupport-notify.md).</span><span class="sxs-lookup"><span data-stu-id="eee6a-138">Service providers can implement support for notifications manually or take advantage of the help provided in three **IMAPISupport** methods: [IMAPISupport::Subscribe](imapisupport-subscribe.md), [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md), and [IMAPISupport::Notify](imapisupport-notify.md).</span></span> <span data-ttu-id="eee6a-139">Les méthodes **d’abonnement** et de **désabonnement** gérer l’inscription aux notifications et annulation d’enregistrement pour les fournisseurs ; la méthode **Notify** gère l’envoi de notifications si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="eee6a-139">The **Subscribe** and **Unsubscribe** methods handle notification registration and deregistration for providers; the **Notify** method handles sending notifications when appropriate.</span></span> 
  
<span data-ttu-id="eee6a-140">Pour utiliser les méthodes de l’objet de prise en charge pour l’inscription aux notifications, les fournisseurs de services [IMAPISupport::Subscribe](imapisupport-subscribe.md) d’appel dans leurs méthodes **Advise** et passez **s’abonner** le pointeur du récepteur advise que clients passer **Advise**.</span><span class="sxs-lookup"><span data-stu-id="eee6a-140">To use the support object methods for notification registration, service providers call [IMAPISupport::Subscribe](imapisupport-subscribe.md) in their **Advise** methods and pass to **Subscribe** the advise sink pointer that clients pass to **Advise**.</span></span> <span data-ttu-id="eee6a-141">Si un identificateur d’entrée est passé comme paramètre d’entrée pour spécifier une source de notification, fournisseurs de services de convertir en une clé binaire.</span><span class="sxs-lookup"><span data-stu-id="eee6a-141">If an entry identifier is passed as an input parameter to specify an advise source, service providers convert it to a binary key.</span></span> <span data-ttu-id="eee6a-142">**S’abonner** crée un numéro de connexion unique et c’est ce numéro qui renvoient des fournisseurs de services aux clients.</span><span class="sxs-lookup"><span data-stu-id="eee6a-142">**Subscribe** creates a unique connection number and it is this number that service providers return to clients.</span></span> <span data-ttu-id="eee6a-143">Fournisseurs de services de diffusion du client pointeur d’objet récepteur de notification à tout moment après l’appel **Advise** est terminé.</span><span class="sxs-lookup"><span data-stu-id="eee6a-143">Service providers can release the client's advise sink object pointer at any time after the **Advise** call has completed.</span></span> 
  
<span data-ttu-id="eee6a-144">Lorsque les clients appellent **Unadvise** pour annuler un enregistrement, les fournisseurs de services soit décrémenter le décompte de références du client pointeur du récepteur de notification ou **Annuler l’abonnement** pour effectuer la même.</span><span class="sxs-lookup"><span data-stu-id="eee6a-144">When clients call **Unadvise** to cancel a registration, service providers either decrement the reference count on the client's advise sink pointer or call **Unsubscribe** to do the same.</span></span> 
  
<span data-ttu-id="eee6a-145">Lorsqu’il est temps de générer une notification, fournisseurs de services exécutez tout traitement interne qui se rapporte à la notification et initialise une structure [NOTIFICATION](notification.md) en affectant à tous ses membres inutilisés à zéro.</span><span class="sxs-lookup"><span data-stu-id="eee6a-145">When it is time to generate a notification, service providers perform any internal processing that relates to the notification and initializes a [NOTIFICATION](notification.md) structure by setting all of its unused members to zero.</span></span> <span data-ttu-id="eee6a-146">Cette technique pour l’initialisation de la structure **NOTIFICATION** peut aider les clients à créer plus petit, plus rapide et moins sujet aux erreurs **OnNotify** implémentations.</span><span class="sxs-lookup"><span data-stu-id="eee6a-146">This technique for initializing the **NOTIFICATION** structure can help clients create smaller, faster, and less error-prone **OnNotify** implementations.</span></span> 
  
<span data-ttu-id="eee6a-147">L’illustration suivante montre la communication entre les objets de récepteur de notification, MAPI et les objets de la source de notification.</span><span class="sxs-lookup"><span data-stu-id="eee6a-147">The following illustration shows the communication between advise sink objects, advise source objects, and MAPI.</span></span> <span data-ttu-id="eee6a-148">MAPI est impliquée uniquement lorsque la source advise appelle les méthodes **IMAPISupport** pour la prise en charge de la notification.</span><span class="sxs-lookup"><span data-stu-id="eee6a-148">MAPI is involved only when the advise source calls the **IMAPISupport** methods for notification support.</span></span> 
  
<span data-ttu-id="eee6a-149">**Appels de notification d’événement**</span><span class="sxs-lookup"><span data-stu-id="eee6a-149">**Event notification calls**</span></span>
  
<span data-ttu-id="eee6a-150">![Appels de notification d’événement] (media/amapi_51.gif "Appels de notification d’événement")</span><span class="sxs-lookup"><span data-stu-id="eee6a-150">![Event notification calls](media/amapi_51.gif "Event notification calls")</span></span>
  
<span data-ttu-id="eee6a-151">La classe MFCMAPI **CAdviseSink** (en utilisant les fichiers AdviseSink.h et AdviseSink.cpp) implémente l’objet de récepteur advise pour tous les appels aux **notifications**.</span><span class="sxs-lookup"><span data-stu-id="eee6a-151">The MFCMAPI **CAdviseSink** class (using the AdviseSink.h and AdviseSink.cpp files) implements the advise sink object for all calls to **Advise**.</span></span> <span data-ttu-id="eee6a-152">Pour plus d’informations sur MFCMAPI, voir [MFCMAPI comme un exemple de Code](mfcmapi-as-a-code-sample.md) et [MFCMAPI](http://go.microsoft.com/fwlink/?LinkId=124154).</span><span class="sxs-lookup"><span data-stu-id="eee6a-152">For more information about MFCMAPI, see [MFCMAPI as a Code Sample](mfcmapi-as-a-code-sample.md) and [MFCMAPI](http://go.microsoft.com/fwlink/?LinkId=124154).</span></span>
  

