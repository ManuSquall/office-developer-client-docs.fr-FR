---
title: Rôle de fournisseur de transport dans le sous-système MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 263370590a35f19482cc5ad7e56c65f6df0087fa
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22581299"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a><span data-ttu-id="99f4b-103">Rôle de fournisseur de transport dans le sous-système MAPI</span><span class="sxs-lookup"><span data-stu-id="99f4b-103">Transport provider role in the MAPI subsystem</span></span>
  
<span data-ttu-id="99f4b-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="99f4b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="99f4b-105">Transport fournisseur bibliothèques de liens dynamiques (DLL) fournissent l’interface entre le spouleur MAPI et la partie d’un système de messagerie responsable de l’envoi et la réception de messages.</span><span class="sxs-lookup"><span data-stu-id="99f4b-105">Transport provider dynamic-link libraries (DLLs) provide the interface between the MAPI spooler and the part of a messaging system responsible for message sending and receiving.</span></span> <span data-ttu-id="99f4b-106">Le spouleur MAPI et le fournisseur de transport fonctionnent ensemble pour gérer les responsabilités de l’envoi d’un message ou de recevoir un message.</span><span class="sxs-lookup"><span data-stu-id="99f4b-106">The MAPI spooler and the transport provider work together to handle the responsibilities of sending a message or receiving a message.</span></span> <span data-ttu-id="99f4b-107">Le spouleur MAPI charge la DLL du fournisseur de transport lorsqu’il est utilisé en premier et libère lorsqu’il n’est plus nécessaire.</span><span class="sxs-lookup"><span data-stu-id="99f4b-107">The MAPI spooler loads the transport provider DLL when it is first used and releases it when it is no longer needed.</span></span> <span data-ttu-id="99f4b-108">Plusieurs fournisseurs de transport peuvent être installés sur le même système, mais MAPI fournit un spouleur requis.</span><span class="sxs-lookup"><span data-stu-id="99f4b-108">Multiple transport providers can be installed on the same system, but MAPI supplies the one spooler required.</span></span>
  
<span data-ttu-id="99f4b-109">En règle générale, les applications clientes ne communiquent pas directement avec le fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="99f4b-109">Client applications do not typically communicate directly with the transport provider.</span></span> <span data-ttu-id="99f4b-110">Au lieu de cela, clients envoyer des messages via un fournisseur de magasin et le spouleur MAPI envoie les messages sortants vers le fournisseur de transport approprié et remet les messages entrants dans le magasin de message approprié.</span><span class="sxs-lookup"><span data-stu-id="99f4b-110">Rather, clients submit messages through a store provider and the MAPI spooler sends outgoing messages to the appropriate transport provider and delivers incoming messages to the appropriate message store.</span></span> <span data-ttu-id="99f4b-111">Le spouleur MAPI s’exécute et effectue ses appels aux fournisseurs de transport lorsque les applications de premier plan sont inactifs.</span><span class="sxs-lookup"><span data-stu-id="99f4b-111">The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle.</span></span> <span data-ttu-id="99f4b-112">Une fois connecté éventuellement afficher les boîtes de dialogue lorsque le fournisseur de transport est en premier, fournisseurs de transport fonctionnent en arrière-plan, sauf si appelée par le client à purger envoyer et recevoir des files d’attente.</span><span class="sxs-lookup"><span data-stu-id="99f4b-112">After optionally displaying dialog boxes when the transport provider is first logged on, transport providers operate in the background unless called by the client to flush send and receive queues.</span></span> 
  
<span data-ttu-id="99f4b-113">Fournisseurs de transport comportent les responsabilités ci-après dans une système de messagerie MAPI de :</span><span class="sxs-lookup"><span data-stu-id="99f4b-113">Transport providers have the following responsibilities in a MAPI messaging system:</span></span>
  
- <span data-ttu-id="99f4b-114">Enregistrer les types d’adresses qu’ils peuvent accepter avec le spouleur MAPI afin que le spouleur MAPI peut envoyer des messages au fournisseur de transport approprié en fonction de l’adresse de destination des messages.</span><span class="sxs-lookup"><span data-stu-id="99f4b-114">Register the address types they can accept with the MAPI spooler so the MAPI spooler can submit messages to the appropriate transport provider depending on the destination address of the messages.</span></span> <span data-ttu-id="99f4b-115">Un fournisseur de transport permettre enregistrer plusieurs types d’adresse.</span><span class="sxs-lookup"><span data-stu-id="99f4b-115">One transport provider can register more than one address type.</span></span> <span data-ttu-id="99f4b-116">Fournisseurs de transport peuvent également enregistrer les adresses des destinataires spécifiques avec le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="99f4b-116">Transport providers can also register specific recipients' addresses with the MAPI spooler.</span></span> <span data-ttu-id="99f4b-117">Les messages adressés à une de ces adresses seront envoyées au fournisseur de transport qui inscrit l’adresse avec le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="99f4b-117">Messages addressed to one of these addresses will be submitted to the transport provider that registered the address with the MAPI spooler.</span></span> <span data-ttu-id="99f4b-118">Pour plus d’informations, voir [fournisseur de Transport et le modèle opérationnel du spouleur MAPI](transport-provider-and-mapi-spooler-operational-model.md).</span><span class="sxs-lookup"><span data-stu-id="99f4b-118">For more information, see [Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span></span>
    
- <span data-ttu-id="99f4b-119">Remettre les messages entrants pour le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="99f4b-119">Deliver incoming messages to the MAPI spooler.</span></span> <span data-ttu-id="99f4b-120">En fonction de la nature du système de messagerie, un fournisseur de transport peut soit directement informer le spouleur MAPI lorsqu’un nouveau message arrive, ou il peut demander que le spouleur MAPI interroger le fournisseur de transport régulièrement pour vérifier les nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="99f4b-120">Depending on the nature of the messaging system, a transport provider can either directly notify the MAPI spooler when a new message arrives, or it can request that the MAPI spooler poll the transport provider periodically to check for new messages.</span></span>
    
- <span data-ttu-id="99f4b-121">Convertir des propriétés de message MAPI vers et à partir des propriétés de message natives au système de messagerie.</span><span class="sxs-lookup"><span data-stu-id="99f4b-121">Convert MAPI message properties to and from message properties native to the messaging system.</span></span> <span data-ttu-id="99f4b-122">Par exemple, le fournisseur de transport peut-être convertir les adresses de l’expéditeur et du destinataire dans un message sortant à un formulaire qui est acceptable pour le système de messagerie.</span><span class="sxs-lookup"><span data-stu-id="99f4b-122">For example, the transport provider might have to convert the sender's and recipient's addresses in an outgoing message to a form that is acceptable to the messaging system.</span></span> <span data-ttu-id="99f4b-123">Certains systèmes de messagerie ne prennent pas en charge toutes les propriétés de message MAPI.</span><span class="sxs-lookup"><span data-stu-id="99f4b-123">Some messaging systems do not support all of the MAPI message properties.</span></span> <span data-ttu-id="99f4b-124">Pour plus d’informations sur la préservation des propriétés de message MAPI lors de la remise des messages à un système de messagerie, voir [développement d’un fournisseur de Transport TNEF-Enabled](developing-a-tnef-enabled-transport-provider.md).</span><span class="sxs-lookup"><span data-stu-id="99f4b-124">For more information about preserving MAPI message properties when delivering messages to a messaging system, see [Developing a TNEF-Enabled Transport Provider](developing-a-tnef-enabled-transport-provider.md).</span></span>
    
- <span data-ttu-id="99f4b-125">Enregistrez le message et le destinataire options spécifiques au fournisseur de transport.</span><span class="sxs-lookup"><span data-stu-id="99f4b-125">Register message and recipient options specific to the transport provider.</span></span>
    
- <span data-ttu-id="99f4b-126">Effectuer la vérification des informations d’identification requises par le système de messagerie.</span><span class="sxs-lookup"><span data-stu-id="99f4b-126">Perform any verification of credentials required by the messaging system.</span></span>
    
- <span data-ttu-id="99f4b-127">Accès aux messages sortants à l’aide de l’objet message lui sont transmises par le spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="99f4b-127">Access outbound messages using the message object passed to it by the MAPI spooler.</span></span>
    
- <span data-ttu-id="99f4b-128">Convertir le format de message comme requis par le système de messagerie sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="99f4b-128">Translate message format as required by the underlying messaging system.</span></span>
    
- <span data-ttu-id="99f4b-129">Informer le spouleur MAPI les destinataires d’un message sortant, le fournisseur de transport a accepté la responsabilité de gestion en définissant la propriété **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) des destinataires.</span><span class="sxs-lookup"><span data-stu-id="99f4b-129">Notify the MAPI spooler which recipients of an outgoing message the transport provider has accepted responsibility for handling by setting the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property for those recipients.</span></span>
    
- <span data-ttu-id="99f4b-130">Informer le spouleur MAPI lorsqu’un message entrant doit être gérée.</span><span class="sxs-lookup"><span data-stu-id="99f4b-130">Inform the MAPI spooler when an incoming message needs to be handled.</span></span>
    
- <span data-ttu-id="99f4b-131">Passer des données de message entrant pour le spouleur MAPI à l’aide des objets de message.</span><span class="sxs-lookup"><span data-stu-id="99f4b-131">Pass incoming message data to the MAPI spooler by using message objects.</span></span>
    
- <span data-ttu-id="99f4b-132">Affecter des valeurs à toutes les propriétés de message MAPI requises sur les messages entrants.</span><span class="sxs-lookup"><span data-stu-id="99f4b-132">Assign values to all required MAPI message properties on incoming messages.</span></span>
    
- <span data-ttu-id="99f4b-133">Supprimer le message à partir du système de messagerie sous-jacent après la livraison, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="99f4b-133">Delete the message from the underlying messaging system after delivery, if necessary.</span></span>
    
- <span data-ttu-id="99f4b-134">Fournissent des informations d’état pour les applications de client et spouleur MAPI.</span><span class="sxs-lookup"><span data-stu-id="99f4b-134">Provide status information for the MAPI spooler and client applications.</span></span>
    
<span data-ttu-id="99f4b-135">L’illustration suivante montre le rôle d’un fournisseur de transport en ce qui concerne les autres composants de l’architecture MAPI.</span><span class="sxs-lookup"><span data-stu-id="99f4b-135">The following illustration shows a transport provider's role with respect to the other components of the MAPI architecture.</span></span>
  
<span data-ttu-id="99f4b-136">**Rôle du fournisseur de transport dans un système de messagerie**</span><span class="sxs-lookup"><span data-stu-id="99f4b-136">**Transport provider role in a messaging system**</span></span>
  
<span data-ttu-id="99f4b-137">![Rôle de fournisseur de transport dans un système de messagerie] (media/xp01.gif "Rôle de fournisseur de transport dans un système de messagerie")</span><span class="sxs-lookup"><span data-stu-id="99f4b-137">![Transport provider role in a messaging system](media/xp01.gif "Transport provider role in a messaging system")</span></span>
  

