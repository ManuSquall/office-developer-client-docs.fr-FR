---
title: Vue d’ensemble de l’objet support
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5b062891-39ab-4334-9706-5b376719d5e4
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 55d8a9c78ae5132eaa8cf0f0aec5b252ef83b926
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433611"
---
# <a name="support-object-overview"></a><span data-ttu-id="9ad35-103">Vue d’ensemble de l’objet support</span><span class="sxs-lookup"><span data-stu-id="9ad35-103">Support Object Overview</span></span>

  
  
<span data-ttu-id="9ad35-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="9ad35-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="9ad35-105">MAPI fournit un objet de support, un objet qui implémente l’interface [IMAPISupport : IUnknown,](imapisupportiunknown.md) pour tous les fournisseurs de services lors de l’logonation et pour tous les services de message pendant la configuration.</span><span class="sxs-lookup"><span data-stu-id="9ad35-105">MAPI furnishes a support object, an object that implements the [IMAPISupport : IUnknown](imapisupportiunknown.md) interface, for all service providers during logon and for all message services during configuration.</span></span> 
  
<span data-ttu-id="9ad35-106">Les objets de support ne sont pas accessibles par les clients ; Elles sont implémentées par MAPI et appelées uniquement par les fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="9ad35-106">Support objects are not accessible by clients; they are implemented by MAPI and called only by service providers.</span></span> <span data-ttu-id="9ad35-107">**L’interface IMAPISupport** est spécifiée dans le fichier d’en-tête Mapispi.h.</span><span class="sxs-lookup"><span data-stu-id="9ad35-107">The **IMAPISupport** interface is specified in the Mapispi.h header file.</span></span> <span data-ttu-id="9ad35-108">Son identificateur IID_IMAPISup et son type de pointeur est LPMAPISUP.</span><span class="sxs-lookup"><span data-stu-id="9ad35-108">Its identifier is IID_IMAPISup and its pointer type is LPMAPISUP.</span></span> <span data-ttu-id="9ad35-109">Aucune propriété MAPI n’est exposée par les objets de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="9ad35-109">No MAPI properties are exposed by support objects.</span></span> 
  
<span data-ttu-id="9ad35-110">Un fournisseur peut se voir donner un ou plusieurs objets de prise en charge, selon le nombre de connexions MAPI au fournisseur ou le nombre d’appel de la fonction d’entrée de service de messagerie du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="9ad35-110">A provider can be given one or more support objects, depending on the number of times MAPI logs the provider on or the number of times the provider's message service entry function is called.</span></span> <span data-ttu-id="9ad35-111">En règle générale, un fournisseur est connecté au moins une fois par session.</span><span class="sxs-lookup"><span data-stu-id="9ad35-111">Typically, a provider will be logged on at least once per session.</span></span> <span data-ttu-id="9ad35-112">Les fournisseurs de carnet d’adresses et de transport sont connectés chaque fois qu’un client démarre une session avec une entrée de profil qui les demande.</span><span class="sxs-lookup"><span data-stu-id="9ad35-112">Address book and transport providers are logged on every time a client starts a session with a profile entry that requests them.</span></span> <span data-ttu-id="9ad35-113">Les fournisseurs de magasins de messages sont connectés chaque fois qu’un client appelle la méthode [IMAPISession::OpenMsgStore.](imapisession-openmsgstore.md)</span><span class="sxs-lookup"><span data-stu-id="9ad35-113">Message store providers are logged on every time a client calls the [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) method.</span></span> 
  
<span data-ttu-id="9ad35-114">Dans le cas de plusieurs ouvertures de session dans une session, vous pouvez choisir de conserver et d’utiliser chaque objet de support séparément ou de conserver et d’utiliser uniquement le premier, en rejetant chaque objet de support suivant.</span><span class="sxs-lookup"><span data-stu-id="9ad35-114">In the case of multiple logons in a session, you can choose either to retain and use each support object separately or to retain and use only the first, discarding each subsequent support object.</span></span> <span data-ttu-id="9ad35-115">Pour conserver un objet de support, appelez sa **méthode IUnknown::AddRef.**</span><span class="sxs-lookup"><span data-stu-id="9ad35-115">To retain a support object, call its **IUnknown::AddRef** method.</span></span> <span data-ttu-id="9ad35-116">Il est extrêmement important d’appeler **AddRef** sur un objet de support que vous souhaitez conserver tout au long d’une session . Si l’appel n’est pas effectué, MAPI libère l’objet de support et libère sa mémoire.</span><span class="sxs-lookup"><span data-stu-id="9ad35-116">Calling **AddRef** on a support object that you want to retain throughout a session is extremely important; if the call is not made, MAPI releases the support object and frees its memory.</span></span> 
  
<span data-ttu-id="9ad35-117">L’objectif de l’objet de support est de fournir des implémentations pour un nombre relativement élevé de méthodes couramment utilisées par les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="9ad35-117">The purpose of the support object is to provide implementations for a fairly large number of methods commonly used by the providers.</span></span> <span data-ttu-id="9ad35-118">Chaque objet de support contient également des données contextuelles spécifiques à sa propre instance, telles que la session dans qui le fournisseur est en cours d’exécution, la section de profil que le fournisseur utilise et les informations d’erreur pour la session.</span><span class="sxs-lookup"><span data-stu-id="9ad35-118">Each support object also contains contextual data specific to its own instance, such as the session the provider is running in, the profile section the provider is using, and error information for the session.</span></span> 
  
<span data-ttu-id="9ad35-119">Il existe quatre types différents d’objets de support : un pour chaque type de fournisseur principal (carnet d’adresses, magasin de messages et transport) et un pour la prise en charge de la configuration.</span><span class="sxs-lookup"><span data-stu-id="9ad35-119">There are four different types of support objects: one for each major provider type (address book, message store, and transport) and one for configuration support.</span></span> 
  
<span data-ttu-id="9ad35-120">MAPI personnalise chaque objet de prise en charge en incluant des implémentations de méthodes pertinentes pour son utilisation.</span><span class="sxs-lookup"><span data-stu-id="9ad35-120">MAPI customizes each support object by including implementations of methods that are relevant for its usage.</span></span> <span data-ttu-id="9ad35-121">Les implémentations de certaines méthodes, telles que [IMAPISupport::OpenProfileSection,](imapisupport-openprofilesection.md)sont incluses dans tous les objets de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="9ad35-121">Implementations of some methods, such as [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md), are included in all support objects.</span></span> <span data-ttu-id="9ad35-122">Les implémentations d’autres méthodes, telles que [IMAPISupport::SpoolerNotify,](imapisupport-spoolernotify.md)s’appliquent uniquement à des objets de support particuliers.</span><span class="sxs-lookup"><span data-stu-id="9ad35-122">Implementations of other methods, such as [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md), apply only to particular support objects.</span></span> <span data-ttu-id="9ad35-123">Seuls les fournisseurs de transport et de magasin de messages peuvent utiliser cette méthode . lorsqu’un fournisseur de carnet d’adresses ou un service de messagerie tente de l’appeler, MAPI renvoie MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="9ad35-123">Only message store and transport providers can use this method; when an address book provider or a message service try to call it, MAPI returns MAPI_E_NO_SUPPORT.</span></span>
  
<span data-ttu-id="9ad35-124">Les objets de support peuvent être utilisés pour accomplir de nombreuses tâches, telles que les suivantes :</span><span class="sxs-lookup"><span data-stu-id="9ad35-124">Support objects can be used to accomplish many tasks, such as the following:</span></span>
  
- <span data-ttu-id="9ad35-125">Accès à une section de profil.</span><span class="sxs-lookup"><span data-stu-id="9ad35-125">Accessing a profile section.</span></span>
    
- <span data-ttu-id="9ad35-126">Copie de dossiers ou de messages.</span><span class="sxs-lookup"><span data-stu-id="9ad35-126">Copying folders or messages.</span></span> <span data-ttu-id="9ad35-127">Pour plus d’informations, [voir Copier ou déplacer un message ou un dossier.](copying-or-moving-a-message-or-a-folder.md)</span><span class="sxs-lookup"><span data-stu-id="9ad35-127">For more information, see [Copying or Moving a Message or a Folder](copying-or-moving-a-message-or-a-folder.md).</span></span>
    
- <span data-ttu-id="9ad35-128">Accès aux objets appartenant à d’autres fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="9ad35-128">Accessing objects that belong to other providers.</span></span> <span data-ttu-id="9ad35-129">Pour plus d’informations, voir [Supporting Object Access and Comparison](supporting-object-access-and-comparison.md).</span><span class="sxs-lookup"><span data-stu-id="9ad35-129">For more information, see [Supporting Object Access and Comparison](supporting-object-access-and-comparison.md).</span></span> 
    
- <span data-ttu-id="9ad35-130">Gestion des notifications d’événement.</span><span class="sxs-lookup"><span data-stu-id="9ad35-130">Handling event notification.</span></span> <span data-ttu-id="9ad35-131">Pour plus d’informations, voir [Notification d’événement de prise en charge.](supporting-event-notification.md)</span><span class="sxs-lookup"><span data-stu-id="9ad35-131">For more information, see [Supporting Event Notification](supporting-event-notification.md).</span></span>
    
- <span data-ttu-id="9ad35-132">Allocation et libération de mémoire.</span><span class="sxs-lookup"><span data-stu-id="9ad35-132">Allocating and freeing memory.</span></span>
    
- <span data-ttu-id="9ad35-133">Obtention d’un identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="9ad35-133">Obtaining a unique identifier.</span></span>
    
- <span data-ttu-id="9ad35-134">Invalidation d’objets.</span><span class="sxs-lookup"><span data-stu-id="9ad35-134">Invalidating objects.</span></span>
    
- <span data-ttu-id="9ad35-135">Gestion des erreurs.</span><span class="sxs-lookup"><span data-stu-id="9ad35-135">Handling errors.</span></span>
    
- <span data-ttu-id="9ad35-136">Inscription des préprocesseurs de messages.</span><span class="sxs-lookup"><span data-stu-id="9ad35-136">Registering message preprocessors.</span></span> 
    
- <span data-ttu-id="9ad35-137">Préparation des rapports de remise des messages.</span><span class="sxs-lookup"><span data-stu-id="9ad35-137">Preparing message delivery reports.</span></span> 
    
<span data-ttu-id="9ad35-138">Au moment de l’logo, MAPI appelle la méthode d’accès à l’objet fournisseur de chaque fournisseur de services.</span><span class="sxs-lookup"><span data-stu-id="9ad35-138">At logon time, MAPI calls the logon method of each service provider's provider object.</span></span> <span data-ttu-id="9ad35-139">Pour les fournisseurs de carnet d’adresses, MAPI appelle [IABProvider::Logon](iabprovider-logon.md).</span><span class="sxs-lookup"><span data-stu-id="9ad35-139">For address book providers, MAPI calls [IABProvider::Logon](iabprovider-logon.md).</span></span> <span data-ttu-id="9ad35-140">Pour les fournisseurs de magasins de messages, MAPI appelle [IMSProvider::Logon](imsprovider-logon.md).</span><span class="sxs-lookup"><span data-stu-id="9ad35-140">For message store providers, MAPI calls [IMSProvider::Logon](imsprovider-logon.md).</span></span> <span data-ttu-id="9ad35-141">Pour les fournisseurs de transport, MAPI appelle [IXPProvider::TransportLogon](ixpprovider-transportlogon.md).</span><span class="sxs-lookup"><span data-stu-id="9ad35-141">For transport providers, MAPI calls [IXPProvider::TransportLogon](ixpprovider-transportlogon.md).</span></span> <span data-ttu-id="9ad35-142">MAPI transmet un pointeur vers l’objet de support approprié dans l’un des paramètres de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="9ad35-142">MAPI passes a pointer to the appropriate support object in one of the parameters to this method.</span></span> <span data-ttu-id="9ad35-143">La méthode d' logon ins instantique à son tour un objet d’accès, en lui passant le pointeur d’objet de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="9ad35-143">The logon method in turn instantiates a logon object, passing it the support object pointer.</span></span> <span data-ttu-id="9ad35-144">L’objet d’logon appelle la méthode **IUnknown::AddRef** de l’objet de support pour le conserver, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="9ad35-144">The logon object calls the support object's **IUnknown::AddRef** method to retain it, if necessary.</span></span> <span data-ttu-id="9ad35-145">Pour plus d’informations sur le processus d’accès pour les fournisseurs de services, voir [Démarrage d’un fournisseur de services.](starting-a-service-provider.md)</span><span class="sxs-lookup"><span data-stu-id="9ad35-145">For more information about the logon process for service providers, see [Starting a Service Provider](starting-a-service-provider.md).</span></span>
  
<span data-ttu-id="9ad35-146">Lorsqu’un client se déconnecte, MAPI appelle la méthode de connexion de l’objet de connexion.</span><span class="sxs-lookup"><span data-stu-id="9ad35-146">When a client logs off, MAPI calls the logon object's logoff method.</span></span> <span data-ttu-id="9ad35-147">La méthode logoff appelle la méthode **IUnknown::Release** de l’objet de support pour indiquer que le fournisseur n’a plus l’intention d’appeler les méthodes de support.</span><span class="sxs-lookup"><span data-stu-id="9ad35-147">The logoff method calls the support object's **IUnknown::Release** method to indicate that the provider no longer intends to call any of the support methods.</span></span> <span data-ttu-id="9ad35-148">Comme pour l' logon, les méthodes de ff de logo ont des noms légèrement différents.</span><span class="sxs-lookup"><span data-stu-id="9ad35-148">As with logon, the logoff methods have slightly different names.</span></span> <span data-ttu-id="9ad35-149">Les interfaces [IABLogon](iablogoniunknown.md) et [IMSLogon](imslogoniunknown.md) ont des méthodes **Logoff** ; [L’interface IXPLogon](ixplogoniunknown.md) possède une [méthode TransportLogoff.](ixplogon-transportlogoff.md)</span><span class="sxs-lookup"><span data-stu-id="9ad35-149">The [IABLogon](iablogoniunknown.md) and [IMSLogon](imslogoniunknown.md) interfaces have **Logoff** methods; the [IXPLogon](ixplogoniunknown.md) interface has a [TransportLogoff](ixplogon-transportlogoff.md) method.</span></span> 
  
<span data-ttu-id="9ad35-150">Les fonctions de point d’entrée de service de message sont appelées lorsqu’une tentative d’accès échoue avec l’erreur MAPI_E_UNCONFIGURED ou lorsqu’un client lance une demande de configuration.</span><span class="sxs-lookup"><span data-stu-id="9ad35-150">Message service entry point functions are called when a logon attempt fails with the error MAPI_E_UNCONFIGURED or when a client initiates a configuration request.</span></span> <span data-ttu-id="9ad35-151">MAPI ins instantie un objet de prise en charge de configuration et appelle la fonction de point d’entrée du service de messagerie pour le fournisseur non configuré ou le fournisseur dont la configuration est sur le point de changer.</span><span class="sxs-lookup"><span data-stu-id="9ad35-151">MAPI instantiates a configuration support object and calls the message service entry point function for either the unconfigured provider or the provider whose configuration is about to change.</span></span> <span data-ttu-id="9ad35-152">Contrairement aux autres objets de prise en charge, les objets de prise en charge de configuration ne sont valides que jusqu’à ce que la fonction de point d’entrée soit de retour . les services de message n’appellent pas les méthodes **AddRef** de ces objets pour les conserver.</span><span class="sxs-lookup"><span data-stu-id="9ad35-152">Unlike the other support objects, configuration support objects are valid only until the entry point function returns; message services do not call these objects' **AddRef** methods to retain them.</span></span> 
  
<span data-ttu-id="9ad35-153">En règle générale, MAPI effectue des appels vers la fonction de point d’entrée du service de messagerie d’un fournisseur, mais parfois, un fournisseur est invité à passer l’appel.</span><span class="sxs-lookup"><span data-stu-id="9ad35-153">Typically, MAPI makes calls to a provider's message service entry point function, but sometimes a provider is asked to make the call.</span></span> <span data-ttu-id="9ad35-154">Cela peut se produire lorsqu’un client appelle la méthode [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) d’un fournisseur pour l’inviter à afficher sa feuille de propriétés de configuration.</span><span class="sxs-lookup"><span data-stu-id="9ad35-154">This can occur when a client calls a provider's [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) method to prompt the provider to display its configuration property sheet.</span></span> <span data-ttu-id="9ad35-155">**SettingsDialog** doit appeler [IMAPISupport::GetSvcConfigSupportObj](imapisupport-getsvcconfigsupportobj.md) pour obtenir un objet de prise en charge de configuration qu’il peut transmettre à la fonction de point d’entrée du service de message.</span><span class="sxs-lookup"><span data-stu-id="9ad35-155">**SettingsDialog** should call [IMAPISupport::GetSvcConfigSupportObj](imapisupport-getsvcconfigsupportobj.md) to obtain a configuration support object that it can pass to the message service entry point function.</span></span> 
  
<span data-ttu-id="9ad35-156">La [méthode IMAPISupport::GetMemAllocRoutines](imapisupport-getmemallocroutines.md) permet de déterminer les adresses des fonctions d’allocation et de déallocation de la mémoire sans avoir à établir de liaison avec MAPI.</span><span class="sxs-lookup"><span data-stu-id="9ad35-156">The [IMAPISupport::GetMemAllocRoutines](imapisupport-getmemallocroutines.md) method is available for determining the addresses of the memory allocation and deallocation functions without having to link with MAPI.</span></span> <span data-ttu-id="9ad35-157">**L’utilisation de GetMemAllocRoutines** facilite également le suivi des fuites de mémoire en entourant les appels de fonction d’allocation avec du code de débogage.</span><span class="sxs-lookup"><span data-stu-id="9ad35-157">Using **GetMemAllocRoutines** also makes it easier to trace memory leaks by surrounding the allocation function calls with debugging code.</span></span> <span data-ttu-id="9ad35-158">Si vous appelez **GetMemAllocRoutines,** comme recommandé, faites-le avant d’appeler la fonction [CreateIProp,](createiprop.md) qui requiert les adresses de la fonction d’allocation en tant que paramètres.</span><span class="sxs-lookup"><span data-stu-id="9ad35-158">If you call **GetMemAllocRoutines**, as is recommended, do so before calling the [CreateIProp](createiprop.md) function, which requires the allocation function addresses as parameters.</span></span> 
  
<span data-ttu-id="9ad35-159">Lorsque vous devez créer un objet de carnet d’adresses ou de magasin de messages, créez et définissez une clé de recherche pour l’objet dans sa propriété **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="9ad35-159">When you need to create a new address book or message store object, create and set a search key for the object in its **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) property.</span></span> <span data-ttu-id="9ad35-160">Appelez [IMAPISupport::NewUID](imapisupport-newuid.md) pour obtenir un identificateur unique à utiliser dans la création d’une clé de recherche.</span><span class="sxs-lookup"><span data-stu-id="9ad35-160">Call [IMAPISupport::NewUID](imapisupport-newuid.md) to obtain a unique identifier to use in building a search key.</span></span> <span data-ttu-id="9ad35-161">N’utilisez pas votre propre [MAPIUID](mapiuid.md)codé en dur.</span><span class="sxs-lookup"><span data-stu-id="9ad35-161">Do not use your own hard-coded [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="9ad35-162">**MapIUID** d’un fournisseur doit être utilisé uniquement pour les identificateurs d’entrée.</span><span class="sxs-lookup"><span data-stu-id="9ad35-162">A provider's **MAPIUID** should be used only for entry identifiers.</span></span> <span data-ttu-id="9ad35-163">Pour plus d’informations sur la construction de clés de recherche, voir [MapI Record and Search Keys](mapi-record-and-search-keys.md).</span><span class="sxs-lookup"><span data-stu-id="9ad35-163">For more information about constructing search keys, see [MAPI Record and Search Keys](mapi-record-and-search-keys.md).</span></span>
  
<span data-ttu-id="9ad35-164">Une application cliente peut parfois libérer un objet sans libérer un ou plusieurs de ses objets affiliés.</span><span class="sxs-lookup"><span data-stu-id="9ad35-164">A client application can sometimes release an object without releasing one or more of its affiliated objects.</span></span> <span data-ttu-id="9ad35-165">Dans ce cas, un fournisseur peut avoir besoin de rendre un objet non nouveau inutilisable.</span><span class="sxs-lookup"><span data-stu-id="9ad35-165">In such a case, a provider may need to render an unreleased object unusable.</span></span> <span data-ttu-id="9ad35-166">Pour ce faire, le fournisseur libère toutes les ressources connectées à l’objet, puis appelle [IMAPISupport::MakeInvalid](imapisupport-makeinvalid.md) pour invalider la table vtable de l’objet.</span><span class="sxs-lookup"><span data-stu-id="9ad35-166">To do this, the provider frees all of the resources connected with the object and then calls [IMAPISupport::MakeInvalid](imapisupport-makeinvalid.md) to invalidate the object's vtable.</span></span> <span data-ttu-id="9ad35-167">**MakeInvalid** remplace les méthodes **IUnknown** du vtable (**QueryInterface**, **AddRef** et **Release**) par des implémentations MAPI standard et entraîne le retour de toutes les autres méthodes MAPI_E_INVALID_OBJECT.</span><span class="sxs-lookup"><span data-stu-id="9ad35-167">**MakeInvalid** replaces the vtable's **IUnknown** methods (**QueryInterface**, **AddRef**, and **Release**) with standard MAPI implementations and causes all other methods to return MAPI_E_INVALID_OBJECT.</span></span> <span data-ttu-id="9ad35-168">**MakeInvalid** libère également toute la mémoire de l’objet autre que le vtable.</span><span class="sxs-lookup"><span data-stu-id="9ad35-168">**MakeInvalid** also frees all the object's memory other than the vtable.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="9ad35-169">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="9ad35-169">See also</span></span>



[<span data-ttu-id="9ad35-170">Fournisseurs de services MAPI</span><span class="sxs-lookup"><span data-stu-id="9ad35-170">MAPI Service Providers</span></span>](mapi-service-providers.md)

