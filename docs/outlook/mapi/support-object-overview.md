---
title: Prise en charge de la vue d’ensemble de l’objet
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5b062891-39ab-4334-9706-5b376719d5e4
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: ecc5439b4abbbfd920fba5456db7462f7967388f
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19787268"
---
# <a name="support-object-overview"></a><span data-ttu-id="22f3a-103">Prise en charge de la vue d’ensemble de l’objet</span><span class="sxs-lookup"><span data-stu-id="22f3a-103">Support Object Overview</span></span>

  
  
<span data-ttu-id="22f3a-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="22f3a-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="22f3a-105">MAPI fournit un objet de prise en charge, un objet qui implémente le [IMAPISupport : IUnknown](imapisupportiunknown.md) interface, pour tous les fournisseurs de services au cours de l’ouverture de session et pour tous les services de message lors de la configuration.</span><span class="sxs-lookup"><span data-stu-id="22f3a-105">MAPI furnishes a support object, an object that implements the [IMAPISupport : IUnknown](imapisupportiunknown.md) interface, for all service providers during logon and for all message services during configuration.</span></span> 
  
<span data-ttu-id="22f3a-106">Prise en charge des objets ne sont pas accessibles par les clients ; ils sont implémentés par MAPI et appelées uniquement par les fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="22f3a-106">Support objects are not accessible by clients; they are implemented by MAPI and called only by service providers.</span></span> <span data-ttu-id="22f3a-107">L’interface **IMAPISupport** est spécifié dans le fichier d’en-tête Mapispi.h.</span><span class="sxs-lookup"><span data-stu-id="22f3a-107">The **IMAPISupport** interface is specified in the Mapispi.h header file.</span></span> <span data-ttu-id="22f3a-108">Son identificateur est IID_IMAPISup et son type de pointeur est LPMAPISUP.</span><span class="sxs-lookup"><span data-stu-id="22f3a-108">Its identifier is IID_IMAPISup and its pointer type is LPMAPISUP.</span></span> <span data-ttu-id="22f3a-109">Aucuns propriétés MAPI ne sont exposées par les objets de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="22f3a-109">No MAPI properties are exposed by support objects.</span></span> 
  
<span data-ttu-id="22f3a-110">Un fournisseur peut être attribué à un ou plusieurs objets de prise en charge, selon le nombre de fois que le fournisseur de session MAPI ou le nombre de répétitions de que fonction de l’entrée de service de message du fournisseur est appelée.</span><span class="sxs-lookup"><span data-stu-id="22f3a-110">A provider can be given one or more support objects, depending on the number of times MAPI logs the provider on or the number of times the provider's message service entry function is called.</span></span> <span data-ttu-id="22f3a-111">En règle générale, un fournisseur sera connecté au moins une fois par session.</span><span class="sxs-lookup"><span data-stu-id="22f3a-111">Typically, a provider will be logged on at least once per session.</span></span> <span data-ttu-id="22f3a-112">Fournisseurs de transport et le carnet d’adresses sont enregistrés chaque fois qu’un client démarre une session avec une entrée de profil qui les demande.</span><span class="sxs-lookup"><span data-stu-id="22f3a-112">Address book and transport providers are logged on every time a client starts a session with a profile entry that requests them.</span></span> <span data-ttu-id="22f3a-113">Fournisseurs de banque de messages sont enregistrés sur chaque fois qu’un client appelle la méthode [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) .</span><span class="sxs-lookup"><span data-stu-id="22f3a-113">Message store providers are logged on every time a client calls the [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) method.</span></span> 
  
<span data-ttu-id="22f3a-114">Dans le cas d’ouvertures de session multiples dans une session, vous pouvez choisir de conserver et d’utiliser chaque objet prise en charge séparément ou de conserver et d’utiliser uniquement le premier, en supprimant chaque objet prise en charge suivantes.</span><span class="sxs-lookup"><span data-stu-id="22f3a-114">In the case of multiple logons in a session, you can choose either to retain and use each support object separately or to retain and use only the first, discarding each subsequent support object.</span></span> <span data-ttu-id="22f3a-115">Pour conserver un objet de prise en charge, appelez la méthode **IUnknown::AddRef** .</span><span class="sxs-lookup"><span data-stu-id="22f3a-115">To retain a support object, call its **IUnknown::AddRef** method.</span></span> <span data-ttu-id="22f3a-116">L’appel de **AddRef** sur un objet de prise en charge que vous souhaitez conserver au sein d’une session est extrêmement important ; Si l’appel n’est pas effectué, MAPI libère l’objet de prise en charge et libère de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="22f3a-116">Calling **AddRef** on a support object that you want to retain throughout a session is extremely important; if the call is not made, MAPI releases the support object and frees its memory.</span></span> 
  
<span data-ttu-id="22f3a-117">L’objectif de l’objet de prise en charge est de fournir des implémentations pour un grand nombre des méthodes couramment utilisées par les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="22f3a-117">The purpose of the support object is to provide implementations for a fairly large number of methods commonly used by the providers.</span></span> <span data-ttu-id="22f3a-118">Chaque objet de prise en charge contient également des données contextuelles spécifiques à sa propre instance, telles que la session que le fournisseur est en cours d’exécution dans la section profil qu'utilise le fournisseur et les informations d’erreur pour la session.</span><span class="sxs-lookup"><span data-stu-id="22f3a-118">Each support object also contains contextual data specific to its own instance, such as the session the provider is running in, the profile section the provider is using, and error information for the session.</span></span> 
  
<span data-ttu-id="22f3a-119">Il existe quatre types d’objets de prise en charge : un pour chaque type de fournisseur principales (carnet d’adresses, banque de messages et de transport) et un pour la prise en charge de la configuration.</span><span class="sxs-lookup"><span data-stu-id="22f3a-119">There are four different types of support objects: one for each major provider type (address book, message store, and transport) and one for configuration support.</span></span> 
  
<span data-ttu-id="22f3a-120">MAPI personnalise chaque objet prise en charge par, y compris les implémentations des méthodes qui sont pertinents pour son utilisation.</span><span class="sxs-lookup"><span data-stu-id="22f3a-120">MAPI customizes each support object by including implementations of methods that are relevant for its usage.</span></span> <span data-ttu-id="22f3a-121">Implémentations de certaines méthodes, telles [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md), sont incluses dans tous les objets de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="22f3a-121">Implementations of some methods, such as [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md), are included in all support objects.</span></span> <span data-ttu-id="22f3a-122">Implémentations d’autres méthodes, telles [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md), s’appliquent uniquement aux objets de prise en charge particulière.</span><span class="sxs-lookup"><span data-stu-id="22f3a-122">Implementations of other methods, such as [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md), apply only to particular support objects.</span></span> <span data-ttu-id="22f3a-123">Magasin des messages uniquement et fournisseurs de transport peuvent utiliser cette méthode ; Lorsqu’un fournisseur de carnet d’adresses ou d’un service de message essayez d’appeler, MAPI renvoie MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="22f3a-123">Only message store and transport providers can use this method; when an address book provider or a message service try to call it, MAPI returns MAPI_E_NO_SUPPORT.</span></span>
  
<span data-ttu-id="22f3a-124">Objets de prise en charge peuvent être utilisés pour réaliser de nombreuses tâches, telles que les suivantes :</span><span class="sxs-lookup"><span data-stu-id="22f3a-124">Support objects can be used to accomplish many tasks, such as the following:</span></span>
  
- <span data-ttu-id="22f3a-125">Accès à une section de profil.</span><span class="sxs-lookup"><span data-stu-id="22f3a-125">Accessing a profile section.</span></span>
    
- <span data-ttu-id="22f3a-126">Copie de dossiers ou des messages.</span><span class="sxs-lookup"><span data-stu-id="22f3a-126">Copying folders or messages.</span></span> <span data-ttu-id="22f3a-127">Pour plus d’informations, voir [copie ou déplacement d’un Message ou un dossier](copying-or-moving-a-message-or-a-folder.md).</span><span class="sxs-lookup"><span data-stu-id="22f3a-127">For more information, see [Copying or Moving a Message or a Folder](copying-or-moving-a-message-or-a-folder.md).</span></span>
    
- <span data-ttu-id="22f3a-128">Accès aux objets qui appartiennent à d’autres fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="22f3a-128">Accessing objects that belong to other providers.</span></span> <span data-ttu-id="22f3a-129">Pour plus d’informations, voir [prise en charge l’accès aux objets et comparaison](supporting-object-access-and-comparison.md).</span><span class="sxs-lookup"><span data-stu-id="22f3a-129">For more information, see [Supporting Object Access and Comparison](supporting-object-access-and-comparison.md).</span></span> 
    
- <span data-ttu-id="22f3a-130">Gestion de notification d’événement.</span><span class="sxs-lookup"><span data-stu-id="22f3a-130">Handling event notification.</span></span> <span data-ttu-id="22f3a-131">Pour plus d’informations, voir [Prise en charge de Notification d’événement](supporting-event-notification.md).</span><span class="sxs-lookup"><span data-stu-id="22f3a-131">For more information, see [Supporting Event Notification](supporting-event-notification.md).</span></span>
    
- <span data-ttu-id="22f3a-132">Allocation et libération de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="22f3a-132">Allocating and freeing memory.</span></span>
    
- <span data-ttu-id="22f3a-133">Obtention d’un identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="22f3a-133">Obtaining a unique identifier.</span></span>
    
- <span data-ttu-id="22f3a-134">Invalidation d’objets.</span><span class="sxs-lookup"><span data-stu-id="22f3a-134">Invalidating objects.</span></span>
    
- <span data-ttu-id="22f3a-135">Gestion des erreurs.</span><span class="sxs-lookup"><span data-stu-id="22f3a-135">Handling errors.</span></span>
    
- <span data-ttu-id="22f3a-136">Inscription Préprocesseurs du message.</span><span class="sxs-lookup"><span data-stu-id="22f3a-136">Registering message preprocessors.</span></span> 
    
- <span data-ttu-id="22f3a-137">Préparation des rapports de remise de message.</span><span class="sxs-lookup"><span data-stu-id="22f3a-137">Preparing message delivery reports.</span></span> 
    
<span data-ttu-id="22f3a-138">Au moment de l’ouverture de session MAPI appelle la méthode d’ouverture de session de l’objet de fournisseur de chaque fournisseur de services.</span><span class="sxs-lookup"><span data-stu-id="22f3a-138">At logon time, MAPI calls the logon method of each service provider's provider object.</span></span> <span data-ttu-id="22f3a-139">Pour les fournisseurs de carnet d’adresses, MAPI appelle [IABProvider::Logon](iabprovider-logon.md).</span><span class="sxs-lookup"><span data-stu-id="22f3a-139">For address book providers, MAPI calls [IABProvider::Logon](iabprovider-logon.md).</span></span> <span data-ttu-id="22f3a-140">Pour les fournisseurs de banque de messages, [IMSProvider::Logon](imsprovider-logon.md)appels MAPI.</span><span class="sxs-lookup"><span data-stu-id="22f3a-140">For message store providers, MAPI calls [IMSProvider::Logon](imsprovider-logon.md).</span></span> <span data-ttu-id="22f3a-141">Pour les fournisseurs de transport, [IXPProvider::TransportLogon](ixpprovider-transportlogon.md)appels MAPI.</span><span class="sxs-lookup"><span data-stu-id="22f3a-141">For transport providers, MAPI calls [IXPProvider::TransportLogon](ixpprovider-transportlogon.md).</span></span> <span data-ttu-id="22f3a-142">MAPI passe un pointeur vers l’objet de prise en charge appropriée dans l’un des paramètres à cette méthode.</span><span class="sxs-lookup"><span data-stu-id="22f3a-142">MAPI passes a pointer to the appropriate support object in one of the parameters to this method.</span></span> <span data-ttu-id="22f3a-143">À son tour, la méthode d’ouverture de session instancie un objet d’ouverture de session, en lui transmettant le pointeur d’objet prise en charge.</span><span class="sxs-lookup"><span data-stu-id="22f3a-143">The logon method in turn instantiates a logon object, passing it the support object pointer.</span></span> <span data-ttu-id="22f3a-144">L’objet d’ouverture de session appelle la prise en charge de méthode l’objet **IUnknown::AddRef** pour conserver, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="22f3a-144">The logon object calls the support object's **IUnknown::AddRef** method to retain it, if necessary.</span></span> <span data-ttu-id="22f3a-145">Pour plus d’informations sur le processus d’ouverture de session pour les fournisseurs de service, voir [démarrage d’un fournisseur de services](starting-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="22f3a-145">For more information about the logon process for service providers, see [Starting a Service Provider](starting-a-service-provider.md).</span></span>
  
<span data-ttu-id="22f3a-146">Quand un client se déconnecte, MAPI appelle la méthode de fermeture de session de l’objet d’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="22f3a-146">When a client logs off, MAPI calls the logon object's logoff method.</span></span> <span data-ttu-id="22f3a-147">La méthode de fermeture de session appelle la méthode **IUnknown::Release** de l’objet de la prise en charge pour indiquer que le fournisseur a n’est plus l’intention d’appeler une des méthodes de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="22f3a-147">The logoff method calls the support object's **IUnknown::Release** method to indicate that the provider no longer intends to call any of the support methods.</span></span> <span data-ttu-id="22f3a-148">Comme avec l’ouverture de session, les méthodes de fermeture de session ont des noms légèrement différents.</span><span class="sxs-lookup"><span data-stu-id="22f3a-148">As with logon, the logoff methods have slightly different names.</span></span> <span data-ttu-id="22f3a-149">Les interfaces [IABLogon](iablogoniunknown.md) et [IMSLogon](imslogoniunknown.md) ont des méthodes de **fermeture de session** ; l’interface [IXPLogon](ixplogoniunknown.md) a une méthode [TransportLogoff](ixplogon-transportlogoff.md) .</span><span class="sxs-lookup"><span data-stu-id="22f3a-149">The [IABLogon](iablogoniunknown.md) and [IMSLogon](imslogoniunknown.md) interfaces have **Logoff** methods; the [IXPLogon](ixplogoniunknown.md) interface has a [TransportLogoff](ixplogon-transportlogoff.md) method.</span></span> 
  
<span data-ttu-id="22f3a-150">Fonctions de point d’entrée message service sont appelées lorsqu’une tentative d’ouverture de session échoue avec l’erreur MAPI_E_UNCONFIGURED ou lorsqu’un client lance une demande de configuration.</span><span class="sxs-lookup"><span data-stu-id="22f3a-150">Message service entry point functions are called when a logon attempt fails with the error MAPI_E_UNCONFIGURED or when a client initiates a configuration request.</span></span> <span data-ttu-id="22f3a-151">MAPI instancie un objet de configuration de prise en charge et appelle la fonction de point d’entrée de message service pour le fournisseur non configuré ou le fournisseur dont la configuration est sur le point de changer.</span><span class="sxs-lookup"><span data-stu-id="22f3a-151">MAPI instantiates a configuration support object and calls the message service entry point function for either the unconfigured provider or the provider whose configuration is about to change.</span></span> <span data-ttu-id="22f3a-152">Contrairement à d’autres objets, objets de configuration de prise en charge sont valides jusqu'à ce que le point d’entrée fonction renvoie ; services message n’appelez pas les méthodes **AddRef** de ces objets pour les conserver.</span><span class="sxs-lookup"><span data-stu-id="22f3a-152">Unlike the other support objects, configuration support objects are valid only until the entry point function returns; message services do not call these objects' **AddRef** methods to retain them.</span></span> 
  
<span data-ttu-id="22f3a-153">En règle générale, MAPI effectue des appels à la fonction de point d’entrée du service de message d’un fournisseur, mais parfois un fournisseur est posée à l’appel.</span><span class="sxs-lookup"><span data-stu-id="22f3a-153">Typically, MAPI makes calls to a provider's message service entry point function, but sometimes a provider is asked to make the call.</span></span> <span data-ttu-id="22f3a-154">Cela peut se produire lorsqu’un client appelle une méthode de fournisseur [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) pour demander le fournisseur pour afficher sa feuille de propriétés de configuration.</span><span class="sxs-lookup"><span data-stu-id="22f3a-154">This can occur when a client calls a provider's [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) method to prompt the provider to display its configuration property sheet.</span></span> <span data-ttu-id="22f3a-155">**Dialogue** doit appeler [IMAPISupport::GetSvcConfigSupportObj](imapisupport-getsvcconfigsupportobj.md) pour obtenir un objet de prise en charge de configuration il peut passer à la fonction de point d’entrée de message service.</span><span class="sxs-lookup"><span data-stu-id="22f3a-155">**SettingsDialog** should call [IMAPISupport::GetSvcConfigSupportObj](imapisupport-getsvcconfigsupportobj.md) to obtain a configuration support object that it can pass to the message service entry point function.</span></span> 
  
<span data-ttu-id="22f3a-156">La méthode [IMAPISupport::GetMemAllocRoutines](imapisupport-getmemallocroutines.md) est disponible pour déterminer les adresses des fonctions allocation et libération de mémoire sans créer de lien MAPI.</span><span class="sxs-lookup"><span data-stu-id="22f3a-156">The [IMAPISupport::GetMemAllocRoutines](imapisupport-getmemallocroutines.md) method is available for determining the addresses of the memory allocation and deallocation functions without having to link with MAPI.</span></span> <span data-ttu-id="22f3a-157">À l’aide de **GetMemAllocRoutines** facilite également effectuer le suivi de fuites de mémoire en mettant les appels de fonction allocation avec code de débogage.</span><span class="sxs-lookup"><span data-stu-id="22f3a-157">Using **GetMemAllocRoutines** also makes it easier to trace memory leaks by surrounding the allocation function calls with debugging code.</span></span> <span data-ttu-id="22f3a-158">Si vous appelez **GetMemAllocRoutines**, comme est recommandé, le faire avant d’appeler la fonction [CreateIProp](createiprop.md) , qui requiert l’allocation des adresses fonction en tant que paramètres.</span><span class="sxs-lookup"><span data-stu-id="22f3a-158">If you call **GetMemAllocRoutines**, as is recommended, do so before calling the [CreateIProp](createiprop.md) function, which requires the allocation function addresses as parameters.</span></span> 
  
<span data-ttu-id="22f3a-159">Lorsque vous avez besoin créer un nouveau carnet d’adresses ou un message objet banque, créer et définir une clé de recherche pour l’objet dans sa propriété **clé PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="22f3a-159">When you need to create a new address book or message store object, create and set a search key for the object in its **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) property.</span></span> <span data-ttu-id="22f3a-160">Appelez [IMAPISupport::NewUID](imapisupport-newuid.md) pour obtenir un identificateur unique à utiliser lors de la création d’une clé de recherche.</span><span class="sxs-lookup"><span data-stu-id="22f3a-160">Call [IMAPISupport::NewUID](imapisupport-newuid.md) to obtain a unique identifier to use in building a search key.</span></span> <span data-ttu-id="22f3a-161">N’utilisez pas votre propre codé en dur [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="22f3a-161">Do not use your own hard-coded [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="22f3a-162">D’un fournisseur **MAPIUID** doit être utilisé uniquement pour les identificateurs d’entrée.</span><span class="sxs-lookup"><span data-stu-id="22f3a-162">A provider's **MAPIUID** should be used only for entry identifiers.</span></span> <span data-ttu-id="22f3a-163">Pour plus d’informations sur la construction clés de recherche, voir [enregistrement MAPI et les clés de recherche](mapi-record-and-search-keys.md).</span><span class="sxs-lookup"><span data-stu-id="22f3a-163">For more information about constructing search keys, see [MAPI Record and Search Keys](mapi-record-and-search-keys.md).</span></span>
  
<span data-ttu-id="22f3a-164">Une application cliente peut parfois libérer un objet sans libère un ou plusieurs de ses objets affiliés.</span><span class="sxs-lookup"><span data-stu-id="22f3a-164">A client application can sometimes release an object without releasing one or more of its affiliated objects.</span></span> <span data-ttu-id="22f3a-165">Dans ce cas, un fournisseur devrez de rendre un objet non publiée inutilisable.</span><span class="sxs-lookup"><span data-stu-id="22f3a-165">In such a case, a provider may need to render an unreleased object unusable.</span></span> <span data-ttu-id="22f3a-166">Pour ce faire, le fournisseur libère toutes les ressources liées à l’objet, puis appelle [IMAPISupport::MakeInvalid](imapisupport-makeinvalid.md) pour invalider vtable de l’objet.</span><span class="sxs-lookup"><span data-stu-id="22f3a-166">To do this, the provider frees all of the resources connected with the object and then calls [IMAPISupport::MakeInvalid](imapisupport-makeinvalid.md) to invalidate the object's vtable.</span></span> <span data-ttu-id="22f3a-167">**MakeInvalid** remplace les méthodes de **IUnknown** de vtable (**QueryInterface**, **AddRef**et **Release**) et les implémentations de MAPI standards et affiche toutes les autres méthodes renvoyer MAPI_E_INVALID_OBJECT.</span><span class="sxs-lookup"><span data-stu-id="22f3a-167">**MakeInvalid** replaces the vtable's **IUnknown** methods (**QueryInterface**, **AddRef**, and **Release**) with standard MAPI implementations and causes all other methods to return MAPI_E_INVALID_OBJECT.</span></span> <span data-ttu-id="22f3a-168">**MakeInvalid** également libère de la mémoire de de tous les objets autre que la vtable.</span><span class="sxs-lookup"><span data-stu-id="22f3a-168">**MakeInvalid** also frees all the object's memory other than the vtable.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="22f3a-169">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="22f3a-169">See also</span></span>



[<span data-ttu-id="22f3a-170">Fournisseurs de services MAPI</span><span class="sxs-lookup"><span data-stu-id="22f3a-170">MAPI Service Providers</span></span>](mapi-service-providers.md)

