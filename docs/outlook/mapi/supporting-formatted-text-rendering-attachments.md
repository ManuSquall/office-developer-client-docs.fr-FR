---
title: Prise en charge de texte mis en forme  Rendu des pi�ces jointes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 68abe85b-5dc0-40d0-8917-30ea002aa816
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: 5f03530f994fd13e7dc4c7eaa4124900c28e613b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32350700"
---
# <a name="supporting-formatted-text-rendering-attachments"></a><span data-ttu-id="d27bf-103">Prise en charge du texte mis en forme: rendu des pièces jointes</span><span class="sxs-lookup"><span data-stu-id="d27bf-103">Supporting Formatted Text: Rendering Attachments</span></span>

  
  
<span data-ttu-id="d27bf-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d27bf-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d27bf-105">Une application cliente qui s'intéresse à l'emplacement dans lequel les pièces jointes sont affichées définit la propriété **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) pour ces pièces jointes lors de la composition du message.</span><span class="sxs-lookup"><span data-stu-id="d27bf-105">A client application that cares about where in a message its attachments are rendered sets the **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) property for these attachments during message composition.</span></span> <span data-ttu-id="d27bf-106">Un client qui ne se soucie pas placement de rendu laisse cette propri�t� non d�finie.</span><span class="sxs-lookup"><span data-stu-id="d27bf-106">A client that does not care about rendering placement leaves this property unset.</span></span>
  
<span data-ttu-id="d27bf-p102">Lorsqu'un client ouvre un message contenant des pi�ces jointes, il tente de r�cup�rer la propri�t� de **PR_RENDERING_POSITION** de chaque pi�ce jointe afin de d�terminer o� la pi�ce jointe doit �tre affich�e dans le texte du message. Un client peut utiliser une des m�thodes suivantes pour r�cup�rer **PR_RENDERING_POSITION**:</span><span class="sxs-lookup"><span data-stu-id="d27bf-p102">When a client opens a message with attachments, it attempts to retrieve each attachment's **PR_RENDERING_POSITION** property to determine where in the message text the attachment should be rendered. A client can use one of the following methods to retrieve **PR_RENDERING_POSITION**:</span></span>
  
- <span data-ttu-id="d27bf-109">[IMAPIProp::GetProps](imapiprop-getprops.md) on the open attachment to retrieve the **PR_RENDERING_POSITION** property.</span><span class="sxs-lookup"><span data-stu-id="d27bf-109">[IMAPIProp::GetProps](imapiprop-getprops.md) on the open attachment to retrieve the **PR_RENDERING_POSITION** property.</span></span> 
    
- <span data-ttu-id="d27bf-p103">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) on the open message to retrieve its attachment table. **PR_RENDERING_POSITION** is a required column in all attachment tables. This is the preferred method because it results in better performance.</span><span class="sxs-lookup"><span data-stu-id="d27bf-p103">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) on the open message to retrieve its attachment table. **PR_RENDERING_POSITION** is a required column in all attachment tables. This is the preferred method because it results in better performance.</span></span> 
    
<span data-ttu-id="d27bf-p104">Banques de messages prenant en charge au format RTF peuvent choisir s'il faut retourner une valeur exacte ou approximative pour **PR_RENDERING_POSITION**. �tant donn� que les banques de messages recalculer valeur de **PR_RENDERING_POSITION** d'une pi�ce jointe lorsque vous �tes invit� pour la propri�t� du message **PR_BODY**, certains messages RTF prenant en charge stocke uniquement les garantie la pr�cision du rendu positionne lorsqu'un client demande d'abord **PR_BODY**. Banques de messages prenant en charge au format RTF sont autoris�s � fournir aux clients ayant des valeurs de position de rendu approximatif pour am�liorer les performances. Fournissant une approximative plut�t qu'une position de rendu pr�cis gagne du temps et est suffisant pour la plupart des cas.</span><span class="sxs-lookup"><span data-stu-id="d27bf-p104">RTF-aware message stores can choose whether to return an accurate or approximate value for **PR_RENDERING_POSITION**. Because message stores recalculate an attachment's **PR_RENDERING_POSITION** value when asked for the message's **PR_BODY** property, some RTF-aware message stores only guarantee the accuracy of rendering positions when a client asks first for **PR_BODY**. RTF-aware message stores are allowed to provide clients with approximate rendering position values to enhance performance. Providing an approximate rather than an accurate rendering position saves time and is sufficient for most situations.</span></span> 
  
<span data-ttu-id="d27bf-p105">Banques de messages RTF prenant en charge doivent reposer leur rapprochement de la valeur sp�cifi�e par le client responsable de la cr�ation de la pi�ce jointe. Bien que tous les clients doivent d�finir **PR_RENDERING_POSITION**, les fournisseurs de banque de message doivent �tre pr�ts � traiter avec la possibilit� de son absence. Lorsque le client ne d�finit pas **PR_RENDERING_POSITION**, une banque de messages peut lui attribuer -1 pour indiquer que la position de rendu n'est pas dans le texte du message. Les pi�ces jointes avec une position de rendu de la valeur -1 peuvent �tre affich�s � n'importe quel endroit au sein du message en fonction du client. De nombreux clients positionner ces types de pi�ces jointes en haut du message.</span><span class="sxs-lookup"><span data-stu-id="d27bf-p105">RTF-aware message stores should base their approximation on the value specified by the client responsible for creating the attachment. Although all clients should set **PR_RENDERING_POSITION**, message store providers should be prepared to deal with the possibility of its absence. When the client does not set **PR_RENDERING_POSITION**, a message store can set it to -1 to indicate that the rendering position is not within the message text. Attachments with a rendering position of -1 can be displayed at any place within the message depending on the client. Many clients position these types of attachments at the top of the message.</span></span>
  
<span data-ttu-id="d27bf-122">Le degré de précision d'une propriété **PR_RENDERING_POSITION** varie selon qu'une banque de messages enregistre à la fois les propriétés **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) et **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) d'un message ou **PR_RTF_COMPRESSED**uniquement.</span><span class="sxs-lookup"><span data-stu-id="d27bf-122">The degree of accuracy for a **PR_RENDERING_POSITION** property depends on whether or not a message store saves both a message's **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) and **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) properties or only **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="d27bf-123">Si le client g�n�re **PR_BODY** et que la banque de messages enregistre en m�me temps que le texte mis en forme, les positions de rendu seront pr�cises.</span><span class="sxs-lookup"><span data-stu-id="d27bf-123">If the client generates **PR_BODY** and the message store saves it along with the formatted text, the rendering positions will be accurate.</span></span> <span data-ttu-id="d27bf-124">Toutefois, si la banque de messages doit g�n�rer sa propre version de **PR_BODY**, car il enregistre uniquement **PR_RTF_COMPRESSED**, il est probable que les positions de rendu sera un peu impr�cises.</span><span class="sxs-lookup"><span data-stu-id="d27bf-124">However, if the message store must generate its own version of **PR_BODY** because it only saves **PR_RTF_COMPRESSED**, it is probable that the rendering positions will be somewhat inaccurate.</span></span> <span data-ttu-id="d27bf-125">Il s'agit en raison des diff�rences dans la mani�re dont que les clients et les fournisseurs de banque de messages g�n�rent la propri�t� **PR_BODY**.</span><span class="sxs-lookup"><span data-stu-id="d27bf-125">This is because of the differences in the way that clients and message store providers generate the **PR_BODY** property.</span></span> 
  
<span data-ttu-id="d27bf-p107">To calculate an accurate **PR_RENDERING_POSITION** value, an RTF-aware store uses a tag embedded in the formatted text. The utility function **RTFSync** can be called to perform this calculation and update an attachment's rendering position. Depending on the amount of state information available, the message store can pass either RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED, or both values to [RTFSync](rtfsync.md).</span><span class="sxs-lookup"><span data-stu-id="d27bf-p107">To calculate an accurate **PR_RENDERING_POSITION** value, an RTF-aware store uses a tag embedded in the formatted text. The utility function **RTFSync** can be called to perform this calculation and update an attachment's rendering position. Depending on the amount of state information available, the message store can pass either RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED, or both values to [RTFSync](rtfsync.md).</span></span>
  

