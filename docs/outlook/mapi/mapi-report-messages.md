---
title: Messages de rapport MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 824eb670-16b7-49bf-9992-39fe0586a552
description: Dernière modification le 9 mars 2015
ms.openlocfilehash: aab5c76fb268729f1a50a33e4764905fe3d53405
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405764"
---
# <a name="mapi-report-messages"></a><span data-ttu-id="2c018-103">Messages de rapport MAPI</span><span class="sxs-lookup"><span data-stu-id="2c018-103">MAPI Report Messages</span></span>

  
  
<span data-ttu-id="2c018-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2c018-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2c018-105">Les messages de rapport présentent des informations d’état sur un message à son expéditeur.</span><span class="sxs-lookup"><span data-stu-id="2c018-105">Report messages present status information about a message to its sender.</span></span>
  
<span data-ttu-id="2c018-106">Il existe deux types généraux de messages de rapport :</span><span class="sxs-lookup"><span data-stu-id="2c018-106">There are two general types of report messages:</span></span>
  
- <span data-ttu-id="2c018-107">Lire les rapports d’état.</span><span class="sxs-lookup"><span data-stu-id="2c018-107">Read status reports.</span></span>
    
- <span data-ttu-id="2c018-108">Rapports d’état de remise.</span><span class="sxs-lookup"><span data-stu-id="2c018-108">Delivery status reports.</span></span>
    
## <a name="read-status-reports"></a><span data-ttu-id="2c018-109">Lire les rapports d’état</span><span class="sxs-lookup"><span data-stu-id="2c018-109">Read Status Reports</span></span>

<span data-ttu-id="2c018-110">Les rapports d’état de lecture sont initiés par les fournisseurs de magasins de messages via un appel à la méthode [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) et sont envoyés au destinataire représenté par l’identificateur d’entrée dans la propriété **PR_REPORT_ENTRYID** ([PidTagReportEntryId](pidtagreportentryid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="2c018-110">Read status reports are initiated by message store providers through a call to the [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) method and are sent to the recipient represented by the entry identifier in the **PR_REPORT_ENTRYID** ([PidTagReportEntryId](pidtagreportentryid-canonical-property.md)) property.</span></span> <span data-ttu-id="2c018-111">Les rapports d’état de lecture ne sont pas générés automatiquement ; les applications clientes qui souhaitent les recevoir doivent explicitement les demander.</span><span class="sxs-lookup"><span data-stu-id="2c018-111">Read status reports are not generated automatically; client applications that want to receive them must explicitly request them.</span></span>
  
<span data-ttu-id="2c018-112">Un rapport de lecture indique que l’indicateur de lecture d’un message a été définie, ce qui peut se produire lorsque le message est ouvert, imprimé, déplacé ou copié.</span><span class="sxs-lookup"><span data-stu-id="2c018-112">A read report indicates that the read flag of a message has been set, which can occur when the message is opened, printed, moved, or copied.</span></span> <span data-ttu-id="2c018-113">Le fait qu’un fournisseur de magasins de messages génère ou non un rapport de lecture en réponse à une opération de déplacement ou de copie dépend de l’endroit où se déplace le message.</span><span class="sxs-lookup"><span data-stu-id="2c018-113">Whether or not a message store provider generates a read report in response to a move or copy operation depends on where the message is going.</span></span> <span data-ttu-id="2c018-114">S’il est déplacé ou copié dans une autre magasin de messages, un rapport de lecture sera probablement toujours envoyé.</span><span class="sxs-lookup"><span data-stu-id="2c018-114">If it is being moved or copied to another message store, a read report will most likely always be sent.</span></span> <span data-ttu-id="2c018-115">S’il est déplacé ou copié dans la boutique de messages actuelle, un rapport de lecture peut être envoyé ou non.</span><span class="sxs-lookup"><span data-stu-id="2c018-115">If it is being moved or copied in the current message store, a read report might or might not be sent.</span></span> 
  
<span data-ttu-id="2c018-116">Un rapport non lu indique que l’indicateur de lecture d’un message n’est pas définie et que le message n’a pas été ouvert avant d’être placé dans le dossier Éléments supprimés ou avant l’expiration d’une limite de temps.</span><span class="sxs-lookup"><span data-stu-id="2c018-116">A nonread report indicates that the read flag of a message is not set and that the message was not opened either before being placed in the Deleted Items folder or before the expiration of a time limit.</span></span> <span data-ttu-id="2c018-117">Les clients peuvent appeler la méthode [IMessage::SetReadFlag](imessage-setreadflag.md) ou [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) pour définir ou effacer l’indicateur de lecture d’un message.</span><span class="sxs-lookup"><span data-stu-id="2c018-117">Clients can call the [IMessage::SetReadFlag](imessage-setreadflag.md) or [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) method to set or clear a message's read flag.</span></span> 
  
## <a name="delivery-status-reports"></a><span data-ttu-id="2c018-118">Rapports d’état de remise</span><span class="sxs-lookup"><span data-stu-id="2c018-118">Delivery Status Reports</span></span>

<span data-ttu-id="2c018-119">L’état de remise est reflété dans un rapport de remise, qui est envoyé lorsqu’un message a atteint son destinataire prévu, et dans un rapport de non remise, qui est envoyé lorsqu’un message n’a pas pu atteindre un destinataire.</span><span class="sxs-lookup"><span data-stu-id="2c018-119">Delivery status is reflected in a delivery report, which is sent when a message has reached its intended recipient, and in a nondelivery report, which is sent when a message could not reach a recipient.</span></span> <span data-ttu-id="2c018-120">Les rapports d’état de remise sont envoyés au destinataire représenté par l’identificateur d’entrée dans la propriété **PR_REPORT_ENTRYID** ou à l’expéditeur si cette propriété n’est pas présente.</span><span class="sxs-lookup"><span data-stu-id="2c018-120">Delivery status reports are sent to the recipient represented by the entry identifier in the **PR_REPORT_ENTRYID** property or to the sender if this property is not present.</span></span> 
  
<span data-ttu-id="2c018-121">Les rapports de remise sont envoyés uniquement par demande et n’incluent pas le message d’origine.</span><span class="sxs-lookup"><span data-stu-id="2c018-121">Delivery reports are sent by request only and do not include the original message.</span></span> <span data-ttu-id="2c018-122">Les rapports non envoyés sont envoyés automatiquement, sauf si une demande de suppression est faite.</span><span class="sxs-lookup"><span data-stu-id="2c018-122">Nondelivery reports are sent automatically unless a request is made to suppress them.</span></span> <span data-ttu-id="2c018-123">Les rapports non remise incluent le message d’origine en tant que pièce jointe pour permettre au destinataire du rapport de renvoyer le message au cas où tout blocage de la remise ne serait plus un problème.</span><span class="sxs-lookup"><span data-stu-id="2c018-123">Nondelivery reports include the original message as an attachment to enable the report's recipient to resend the message in case whatever blocked the delivery is no longer a problem.</span></span> <span data-ttu-id="2c018-124">Le message joint ressemble à l’original tel qu’il existait lorsque la méthode [IMessage::SubmitMessage](imessage-submitmessage.md) a été appelée pour l’envoyer initialement.</span><span class="sxs-lookup"><span data-stu-id="2c018-124">The attached message resembles the original as it existed when the [IMessage::SubmitMessage](imessage-submitmessage.md) method was called to send it initially.</span></span> 
  
<span data-ttu-id="2c018-125">Un ou plusieurs rapports d’état de remise sont générés par les fournisseurs de transport lorsqu’ils appellent la méthode [IMAPISupport::StatusRecips.](imapisupport-statusrecips.md)</span><span class="sxs-lookup"><span data-stu-id="2c018-125">One or more delivery status reports are generated by transport providers when they call the [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) method.</span></span> <span data-ttu-id="2c018-126">Les fournisseurs de transport composent une liste de destinataires pour un message.</span><span class="sxs-lookup"><span data-stu-id="2c018-126">Transport providers compose a list of recipients for a message.</span></span> <span data-ttu-id="2c018-127">Le fait qu’un destinataire reçoit ou non un rapport et le type de rapport généré dépend des données suivantes :</span><span class="sxs-lookup"><span data-stu-id="2c018-127">Whether or not a recipient receives a report and the type of report that is generated depends on the following:</span></span> 
  
- <span data-ttu-id="2c018-128">Les rapports de remise sont envoyés aux destinataires qui définissent la propriété **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) sur TRUE avant que le message ne soit placé dans la magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="2c018-128">Delivery reports go to recipients that set the **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) property to TRUE before the message was placed in the message store.</span></span>
    
- <span data-ttu-id="2c018-129">Les rapports non remis sont remis aux destinataires qui n’ont pas PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED **(** [PidTagOriginatorNonDeliveryReportRequested](pidtagoriginatornondeliveryreportrequested-canonical-property.md)) sur FALSE.</span><span class="sxs-lookup"><span data-stu-id="2c018-129">Nondelivery reports go to recipients that did not set the **PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorNonDeliveryReportRequested](pidtagoriginatornondeliveryreportrequested-canonical-property.md)) property to FALSE.</span></span> 
    
<span data-ttu-id="2c018-130">Presque toutes les informations nécessaires à l’affichage d’un rapport de non-destinataire sont contenues dans la table des destinataires du message joint.</span><span class="sxs-lookup"><span data-stu-id="2c018-130">Almost all of the information necessary to display a nondelivery report is contained in the recipient table of the attached message.</span></span> <span data-ttu-id="2c018-131">Quelques propriétés sont du rapport lui-même.</span><span class="sxs-lookup"><span data-stu-id="2c018-131">A few properties are from the report itself.</span></span> <span data-ttu-id="2c018-132">Pour les rapports de remise, les informations nécessaires sont contenues dans la table des destinataires du rapport et dans quelques propriétés de rapport.</span><span class="sxs-lookup"><span data-stu-id="2c018-132">For delivery reports, the necessary information is contained in the recipient table of the report and in a few report properties.</span></span> 
  
<span data-ttu-id="2c018-133">Les rapports sont des messages avec des classes de message distinctes, en fonction de la classe du message envoyé.</span><span class="sxs-lookup"><span data-stu-id="2c018-133">Reports are messages with distinct message classes, based on the class of the sent message.</span></span> <span data-ttu-id="2c018-134">La plupart des fournisseurs de services utilisent une convention d’attribution de noms selon laquelle la classe de message est composée de plusieurs parties séparées par des périodes.</span><span class="sxs-lookup"><span data-stu-id="2c018-134">Most service providers use a naming convention whereby the message class is composed of several parts separated by periods.</span></span> <span data-ttu-id="2c018-135">La première partie est « Report » et la dernière est une constante qui représente le type de rapport.</span><span class="sxs-lookup"><span data-stu-id="2c018-135">The first part is "Report" and the last part is a constant that represents the report type.</span></span> <span data-ttu-id="2c018-136">La partie intermédiaire est réservée à la classe du message envoyé.</span><span class="sxs-lookup"><span data-stu-id="2c018-136">The middle part is reserved for the class of the sent message.</span></span> <span data-ttu-id="2c018-137">Par exemple, comme un rapport de remise utilise la constante DR, la classe de message pour un rapport de remise sur un IPM. Le message de note serait **Report.IPM.Note.DR**.</span><span class="sxs-lookup"><span data-stu-id="2c018-137">For example, because a delivery report uses the constant DR, the message class for a delivery report about an IPM.Note message would be **Report.IPM.Note.DR**.</span></span>
  
<span data-ttu-id="2c018-138">Le tableau suivant indique les constantes qui représentent les types de rapports.</span><span class="sxs-lookup"><span data-stu-id="2c018-138">The following table shows the constants that represent the types of reports.</span></span>
  
|<span data-ttu-id="2c018-139">**Type de rapport**</span><span class="sxs-lookup"><span data-stu-id="2c018-139">**Report type**</span></span>|<span data-ttu-id="2c018-140">**Constante utilisée dans la classe de message**</span><span class="sxs-lookup"><span data-stu-id="2c018-140">**Constant used in message class**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2c018-141">Lire</span><span class="sxs-lookup"><span data-stu-id="2c018-141">Read</span></span>  <br/> |<span data-ttu-id="2c018-142">IPNRN</span><span class="sxs-lookup"><span data-stu-id="2c018-142">IPNRN</span></span>  <br/> |
|<span data-ttu-id="2c018-143">Non lu</span><span class="sxs-lookup"><span data-stu-id="2c018-143">Nonread</span></span>  <br/> |<span data-ttu-id="2c018-144">IPNNRN</span><span class="sxs-lookup"><span data-stu-id="2c018-144">IPNNRN</span></span>  <br/> |
|<span data-ttu-id="2c018-145">Remise</span><span class="sxs-lookup"><span data-stu-id="2c018-145">Delivery</span></span>  <br/> |<span data-ttu-id="2c018-146">DR</span><span class="sxs-lookup"><span data-stu-id="2c018-146">DR</span></span>  <br/> |
|<span data-ttu-id="2c018-147">Nondelivery</span><span class="sxs-lookup"><span data-stu-id="2c018-147">Nondelivery</span></span>  <br/> |<span data-ttu-id="2c018-148">NDR</span><span class="sxs-lookup"><span data-stu-id="2c018-148">NDR</span></span>  <br/> |
   
<span data-ttu-id="2c018-149">Les clients interactifs peuvent afficher des messages de rapport à l’aide de formulaires standard fournis par MAPI ou de formulaires personnalisés qui ont été enregistrés auprès du gestionnaire de formulaires pour la classe de message de l’état.</span><span class="sxs-lookup"><span data-stu-id="2c018-149">Interactive clients can display report messages by using standard forms provided by MAPI, or custom forms that have been registered with the form manager for the report's message class.</span></span> <span data-ttu-id="2c018-150">Clients qui reçoivent un rapport de non-delivery pour un IPM. Le message de note, par exemple, peut afficher le formulaire MAPI standard qui présente la liste des destinataires en échec et une suggestion de motif de l’échec.</span><span class="sxs-lookup"><span data-stu-id="2c018-150">Clients that receive a nondelivery report for an IPM.Note message, for example, can display the standard MAPI form that presents a list of the failed recipients and a suggested reason for the failure.</span></span> <span data-ttu-id="2c018-151">Le formulaire permet également à l’utilisateur de renvoyer le message, si vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="2c018-151">The form also enables the user to resend the message, if desired.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2c018-152">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2c018-152">See also</span></span>



[<span data-ttu-id="2c018-153">MAPI Messages</span><span class="sxs-lookup"><span data-stu-id="2c018-153">MAPI Messages</span></span>](mapi-messages.md)

