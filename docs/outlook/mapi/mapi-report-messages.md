---
title: Messages de rapport MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 824eb670-16b7-49bf-9992-39fe0586a552
description: Dernière modification le 09 mars 2015
ms.openlocfilehash: a56223e909edf89d0f7fe2ba7f6d281509002429
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22563680"
---
# <a name="mapi-report-messages"></a><span data-ttu-id="e49d5-103">Messages de rapport MAPI</span><span class="sxs-lookup"><span data-stu-id="e49d5-103">MAPI Report Messages</span></span>

  
  
<span data-ttu-id="e49d5-104">**S’applique à**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e49d5-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e49d5-105">Signaler des messages présenter l’état des informations sur un message à l’expéditeur.</span><span class="sxs-lookup"><span data-stu-id="e49d5-105">Report messages present status information about a message to its sender.</span></span>
  
<span data-ttu-id="e49d5-106">Il existe deux types généraux de messages de rapport :</span><span class="sxs-lookup"><span data-stu-id="e49d5-106">There are two general types of report messages:</span></span>
  
- <span data-ttu-id="e49d5-107">Lisez les rapports d’état.</span><span class="sxs-lookup"><span data-stu-id="e49d5-107">Read status reports.</span></span>
    
- <span data-ttu-id="e49d5-108">Rapports d’état de remise.</span><span class="sxs-lookup"><span data-stu-id="e49d5-108">Delivery status reports.</span></span>
    
## <a name="read-status-reports"></a><span data-ttu-id="e49d5-109">Rapports d’état en lecture</span><span class="sxs-lookup"><span data-stu-id="e49d5-109">Read Status Reports</span></span>

<span data-ttu-id="e49d5-110">Rapports d’état en lecture sont initiées par les fournisseurs de banque de messages via un appel à la méthode [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) et sont envoyées au destinataire représenté par l’identificateur d’entrée dans le **PR_REPORT_ENTRYID** ([PidTagReportEntryId](pidtagreportentryid-canonical-property.md)) propriété.</span><span class="sxs-lookup"><span data-stu-id="e49d5-110">Read status reports are initiated by message store providers through a call to the [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) method and are sent to the recipient represented by the entry identifier in the **PR_REPORT_ENTRYID** ([PidTagReportEntryId](pidtagreportentryid-canonical-property.md)) property.</span></span> <span data-ttu-id="e49d5-111">Rapports d’état en lecture ne sont pas générés automatiquement ; les applications clientes qui doivent recevoir les doivent demander explicitement les.</span><span class="sxs-lookup"><span data-stu-id="e49d5-111">Read status reports are not generated automatically; client applications that want to receive them must explicitly request them.</span></span>
  
<span data-ttu-id="e49d5-112">Un rapport de lecture indique que l’indicateur de lecture d’un message a été définie, qui peut se produire lorsque le message est ouvert, imprimer, déplacé ou copié.</span><span class="sxs-lookup"><span data-stu-id="e49d5-112">A read report indicates that the read flag of a message has been set, which can occur when the message is opened, printed, moved, or copied.</span></span> <span data-ttu-id="e49d5-113">Si un fournisseur de magasins message génère un rapport de lecture en réponse à un déplacement ou opération de copie dépend où le message est sur le point.</span><span class="sxs-lookup"><span data-stu-id="e49d5-113">Whether or not a message store provider generates a read report in response to a move or copy operation depends on where the message is going.</span></span> <span data-ttu-id="e49d5-114">S’il est en cours déplacé ou copié dans une autre banque de messages, un sera rapport lecture certainement toujours envoyés.</span><span class="sxs-lookup"><span data-stu-id="e49d5-114">If it is being moved or copied to another message store, a read report will most likely always be sent.</span></span> <span data-ttu-id="e49d5-115">S’il est déplacé ou copié dans le magasin de message en cours, un rapport de lecture peut-être ou la ne peut pas être envoyé.</span><span class="sxs-lookup"><span data-stu-id="e49d5-115">If it is being moved or copied in the current message store, a read report might or might not be sent.</span></span> 
  
<span data-ttu-id="e49d5-116">Un rapport nonread indique que l’indicateur de lecture d’un message n’est pas défini et que le message a été ouvert pas avant d’être placé dans le dossier éléments supprimés ou avant l’expiration d’un délai.</span><span class="sxs-lookup"><span data-stu-id="e49d5-116">A nonread report indicates that the read flag of a message is not set and that the message was not opened either before being placed in the Deleted Items folder or before the expiration of a time limit.</span></span> <span data-ttu-id="e49d5-117">Les clients peuvent appeler la méthode [IMessage::SetReadFlag](imessage-setreadflag.md) ou [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) pour définir ou effacer l’indicateur de lecture d’un message.</span><span class="sxs-lookup"><span data-stu-id="e49d5-117">Clients can call the [IMessage::SetReadFlag](imessage-setreadflag.md) or [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) method to set or clear a message's read flag.</span></span> 
  
## <a name="delivery-status-reports"></a><span data-ttu-id="e49d5-118">Rapports d’état de remise</span><span class="sxs-lookup"><span data-stu-id="e49d5-118">Delivery Status Reports</span></span>

<span data-ttu-id="e49d5-119">État de remise est reflétée dans un rapport de remise, qui est envoyé lorsqu’un message atteint son destinataire, et dans un rapport de non-remise, qui est envoyé lorsqu’un message n’a pas pu atteindre un destinataire.</span><span class="sxs-lookup"><span data-stu-id="e49d5-119">Delivery status is reflected in a delivery report, which is sent when a message has reached its intended recipient, and in a nondelivery report, which is sent when a message could not reach a recipient.</span></span> <span data-ttu-id="e49d5-120">Rapports d’état de remise sont envoyés au destinataire représentée par l’identificateur d’entrée dans la propriété **PR_REPORT_ENTRYID** ou à l’expéditeur si cette propriété n’est pas présente.</span><span class="sxs-lookup"><span data-stu-id="e49d5-120">Delivery status reports are sent to the recipient represented by the entry identifier in the **PR_REPORT_ENTRYID** property or to the sender if this property is not present.</span></span> 
  
<span data-ttu-id="e49d5-121">Rapports de remise sont envoyés par demande uniquement et ne pas incluent le message d’origine.</span><span class="sxs-lookup"><span data-stu-id="e49d5-121">Delivery reports are sent by request only and do not include the original message.</span></span> <span data-ttu-id="e49d5-122">Rapports de non-remise sont envoyées automatiquement, sauf si une demande est effectuée pour les supprimer.</span><span class="sxs-lookup"><span data-stu-id="e49d5-122">Nondelivery reports are sent automatically unless a request is made to suppress them.</span></span> <span data-ttu-id="e49d5-123">Rapports de non-remise incluent le message d’origine en tant que pièce jointe à activer le destinataire de l’état de renvoyer le message en cas de quelle que soit bloqué la remise n’est plus un problème.</span><span class="sxs-lookup"><span data-stu-id="e49d5-123">Nondelivery reports include the original message as an attachment to enable the report's recipient to resend the message in case whatever blocked the delivery is no longer a problem.</span></span> <span data-ttu-id="e49d5-124">Le message joint ressemble à l’original tel qu’il existait lorsque la méthode [IMessage::SubmitMessage](imessage-submitmessage.md) a été appelée pour l’envoyer à l’origine.</span><span class="sxs-lookup"><span data-stu-id="e49d5-124">The attached message resembles the original as it existed when the [IMessage::SubmitMessage](imessage-submitmessage.md) method was called to send it initially.</span></span> 
  
<span data-ttu-id="e49d5-125">Un ou plusieurs rapports d’état de remise sont générées par des fournisseurs de transport quand ils appellent la méthode [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) .</span><span class="sxs-lookup"><span data-stu-id="e49d5-125">One or more delivery status reports are generated by transport providers when they call the [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) method.</span></span> <span data-ttu-id="e49d5-126">Fournisseurs de transport de composer une liste de destinataires pour un message.</span><span class="sxs-lookup"><span data-stu-id="e49d5-126">Transport providers compose a list of recipients for a message.</span></span> <span data-ttu-id="e49d5-127">Si un destinataire reçoit un rapport et le type de rapport est généré dépend des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="e49d5-127">Whether or not a recipient receives a report and the type of report that is generated depends on the following:</span></span> 
  
- <span data-ttu-id="e49d5-128">Rapports de remise accédez aux destinataires que vous définissez la propriété **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) sur TRUE avant que le message a été placé dans la banque de messages.</span><span class="sxs-lookup"><span data-stu-id="e49d5-128">Delivery reports go to recipients that set the **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) property to TRUE before the message was placed in the message store.</span></span>
    
- <span data-ttu-id="e49d5-129">Rapports de non-remise accédez aux destinataires qui n’a pas défini la propriété **PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorNonDeliveryReportRequested](pidtagoriginatornondeliveryreportrequested-canonical-property.md)) à FALSE.</span><span class="sxs-lookup"><span data-stu-id="e49d5-129">Nondelivery reports go to recipients that did not set the **PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorNonDeliveryReportRequested](pidtagoriginatornondeliveryreportrequested-canonical-property.md)) property to FALSE.</span></span> 
    
<span data-ttu-id="e49d5-130">Presque toutes les informations nécessaires pour afficher un rapport de non-remise est contenue dans la table de destinataires du message attaché.</span><span class="sxs-lookup"><span data-stu-id="e49d5-130">Almost all of the information necessary to display a nondelivery report is contained in the recipient table of the attached message.</span></span> <span data-ttu-id="e49d5-131">Certaines propriétés sont à partir de l’état.</span><span class="sxs-lookup"><span data-stu-id="e49d5-131">A few properties are from the report itself.</span></span> <span data-ttu-id="e49d5-132">Pour les rapports de remise, les informations nécessaires sont contenues dans la table de destinataires de l’état et dans certaines propriétés du rapport.</span><span class="sxs-lookup"><span data-stu-id="e49d5-132">For delivery reports, the necessary information is contained in the recipient table of the report and in a few report properties.</span></span> 
  
<span data-ttu-id="e49d5-133">Les rapports sont des messages avec les classes de message distincts, en fonction de la classe du message envoyé.</span><span class="sxs-lookup"><span data-stu-id="e49d5-133">Reports are messages with distinct message classes, based on the class of the sent message.</span></span> <span data-ttu-id="e49d5-134">La plupart des fournisseurs de services utilisent une convention d’affectation de noms grâce à laquelle la classe de message est composée de plusieurs composants séparés par des virgules.</span><span class="sxs-lookup"><span data-stu-id="e49d5-134">Most service providers use a naming convention whereby the message class is composed of several parts separated by periods.</span></span> <span data-ttu-id="e49d5-135">La première partie est « Report » et la dernière partie est une constante représentant le type de rapport.</span><span class="sxs-lookup"><span data-stu-id="e49d5-135">The first part is "Report" and the last part is a constant that represents the report type.</span></span> <span data-ttu-id="e49d5-136">La partie centrale est réservée pour la classe du message envoyé.</span><span class="sxs-lookup"><span data-stu-id="e49d5-136">The middle part is reserved for the class of the sent message.</span></span> <span data-ttu-id="e49d5-137">Par exemple, comme un rapport de remise utilise la constante reprise après sinistre, la classe de message pour une remise de rapports sur un IPM. Message de Remarque serait **Report.IPM.Note.DR**.</span><span class="sxs-lookup"><span data-stu-id="e49d5-137">For example, because a delivery report uses the constant DR, the message class for a delivery report about an IPM.Note message would be **Report.IPM.Note.DR**.</span></span>
  
<span data-ttu-id="e49d5-138">Le tableau suivant présente l’une des constantes qui représentent les types de rapports.</span><span class="sxs-lookup"><span data-stu-id="e49d5-138">The following table shows the constants that represent the types of reports.</span></span>
  
|<span data-ttu-id="e49d5-139">**Type de rapport**</span><span class="sxs-lookup"><span data-stu-id="e49d5-139">**Report type**</span></span>|<span data-ttu-id="e49d5-140">**Constante utilisée dans la classe de message**</span><span class="sxs-lookup"><span data-stu-id="e49d5-140">**Constant used in message class**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e49d5-141">Read</span><span class="sxs-lookup"><span data-stu-id="e49d5-141">Read</span></span>  <br/> |<span data-ttu-id="e49d5-142">IPNRN</span><span class="sxs-lookup"><span data-stu-id="e49d5-142">IPNRN</span></span>  <br/> |
|<span data-ttu-id="e49d5-143">Suppression du mode lecture</span><span class="sxs-lookup"><span data-stu-id="e49d5-143">Nonread</span></span>  <br/> |<span data-ttu-id="e49d5-144">IPNNRN</span><span class="sxs-lookup"><span data-stu-id="e49d5-144">IPNNRN</span></span>  <br/> |
|<span data-ttu-id="e49d5-145">Remise</span><span class="sxs-lookup"><span data-stu-id="e49d5-145">Delivery</span></span>  <br/> |<span data-ttu-id="e49d5-146">REPRISE APRÈS SINISTRE</span><span class="sxs-lookup"><span data-stu-id="e49d5-146">DR</span></span>  <br/> |
|<span data-ttu-id="e49d5-147">Non-remise</span><span class="sxs-lookup"><span data-stu-id="e49d5-147">Nondelivery</span></span>  <br/> |<span data-ttu-id="e49d5-148">Notification d’échec de remise</span><span class="sxs-lookup"><span data-stu-id="e49d5-148">NDR</span></span>  <br/> |
   
<span data-ttu-id="e49d5-149">Clients interactives peuvent afficher des messages d’état à l’aide de formulaires standards fournis par MAPI, ou des formulaires personnalisés qui ont été enregistrés avec le Gestionnaire de formulaire pour la classe de message de l’état.</span><span class="sxs-lookup"><span data-stu-id="e49d5-149">Interactive clients can display report messages by using standard forms provided by MAPI, or custom forms that have been registered with the form manager for the report's message class.</span></span> <span data-ttu-id="e49d5-150">Clients qui reçoivent un rapport de non-remise pour un IPM. Message de Remarque, peut, par exemple, afficher le formulaire MAPI standard qui affiche une liste de destinataires ayant échoués et un motif suggéré pour l’échec.</span><span class="sxs-lookup"><span data-stu-id="e49d5-150">Clients that receive a nondelivery report for an IPM.Note message, for example, can display the standard MAPI form that presents a list of the failed recipients and a suggested reason for the failure.</span></span> <span data-ttu-id="e49d5-151">Le formulaire permet également aux utilisateurs de renvoyer le message, si vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="e49d5-151">The form also enables the user to resend the message, if desired.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e49d5-152">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e49d5-152">See also</span></span>



[<span data-ttu-id="e49d5-153">Messages MAPI</span><span class="sxs-lookup"><span data-stu-id="e49d5-153">MAPI Messages</span></span>](mapi-messages.md)

