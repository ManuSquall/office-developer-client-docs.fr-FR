---
title: Objets de progression MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e446004e-1ef2-4e58-b764-de7b4dcefaf1
description: 'Derni�re modification�: samedi 23 juillet 2011'
ms.openlocfilehash: 3007aeb5ac3810c57ed6fb4a555d5ce22e831768
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19784659"
---
# <a name="mapi-progress-objects"></a><span data-ttu-id="76b93-103">Objets de progression MAPI</span><span class="sxs-lookup"><span data-stu-id="76b93-103">MAPI Progress Objects</span></span>

  
  
<span data-ttu-id="76b93-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="76b93-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="76b93-105">Les méthodes et les données d’un objet de progression, vous pouvez contrôler comment l’indicateur signale la progression.</span><span class="sxs-lookup"><span data-stu-id="76b93-105">With the methods and data of a progress object, you can control how the indicator reports progress.</span></span> <span data-ttu-id="76b93-106">Bien qu’un client ou un MAPI implémente l’objet de l’avancement, la plupart de la charge d’assurer l’exactitude de l’affichage de l’avancement se situe sur les fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="76b93-106">Although a client or MAPI implements the progress object, most of the burden of ensuring the correctness of the progress display falls on service providers.</span></span> <span data-ttu-id="76b93-107">Vous pouvez garantir son exactitude en spécifiant une valeur pour les paramètres qui sont transmises aux méthodes d’objet de progression et un ordre particulier.</span><span class="sxs-lookup"><span data-stu-id="76b93-107">You can guarantee its accuracy by specifying a particular order and value for the parameters that are passed to progress object methods.</span></span>
  
<span data-ttu-id="76b93-108">Les paramètres suivants sont transmis aux objets cours :</span><span class="sxs-lookup"><span data-stu-id="76b93-108">The following parameters are passed to progress objects:</span></span>
  
- <span data-ttu-id="76b93-109">Un masque de bits d’indicateurs, définie avec [IMAPIProgress::SetLimits](imapiprogress-setlimits.md) et récupérés par [IMAPIProgress::GetFlags](imapiprogress-getflags.md).</span><span class="sxs-lookup"><span data-stu-id="76b93-109">A bitmask of flags, set with [IMAPIProgress::SetLimits](imapiprogress-setlimits.md) and retrieved with [IMAPIProgress::GetFlags](imapiprogress-getflags.md).</span></span>
    
- <span data-ttu-id="76b93-110">Valeur minimale (locale et globale), définie avec **SetLimits** et récupérés par [IMAPIProgress::GetMin](imapiprogress-getmin.md).</span><span class="sxs-lookup"><span data-stu-id="76b93-110">A minimum value (local and global), set with **SetLimits** and retrieved with [IMAPIProgress::GetMin](imapiprogress-getmin.md).</span></span>
    
- <span data-ttu-id="76b93-111">Une valeur maximale (locale et globale), définie avec **SetLimits** et récupérés par [IMAPIProgress::GetMax](imapiprogress-getmax.md).</span><span class="sxs-lookup"><span data-stu-id="76b93-111">A maximum value (local and global), set with **SetLimits** and retrieved with [IMAPIProgress::GetMax](imapiprogress-getmax.md).</span></span>
    
- <span data-ttu-id="76b93-112">Une valeur qui indique le pourcentage d’achèvement de l’opération, transmis à [IMAPIProgress::Progress](imapiprogress-progress.md).</span><span class="sxs-lookup"><span data-stu-id="76b93-112">A value that indicates the current percentage of completion of the operation, passed to [IMAPIProgress::Progress](imapiprogress-progress.md).</span></span>
    
- <span data-ttu-id="76b93-113">Le nombre d’objets qui ont été jusqu'à présent traités, transmises à la **progression**.</span><span class="sxs-lookup"><span data-stu-id="76b93-113">A count of the number of objects that have so far been processed, passed to **Progress**.</span></span>
    
- <span data-ttu-id="76b93-114">Un nombre au nombre total d’objets impliqués dans l’opération, transmise à **l’avancement**.</span><span class="sxs-lookup"><span data-stu-id="76b93-114">A count of the total number of objects involved in the operation, passed to **Progress**.</span></span>
    
<span data-ttu-id="76b93-115">Tous les fournisseurs de services commencent leur affichage en cours de traitement par un appel à **IMAPIProgress::GetFlags** pour récupérer les indicateurs présent définition.</span><span class="sxs-lookup"><span data-stu-id="76b93-115">All service providers begin their progress display processing with a call to **IMAPIProgress::GetFlags** to retrieve the present flags setting.</span></span> <span data-ttu-id="76b93-116">Actuellement, les indicateurs peuvent être définies qu’avec MAPI_TOP_LEVEL.</span><span class="sxs-lookup"><span data-stu-id="76b93-116">Currently, the flags can be set only to MAPI_TOP_LEVEL.</span></span> <span data-ttu-id="76b93-117">Clients et MAPI initialiser l’indicateur MAPI_TOP_LEVEL, compter sur les fournisseurs de services pour la désactiver le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="76b93-117">Clients and MAPI initialize the flag to MAPI_TOP_LEVEL, relying on service providers to clear it when appropriate.</span></span> 
  
<span data-ttu-id="76b93-118">La valeur flags est définie à MAPI_TOP_LEVEL lorsque vous travaillez avec l’objet de niveau supérieur dans l’opération.</span><span class="sxs-lookup"><span data-stu-id="76b93-118">The flags value is set to MAPI_TOP_LEVEL while you are working with the top-level object in the operation.</span></span> <span data-ttu-id="76b93-119">L’objet de niveau supérieur est l’objet qui est appelée par le client pour commencer une opération.</span><span class="sxs-lookup"><span data-stu-id="76b93-119">The top-level object is the object that is called by the client to begin an operation.</span></span> <span data-ttu-id="76b93-120">Dans une opération de copie de dossier, c’est le dossier en cours de copie.</span><span class="sxs-lookup"><span data-stu-id="76b93-120">In a folder copy operation, this is the folder being copied.</span></span> <span data-ttu-id="76b93-121">Dans une opération de suppression de dossier, c’est le dossier en cours de suppression.</span><span class="sxs-lookup"><span data-stu-id="76b93-121">In a folder delete operation, this is the folder being deleted.</span></span> <span data-ttu-id="76b93-122">Lorsque vous effectuez un appel à un objet de niveau inférieur de processus ou sous-objet, désactivez la valeur flags.</span><span class="sxs-lookup"><span data-stu-id="76b93-122">When you make a call to process a lower level object, or subobject, clear the flags value.</span></span> <span data-ttu-id="76b93-123">Dans une opération de copie de dossier, sous-objets sont les sous-dossiers qui se trouvent dans le dossier en cours de copie.</span><span class="sxs-lookup"><span data-stu-id="76b93-123">In a folder copy operation, subobjects are the subfolders that are in the folder being copied.</span></span> 
  
<span data-ttu-id="76b93-124">MAPI vous permet de faire la distinction entre les objets de niveau supérieur et sous-objets avec l’indicateur MAPI_TOP_LEVEL afin que tous les objets impliquant dans une opération peuvent utiliser la même implémentation [IMAPIProgress](imapiprogressiunknown.md) pour afficher la progression, ce qui provoque l’affichage de l’indicateur pour passez comme prévu dans un seul sens positif.</span><span class="sxs-lookup"><span data-stu-id="76b93-124">MAPI allows you to differentiate between top-level objects and subobjects with the MAPI_TOP_LEVEL flag so that all objects involved in an operation can use the same [IMAPIProgress](imapiprogressiunknown.md) implementation to show progress, thereby causing the indicator display to proceed smoothly in a single positive direction.</span></span> <span data-ttu-id="76b93-125">Si l’indicateur MAPI_TOP_LEVEL est défini affecte les paramètres des autres paramètres dans les appels suivants à l’objet de progression.</span><span class="sxs-lookup"><span data-stu-id="76b93-125">Whether or not the MAPI_TOP_LEVEL flag is set affects the settings of the other parameters in subsequent calls to the progress object.</span></span> 
  
<span data-ttu-id="76b93-126">Car il peut être important de définir des valeurs de paramètre appropriée pour un affichage en cours à tous les niveaux d’une opération à plusieurs niveaux, certains fournisseurs de services de choisir de ne pas afficher la progression de sous-objets.</span><span class="sxs-lookup"><span data-stu-id="76b93-126">Because it can be nontrivial to set appropriate parameter values for a progress display at all levels of a multilevel operation, some service providers elect not to show progress for subobjects.</span></span> 
  
 <span data-ttu-id="76b93-127">**Pour éviter d’afficher la progression de sous-objets**</span><span class="sxs-lookup"><span data-stu-id="76b93-127">**To avoid showing progress for subobjects**</span></span>
  
- <span data-ttu-id="76b93-128">Passez la valeur NULL pour le paramètre _lpProgress_ dans l’appel à traiter un sous-objet.</span><span class="sxs-lookup"><span data-stu-id="76b93-128">Pass NULL for the  _lpProgress_ parameter in the call to process a subobject.</span></span> <span data-ttu-id="76b93-129">Par exemple, si vous copiez les dossiers, il s’agit de l’appel de méthode [d’IMAPIFolder::CopyFolder](imapifolder-copyfolder.md) d’un sous-dossier.</span><span class="sxs-lookup"><span data-stu-id="76b93-129">For example, if you are copying folders, this is the call to a subfolder's [IMAPIFolder::CopyFolder](imapifolder-copyfolder.md) method.</span></span> 
    
- <span data-ttu-id="76b93-130">Écrire du code spécial pour déterminer comment interpréter le paramètre _lpProgress_ .</span><span class="sxs-lookup"><span data-stu-id="76b93-130">Write special code to determine how to interpret the  _lpProgress_ parameter.</span></span> <span data-ttu-id="76b93-131">Une valeur NULL pour le paramètre _lpProgress_ peut également signifier que le client doit afficher l’avancement à l’aide de l’implémentation MAPI, code spécial est nécessaire afin de déterminer quand d’ignorer le paramètre _lpProgress_ et appelez [ IMAPISupport::DoProgressDialog](imapisupport-doprogressdialog.md).</span><span class="sxs-lookup"><span data-stu-id="76b93-131">Because a NULL value for the  _lpProgress_ parameter can also mean that the client should display progress by using the MAPI implementation, special code is necessary to determine when to ignore the  _lpProgress_ parameter and when to call [IMAPISupport::DoProgressDialog](imapisupport-doprogressdialog.md).</span></span>
    
<span data-ttu-id="76b93-132">Appelez **IMAPIProgress::SetLimits** pour définir ou effacer l’indicateur MAPI_TOP_LEVEL et définir les valeurs minimales et maximales globales et locales.</span><span class="sxs-lookup"><span data-stu-id="76b93-132">Call **IMAPIProgress::SetLimits** to set or clear the MAPI_TOP_LEVEL flag and to set local and global minimum and maximum values.</span></span> <span data-ttu-id="76b93-133">La valeur des indicateurs de la définition ou non affecte l’objet progression comprend les valeurs minimales et maximales pour être local ou global.</span><span class="sxs-lookup"><span data-stu-id="76b93-133">The value of the flags setting affects whether the progress object understands the minimum and maximum values to be local or global.</span></span> <span data-ttu-id="76b93-134">Lorsque l’indicateur MAPI_TOP_LEVEL est défini, ces valeurs sont considérées comme globales et sont utilisés pour calculer l’avancement pour toute l’opération.</span><span class="sxs-lookup"><span data-stu-id="76b93-134">When the MAPI_TOP_LEVEL flag is set, these values are considered global and are used to calculate progress for the entire operation.</span></span> <span data-ttu-id="76b93-135">Objets de progression initialiser la valeur minimale globale à 0 et la valeur maximale globale et 1000.</span><span class="sxs-lookup"><span data-stu-id="76b93-135">Progress objects initialize the global minimum value to 0 and the global maximum value to 1000.</span></span> 
  
<span data-ttu-id="76b93-136">Lorsque MAPI_TOP_LEVEL n’est pas définie, les valeurs minimales et maximales sont considérés comme étant locales et sont utilisés en interne par les fournisseurs pour afficher la progression de sous-objets de niveau inférieurs.</span><span class="sxs-lookup"><span data-stu-id="76b93-136">When MAPI_TOP_LEVEL is not set, the minimum and maximum values are considered local and are used internally by providers to display progress for lower level subobjects.</span></span> <span data-ttu-id="76b93-137">Objets de progression enregistrement les valeurs minimales et maximales locales uniquement afin qu’ils peuvent être renvoyées à fournisseurs lorsque **GetMin** et **GetMax** sont appelées.</span><span class="sxs-lookup"><span data-stu-id="76b93-137">Progress objects save the local minimum and maximum values only so that they can be returned to providers when **GetMin** and **GetMax** are called.</span></span> 
  
<span data-ttu-id="76b93-138">La valeur, nombre d’objets et paramètres de l’objet total sont d’entrée à la méthode **IMAPIProgress::Progress** .</span><span class="sxs-lookup"><span data-stu-id="76b93-138">The value, object count, and object total parameters are input to the **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="76b93-139">Le paramètre value, un nombre qui indique le pourcentage d’avancement, est requis.</span><span class="sxs-lookup"><span data-stu-id="76b93-139">The value parameter, a number that indicates the percentage of progress, is required.</span></span> <span data-ttu-id="76b93-140">Si l’indicateur MAPI_TOP_LEVEL est défini, vous pouvez également passer un nombre d’objets et un total de l’objet.</span><span class="sxs-lookup"><span data-stu-id="76b93-140">If the MAPI_TOP_LEVEL flag is set, you can also pass an object count and an object total.</span></span> <span data-ttu-id="76b93-141">Certains clients utilisent ces valeurs pour afficher une phrase tel que « 5 éléments terminé sur 10 » avec l’indicateur de progression.</span><span class="sxs-lookup"><span data-stu-id="76b93-141">Some clients use these values to display a phrase such as "5 items completed out of 10" with the progress indicator.</span></span> <span data-ttu-id="76b93-142">Progression d’une opération peut être signalée strictement sous forme de pourcentage ou sous forme de pourcentage et en termes de nombre d’éléments qui ont été traitées en dehors du total à traiter.</span><span class="sxs-lookup"><span data-stu-id="76b93-142">Progress on an operation can be reported strictly as a percentage or as a percentage and in terms of the number of items that have been processed out of the total to be processed.</span></span> <span data-ttu-id="76b93-143">Par exemple, si vous êtes un fournisseur de magasin de message et vous effectuez une opération de copie qui copie les 10 dossiers, l’indicateur de progression peut fournir des informations supplémentaires à l’utilisateur en affichant une phrase tel que « 1 de 10 », « 2 sur 10 », « 3 10 » , et ainsi de suite jusqu'à ce que l’opération est terminée.</span><span class="sxs-lookup"><span data-stu-id="76b93-143">For example, if you are a message store provider and you are performing a copy operation that is copying 10 folders, the progress indicator can supply the user with additional information by displaying a phrase such as "1 of 10", "2 of 10", "3 of 10", and so on until the operation is complete.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="76b93-144">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="76b93-144">See also</span></span>



[<span data-ttu-id="76b93-145">Indicateurs de progression MAPI</span><span class="sxs-lookup"><span data-stu-id="76b93-145">MAPI Progress Indicators</span></span>](mapi-progress-indicators.md)

