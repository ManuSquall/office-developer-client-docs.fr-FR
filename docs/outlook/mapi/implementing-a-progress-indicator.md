---
title: Mise en œuvre d’un indicateur de progression
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: 'Derniére modification : samedi 23 juillet 2011'
ms.openlocfilehash: 6972c960705c336aa6ff96d81b48ccbd490a22ee
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435095"
---
# <a name="implementing-a-progress-indicator"></a><span data-ttu-id="d8c43-103">Mise en œuvre d’un indicateur de progression</span><span class="sxs-lookup"><span data-stu-id="d8c43-103">Implementing a Progress Indicator</span></span>

  
  
<span data-ttu-id="d8c43-104">**S’applique à** : Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d8c43-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d8c43-105">La plupart des opérations initiées par les clients prennent beaucoup de temps.</span><span class="sxs-lookup"><span data-stu-id="d8c43-105">Many of the operations initiated by clients take a significant amount of time.</span></span> <span data-ttu-id="d8c43-106">L’un des paramètres d’entrée de ces opérations potentiellement longues est un pointeur vers un objet de progression , un objet qui implémente l’interface [IMAPIProgress : IUnknown.](imapiprogressiunknown.md)</span><span class="sxs-lookup"><span data-stu-id="d8c43-106">One of the input parameters to these potentially lengthy operations is a pointer to a progress object — an object that implements the [IMAPIProgress : IUnknown](imapiprogressiunknown.md) interface.</span></span> <span data-ttu-id="d8c43-107">Les objets de progression contrôlent l’apparence et l’affichage des indicateurs de progression et sont implémentés par les clients et par MAPI.</span><span class="sxs-lookup"><span data-stu-id="d8c43-107">Progress objects control the appearance and display of progress indicators and are implemented by clients and by MAPI.</span></span> <span data-ttu-id="d8c43-108">Vous pouvez choisir d’implémenter ou non un objet de progression.</span><span class="sxs-lookup"><span data-stu-id="d8c43-108">You can choose whether or not to implement a progress object.</span></span> <span data-ttu-id="d8c43-109">L’implémentation MAPI est disponible pour les fournisseurs de services à utiliser si vous ne souhaitez pas fournir d’implémentation.</span><span class="sxs-lookup"><span data-stu-id="d8c43-109">The MAPI implementation is available for service providers to use if you elect not to supply an implementation.</span></span> 
  
<span data-ttu-id="d8c43-110">Les objets de progression fonctionnent avec les éléments de données suivants :</span><span class="sxs-lookup"><span data-stu-id="d8c43-110">Progress objects work with the following pieces of data:</span></span>
  
- <span data-ttu-id="d8c43-111">Valeur minimale globale qui, lorsque votre méthode [IMAPIProgress::P rogress](imapiprogress-progress.md) est appelée, doit être inférieure ou égale à la valeur du paramètre _ulValue._</span><span class="sxs-lookup"><span data-stu-id="d8c43-111">A global minimum value which, when your [IMAPIProgress::Progress](imapiprogress-progress.md) method is called, should be less than or equal to the value of the  _ulValue_ parameter.</span></span> <span data-ttu-id="d8c43-112">Au début de l’opération,  _ulValue_ sera égal à cette valeur minimale.</span><span class="sxs-lookup"><span data-stu-id="d8c43-112">At the beginning of the operation,  _ulValue_ will be equal to this minimum value.</span></span> 
    
- <span data-ttu-id="d8c43-113">Valeur maximale globale qui, lorsque votre méthode **IMAPIProgress::P rogress** est appelée, doit être supérieure ou égale au paramètre _ulValue._</span><span class="sxs-lookup"><span data-stu-id="d8c43-113">A global maximum value which, when your **IMAPIProgress::Progress** method is called, should be greater than or equal to the  _ulValue_ parameter.</span></span> <span data-ttu-id="d8c43-114">À la fin de l’opération,  _ulValue_ sera égal à cette valeur maximale.</span><span class="sxs-lookup"><span data-stu-id="d8c43-114">At the end of the operation,  _ulValue_ will be equal to this maximum value.</span></span> 
    
- <span data-ttu-id="d8c43-115">Valeur d’indicateur qui indique si la progression correspond à un élément de niveau supérieur ou inférieur.</span><span class="sxs-lookup"><span data-stu-id="d8c43-115">A flags value which indicates whether the progress corresponds to a top or lower level item.</span></span>
    
- <span data-ttu-id="d8c43-116">Valeur qui indique le niveau de progression actuel de l’opération.</span><span class="sxs-lookup"><span data-stu-id="d8c43-116">A value that indicates the current level of progress for the operation.</span></span>
    
- <span data-ttu-id="d8c43-117">Nombre d’éléments actuellement traitées par rapport au total.</span><span class="sxs-lookup"><span data-stu-id="d8c43-117">The number of the currently processed items relative to the total.</span></span>
    
- <span data-ttu-id="d8c43-118">Nombre total d’éléments à traiter pendant l’opération.</span><span class="sxs-lookup"><span data-stu-id="d8c43-118">The total number of items to be processed during the operation.</span></span>
    
<span data-ttu-id="d8c43-119">Les valeurs minimale et maximale représentent le début et la fin de l’opération sous forme numérique.</span><span class="sxs-lookup"><span data-stu-id="d8c43-119">The minimum and maximum values represent the beginning and end of the operation in numeric form.</span></span> <span data-ttu-id="d8c43-120">Utilisez 1 pour la valeur minimale initiale et 1 000 pour la valeur maximale initiale, en passant ces valeurs aux fournisseurs de services dans les méthodes [IMAPIProgress::GetMin](imapiprogress-getmin.md) et [IMAPIProgress::GetMax.](imapiprogress-getmax.md)</span><span class="sxs-lookup"><span data-stu-id="d8c43-120">Use 1 for the initial minimum value and 1000 for the initial maximum value, passing these values to service providers in the [IMAPIProgress::GetMin](imapiprogress-getmin.md) and [IMAPIProgress::GetMax](imapiprogress-getmax.md) methods.</span></span> <span data-ttu-id="d8c43-121">Les fournisseurs de services réinitialiseront ces valeurs lorsqu’ils appellent [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span><span class="sxs-lookup"><span data-stu-id="d8c43-121">Service providers reset these values when they call [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span></span> 
  
<span data-ttu-id="d8c43-122">La valeur des indicateurs est utilisée par les fournisseurs de services pour déterminer comment ils doivent définir les autres valeurs.</span><span class="sxs-lookup"><span data-stu-id="d8c43-122">The flags value is used by service providers to determine how they should set the other values.</span></span> <span data-ttu-id="d8c43-123">Initialisez la valeur des indicateurs à MAPI_TOP_LEVEL et renvoyez cette valeur dans votre implémentation de **GetFlags** jusqu’à ce que le fournisseur de services la réinitialise en appelant **SetLimits**.</span><span class="sxs-lookup"><span data-stu-id="d8c43-123">Initialize the flags value to MAPI_TOP_LEVEL and return this value in your implementation of **GetFlags** until the service provider resets it by calling **SetLimits**.</span></span> 
  
<span data-ttu-id="d8c43-124">Dans votre implémentation de la méthode **SetLimits,** enregistrez les copies locales de chacun des paramètres :  _lpulMin_,  _lpulMax_ et  _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="d8c43-124">In your implementation of the **SetLimits** method, save local copies of each of the parameters:  _lpulMin_,  _lpulMax_, and  _lpulFlags_.</span></span> <span data-ttu-id="d8c43-125">Ces valeurs doivent être facilement disponibles lorsqu’un fournisseur de services appelle vos méthodes **GetMin,** **GetMax** ou **GetFlags.**</span><span class="sxs-lookup"><span data-stu-id="d8c43-125">These values should be readily available when a service provider calls your **GetMin**, **GetMax**, or **GetFlags** methods.</span></span> 
  
<span data-ttu-id="d8c43-126">Pour mettre à jour l’affichage de l’indicateur de progression, les fournisseurs de services appellent votre méthode **IMAPIProgress::P rogress.**</span><span class="sxs-lookup"><span data-stu-id="d8c43-126">To update the display of the progress indicator, service providers call your **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="d8c43-127">Il existe trois paramètres pour cette méthode : une valeur, un nombre et un total.</span><span class="sxs-lookup"><span data-stu-id="d8c43-127">There are three parameters to this method: a value, a count, and a total.</span></span> <span data-ttu-id="d8c43-128">Utilisez le premier paramètre,  _ulValue,_ pour afficher l’indicateur de progression.</span><span class="sxs-lookup"><span data-stu-id="d8c43-128">Use the first parameter,  _ulValue_, to display the progress indicator.</span></span> <span data-ttu-id="d8c43-129">Le  _paramètre ulValue_ est l’indicateur de progression et n’est égal à  _ulMin_ global qu’au tout début de l’opération et n’est égal à  _ulMax_ global qu’à la fin de l’opération.</span><span class="sxs-lookup"><span data-stu-id="d8c43-129">The  _ulValue_ parameter is the progress indicator and will be equal to global  _ulMin_ only at the very beginning of the operation and equal to global  _ulMax_ only at the completion of the operation.</span></span> 
  
<span data-ttu-id="d8c43-130">Utilisez les deuxième et troisième paramètres,  _ulCount_ et  _ulTotal,_ si disponibles, pour afficher un message facultatif tel que « 5 éléments terminés sur 10 ».</span><span class="sxs-lookup"><span data-stu-id="d8c43-130">Use the second and third parameters,  _ulCount_ and  _ulTotal_, if available, to display an optional message such as "5 items completed out of 10."</span></span> <span data-ttu-id="d8c43-131">Si les deuxième et troisième paramètres sont définies sur 0, vous pouvez choisir de modifier visuellement ou non l’indicateur de progression.</span><span class="sxs-lookup"><span data-stu-id="d8c43-131">If the second and third parameters are set to 0, you can choose whether or not to visually change the progress indicator.</span></span> <span data-ttu-id="d8c43-132">Certains fournisseurs de services définissent ces paramètres sur zéros pour indiquer qu’ils traitent un sous-objet dont la progression est surveillée par rapport à un objet parent.</span><span class="sxs-lookup"><span data-stu-id="d8c43-132">Some service providers set these parameters to zeroes to indicate that they are processing a subobject whose progress is monitored relative to a parent object.</span></span> <span data-ttu-id="d8c43-133">Dans ce cas, il est logique de modifier l’affichage uniquement lorsque l’objet parent signale la progression.</span><span class="sxs-lookup"><span data-stu-id="d8c43-133">In this situation, it makes sense to change the display only when the parent object reports progress.</span></span> <span data-ttu-id="d8c43-134">Certains fournisseurs de services passent des zéros pour ces paramètres à chaque fois.</span><span class="sxs-lookup"><span data-stu-id="d8c43-134">Some service providers pass zeroes for these parameters every time.</span></span> 
  

