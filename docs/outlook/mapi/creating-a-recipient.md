---
title: Création d’un destinataire
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 'Derni�re modification�: lundi 9 mars 2015'
ms.openlocfilehash: c596cb219cb1096f186e616c05b8372fef3b42a0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19783116"
---
# <a name="creating-a-recipient"></a><span data-ttu-id="c1abe-103">Création d’un destinataire</span><span class="sxs-lookup"><span data-stu-id="c1abe-103">Creating a Recipient</span></span>

  
  
<span data-ttu-id="c1abe-104">**S’applique à**: Outlook</span><span class="sxs-lookup"><span data-stu-id="c1abe-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="c1abe-105">Clients de créer des destinataires lors de l’envoi de messages et lorsqu’ils sont Ajout d’entrées pour les conteneurs de carnet d’adresses modifiable.</span><span class="sxs-lookup"><span data-stu-id="c1abe-105">Clients create recipients when they are addressing messages and when they are adding entries to modifiable address book containers.</span></span> <span data-ttu-id="c1abe-106">MAPI propose trois méthodes pour la création de destinataires :</span><span class="sxs-lookup"><span data-stu-id="c1abe-106">MAPI provides three methods for creating recipients:</span></span>
  
- [<span data-ttu-id="c1abe-107">IAddrBook::CreateOneOff</span><span class="sxs-lookup"><span data-stu-id="c1abe-107">IAddrBook::CreateOneOff</span></span>](iaddrbook-createoneoff.md)
    
- [<span data-ttu-id="c1abe-108">IAddrBook::NewEntry</span><span class="sxs-lookup"><span data-stu-id="c1abe-108">IAddrBook::NewEntry</span></span>](iaddrbook-newentry.md)
    
- [<span data-ttu-id="c1abe-109">IABContainer::CreateEntry</span><span class="sxs-lookup"><span data-stu-id="c1abe-109">IABContainer::CreateEntry</span></span>](iabcontainer-createentry.md)
    
<span data-ttu-id="c1abe-110">Appelez **IAddrBook::CreateOneOff** lorsque vous créez des destinataires à utiliser pour envoyer des messages.</span><span class="sxs-lookup"><span data-stu-id="c1abe-110">Call **IAddrBook::CreateOneOff** when you are creating recipients to be used to address messages.</span></span> <span data-ttu-id="c1abe-111">**CreateOneOff** crée un identificateur d’entrée unique mise en forme spéciale pour être associé à une adresse d’un type particulier.</span><span class="sxs-lookup"><span data-stu-id="c1abe-111">**CreateOneOff** creates a specially formatted one-off entry identifier to be associated with an address of a particular address type.</span></span> <span data-ttu-id="c1abe-112">Pour plus d’informations sur uniques et les identificateurs d’entrée unique, voir [Adresses uniques](one-off-addresses.md) et des [Identificateurs uniques d’entrée](one-off-entry-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="c1abe-112">For more information about one-offs and one-off entry identifiers, see [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span></span>
  
<span data-ttu-id="c1abe-113">Appel **IAddrBook::NewEntry** lorsque vous créez des destinataires à être utilisé pour envoyer des messages ou à ajouter à un conteneur.</span><span class="sxs-lookup"><span data-stu-id="c1abe-113">Call **IAddrBook::NewEntry** when you are creating recipients to be used either to address messages or to add to a container.</span></span> <span data-ttu-id="c1abe-114">**NewEntry** a trois paires de paramètres qui contiennent les identificateurs d’entrée.</span><span class="sxs-lookup"><span data-stu-id="c1abe-114">**NewEntry** has three pairs of parameters that contain entry identifiers.</span></span> <span data-ttu-id="c1abe-115">Ces paramètres sont décrits comme suit :</span><span class="sxs-lookup"><span data-stu-id="c1abe-115">These parameters are described as follows:</span></span> 
  
|<span data-ttu-id="c1abe-116">**Paire de paramètre**</span><span class="sxs-lookup"><span data-stu-id="c1abe-116">**Parameter pair**</span></span>|<span data-ttu-id="c1abe-117">**Description**</span><span class="sxs-lookup"><span data-stu-id="c1abe-117">**Description**</span></span>|
|:-----|:-----|
| <span data-ttu-id="c1abe-118">_cbEidContainer_ et _lpEidContainer_</span><span class="sxs-lookup"><span data-stu-id="c1abe-118">_cbEidContainer_ and  _lpEidContainer_</span></span> <br/> |<span data-ttu-id="c1abe-119">Identificateur d’entrée pour le conteneur dans lequel la nouvelle entrée doit être placée.</span><span class="sxs-lookup"><span data-stu-id="c1abe-119">Entry identifier for the container into which the new entry should be placed.</span></span>  <br/> |
| <span data-ttu-id="c1abe-120">_cbEidNewEntryTpl_ et _lpEidNewEntryTpl_</span><span class="sxs-lookup"><span data-stu-id="c1abe-120">_cbEidNewEntryTpl_ and  _lpEidNewEntryTpl_</span></span> <br/> |<span data-ttu-id="c1abe-121">Identificateur d’entrée pour le modèle à utiliser pour créer la nouvelle entrée.</span><span class="sxs-lookup"><span data-stu-id="c1abe-121">Entry identifier for the template to be used to create the new entry.</span></span>  <br/> |
| <span data-ttu-id="c1abe-122">_lpcbEidNewEntry_ et _lppEidNewEntry_</span><span class="sxs-lookup"><span data-stu-id="c1abe-122">_lpcbEidNewEntry_ and  _lppEidNewEntry_</span></span> <br/> |<span data-ttu-id="c1abe-123">Identificateur d’entrée pour la nouvelle entrée.</span><span class="sxs-lookup"><span data-stu-id="c1abe-123">Entry identifier for the new entry.</span></span>  <br/> |
   
<span data-ttu-id="c1abe-124">Pour créer un destinataire d’un message sortant, définissez _cbEidContainer_ à zéro et _lpEidContainer_ sur NULL.</span><span class="sxs-lookup"><span data-stu-id="c1abe-124">To create a recipient for an outgoing message, set  _cbEidContainer_ to zero and  _lpEidContainer_ to NULL.</span></span> <span data-ttu-id="c1abe-125">**NewEntry** crée un destinataire avec un identificateur d’entrée est conforme au format unique, le même type de destinataire qui est généré par un appel à **IAddrBook::CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="c1abe-125">**NewEntry** creates a recipient with an entry identifier that conforms to the one-off format, the same type of recipient that is produced by a call to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="c1abe-126">Pour créer un destinataire à insérer dans un conteneur particulier, définissez _lpEidContainer_ du conteneur identificateur d’entrée et _cbEidContainer_ pour le nombre d’octets dans l’identificateur d’entrée du conteneur.</span><span class="sxs-lookup"><span data-stu-id="c1abe-126">To create a recipient to be inserted into a particular container, set  _lpEidContainer_ to the container's entry identifier and  _cbEidContainer_ to the number of bytes in the container's entry identifier.</span></span> 
  
<span data-ttu-id="c1abe-127">Pour utiliser un modèle pour créer un destinataire, définissez _lpEidNewEntryTpl_ sur l’identificateur d’entrée du modèle à utiliser et _cbEidNewEntryTpl_ au nombre d’octets dans cet identificateur d’entrée.</span><span class="sxs-lookup"><span data-stu-id="c1abe-127">To use a template to create a recipient, set  _lpEidNewEntryTpl_ to the entry identifier of the template to be used and  _cbEidNewEntryTpl_ to the count of bytes in this entry identifier.</span></span> <span data-ttu-id="c1abe-128">Plus des conteneurs du carnet d’adresses modifiable prend en charge un ou plusieurs modèles pour créer des entrées d’un type particulier.</span><span class="sxs-lookup"><span data-stu-id="c1abe-128">Most modifiable address book containers support one or more templates for creating entries of a particular type.</span></span> <span data-ttu-id="c1abe-129">Modèles uniques sont généralement, mais pas toujours, boîtes de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c1abe-129">One-off templates are typically, but not always, dialog boxes.</span></span> <span data-ttu-id="c1abe-130">Entrer des informations dans le modèle de produit un destinataire dont l’adresse est correctement mis en forme pour le type.</span><span class="sxs-lookup"><span data-stu-id="c1abe-130">Entering information into the template produces a recipient with an address that is correctly formatted for the type.</span></span> 
  
<span data-ttu-id="c1abe-131">Obtenir l’identificateur d’entrée modèle soit :</span><span class="sxs-lookup"><span data-stu-id="c1abe-131">Obtain the template entry identifier from either:</span></span>
  
- <span data-ttu-id="c1abe-132">La colonne **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) dans la table uniques du conteneur, accédé à l’appel de méthode [d’IMAPIProp::OpenProperty](imapiprop-openproperty.md) du conteneur et en spécifiant **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) en tant que la balise de propriété et IID_IMAPITable en tant que l’identificateur d’interface.</span><span class="sxs-lookup"><span data-stu-id="c1abe-132">The **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column in the container's one-off table, accessed by calling the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method and specifying **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span> 
    
- <span data-ttu-id="c1abe-133">Un carnet d’adresses **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) du fournisseur et des propriétés **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) qui contiennent les identificateurs d’entrée pour le fournisseur de messagerie de l’objet utilisateur et modèles de liste de distribution.</span><span class="sxs-lookup"><span data-stu-id="c1abe-133">An address book provider's **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) properties which hold the entry identifiers for the provider's messaging user object and distribution list templates.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="c1abe-134">Ne confondez pas l’identificateur d’entrée d’un nouveau modèle entrée avec un autre type d’identificateur d’entrée appelé un identificateur de modèle.</span><span class="sxs-lookup"><span data-stu-id="c1abe-134">Do not confuse a new entry template's entry identifier with a different type of entry identifier called a template identifier.</span></span> <span data-ttu-id="c1abe-135">Un identificateur de modèle est utilisé par les fournisseurs pour gérer les entrées copiées à partir d’autres fournisseurs ; Il n’est jamais utilisé par les clients et il n’est pas utilisé pour créer de nouvelles entrées.</span><span class="sxs-lookup"><span data-stu-id="c1abe-135">A template identifier is used only by providers to maintain entries copied from other providers; it is never used by clients and it is not used to create new entries.</span></span> 
  
<span data-ttu-id="c1abe-136">Pour permettre à l’utilisateur déterminer le type d’entrée à créer, passez zéro pour _cbEidNewEntryTpl_ et NULL pour _lpEidNewEntryTpl_.</span><span class="sxs-lookup"><span data-stu-id="c1abe-136">To enable the user to determine the type of entry to be created, pass zero for  _cbEidNewEntryTpl_ and NULL for  _lpEidNewEntryTpl_.</span></span> <span data-ttu-id="c1abe-137">Lorsque cela se produit, **NewEntry** affiche une boîte de dialogue commune construite à partir unique table de MAPI, une liste hiérarchique de tous les modèles pris en charge par chaque fournisseur de carnet d’adresses dans le profil.</span><span class="sxs-lookup"><span data-stu-id="c1abe-137">When this occurs, **NewEntry** displays a common dialog box built from MAPI's one-off table — a hierarchical list of all of the templates supported by each address book provider in the profile.</span></span> 
  
<span data-ttu-id="c1abe-138">Lorsqu’un type d’adresse a été déterminé, soit par le biais du paramètre du paramètre _lpEidNewEntryTpl_ ou une sélection par l’utilisateur à partir de l’affichage tableau uniques, **NewEntry** affiche le modèle correspondant à l’aide de son affichage de la table.</span><span class="sxs-lookup"><span data-stu-id="c1abe-138">When an address type has been determined, either through the setting of the  _lpEidNewEntryTpl_ parameter or a selection by the user from the one-off table display, **NewEntry** displays the corresponding template using its display table.</span></span> <span data-ttu-id="c1abe-139">Tous les nouveaux modèles d’entrée prend en charge la propriété **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="c1abe-139">All new entry templates support the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property.</span></span> 
  
<span data-ttu-id="c1abe-140">Pour renvoyer l’identificateur d’entrée de l’entrée créée **NewEntry** , transmettez une adresse valide pour les paramètres _lpcbEidNewEntry_ et _lppEidNewEntry_ .</span><span class="sxs-lookup"><span data-stu-id="c1abe-140">To have **NewEntry** return the entry identifier of the created entry, pass a valid address for the  _lpcbEidNewEntry_ and  _lppEidNewEntry_ parameters.</span></span> <span data-ttu-id="c1abe-141">MAPI place l’identificateur d’entrée à l’adresse vers laquelle pointé _lppEidNewEntry_ et le nombre d’octets du nouvel identificateur d’entrée à l’adresse vers laquelle pointé _lpcbEidNewEntry_.</span><span class="sxs-lookup"><span data-stu-id="c1abe-141">MAPI places the new entry identifier at the address pointed to by  _lppEidNewEntry_ and the byte count of the new entry identifier at the address pointed to by  _lpcbEidNewEntry_.</span></span>
  
<span data-ttu-id="c1abe-142">Appelez [IABContainer::CreateEntry](iabcontainer-createentry.md) pour créer un destinataire et enregistrez-le dans un conteneur de carnet d’adresses particulière.</span><span class="sxs-lookup"><span data-stu-id="c1abe-142">Call [IABContainer::CreateEntry](iabcontainer-createentry.md) to create a recipient and save it into a particular address book container.</span></span> <span data-ttu-id="c1abe-143">Vous pouvez utiliser cette méthode uniquement avec les conteneurs modifiables : conteneurs dont la AB_MODIFIABLE l’indicateur est défini dans leur propriété **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="c1abe-143">You can use this method only with modifiable containers — containers that have the AB_MODIFIABLE flag set in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property.</span></span> <span data-ttu-id="c1abe-144">Fournisseurs de carnet d’adresses avec des conteneurs non modifiables ne prennent pas en charge cette méthode.</span><span class="sxs-lookup"><span data-stu-id="c1abe-144">Address book providers with nonmodifiable containers do not support this method.</span></span> <span data-ttu-id="c1abe-145">Spécifier l’identificateur d’entrée du modèle pour la création d’une entrée du type souhaité dans le paramètre _lpEntryID_ .</span><span class="sxs-lookup"><span data-stu-id="c1abe-145">Specify the entry identifier of the template for creating an entry of the desired type in the  _lpEntryID_ parameter.</span></span> 
  
<span data-ttu-id="c1abe-146">Dans le paramètre _ulCreateFlags_ , spécifiez le type d’entrée en double vérification obligatoire et ou non les nouvelles entrées doivent remplacer existants.</span><span class="sxs-lookup"><span data-stu-id="c1abe-146">In the  _ulCreateFlags_ parameter, specify the type of duplicate entry checking required and whether or not new entries should replace existing ones.</span></span> <span data-ttu-id="c1abe-147">Si **CreateEntry** ne parvient pas à créer un nouvel objet en raison de la vérification de l’entrée en double imposées par le fournisseur, pas vous devriez voir une erreur ou un avertissement renvoyé.</span><span class="sxs-lookup"><span data-stu-id="c1abe-147">If **CreateEntry** fails to create a new object because of the duplicate entry checking imposed by the provider, do not expect to see an error or warning returned.</span></span> <span data-ttu-id="c1abe-148">Dans ces conditions, fournisseurs retournent un code de réussite.</span><span class="sxs-lookup"><span data-stu-id="c1abe-148">Under these conditions, providers return a success code.</span></span> 
  
<span data-ttu-id="c1abe-149">Si vous travaillez directement avec un conteneur et que vous savez exactement les types d’adresses que le conteneur peut créer, vous pouvez appeler **IABContainer::CreateEntry** et transmettre l’identificateur d’entrée pour le modèle approprié.</span><span class="sxs-lookup"><span data-stu-id="c1abe-149">If you are working directly with a container and you know exactly the types of addresses that the container can create, you can call **IABContainer::CreateEntry** and pass the entry identifier for the appropriate template.</span></span> <span data-ttu-id="c1abe-150">Le fournisseur de carnet d’adresses définit certaines propriétés par défaut ; Vous pouvez appeler **SetProps** pour définir d’autres personnes.</span><span class="sxs-lookup"><span data-stu-id="c1abe-150">The address book provider sets some initial default properties; you can call **SetProps** to set others.</span></span> <span data-ttu-id="c1abe-151">L’utilisateur n’est jamais concerné.</span><span class="sxs-lookup"><span data-stu-id="c1abe-151">The user is never involved.</span></span> 
  

