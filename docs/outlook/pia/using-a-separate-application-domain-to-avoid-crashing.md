---
title: Utilisation d’un domaine d’application distinct pour éviter les blocages
TOCTitle: Using a separate application domain to avoid crashing
ms:assetid: 7fc6d1e5-7032-47a9-826f-6b5d3b43fef9
ms:mtpsurl: https://msdn.microsoft.com/library/office/bb623114(v=office.15)
ms:contentKeyID: 55119786
ms.date: 07/24/2014
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e2490c15da9c993a1a26b50adeb38207457f8286
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32285146"
---
# <a name="using-a-separate-application-domain-to-avoid-crashing"></a><span data-ttu-id="d6a5c-102">Utilisation d’un domaine d’application distinct pour éviter les blocages</span><span class="sxs-lookup"><span data-stu-id="d6a5c-102">Using a separate application domain to avoid crashing</span></span>

<span data-ttu-id="d6a5c-p101">Les compléments managés qui implémentent l'interface **IDTExtensibility2** sont chargés dans le même domaine d'application par défaut. En cas d'échec d'un complément dans le domaine d'application, les autres compléments de ce même domaine échouent également.</span><span class="sxs-lookup"><span data-stu-id="d6a5c-p101">Managed add-ins that implement the **IDTExtensibility2** interface are loaded into the same default application domain. When an add-in in the application domain crashes, it can cause other add-ins in the same application domain to fail as well.</span></span>

<span data-ttu-id="d6a5c-p102">Pour contourner ce problème, vous pouvez créer un shim pour le complément de sorte que ce dernier puisse être chargé dans son propre domaine d'application. Un shim est une bibliothèque de liens dynamiques non managés écrite en C++. Lorsque vous utilisez un shim, vous enregistrez le shim à la place du complément. Outlook charge le shim et le shim charge le complément pour lequel il a été créé. Vous devez créer et enregistrer un shim distinct pour chaque complément. Pour plus d'informations sur le développement de shims pour les compléments managés, voir [Isolation des extensions Office avec l'Assistant Shim COM (éventuellement en anglais)](https://go.microsoft.com/fwlink/?linkid=89109).</span><span class="sxs-lookup"><span data-stu-id="d6a5c-p102">To work around this problem, you can create a shim for the add-in, so that the add-in can be loaded in its own application domain. A shim is an unmanaged dynamic link library written in C++. When you use a shim, you register the shim instead of the add-in. Outlook loads the shim, and the shim loads the add-in for which it was built. You must build and register a separate shim for each add-in. For more information about developing shims for managed add-ins, see [Isolating Office Extensions with the COM Shim Wizard](https://go.microsoft.com/fwlink/?linkid=89109).</span></span>

<span data-ttu-id="d6a5c-111">Une autre solution pour charger votre complément dans un domaine d’application distinct est de développer votre complément à l’aide des Outils de développement Office dans Visual Studio 2010 ou une version ultérieure des Outils de développement Office pour Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d6a5c-111">Another alternative to load your add-in into a separate application domain is to develop your add-in using Office development tools in Visual Studio 2010, or a later release of Office Developer Tools for Visual Studio.</span></span> <span data-ttu-id="d6a5c-112">Les compléments développés par ces versions des Outils de développement Office pour Visual Studio n’implémentent pas l’interface IDTExtensibility2, mais utilisent l’interface **IStartup**.</span><span class="sxs-lookup"><span data-stu-id="d6a5c-112">Add-ins developed by these versions of Office Developer Tools for Visual Studio do not implement the IDTExtensibility2 interface but use the **IStartup** interface.</span></span> <span data-ttu-id="d6a5c-113">Ils utilisent un chargeur fourni par Visual Studio, AddinLoader.dll, qui agit comme un shim générique.</span><span class="sxs-lookup"><span data-stu-id="d6a5c-113">They use a loader provided by Visual Studio, AddinLoader.dll, which acts like a generic shim.</span></span> <span data-ttu-id="d6a5c-114">Outlook recherche dans le Registre les compléments créés avec Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d6a5c-114">Outlook looks in the registry for add-ins created with Visual Studio.</span></span> 

<span data-ttu-id="d6a5c-115">Si Outlook trouve ce type de compléments, Outlook lance AddinLoader.dll, qui lance ensuite Visual Studio Tools pour Office Runtime pour lui transmettre le manifeste d’application.</span><span class="sxs-lookup"><span data-stu-id="d6a5c-115">If Outlook finds such add-ins, Outlook starts AddinLoader.dll, which then starts the Visual Studio Tools for Office Runtime and relays the application manifest to the Visual Studio Tools for Office Runtime.</span></span> <span data-ttu-id="d6a5c-116">Visual Studio Tools pour Office Runtime charge ensuite chacun de ces compléments dans un domaine d’application distinct.</span><span class="sxs-lookup"><span data-stu-id="d6a5c-116">The Visual Studio Tools for Office Runtime then loads each such add-in in a separate application domain.</span></span> <span data-ttu-id="d6a5c-117">Pour savoir comment Visual Studio charge un complément, consultez l’article relatif à l’[architecture des compléments d’application](https://msdn.microsoft.com/library/bb386298\(v=office.15\)).</span><span class="sxs-lookup"><span data-stu-id="d6a5c-117">For more information about how Visual Studio loads an add-in, see [Architecture of Application-Level Add-Ins](https://msdn.microsoft.com/library/bb386298\(v=office.15\)).</span></span>

