---
title: Fonctions sécurisées en cluster
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
localization_priority: Normal
ms.assetid: 787badaf-8782-454d-a016-7eae83bbd8a9
description: 'S�applique �: Excel 2013�| Office 2013�| Visual Studio'
ms.openlocfilehash: d32925fcd5c3be7fe3e615ee2290f25c7595911c
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32310975"
---
# <a name="cluster-safe-functions"></a><span data-ttu-id="64b1a-103">Fonctions sécurisées en cluster</span><span class="sxs-lookup"><span data-stu-id="64b1a-103">Cluster safe functions</span></span>

<span data-ttu-id="64b1a-104">**S’applique à**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="64b1a-104">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="64b1a-105">Dans Excel 2013, Excel peut décharger les appels UDF (fonction définie par l'utilisateur) vers un cluster informatique à hautes performances via une interface de connecteur de cluster dédiée.</span><span class="sxs-lookup"><span data-stu-id="64b1a-105">In Excel 2013, Excel can offload User-Defined Function (UDF) calls to a high-performance computing cluster through a dedicated cluster connector interface.</span></span> <span data-ttu-id="64b1a-106">Les fournisseurs de cluster de calcul fournissent des connecteurs de cluster.</span><span class="sxs-lookup"><span data-stu-id="64b1a-106">Compute cluster vendors provide Cluster Connectors.</span></span> <span data-ttu-id="64b1a-107">Les auteurs de fichiers UDF peuvent déclarer les fichiers UDF comme étant sécurisés pour les clusters, puis, lorsqu'un connecteur de cluster est présent, Excel envoie des appels à ces UDF au connecteur de cluster pour le déchargement.</span><span class="sxs-lookup"><span data-stu-id="64b1a-107">UDF authors can declare their UDFs as cluster safe and then, when a cluster connector is present, Excel sends calls to these UDFs to the cluster connector for offloading.</span></span>
  
<span data-ttu-id="64b1a-108">Lorsqu'Excel trouve une FDU de cluster sécurisée lors du recalcul, il transmet le nom de la XLL qui est en cours d'exécution, le nom de la FDU de cluster sécurisée et tous les paramètres du connecteur de cluster.</span><span class="sxs-lookup"><span data-stu-id="64b1a-108">When Excel discovers a cluster-safe UDF during recalculation, it passes the name of the XLL that is currently running, the name of the cluster-safe UDF, and any parameters to the cluster connector.</span></span> <span data-ttu-id="64b1a-109">Le connecteur exécute l'appel UDF à distance et renvoie les résultats à Excel.</span><span class="sxs-lookup"><span data-stu-id="64b1a-109">The connector runs the UDF call remotely and returns the results to Excel.</span></span> <span data-ttu-id="64b1a-110">Le calcul non dépendant continue et lorsque le connecteur de cluster a terminé d'exécuter le fichier UDF, il transmet les résultats à Excel et les calculs dépendants continuent.</span><span class="sxs-lookup"><span data-stu-id="64b1a-110">Non-dependent calculation continues and when the cluster connector has finished running the UDF, it passes the results to Excel and dependent calculations continue.</span></span> <span data-ttu-id="64b1a-111">Le mécanisme de ce comportement asynchrone imite le mécanisme utilisé par les fonctions définies par l'utilisateur asynchrone, à l'exception du fait que le connecteur de cluster gère les aspects asynchrones au lieu de l'auteur de la FDU.</span><span class="sxs-lookup"><span data-stu-id="64b1a-111">The mechanism for this asynchronous behavior mimics the mechanism used by asynchronous UDFs, except that the cluster connector manages the asynchronous aspects instead of the UDF author.</span></span> <span data-ttu-id="64b1a-112">En règle générale, un connecteur de cluster implémente un shim XLL pour charger des XLL et exécuter des fonctions UDF sur les nœuds de cluster de calcul.</span><span class="sxs-lookup"><span data-stu-id="64b1a-112">Typically, a cluster connector implements an XLL shim to load XLLs and run UDFs on compute cluster nodes.</span></span>
  
<span data-ttu-id="64b1a-113">Les mécanismes de déclaration des FDU comme étant sécurisés pour les clusters ressemblent à ceux de la déclaration de FDU en toute sécurité pour le recalcul multi-thread.</span><span class="sxs-lookup"><span data-stu-id="64b1a-113">The mechanics of declaring UDFs as cluster-safe resemble those of declaring UDFs as safe for multi-threaded recalculation.</span></span> <span data-ttu-id="64b1a-114">Toutefois, étant donné que la FDU n'est pas nécessairement exécutée sur le même ordinateur que d'autres UDF à partir de la même session Excel, il y a différentes considérations à prendre en compte lors de l'écriture de FDU de cluster.</span><span class="sxs-lookup"><span data-stu-id="64b1a-114">However, because the UDF is not necessarily running on the same computer as other UDFs from the same Excel session, there are different considerations when writing cluster-safe UDFs.</span></span>
  
<span data-ttu-id="64b1a-115">Pour enregistrer une FDU comme étant sécurisée en clusters, vous devez appeler la fonction de rappel [xlfRegister (formulaire 1)](xlfregister-form-1.md) par le biais de l'interface **Excel12** ou **Excel12v** .</span><span class="sxs-lookup"><span data-stu-id="64b1a-115">To register a UDF as cluster-safe, you must call the [xlfRegister (Form 1)](xlfregister-form-1.md) callback function through the **Excel12** or **Excel12v** interface.</span></span> <span data-ttu-id="64b1a-116">Pour plus d'informations sur ces interfaces, voir [Excel4/Excel12](excel4-excel12.md) et [Excel4v/Excel12v](excel4v-excel12v.md).</span><span class="sxs-lookup"><span data-stu-id="64b1a-116">For more information about these interfaces, see the [Excel4/Excel12](excel4-excel12.md) and [Excel4v/Excel12v](excel4v-excel12v.md).</span></span> <span data-ttu-id="64b1a-117">L'enregistrement d'une FDU en tant que sécurité de cluster via l'interface **Excel4** ou **Excel4v** n'est pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="64b1a-117">Registering a UDF as cluster-safe through the **Excel4** or **Excel4v** interface is not supported.</span></span> 
  
<span data-ttu-id="64b1a-118">Si vous enregistrez une fonction de manière sécurisée en cluster, vous devez vous assurer que la fonction se comporte de façon sécurisée en cluster.</span><span class="sxs-lookup"><span data-stu-id="64b1a-118">If you register a function as cluster-safe, you must ensure that the function behaves in a cluster-safe way.</span></span> <span data-ttu-id="64b1a-119">Bien que le comportement exact du connecteur de cluster soit propre à l'implémentation, vous devez concevoir votre fichier UDF pour qu'il s'exécute sur un système informatique distribué et présenter les caractéristiques suivantes:</span><span class="sxs-lookup"><span data-stu-id="64b1a-119">Although the exact behavior of the cluster connector is implementation-specific, you should design your UDF to run on a distributed computer system and to have the following characteristics:</span></span>
  
- <span data-ttu-id="64b1a-120">Une FDU ne doit pas reposer sur un état de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="64b1a-120">A UDF should not rely on any memory state.</span></span> <span data-ttu-id="64b1a-121">Par exemple, un fichier UDF ne doit pas reposer sur un cache en mémoire existant.</span><span class="sxs-lookup"><span data-stu-id="64b1a-121">For example, a UDF should not rely on an existing in-memory cache.</span></span>
    
- <span data-ttu-id="64b1a-122">Une FDU ne doit pas effectuer de rappels Excel que le fournisseur de connecteur cluster ne prend pas en charge.</span><span class="sxs-lookup"><span data-stu-id="64b1a-122">A UDF should not perform Excel callbacks that the cluster connector provider does not support.</span></span>
    
<span data-ttu-id="64b1a-123">Outre le comportement de cluster sécurisé, il existe les restrictions techniques suivantes sur les UDF de cluster:</span><span class="sxs-lookup"><span data-stu-id="64b1a-123">In addition to cluster-safe behavior, there are the following technical restrictions on cluster-safe UDFs:</span></span>
  
1. <span data-ttu-id="64b1a-124">Pas d'arguments XLOPER (types «P», «R»).</span><span class="sxs-lookup"><span data-stu-id="64b1a-124">No XLOPER arguments (types 'P', 'R').</span></span>
    
2. <span data-ttu-id="64b1a-125">Aucun argument XLOPER12 prenant en charge les références de plage (tapez'U').</span><span class="sxs-lookup"><span data-stu-id="64b1a-125">No XLOPER12 arguments that support range references (type 'U').</span></span>
    
3. <span data-ttu-id="64b1a-126">Ne peut pas être une fonction équivalente de feuille macro («&amp;#» et «» ne peuvent pas être combinées).</span><span class="sxs-lookup"><span data-stu-id="64b1a-126">Cannot be a macro sheet equivalent function ('#' and '&amp;' cannot be combined).</span></span>
    
<span data-ttu-id="64b1a-127">Pour les UDF avec des temps d'exécution plus courts, la charge de travail de déchargement peut être plus importante que le temps nécessaire à l'exécution du fichier UDF, ce qui annule la plupart des avantages de l'utilisation de cette infrastructure.</span><span class="sxs-lookup"><span data-stu-id="64b1a-127">For UDFs with shorter execution times, the overhead of offloading may be larger than the time it takes the UDF to execute, negating many of the benefits of using this infrastructure.</span></span>
  
> [!NOTE]
> <span data-ttu-id="64b1a-128">Vous ne pouvez pas déclarer une FDU de cluster sécurisée en tant que FDU asynchrone.</span><span class="sxs-lookup"><span data-stu-id="64b1a-128">You cannot declare a cluster-safe UDF as an asynchronous UDF.</span></span> 
  
<span data-ttu-id="64b1a-129">Une FDU peut déterminer si elle est exécutée à l'aide d'un connecteur de cluster en appelant la fonction de rappel [xlRunningOnCluster](xlrunningoncluster.md) .</span><span class="sxs-lookup"><span data-stu-id="64b1a-129">A UDF can determine whether it is being run using a cluster connector by calling the [xlRunningOnCluster](xlrunningoncluster.md) callback function.</span></span> 
  

