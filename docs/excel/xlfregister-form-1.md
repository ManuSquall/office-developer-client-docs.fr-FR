---
title: xlfRegister (formulaire 1)
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- xlfRegister
keywords:
- fonction xlfRegister [Excel 2007]
localization_priority: Normal
ms.assetid: c730124c-1886-4a0f-8f06-79763025537d
description: 'S�applique �: Excel 2013�| Office 2013�| Visual Studio'
ms.openlocfilehash: 3cd2e5072c8602fe301028e69592220a8345c211
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303863"
---
# <a name="xlfregister-form-1"></a><span data-ttu-id="82c57-104">xlfRegister (formulaire 1)</span><span class="sxs-lookup"><span data-stu-id="82c57-104">xlfRegister (Form 1)</span></span>

<span data-ttu-id="82c57-105">**S’applique à**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="82c57-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="82c57-106">Peut être appelée à partir d'une commande DLL ou XLL qui a elle-même été appelée par Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="82c57-106">Can be called from a DLL or XLL command that has itself been called by Microsoft Excel.</span></span> <span data-ttu-id="82c57-107">Cela équivaut à appeler **Register** à partir d'une feuille macro XLM Excel.</span><span class="sxs-lookup"><span data-stu-id="82c57-107">This is equal to calling **REGISTER** from an Excel XLM macro sheet.</span></span> 
  
<span data-ttu-id="82c57-108">**xlfRegister** peut être appelé sous deux formes:</span><span class="sxs-lookup"><span data-stu-id="82c57-108">**xlfRegister** can be called in two forms:</span></span> 
  
- <span data-ttu-id="82c57-109">xlfRegister (formulaire 1): inscrit une commande ou une fonction unique.</span><span class="sxs-lookup"><span data-stu-id="82c57-109">xlfRegister (Form 1): Registers a single command or function.</span></span>
    
- <span data-ttu-id="82c57-110">[xlfRegister (formulaire 2)](xlfregister-form-2.md): charge et active un XLL.</span><span class="sxs-lookup"><span data-stu-id="82c57-110">[xlfRegister (Form 2)](xlfregister-form-2.md): Loads and activates an XLL.</span></span>
    
<span data-ttu-id="82c57-111">Appelée dans le formulaire 1, cette fonction rend une fonction ou commande DLL disponible dans Excel, définit son nombre d'utilisations sur 1 et renvoie son ID d'inscription, qui peut être utilisé pour appeler la fonction ultérieurement à l'aide de l' [xlUDF](xludf.md) ou de la fonction **xlfCall** .</span><span class="sxs-lookup"><span data-stu-id="82c57-111">Called in Form 1, this function makes a DLL function or command available to Excel, sets its use count to 1, and returns its registration ID, which can be used to call the function later by using the [xlUDF](xludf.md) or the **xlfCall** function.</span></span> <span data-ttu-id="82c57-112">L'ID d'inscription est également utilisé pour annuler l'inscription de la fonction à l'aide de [xlfUnregister (formulaire 1)](xlfunregister-form-1.md).</span><span class="sxs-lookup"><span data-stu-id="82c57-112">The registration ID is also used to unregister the function using [xlfUnregister (Form 1)](xlfunregister-form-1.md).</span></span> <span data-ttu-id="82c57-113">Si la fonction a été inscrite, l'appel de **xlfRegister** incrémente son nombre d'utilisations.</span><span class="sxs-lookup"><span data-stu-id="82c57-113">If the function has been registered, calling **xlfRegister** again increments its use count.</span></span> 
  
<span data-ttu-id="82c57-114">Cette forme de la fonction définit également un nom masqué correspondant à l'argument texte de la fonction, _pxFunctionText_, et correspond à l'ID d'enregistrement de la fonction ou de la commande.</span><span class="sxs-lookup"><span data-stu-id="82c57-114">This form of the function also defines a hidden name which is the function text argument,  _pxFunctionText_, and which evaluates to the registration ID of the function or command.</span></span> <span data-ttu-id="82c57-115">Lorsque vous annulez l'inscription de la fonction, supprimez ce nom à l'aide du [xlfSetName](xlfsetname.md).</span><span class="sxs-lookup"><span data-stu-id="82c57-115">When you unregister the function, delete this name using the [xlfSetName](xlfsetname.md).</span></span> <span data-ttu-id="82c57-116">Pour plus d�informations, consultez [Probl�mes connus concernant le d�veloppement de XLL Excel](known-issues-in-excel-xll-development.md).</span><span class="sxs-lookup"><span data-stu-id="82c57-116">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span>
  
```cs
Excel12(xlfRegister, LPXLOPER12 pxRes, int iCount,
    LPXLOPER12 pxModuleText,   LPXLOPER12 pxProcedure,
    LPXLOPER12 pxTypeText,     LPXLOPER12 pxFunctionText,
    LPXLOPER12 pxArgumentText, LPXLOPER12 pxMacroType,
    LPXLOPER12 pxCategory,     LPXLOPER12 pxShortcutText,
    LPXLOPER12 pxHelpTopic,    LPXLOPER12 pxFunctionHelp,
    LPXLOPER12 pxArgumentHelp1, LPXLOPER12 pxArgumentHelp2,
        ...);
```

## <a name="parameters"></a><span data-ttu-id="82c57-117">Paramètres</span><span class="sxs-lookup"><span data-stu-id="82c57-117">Parameters</span></span>

<span data-ttu-id="82c57-118">_pxModuleText_ (**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="82c57-118">_pxModuleText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="82c57-119">Nom de la DLL qui contient la fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-119">The name of the DLL that contains the function.</span></span> <span data-ttu-id="82c57-120">Cela peut être obtenu en appelant la fonction XLL-only [xlGetName](xlgetname.md) si la fonction inscrite se trouve également dans la dll en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="82c57-120">This can be obtained by calling the XLL-only function [xlGetName](xlgetname.md) if the function registered is also within the currently executing DLL.</span></span> 
  
<span data-ttu-id="82c57-121">_pxProcedure_ (**xltypeStr** ou **xltypeNum**)</span><span class="sxs-lookup"><span data-stu-id="82c57-121">_pxProcedure_ (**xltypeStr** or **xltypeNum**)</span></span>
  
<span data-ttu-id="82c57-122">S'il s'agit d'une chaîne, le nom de la fonction à appeler telle qu'elle apparaît dans le code de la DLL.</span><span class="sxs-lookup"><span data-stu-id="82c57-122">If a string, the name of the function to call as it appears in the DLL code.</span></span> <span data-ttu-id="82c57-123">S'il s'agit d'un nombre, le numéro d'export ordinal de la fonction à appeler.</span><span class="sxs-lookup"><span data-stu-id="82c57-123">If a number, the ordinal export number of the function to call.</span></span> <span data-ttu-id="82c57-124">Pour plus de clarté, utilisez toujours le formulaire de chaîne.</span><span class="sxs-lookup"><span data-stu-id="82c57-124">For clarity, always use the string form.</span></span>
  
<span data-ttu-id="82c57-125">_pxTypeText_ (**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="82c57-125">_pxTypeText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="82c57-126">Chaîne facultative qui spécifie les types d'arguments de la fonction et le type de la valeur de retour de la fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-126">An optional string that specifies the types of arguments to the function and the type of the return value of the function.</span></span> <span data-ttu-id="82c57-127">Pour plus d'informations, consultez la section Notes.</span><span class="sxs-lookup"><span data-stu-id="82c57-127">For more information, see the Remarks section.</span></span> <span data-ttu-id="82c57-128">Cet argument peut être omis pour une DLL autonome (XLL) qui inclut une [fonction xlAutoRegister](xlautoregister-xlautoregister12.md) ou **xlAutoRegister12**.</span><span class="sxs-lookup"><span data-stu-id="82c57-128">This argument can be omitted for a stand-alone DLL (XLL) that includes an [xlAutoRegister function](xlautoregister-xlautoregister12.md) or **xlAutoRegister12**.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="82c57-129">**xlAutoRegister12** est uniquement pris en charge dans Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="82c57-129">**xlAutoRegister12** is only supported in Excel 2007.</span></span> 
  
<span data-ttu-id="82c57-130">Si **xlfRegister** est appelé avec cet argument manquant, Excel appelle **xlAutoRegister** ou **xlAutoRegister12**, s'il existe dans la DLL spécifiée, qui doit ensuite correctement enregistrer la fonction en fournissant ces informations.</span><span class="sxs-lookup"><span data-stu-id="82c57-130">If **xlfRegister** is called with this argument missing, Excel calls **xlAutoRegister** or **xlAutoRegister12**, if either exists in the specified DLL, which should then correctly register the function by providing this information.</span></span>
  
<span data-ttu-id="82c57-131">_pxFunctionText_ (**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="82c57-131">_pxFunctionText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="82c57-132">Nom de la fonction tel qu'il apparaîtra dans l'Assistant fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-132">The function name as it will appear in the Function Wizard.</span></span> <span data-ttu-id="82c57-133">Cet argument est facultatif; Si elle est omise, la fonction n'est pas disponible dans l'Assistant fonction et ne peut être appelée qu'à l'aide de la fonction **Call** à l'aide de l'ID d'enregistrement des fonctions d'une feuille macro XLM.</span><span class="sxs-lookup"><span data-stu-id="82c57-133">This argument is optional; if it is omitted, the function is not available in the Function Wizard, and can only be called using the **CALL** function using the functions registration ID from an XLM macro sheet.</span></span> <span data-ttu-id="82c57-134">Par conséquent, pour une utilisation ordinaire de feuille de calcul, vous devez gérer cet argument comme requis.</span><span class="sxs-lookup"><span data-stu-id="82c57-134">Therefore, for ordinary worksheet use, you should handle this argument as required.</span></span> 
  
<span data-ttu-id="82c57-135">_pxArgumentText_ (**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="82c57-135">_pxArgumentText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="82c57-136">Chaîne de texte facultative qui décrit les arguments de la fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-136">An optional text string that describes the arguments to the function.</span></span> <span data-ttu-id="82c57-137">L'utilisateur voit cela dans l'Assistant fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-137">The user sees this in the Function Wizard.</span></span> <span data-ttu-id="82c57-138">Si ce paramètre est omis, Excel construit des descriptions de base à partir de _pxTypeText_.</span><span class="sxs-lookup"><span data-stu-id="82c57-138">If it is omitted, Excel constructs basic descriptions from  _pxTypeText_.</span></span>
  
<span data-ttu-id="82c57-139">_pxMacroType_ (**xltypeNum** ou **xltypeInt**)</span><span class="sxs-lookup"><span data-stu-id="82c57-139">_pxMacroType_ (**xltypeNum** or **xltypeInt**)</span></span>
  
<span data-ttu-id="82c57-140">Argument facultatif qui indique le type de point d'entrée XLL.</span><span class="sxs-lookup"><span data-stu-id="82c57-140">An optional argument that indicates the type of XLL entry point.</span></span> <span data-ttu-id="82c57-141">La valeur par défaut, si elle est omise, est 1.</span><span class="sxs-lookup"><span data-stu-id="82c57-141">The default value, if it is omitted, is 1.</span></span>
  
|||||
|:-----|:-----|:-----|:-----|
| <span data-ttu-id="82c57-142">_valeur pxMacroType_</span><span class="sxs-lookup"><span data-stu-id="82c57-142">_pxMacroType value_</span></span> <br/> |<span data-ttu-id="82c57-143">0</span><span class="sxs-lookup"><span data-stu-id="82c57-143">0</span></span>  <br/> |<span data-ttu-id="82c57-144">0,1</span><span class="sxs-lookup"><span data-stu-id="82c57-144">1</span></span>  <br/> |<span data-ttu-id="82c57-145">n°2</span><span class="sxs-lookup"><span data-stu-id="82c57-145">2</span></span>  <br/> |
|<span data-ttu-id="82c57-146">Peut être appelé à partir d'une feuille de calcul</span><span class="sxs-lookup"><span data-stu-id="82c57-146">Can be called from a worksheet</span></span>  <br/> |<span data-ttu-id="82c57-147">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-147">Yes</span></span>  <br/> |<span data-ttu-id="82c57-148">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-148">Yes</span></span>  <br/> |<span data-ttu-id="82c57-149">Non</span><span class="sxs-lookup"><span data-stu-id="82c57-149">No</span></span>  <br/> |
|<span data-ttu-id="82c57-150">Peut être appelé à partir d'une feuille macro</span><span class="sxs-lookup"><span data-stu-id="82c57-150">Can be called from a macro sheet</span></span>  <br/> |<span data-ttu-id="82c57-151">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-151">Yes</span></span>  <br/> |<span data-ttu-id="82c57-152">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-152">Yes</span></span>  <br/> |<span data-ttu-id="82c57-153">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-153">Yes</span></span>  <br/> |
|<span data-ttu-id="82c57-154">Peut être appelé à partir d'une définition de nom définie</span><span class="sxs-lookup"><span data-stu-id="82c57-154">Can be called from a defined name definition</span></span>  <br/> |<span data-ttu-id="82c57-155">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-155">Yes</span></span>  <br/> |<span data-ttu-id="82c57-156">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-156">Yes</span></span>  <br/> |<span data-ttu-id="82c57-157">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-157">Yes</span></span>  <br/> |
|<span data-ttu-id="82c57-158">Peut être appelé à partir d'une expression de mise en forme conditionnelle</span><span class="sxs-lookup"><span data-stu-id="82c57-158">Can be called from a conditional format expression</span></span>  <br/> |<span data-ttu-id="82c57-159">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-159">Yes</span></span>  <br/> |<span data-ttu-id="82c57-160">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-160">Yes</span></span>  <br/> |<span data-ttu-id="82c57-161">Non</span><span class="sxs-lookup"><span data-stu-id="82c57-161">No</span></span>  <br/> |
|<span data-ttu-id="82c57-162">Mentionné dans l'Assistant fonction pour les fonctions de feuille de calcul</span><span class="sxs-lookup"><span data-stu-id="82c57-162">Listed in the Function Wizard for worksheet functions</span></span>  <br/> |<span data-ttu-id="82c57-163">Non</span><span class="sxs-lookup"><span data-stu-id="82c57-163">No</span></span>  <br/> |<span data-ttu-id="82c57-164">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-164">Yes</span></span>  <br/> |<span data-ttu-id="82c57-165">Non</span><span class="sxs-lookup"><span data-stu-id="82c57-165">No</span></span>  <br/> |
|<span data-ttu-id="82c57-166">Dans l'Assistant fonction pour les fonctions de feuille macro</span><span class="sxs-lookup"><span data-stu-id="82c57-166">Listed in the Function Wizard for macro sheet functions</span></span>  <br/> |<span data-ttu-id="82c57-167">Non</span><span class="sxs-lookup"><span data-stu-id="82c57-167">No</span></span>  <br/> |<span data-ttu-id="82c57-168">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-168">Yes</span></span>  <br/> |<span data-ttu-id="82c57-169">Oui</span><span class="sxs-lookup"><span data-stu-id="82c57-169">Yes</span></span>  <br/> |
   
<span data-ttu-id="82c57-170">Dans la pratique, vous devez utiliser 1 pour les fonctions de feuille de calcul, 1 pour les fonctions équivalentes de feuille macro (inscrites en tant que type **#**) que vous souhaitez appeler à partir de la feuille de calcul, et 2 pour les commandes.</span><span class="sxs-lookup"><span data-stu-id="82c57-170">In practice, you should use 1 for worksheet functions, 1 for macro sheet equivalent functions (registered as type **#**) that you want to call from the worksheet, and 2 for commands.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="82c57-171">Les commandes XLL sont masquées et ne sont pas affichées dans les boîtes de dialogue pour l'exécution des macros, bien qu'il soit possible d'entrer leurs noms partout où un nom de commande valide est requis.</span><span class="sxs-lookup"><span data-stu-id="82c57-171">XLL commands are hidden and not displayed in dialog boxes for running macros, although their names can be entered anywhere a valid command name is required.</span></span> 
  
<span data-ttu-id="82c57-172">_pxCategory_ (**xltypeStr** ou **xltypeNum**)</span><span class="sxs-lookup"><span data-stu-id="82c57-172">_pxCategory_ (**xltypeStr** or **xltypeNum**)</span></span>
  
<span data-ttu-id="82c57-173">Argument facultatif qui vous permet de spécifier la catégorie à laquelle la nouvelle fonction ou commande doit appartenir.</span><span class="sxs-lookup"><span data-stu-id="82c57-173">An optional argument that enables you to specify which category that the new function or command should belong to.</span></span> <span data-ttu-id="82c57-174">L'Assistant fonction divise les fonctions par type (Category).</span><span class="sxs-lookup"><span data-stu-id="82c57-174">The Function Wizard divides functions by type (category).</span></span> <span data-ttu-id="82c57-175">Vous pouvez spécifier un nom de catégorie ou un numéro séquentiel, où le nombre correspond à la position dans laquelle la catégorie apparaît dans l'Assistant fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-175">You can specify a category name or a sequential number, where the number is the position in which the category appears in the Function Wizard.</span></span> <span data-ttu-id="82c57-176">Pour plus d'informations, reportez-vous à la section «noms de catégorie».</span><span class="sxs-lookup"><span data-stu-id="82c57-176">For more information, see the "Category Names" section.</span></span> <span data-ttu-id="82c57-177">Si ce paramètre est omis, la catégorie définie par l'utilisateur est supposée.</span><span class="sxs-lookup"><span data-stu-id="82c57-177">If it is omitted, the User Defined category is assumed.</span></span>
  
<span data-ttu-id="82c57-178">_pxShortcutText_ (**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="82c57-178">_pxShortcutText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="82c57-179">Chaîne qui respecte la casse d'un caractère, qui spécifie la touche de contrôle affectée à cette commande.</span><span class="sxs-lookup"><span data-stu-id="82c57-179">A one-character, case-sensitive string that specifies the control key assigned to this command.</span></span> <span data-ttu-id="82c57-180">Par exemple, «A» affecte cette commande à Ctrl + Maj + A.</span><span class="sxs-lookup"><span data-stu-id="82c57-180">For example, "A" assigns this command to CONTROL+SHIFT+A.</span></span> <span data-ttu-id="82c57-181">Cet argument est facultatif et est utilisé uniquement pour les commandes.</span><span class="sxs-lookup"><span data-stu-id="82c57-181">This argument is optional and is used for commands only.</span></span>
  
<span data-ttu-id="82c57-182">_pxHelpTopic_ (**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="82c57-182">_pxHelpTopic_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="82c57-183">Référence facultative au fichier d'aide (. chm ou. hlp) à afficher lorsque l'utilisateur clique sur le bouton aide (lorsque votre fonction personnalisée est affichée).</span><span class="sxs-lookup"><span data-stu-id="82c57-183">An optional reference to the Help file (.chm or .hlp) to display when the user clicks the Help button (when your custom function is displayed).</span></span> <span data-ttu-id="82c57-184">Peut être sous la forme `filepath!HelpContextID` ou `https://address/path_to_file_in_site!0`.</span><span class="sxs-lookup"><span data-stu-id="82c57-184">Can be in the form  `filepath!HelpContextID` or  `https://address/path_to_file_in_site!0`.</span></span> <span data-ttu-id="82c57-185">Les deux parties avant et après le «!» sont obligatoires.</span><span class="sxs-lookup"><span data-stu-id="82c57-185">Both parts before and after the "!" are required.</span></span>  <span data-ttu-id="82c57-186">*HelpContextID* ne doit pas contenir de guillemets simples et sera converti par Excel en entier non signé de 4 octets de long, sous forme décimale.</span><span class="sxs-lookup"><span data-stu-id="82c57-186">*HelpContextID*  must not contain single quotes, and will be converted by Excel to an unsigned integer 4 bytes long, in decimal form.</span></span> <span data-ttu-id="82c57-187">Lorsque vous utilisez le formulaire d'URL, Excel ouvre uniquement le fichier d'aide référencé.</span><span class="sxs-lookup"><span data-stu-id="82c57-187">When using the URL form, Excel opens only the referenced help file.</span></span> 
  
<span data-ttu-id="82c57-188">_pxFunctionHelp_ (**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="82c57-188">_pxFunctionHelp_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="82c57-189">Chaîne facultative qui décrit votre fonction personnalisée lorsque celle-ci est sélectionnée dans l'Assistant fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-189">An optional string that describes your custom function when it is selected in the Function Wizard.</span></span>
  
<span data-ttu-id="82c57-190">_pxArgumentHelp1_ (**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="82c57-190">_pxArgumentHelp1_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="82c57-191">Facultatif.</span><span class="sxs-lookup"><span data-stu-id="82c57-191">Optional.</span></span> <span data-ttu-id="82c57-192">La première des chaînes qui décrivent les arguments personnalisés de la fonction lorsque la fonction est sélectionnée dans l'Assistant fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-192">The first of the strings that describe the custom arguments of the function when the function is selected in the Function Wizard.</span></span> <span data-ttu-id="82c57-193">Dans Excel 2003 et versions antérieures, **xlfRegister** peut prendre, au plus, 30 arguments afin que vous puissiez fournir cette aide pour les 20 premiers de vos arguments de fonction uniquement.</span><span class="sxs-lookup"><span data-stu-id="82c57-193">In Excel 2003 and earlier, **xlfRegister** can take, at most, 30 arguments so that you can provide this help for the first 20 of your function arguments only.</span></span> <span data-ttu-id="82c57-194">À partir d'Excel 2007, **xlfRegister** peut prendre jusqu'à 255 arguments afin que vous puissiez fournir cette aide pour un maximum de 245 paramètres de fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-194">Starting in Excel 2007, **xlfRegister** can take up to 255 arguments so that you can provide this help for up to 245 function parameters.</span></span> 
  
## <a name="property-valuereturn-value"></a><span data-ttu-id="82c57-195">Valeur de propriété/valeur de renvoi</span><span class="sxs-lookup"><span data-stu-id="82c57-195">Property value/Return value</span></span>

<span data-ttu-id="82c57-196">Si l'inscription a réussi, cette fonction renvoie l'ID de registre de la fonction (**xltypeNum**), qui peut être utilisé dans les appels à **xlUDF** et **xlfUnregister** dans une dll, ou avec **Call** et Unregister dans une feuille macro XLM. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="82c57-196">If registration was successful, this function returns the register ID of the function (**xltypeNum**), which can be used in calls to **xlUDF** and **xlfUnregister** in a DLL, or with **CALL** and **UNREGISTER** in an XLM macro sheet.</span></span> <span data-ttu-id="82c57-197">Dans le cas contraire, elle renvoie une #VALUE!</span><span class="sxs-lookup"><span data-stu-id="82c57-197">Otherwise, it returns a #VALUE!</span></span> <span data-ttu-id="82c57-198">«.</span><span class="sxs-lookup"><span data-stu-id="82c57-198">error.</span></span> 
  
## <a name="remarks"></a><span data-ttu-id="82c57-199">Remarques</span><span class="sxs-lookup"><span data-stu-id="82c57-199">Remarks</span></span>

### <a name="data-types"></a><span data-ttu-id="82c57-200">Types de données</span><span class="sxs-lookup"><span data-stu-id="82c57-200">Data types</span></span>

<span data-ttu-id="82c57-201">L'argument _pxTypeText_ spécifie le type de données de la valeur renvoyée et les types de données de tous les arguments de la fonction ou de la ressource de code de la dll.</span><span class="sxs-lookup"><span data-stu-id="82c57-201">The  _pxTypeText_ argument specifies the data type of the return value and the data types of all arguments to the DLL function or code resource.</span></span> <span data-ttu-id="82c57-202">Le premier caractère de _pxTypeText_ spécifie le type de données de la valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="82c57-202">The first character of  _pxTypeText_ specifies the data type of the return value.</span></span> <span data-ttu-id="82c57-203">Les autres caractères indiquent les types de données de tous les arguments.</span><span class="sxs-lookup"><span data-stu-id="82c57-203">The remaining characters indicate the data types of all the arguments.</span></span> <span data-ttu-id="82c57-204">Par exemple, une fonction DLL qui renvoie un nombre à virgule flottante et prend un nombre entier et un nombre à virgule flottante comme arguments exigerait «BIB» pour l'argument _pxTypeText_ .</span><span class="sxs-lookup"><span data-stu-id="82c57-204">For example, a DLL function that returns a floating-point number and takes an integer and a floating-point number as arguments would require "BIB" for the  _pxTypeText_ argument.</span></span> 
  
<span data-ttu-id="82c57-205">Les types de données et les structures utilisés par Excel pour échanger des données avec des XLL sont résumées dans les deux tableaux suivants.</span><span class="sxs-lookup"><span data-stu-id="82c57-205">The data types and structures used by Excel to exchange data with XLLs are summarized in the following two tables.</span></span>
  
<span data-ttu-id="82c57-206">Le premier tableau répertorie les types pris en charge dans toutes les versions d'Excel.</span><span class="sxs-lookup"><span data-stu-id="82c57-206">The first table lists the types supported in all versions of Excel.</span></span>
  
|<span data-ttu-id="82c57-207">**Type de données**</span><span class="sxs-lookup"><span data-stu-id="82c57-207">**Data type**</span></span>|<span data-ttu-id="82c57-208">**Passer par valeur**</span><span class="sxs-lookup"><span data-stu-id="82c57-208">**Pass by value**</span></span>|<span data-ttu-id="82c57-209">**Passer par référence (pointeur)**</span><span class="sxs-lookup"><span data-stu-id="82c57-209">**Pass by ref (pointer)**</span></span>|<span data-ttu-id="82c57-210">**Comments**</span><span class="sxs-lookup"><span data-stu-id="82c57-210">**Comments**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="82c57-211">Booléen</span><span class="sxs-lookup"><span data-stu-id="82c57-211">Boolean</span></span>  <br/> |<span data-ttu-id="82c57-212">A</span><span class="sxs-lookup"><span data-stu-id="82c57-212">A</span></span>  <br/> |<span data-ttu-id="82c57-213">L</span><span class="sxs-lookup"><span data-stu-id="82c57-213">L</span></span>  <br/> |<span data-ttu-id="82c57-214">short [entier] (0 = false ou 1 = true)</span><span class="sxs-lookup"><span data-stu-id="82c57-214">short [int] (0=false or 1=true)</span></span>  <br/> |
|<span data-ttu-id="82c57-215">double</span><span class="sxs-lookup"><span data-stu-id="82c57-215">double</span></span>  <br/> |<span data-ttu-id="82c57-216">B</span><span class="sxs-lookup"><span data-stu-id="82c57-216">B</span></span>  <br/> |<span data-ttu-id="82c57-217">E</span><span class="sxs-lookup"><span data-stu-id="82c57-217">E</span></span>  <br/> ||
|<span data-ttu-id="82c57-218">char \*</span><span class="sxs-lookup"><span data-stu-id="82c57-218">char \*</span></span>  <br/> ||<span data-ttu-id="82c57-219">C, F</span><span class="sxs-lookup"><span data-stu-id="82c57-219">C, F</span></span>  <br/> |<span data-ttu-id="82c57-220">Chaîne d’octets ASCII se terminant par null</span><span class="sxs-lookup"><span data-stu-id="82c57-220">Null-terminated ASCII byte string</span></span>  <br/> |
|<span data-ttu-id="82c57-221">unsigned char \*</span><span class="sxs-lookup"><span data-stu-id="82c57-221">unsigned char \*</span></span>  <br/> ||<span data-ttu-id="82c57-222">D, G</span><span class="sxs-lookup"><span data-stu-id="82c57-222">D, G</span></span>  <br/> |<span data-ttu-id="82c57-223">Chaîne d'octets ASCII comptés</span><span class="sxs-lookup"><span data-stu-id="82c57-223">Counted ASCII byte string</span></span>  <br/> |
|<span data-ttu-id="82c57-224">unsigned short [int]</span><span class="sxs-lookup"><span data-stu-id="82c57-224">unsigned short [int]</span></span>  <br/> |<span data-ttu-id="82c57-225">H</span><span class="sxs-lookup"><span data-stu-id="82c57-225">H</span></span>  <br/> ||<span data-ttu-id="82c57-226">MOT 16 bits</span><span class="sxs-lookup"><span data-stu-id="82c57-226">16-bit WORD</span></span>  <br/> |
|<span data-ttu-id="82c57-227">[signed] short [int]</span><span class="sxs-lookup"><span data-stu-id="82c57-227">[signed] short [int]</span></span>  <br/> |<span data-ttu-id="82c57-228">I</span><span class="sxs-lookup"><span data-stu-id="82c57-228">I</span></span>  <br/> |<span data-ttu-id="82c57-229">M</span><span class="sxs-lookup"><span data-stu-id="82c57-229">M</span></span>  <br/> |<span data-ttu-id="82c57-230">entier signé 16 bits</span><span class="sxs-lookup"><span data-stu-id="82c57-230">16-bit signed integer</span></span>  <br/> |
|<span data-ttu-id="82c57-231">[signed long] int</span><span class="sxs-lookup"><span data-stu-id="82c57-231">[signed long] int</span></span>  <br/> |<span data-ttu-id="82c57-232">J</span><span class="sxs-lookup"><span data-stu-id="82c57-232">J</span></span>  <br/> |<span data-ttu-id="82c57-233">N</span><span class="sxs-lookup"><span data-stu-id="82c57-233">N</span></span>  <br/> |<span data-ttu-id="82c57-234">entier signé 32 bits</span><span class="sxs-lookup"><span data-stu-id="82c57-234">32-bit signed integer</span></span>  <br/> |
|<span data-ttu-id="82c57-235">FP</span><span class="sxs-lookup"><span data-stu-id="82c57-235">FP</span></span>  <br/> ||<span data-ttu-id="82c57-236">K</span><span class="sxs-lookup"><span data-stu-id="82c57-236">K</span></span>  <br/> |<span data-ttu-id="82c57-237">Structure de tableau à virgule flottante</span><span class="sxs-lookup"><span data-stu-id="82c57-237">Floating-point array structure</span></span>  <br/> |
|<span data-ttu-id="82c57-238">Tableau</span><span class="sxs-lookup"><span data-stu-id="82c57-238">Array</span></span>  <br/> ||<span data-ttu-id="82c57-239">O</span><span class="sxs-lookup"><span data-stu-id="82c57-239">O</span></span>  <br/> |<span data-ttu-id="82c57-240">Trois arguments sont passés:</span><span class="sxs-lookup"><span data-stu-id="82c57-240">Three arguments are passed:</span></span><br/><span data-ttu-id="82c57-241">-unsigned short int\*</span><span class="sxs-lookup"><span data-stu-id="82c57-241">- unsigned short int \*</span></span><br/><span data-ttu-id="82c57-242">-unsigned short int\*</span><span class="sxs-lookup"><span data-stu-id="82c57-242">- unsigned short int \*</span></span><br/><span data-ttu-id="82c57-243">-double []</span><span class="sxs-lookup"><span data-stu-id="82c57-243">- double []</span></span>  <br/> |
|<span data-ttu-id="82c57-244">XLOPER</span><span class="sxs-lookup"><span data-stu-id="82c57-244">XLOPER</span></span>  <br/> ||<span data-ttu-id="82c57-245">P</span><span class="sxs-lookup"><span data-stu-id="82c57-245">P</span></span>  <br/> |<span data-ttu-id="82c57-246">Tableaux et valeurs de feuille de calcul de type variable</span><span class="sxs-lookup"><span data-stu-id="82c57-246">Variable-type worksheet values and arrays</span></span>  <br/> |
|||<span data-ttu-id="82c57-247">R</span><span class="sxs-lookup"><span data-stu-id="82c57-247">R</span></span>  <br/> |<span data-ttu-id="82c57-248">Valeurs, tableaux et références de plage</span><span class="sxs-lookup"><span data-stu-id="82c57-248">Values, arrays, and range references</span></span>  <br/> |
   
<span data-ttu-id="82c57-249">Dans Excel 2007, les types de données suivants ont été introduits pour prendre en charge les grandes grilles et les longues chaînes Unicode.</span><span class="sxs-lookup"><span data-stu-id="82c57-249">In Excel 2007 the following data types were introduced to support the larger grids and long Unicode strings.</span></span>
  
|<span data-ttu-id="82c57-250">**Type de données**</span><span class="sxs-lookup"><span data-stu-id="82c57-250">**Data type**</span></span>|<span data-ttu-id="82c57-251">**Passer par valeur**</span><span class="sxs-lookup"><span data-stu-id="82c57-251">**Pass by value**</span></span>|<span data-ttu-id="82c57-252">**Passer par référence (pointeur)**</span><span class="sxs-lookup"><span data-stu-id="82c57-252">**Pass by ref (pointer)**</span></span>|<span data-ttu-id="82c57-253">**Comments**</span><span class="sxs-lookup"><span data-stu-id="82c57-253">**Comments**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="82c57-254">Short non signé\*</span><span class="sxs-lookup"><span data-stu-id="82c57-254">unsigned short \*</span></span>  <br/> ||<span data-ttu-id="82c57-255">C%, F%</span><span class="sxs-lookup"><span data-stu-id="82c57-255">C%, F%</span></span>  <br/> |<span data-ttu-id="82c57-256">Chaîne de caractères larges Unicode terminée par un caractère null</span><span class="sxs-lookup"><span data-stu-id="82c57-256">Null-terminated Unicode wide-character string</span></span>  <br/> |
|<span data-ttu-id="82c57-257">Short non signé\*</span><span class="sxs-lookup"><span data-stu-id="82c57-257">unsigned short \*</span></span>  <br/> ||<span data-ttu-id="82c57-258">D%, G%</span><span class="sxs-lookup"><span data-stu-id="82c57-258">D%, G%</span></span>  <br/> |<span data-ttu-id="82c57-259">Chaîne Unicode à caractères larges comptés</span><span class="sxs-lookup"><span data-stu-id="82c57-259">Counted Unicode wide-character string</span></span>  <br/> |
|<span data-ttu-id="82c57-260">FP12</span><span class="sxs-lookup"><span data-stu-id="82c57-260">FP12</span></span>  <br/> ||<span data-ttu-id="82c57-261">K%</span><span class="sxs-lookup"><span data-stu-id="82c57-261">K%</span></span>  <br/> |<span data-ttu-id="82c57-262">Structure de tableau à virgule flottante à grande grille</span><span class="sxs-lookup"><span data-stu-id="82c57-262">Larger grid floating-point array structure</span></span>  <br/> |
|<span data-ttu-id="82c57-263">Tableau</span><span class="sxs-lookup"><span data-stu-id="82c57-263">Array</span></span>  <br/> ||<span data-ttu-id="82c57-264">O%</span><span class="sxs-lookup"><span data-stu-id="82c57-264">O%</span></span>  <br/> |<span data-ttu-id="82c57-265">Trois arguments sont passés:</span><span class="sxs-lookup"><span data-stu-id="82c57-265">Three arguments are passed:</span></span><br/><span data-ttu-id="82c57-266">-signé int \* /RW\*</span><span class="sxs-lookup"><span data-stu-id="82c57-266">- signed int \* / RW \*</span></span><br/><span data-ttu-id="82c57-267">-signe int \* /col signé\*</span><span class="sxs-lookup"><span data-stu-id="82c57-267">- signed int \* / COL \*</span></span><br/><span data-ttu-id="82c57-268">-double []</span><span class="sxs-lookup"><span data-stu-id="82c57-268">- double []</span></span>  <br/> |
|<span data-ttu-id="82c57-269">XLOPER12</span><span class="sxs-lookup"><span data-stu-id="82c57-269">XLOPER12</span></span>  <br/> ||<span data-ttu-id="82c57-270">Q</span><span class="sxs-lookup"><span data-stu-id="82c57-270">Q</span></span>  <br/> |<span data-ttu-id="82c57-271">Tableaux et valeurs de feuille de calcul de type variable</span><span class="sxs-lookup"><span data-stu-id="82c57-271">Variable-type worksheet values and arrays</span></span>  <br/> |
|||<span data-ttu-id="82c57-272">U</span><span class="sxs-lookup"><span data-stu-id="82c57-272">U</span></span>  <br/> |<span data-ttu-id="82c57-273">Valeurs, tableaux et références de plage</span><span class="sxs-lookup"><span data-stu-id="82c57-273">Values, arrays, and range references</span></span>  <br/> |
   
<span data-ttu-id="82c57-274">À partir d'Excel 2010, les types de données suivants ont été introduits:</span><span class="sxs-lookup"><span data-stu-id="82c57-274">Starting in Excel 2010 the following data types were introduced:</span></span>
  
|<span data-ttu-id="82c57-275">**Type de données**</span><span class="sxs-lookup"><span data-stu-id="82c57-275">**Data Type**</span></span>|<span data-ttu-id="82c57-276">**Passer par valeur**</span><span class="sxs-lookup"><span data-stu-id="82c57-276">**Pass by value**</span></span>|<span data-ttu-id="82c57-277">**Passer par référence (pointeur)**</span><span class="sxs-lookup"><span data-stu-id="82c57-277">**Pass by ref (pointer)**</span></span>|<span data-ttu-id="82c57-278">**Comments**</span><span class="sxs-lookup"><span data-stu-id="82c57-278">**Comments**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="82c57-279">XLOPER12</span><span class="sxs-lookup"><span data-stu-id="82c57-279">XLOPER12</span></span>  <br/> ||<span data-ttu-id="82c57-280">X</span><span class="sxs-lookup"><span data-stu-id="82c57-280">X</span></span>  <br/> |<span data-ttu-id="82c57-281">Le handle asynchrone est utilisé pour suivre un appel de fonction asynchrone en attente par Excel et le XLL. L'existence du type de paramètre dans la chaîne de type désigne également la fonction comme étant asynchrone. Pour plus d'informations sur les fonctions asynchrones, consultez la rubrique [fonctions asynchrones définies par l'utilisateur](asynchronous-user-defined-functions.md).</span><span class="sxs-lookup"><span data-stu-id="82c57-281">The asynchronous handle is used to track a pending asynchronous function call by Excel and the XLL.The existence of the parameter type in the type string also designates the function as asynchronous.For more information about asynchronous functions, see [Asynchronous User-Defined Functions](asynchronous-user-defined-functions.md).</span></span>  <br/> |
   
<span data-ttu-id="82c57-282">Les types de chaînes**F**, **F%**, **G** et **G%** sont utilisés pour les arguments qui sont modifiés directement (modified-in-place).</span><span class="sxs-lookup"><span data-stu-id="82c57-282">The string types **F**, **F%**, **G**, and **G%** are used for arguments that are modified-in-place.</span></span> 
  
<span data-ttu-id="82c57-283">Lorsque vous utilisez les types de données affichés dans le tableau précédent, gardez à l'esprit les points suivants:</span><span class="sxs-lookup"><span data-stu-id="82c57-283">When working with the data types displayed in the previous table, be aware of the following:</span></span>
  
- <span data-ttu-id="82c57-284">Les déclarations en langage C partent du principe que votre compilateur utilise des doubles de 8 octets, des nombres entiers courts de 2 octets et des entiers longs de 4 octets par défaut.</span><span class="sxs-lookup"><span data-stu-id="82c57-284">The C-language declarations assume that your compiler uses 8-byte doubles, 2-byte short integers, and 4-byte long integers by default.</span></span>
    
- <span data-ttu-id="82c57-285">Toutes les fonctions dans les dll et les ressources de code sont appelées à l'aide de la Convention d'appel **_ _ stdcall** .</span><span class="sxs-lookup"><span data-stu-id="82c57-285">All functions in DLLs and code resources are called using the **__stdcall** calling convention.</span></span> 
    
- <span data-ttu-id="82c57-286">Toute fonction qui renvoie un type de données par référence, c'est-à-dire qui renvoie un pointeur vers un autre, peut retourner en toute sécurité un pointeur null.</span><span class="sxs-lookup"><span data-stu-id="82c57-286">Any function that returns a data type by reference, that is, that returns a pointer to something, can safely return a null pointer.</span></span> <span data-ttu-id="82c57-287">Excel interprète un pointeur null comme un #NUM!</span><span class="sxs-lookup"><span data-stu-id="82c57-287">Excel interprets a null pointer as a #NUM!</span></span> <span data-ttu-id="82c57-288">«.</span><span class="sxs-lookup"><span data-stu-id="82c57-288">error.</span></span>
    
## <a name="additional-data-type-information"></a><span data-ttu-id="82c57-289">Informations supplémentaires sur le type de données</span><span class="sxs-lookup"><span data-stu-id="82c57-289">Additional data type information</span></span>

<span data-ttu-id="82c57-290">Cette section contient des informations détaillées sur les types de données **E**, **f**, **f%**, **g**, **g%**, **K**, **O**, **P**, **Q**, **R**et **U** , ainsi que d'autres informations sur le _pxTypeText _argument.</span><span class="sxs-lookup"><span data-stu-id="82c57-290">This section contains detailed information about the **E**, **F**, **F%**, **G**, **G%**, **K**, **O**, **P**, **Q**, **R**, and **U** data types, and other information about the _pxTypeText_ argument.</span></span> 
  
### <a name="e-data-type"></a><span data-ttu-id="82c57-291">E, type de données</span><span class="sxs-lookup"><span data-stu-id="82c57-291">E data type</span></span>

<span data-ttu-id="82c57-292">Excel s'attend à ce qu'une DLL utilisant le type de données E passe des pointeurs vers des nombres à virgule flottante sur la pile.</span><span class="sxs-lookup"><span data-stu-id="82c57-292">Excel expects a DLL using the E data type to pass pointers to floating-point numbers on the stack.</span></span> <span data-ttu-id="82c57-293">Cela peut entraîner des problèmes avec certains langages (par exemple, Borland C++) qui s'attendent à ce que le numéro soit passé sur la pile de l'émulateur du coprocesseur.</span><span class="sxs-lookup"><span data-stu-id="82c57-293">This can cause problems with some languages (for example, Borland C++) that expect the number to be passed on the coprocessor emulator stack.</span></span> <span data-ttu-id="82c57-294">La solution de contournement consiste à transmettre un pointeur vers le numéro sur la pile de coprocesseur.</span><span class="sxs-lookup"><span data-stu-id="82c57-294">The workaround is to pass a pointer to the number on the coprocessor stack.</span></span> <span data-ttu-id="82c57-295">L'exemple suivant montre comment retourner un double à partir de Borland C++.</span><span class="sxs-lookup"><span data-stu-id="82c57-295">The following example shows how to return a double from Borland C++.</span></span>
  
```cpp
typedef double * lpDbl;
extern "C" lpDbl __stdcall AddDbl(double D1,
    double D2, WORD npDbl)
{
    lpDbl Result;
    Result = (lpDbl)MK_FP(_SS, npDbl);
    *Result = D1 + D2;
    return (Result);
}
```

### <a name="f-f-g-and-g-data-types"></a><span data-ttu-id="82c57-296">Types de données F, F%, G et G%</span><span class="sxs-lookup"><span data-stu-id="82c57-296">F, F%, G, and G% data types</span></span>

<span data-ttu-id="82c57-297">Avec les types de données **f**, **f%**, **g**et **g%** , une fonction peut modifier une mémoire tampon de chaîne allouée par Excel.</span><span class="sxs-lookup"><span data-stu-id="82c57-297">With the **F**, **F%**, **G**, and **G%** data types, a function can modify a string buffer that is allocated by Excel.</span></span> <span data-ttu-id="82c57-298">Si le code de type de la valeur renvoyée est l'un de ces types, Excel ignore la valeur renvoyée par la fonction.</span><span class="sxs-lookup"><span data-stu-id="82c57-298">If the return value type code is one of these types, Excel ignores the value returned by the function.</span></span> <span data-ttu-id="82c57-299">Au lieu de cela, Excel recherche dans la liste des arguments de fonction le premier type de données correspondant (**f**, **f%**, **g**ou **g%**), puis prend le contenu actuel de la mémoire tampon de chaîne allouée en tant que valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="82c57-299">Instead, Excel searches the list of function arguments for the first corresponding data type (**F**, **F%**, **G**, or **G%**) and then takes the current contents of the allocated string buffer as the return value.</span></span> <span data-ttu-id="82c57-300">Toutes les versions d'Excel allouent 256 octets pour les chaînes **F** et **G** ASCII, et en commençant dans Excel 2007 65 536 les octets sont alloués, soit suffisant pour 32 768 caractères Unicode, pour les chaînes Unicode **f%** et **G%** .</span><span class="sxs-lookup"><span data-stu-id="82c57-300">All versions of Excel allocate 256 bytes for **F** and **G** ASCII strings, and starting in Excel 2007 65,536 bytes are allocated, enough for 32,768 Unicode characters, for **F%** and **G%** Unicode strings.</span></span> <span data-ttu-id="82c57-301">N'oubliez pas que les mémoires tampon doivent inclure un nombre de caractères (types **g** et **g%**) ou un caractère d'arrêt nul (types **f** et **f%**), afin que les longueurs maximales de chaîne soient 255 et 32 767.</span><span class="sxs-lookup"><span data-stu-id="82c57-301">Remember that the buffers must include a count character (types **G** and **G%**) or a null-termination character (types **F** and **F%**), so that the actual maximum string lengths are 255 and 32,767.</span></span> <span data-ttu-id="82c57-302">Les chaînes Unicode et, par conséquent, les arguments **F%** et **G%** sont disponibles uniquement par le biais de l'API C dans Excel.</span><span class="sxs-lookup"><span data-stu-id="82c57-302">Unicode strings, and therefore type **F%** and **G%** arguments, are available only through the C API in Excel.</span></span> 
  
### <a name="k-and-k-data-types"></a><span data-ttu-id="82c57-303">Types de données K et K%</span><span class="sxs-lookup"><span data-stu-id="82c57-303">K and K% data types</span></span>

<span data-ttu-id="82c57-304">Les types de données **k** et **k%** utilisent des pointeurs vers les structures FP et FP12 de taille variable, respectivement.</span><span class="sxs-lookup"><span data-stu-id="82c57-304">The **K** and **K%** data types use pointers to the variable-sized FP and FP12 structures respectively.</span></span> <span data-ttu-id="82c57-305">Ces structures sont définies dans XLLCALL. H.</span><span class="sxs-lookup"><span data-stu-id="82c57-305">These structures are defined in XLLCALL.H.</span></span> <span data-ttu-id="82c57-306">Les structures FP12, et par conséquent tapez **K%** arguments, sont uniquement prises en charge à partir d'Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="82c57-306">FP12 structures, and therefore type **K%** arguments, are only supported starting in Excel 2007.</span></span> 
  
### <a name="o-and-o-data-types"></a><span data-ttu-id="82c57-307">Types de données O et O%</span><span class="sxs-lookup"><span data-stu-id="82c57-307">O and O% data types</span></span>

<span data-ttu-id="82c57-308">Les types de données **o** et **o%** ne peuvent être utilisés que pour les arguments, pas les valeurs renvoyées, bien que les valeurs puissent être renvoyées après la modification d'un argument de type **o** ou **o%** .</span><span class="sxs-lookup"><span data-stu-id="82c57-308">The **O** and **O%** data types can only be used for arguments, not return values, although values can be returned my modifying an **O** or **O%** type argument in place.</span></span> <span data-ttu-id="82c57-309">Chacun passe trois éléments: un pointeur vers le nombre de lignes dans une matrice, un pointeur vers le nombre de colonnes dans un tableau et un pointeur vers un tableau à deux dimensions de nombres à virgule flottante.</span><span class="sxs-lookup"><span data-stu-id="82c57-309">Each passes three items: a pointer to the number of rows in an array, a pointer to the number of columns in an array, and a pointer to a two-dimensional array of floating-point numbers.</span></span> 
  
<span data-ttu-id="82c57-310">Pour modifier un tableau passé par le type de données O ou O% sur place, vous pouvez utiliser «>O» ou «>O%» comme argument _pxTypeText_ .</span><span class="sxs-lookup"><span data-stu-id="82c57-310">To modify an array passed by the O or O% data type in place, you could use ">O" or ">O%" as the  _pxTypeText_ argument.</span></span> <span data-ttu-id="82c57-311">Pour plus d'informations sur la modification d'un tableau, reportez-vous à la section «modification en place: fonctions déclarées void» de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="82c57-311">For more information about modifying an array, see the "Modifying in Place: Functions Declared as Void" section in this topic.</span></span> 
  
<span data-ttu-id="82c57-312">Le type de données **O** a été créé pour des fins de compatibilité directe avec les dll Fortran, qui passent des arguments par référence.</span><span class="sxs-lookup"><span data-stu-id="82c57-312">The **O** data type was created for direct compatibility with Fortran DLLs, which pass arguments by reference.</span></span> 
  
<span data-ttu-id="82c57-313">Le **O%** est pris en charge à partir d'Excel 2007 et s'ajuste au plus grand nombre de lignes prises en charge par Excel.</span><span class="sxs-lookup"><span data-stu-id="82c57-313">The **O%** is supported starting in Excel 2007, and accommodates the larger number of rows that Excel supports.</span></span> 
  
### <a name="p-and-q-data-types"></a><span data-ttu-id="82c57-314">Types de données P et Q</span><span class="sxs-lookup"><span data-stu-id="82c57-314">P and Q data types</span></span>

<span data-ttu-id="82c57-315">Lorsque les arguments de la fonction DLL sont enregistrés comme prenant en charge le type **P** XLOPER ou le type **Q** XLOPER12, Excel convertit des références à cellule unique en valeurs simples et des références à plusieurs cellules en tableaux lors de la préparation de ces arguments.</span><span class="sxs-lookup"><span data-stu-id="82c57-315">When DLL function arguments are registered as taking type **P** XLOPERs or type **Q** XLOPER12s, Excel converts single-cell references to simple values and multi-cell references to arrays when preparing these arguments.</span></span> <span data-ttu-id="82c57-316">En d'autres termes, les types **P** et **Q** arriveront toujours dans votre fonction comme l'un des types suivants: **xltypeNum**, **xltypeStr**, **xltypeBool**, **xltypeErr**, **xltypeMulti**, **xltypeMissing**ou \*\*xltypeNil \*\*, mais pas **XltypeRef** ou **xltypeSRef** , car ils sont toujours déréférencés.</span><span class="sxs-lookup"><span data-stu-id="82c57-316">In other words, **P** and **Q** types will always arrive in your function as one of these types: **xltypeNum**, **xltypeStr**, **xltypeBool**, **xltypeErr**, **xltypeMulti**, **xltypeMissing**, or **xltypeNil**, but not **xltypeRef** or **xltypeSRef** because these are always dereferenced.</span></span> <span data-ttu-id="82c57-317">Les objets **XLOPER12**et, par conséquent, les arguments **Q** , sont pris en charge uniquement à partir d'Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="82c57-317">**XLOPER12**s, and therefore type **Q** arguments, are only supported starting in Excel 2007.</span></span> 
  
<span data-ttu-id="82c57-318">Si les types **xltypeMissing** ou **xltypeNil** sont utilisés pour les valeurs de retour, elles sont interprétées par Excel comme une valeur numérique zéro.</span><span class="sxs-lookup"><span data-stu-id="82c57-318">If types **xltypeMissing** or **xltypeNil** are used for return values, they are interpreted by Excel as numeric zero.</span></span> <span data-ttu-id="82c57-319">**xltypeMissing** est transmis lorsque l'appelant omet un argument.</span><span class="sxs-lookup"><span data-stu-id="82c57-319">**xltypeMissing** is passed when the caller omits an argument.</span></span> <span data-ttu-id="82c57-320">**xltypeNil** est transmis lorsque l'appelant transmet une référence à une cellule vide.</span><span class="sxs-lookup"><span data-stu-id="82c57-320">**xltypeNil** is passed when the caller passes a reference to an empty cell.</span></span> <span data-ttu-id="82c57-321">Lorsqu'une plage de cellules est convertie en **xltypeMulti** pour être transmise en tant que type **P** ou **Q**, toutes les cellules vides comprises dans la plage sont converties en éléments de tableau **xltypeNil** .</span><span class="sxs-lookup"><span data-stu-id="82c57-321">When a range of cells is converted to an **xltypeMulti** to be passed as type **P** or **Q**, any blank cells within the range are converted to **xltypeNil** array elements.</span></span> <span data-ttu-id="82c57-322">Les éléments manquants dans un tableau littéral sont passés de la même manière que les éléments **xltypeNil** .</span><span class="sxs-lookup"><span data-stu-id="82c57-322">Missing elements in a literal array are similarly passed as **xltypeNil** elements.</span></span> 
  
### <a name="volatile-functions-and-recalculation"></a><span data-ttu-id="82c57-323">Fonctions volatiles et recalcul</span><span class="sxs-lookup"><span data-stu-id="82c57-323">Volatile functions and recalculation</span></span>

<span data-ttu-id="82c57-324">Dans une feuille de calcul, vous pouvez créer une ressource de code ou une fonction DLL volatile, afin qu'elle recalcule chaque fois que la feuille de calcul recalcule.</span><span class="sxs-lookup"><span data-stu-id="82c57-324">On a worksheet, you can make a DLL function or code resource volatile, so that it recalculates every time the worksheet recalculates.</span></span> <span data-ttu-id="82c57-325">Pour ce faire, ajoutez un point d'exclamation (!) après le dernier code d'argument de l'argument _pxTypeText_ .</span><span class="sxs-lookup"><span data-stu-id="82c57-325">To do this, add an exclamation mark (!) after the last argument code in the  _pxTypeText_ argument.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="82c57-326">Par défaut, les fonctions qui prennent type **R** XLOPER ou type **U** XLOPER12 et qui sont inscrites en tant qu'équivalents **#** de feuille macro (type; consultez la section suivante) sont gérées comme volatile dans Excel.</span><span class="sxs-lookup"><span data-stu-id="82c57-326">By default, functions that take type **R** XLOPERs or type **U** XLOPER12s and that are registered as macro sheet equivalents (type **#**; see next section) are handled as volatile in Excel.</span></span> 
  
### <a name="functions-declared-as-void"></a><span data-ttu-id="82c57-327">Fonctions déclarées void</span><span class="sxs-lookup"><span data-stu-id="82c57-327">Functions declared as void</span></span>

<span data-ttu-id="82c57-328">Il existe deux cas qui appellent la déclaration d'une fonction comme renvoyant void.</span><span class="sxs-lookup"><span data-stu-id="82c57-328">There are two cases that call for declaring a function as returning void.</span></span> <span data-ttu-id="82c57-329">Dans les deux cas, la fonction renvoie son résultat par d'autres moyens.</span><span class="sxs-lookup"><span data-stu-id="82c57-329">In both cases, the function returns its result by other means.</span></span>
  
#### <a name="modifying-in-place"></a><span data-ttu-id="82c57-330">Modification sur place</span><span class="sxs-lookup"><span data-stu-id="82c57-330">Modifying in place</span></span>

<span data-ttu-id="82c57-331">Vous pouvez utiliser un seul chiffre _n_ pour le code de type de retour dans _pxTypeText_, où _n_ est un nombre compris entre 1 et 9.</span><span class="sxs-lookup"><span data-stu-id="82c57-331">You can use a single digit  _n_ for the return type code in  _pxTypeText_, where  _n_ is a number from 1 through 9.</span></span> <span data-ttu-id="82c57-332">Cela indique à Excel d'utiliser la valeur de la variable à l'emplacement désigné par l'argument _n_th dans _pxTypeText_ en tant que valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="82c57-332">This instructs Excel to take the value of the variable in the location pointed to by the  _n_th argument in  _pxTypeText_ as the return value.</span></span> <span data-ttu-id="82c57-333">Cette fonctionnalité est également appelée modification sur place.</span><span class="sxs-lookup"><span data-stu-id="82c57-333">This is also known as modifying in place.</span></span> <span data-ttu-id="82c57-334">L'argument _n_th doit être un type de données de transfert par référence (C, D, E, F, F%, G, G%, K, K%, L, M, N, O, O%, P, Q, R ou U).</span><span class="sxs-lookup"><span data-stu-id="82c57-334">The  _n_th argument must be a pass-by-reference data type (C, D, E, F, F%, G, G%, K, K%, L, M, N, O, O%, P, Q, R, or U).</span></span> <span data-ttu-id="82c57-335">La fonction DLL ou la ressource de code doit également être déclarée à l'aide du mot clé **void** dans les langages C/C++ (ou le mot clé de **procédure** en langage Pascal).</span><span class="sxs-lookup"><span data-stu-id="82c57-335">The DLL function or code resource must also be declared with the **void** keyword in the C/C++ languages (or the **procedure** keyword in the Pascal language).</span></span> 
  
<span data-ttu-id="82c57-336">Par exemple, une fonction DLL qui prend une chaîne terminée par un caractère null et deux pointeurs vers des entiers comme arguments peut modifier la chaîne sur place.</span><span class="sxs-lookup"><span data-stu-id="82c57-336">For example, a DLL function that takes a null-terminated string and two pointers to integers as arguments can modify the string in place.</span></span> <span data-ttu-id="82c57-337">Utilisez «1FMM» comme argument _pxTypeText_ et déclarez la fonction comme void.</span><span class="sxs-lookup"><span data-stu-id="82c57-337">Use "1FMM" as the  _pxTypeText_ argument, and declare the function as void.</span></span> 
  
<span data-ttu-id="82c57-338">Les versions précédentes d'Excel **\>** utilisaient au début de _pxTypeText_ pour indiquer que la fonction a été déclarée comme void et que le premier argument devait être modifié sur place, il n'était pas possible de modifier un argument autre que le premier.</span><span class="sxs-lookup"><span data-stu-id="82c57-338">Previous versions of Excel used **\>** at the start of  _pxTypeText_ to signify that the function was declared as void and that the first argument was to be modified in place—there was no way to modify any argument other than the first.</span></span> <span data-ttu-id="82c57-339">Équivaut **\>** à _n_ = 1 dans les versions actuelles d'Excel et cette utilisation de **\>** dans les fonctions synchrones est prise en charge uniquement à des fins de compatibilité descendante.</span><span class="sxs-lookup"><span data-stu-id="82c57-339">The **\>** is equivalent to  _n_ = 1 in current Excel versions and this use of **\>** in synchronous functions is supported for backward compatibility only.</span></span> 
  
#### <a name="asynchronous-functions"></a><span data-ttu-id="82c57-340">Fonctions asynchrones</span><span class="sxs-lookup"><span data-stu-id="82c57-340">Asynchronous functions</span></span>

<span data-ttu-id="82c57-341">Une fonction asynchrone, dénotée à l'aide d'un paramètre de type X dans **pxTypeText**, ne renvoie pas son résultat à partir de l'appel de la fonction initiale.</span><span class="sxs-lookup"><span data-stu-id="82c57-341">An asynchronous function, denoted by using a parameter of type X in **pxTypeText**, does not return its result from the initial function call.</span></span> <span data-ttu-id="82c57-342">Au lieu de cela, vous devez déclarer une fonction asynchrone comme void et, par la suite, le complément renvoie le résultat via un rappel.</span><span class="sxs-lookup"><span data-stu-id="82c57-342">Instead, you must declare an asynchronous function as void and later the add-in returns the result through a callback.</span></span> <span data-ttu-id="82c57-343">La fonction asynchrone doit être inscrite en **\>** utilisant au début de **pxTypeText**.</span><span class="sxs-lookup"><span data-stu-id="82c57-343">The asynchronous function must be registered by using **\>** at the start of **pxTypeText**.</span></span> <span data-ttu-id="82c57-344">Dans les fonctions asynchrones, **\>** indique que la fonction est déclarée void, mais n'indique pas que le premier argument est modifié sur place.</span><span class="sxs-lookup"><span data-stu-id="82c57-344">In asynchronous functions, **\>** denotes that the function is declared as void, but does not indicate that the first argument is modified in place.</span></span> <span data-ttu-id="82c57-345">Pour plus d'informations sur les fonctions asynchrones, consultez la rubrique [fonctions asynchrones définies par l'utilisateur](asynchronous-user-defined-functions.md).</span><span class="sxs-lookup"><span data-stu-id="82c57-345">For more information about asynchronous functions, see [Asynchronous User-Defined Functions](asynchronous-user-defined-functions.md).</span></span> 

### <a name="registering-worksheet-functions-as-macro-sheet-equivalents-handling-uncalculated-cells"></a><span data-ttu-id="82c57-346">Enregistrement des fonctions de feuille de calcul en tant qu'équivalents de feuille macro (gestion des cellules non calculées)</span><span class="sxs-lookup"><span data-stu-id="82c57-346">Registering worksheet functions as macro sheet equivalents (handling uncalculated cells)</span></span>

<span data-ttu-id="82c57-347">Le fait **#** de placer un caractère après le dernier code de paramètre dans _pxTypeText_ donne aux fonctions les mêmes autorisations d'appel que les fonctions d'une feuille macro.</span><span class="sxs-lookup"><span data-stu-id="82c57-347">Placing a **#** character after the last parameter code in  _pxTypeText_ gives the function the same calling permissions as functions on a macro sheet.</span></span> <span data-ttu-id="82c57-348">Elle comprennent notamment :</span><span class="sxs-lookup"><span data-stu-id="82c57-348">These are as follows:</span></span> 
  
- <span data-ttu-id="82c57-349">La fonction peut récupérer les valeurs des cellules qui n'ont pas encore été calculées dans ce cycle de recalcul.</span><span class="sxs-lookup"><span data-stu-id="82c57-349">The function can retrieve the values of cells that have not yet been calculated in this recalculation cycle.</span></span>
    
- <span data-ttu-id="82c57-350">La fonction peut appeler n'importe laquelle des informations XLM (classe 2), par exemple **xlfGetCell**.</span><span class="sxs-lookup"><span data-stu-id="82c57-350">The function can call any of the XLM information (Class 2) functions, for example, **xlfGetCell**.</span></span>
    
- <span data-ttu-id="82c57-351">Si le signe dièse (#) n'est pas présent: l'évaluation d'une cellule non calculée génère une erreur **xlretUncalced** et la fonction active est rappelée une fois que la cellule a été calculée; l'appel d'une fonction d'informations XLM autre que **xlfCaller** génère une erreur **xlretInvXlfn** .</span><span class="sxs-lookup"><span data-stu-id="82c57-351">If the number sign (#) is not present: evaluating an uncalculated cell results in an **xlretUncalced** error, and the current function is called again once the cell has been calculated; calling any XLM information function other than **xlfCaller** results in an **xlretInvXlfn** error.</span></span> 
    
### <a name="registering-worksheet-functions-as-thread-safe"></a><span data-ttu-id="82c57-352">Enregistrement des fonctions de feuille de calcul en tant que thread-safe</span><span class="sxs-lookup"><span data-stu-id="82c57-352">Registering worksheet functions as thread-safe</span></span>

<span data-ttu-id="82c57-353">À partir d'Excel 2007, Excel peut effectuer un recalcul de classeurs multithreads.</span><span class="sxs-lookup"><span data-stu-id="82c57-353">Starting in Excel 2007, Excel can perform multithreaded workbook recalculation.</span></span> <span data-ttu-id="82c57-354">Cela signifie qu'il peut affecter différentes instances d'une fonction thread-safe aux threads simultanés pour la réévaluation.</span><span class="sxs-lookup"><span data-stu-id="82c57-354">This means that it can assign different instances of a thread-safe function to concurrent threads for reevaluation.</span></span> <span data-ttu-id="82c57-355">À partir d'Excel 2007, la plupart des fonctions de feuille de calcul intégrées sont thread-safe.</span><span class="sxs-lookup"><span data-stu-id="82c57-355">Starting in Excel 2007, most of the built-in worksheet functions are thread-safe.</span></span> <span data-ttu-id="82c57-356">À partir d'Excel 2007, Excel autorise également les XLL à enregistrer des fonctions de feuille de calcul en tant que thread-safe.</span><span class="sxs-lookup"><span data-stu-id="82c57-356">Starting in Excel 2007, Excel also allows XLLs to register worksheet functions as thread-safe.</span></span> <span data-ttu-id="82c57-357">Pour ce faire, incluez **$** un caractère après le dernier code de paramètre dans _pxTypeText_.</span><span class="sxs-lookup"><span data-stu-id="82c57-357">To do this, include a **$** character after the last parameter code in  _pxTypeText_.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="82c57-358">Seules les fonctions de feuille de calcul peuvent être déclarées comme thread-safe.</span><span class="sxs-lookup"><span data-stu-id="82c57-358">Only worksheet functions can be declared as thread-safe.</span></span> <span data-ttu-id="82c57-359">Excel ne considère pas une fonction équivalente de feuille macro comme étant thread-safe, de sorte que vous **#** ne **$** pouvez pas ajouter les deux et les caractères à l'argument _pxTypeText_ .</span><span class="sxs-lookup"><span data-stu-id="82c57-359">Excel does not consider a macro sheet equivalent function to be thread-safe, so that you cannot append both **#** and **$** characters to the  _pxTypeText_ argument.</span></span> 
  
<span data-ttu-id="82c57-360">Si vous avez inscrit une fonction thread-safe, vous devez vous assurer qu'elle se comporte de manière thread-safe, bien qu'Excel rejette tous les appels non sécurisés de thread via l'API C.</span><span class="sxs-lookup"><span data-stu-id="82c57-360">If you have registered a function as thread-safe, you must ensure that it behaves in a thread-safe way, although Excel rejects any thread-unsafe calls via the C API.</span></span> <span data-ttu-id="82c57-361">Par exemple, si une fonction thread-safe tente d'appeler **xlfGetCell**, l'appel échoue avec l'erreur **xlretNotThreadSafe** .</span><span class="sxs-lookup"><span data-stu-id="82c57-361">For example, if a thread-safe function tries to call **xlfGetCell**, the call fails with the **xlretNotThreadSafe** error.</span></span> 
  
### <a name="registering-worksheet-functions-as-cluster-safe"></a><span data-ttu-id="82c57-362">Enregistrement des fonctions de feuille de calcul en tant que cluster-safe</span><span class="sxs-lookup"><span data-stu-id="82c57-362">Registering worksheet functions as cluster-safe</span></span>

<span data-ttu-id="82c57-363">À partir d'Excel 2010, Excel peut décharger les appels de fonction vers un fournisseur de cluster de calcul désigné.</span><span class="sxs-lookup"><span data-stu-id="82c57-363">Starting in Excel 2010, Excel can offload function calls to a designated compute cluster provider.</span></span> <span data-ttu-id="82c57-364">Pour plus d'informations, consultez la rubrique [fonctions de sécurité](cluster-safe-functions.md)des clusters.</span><span class="sxs-lookup"><span data-stu-id="82c57-364">For more information, see [Cluster Safe Functions](cluster-safe-functions.md).</span></span> <span data-ttu-id="82c57-365">Toutes les fonctions de feuille de calcul XLL enregistrées en tant que cluster-safe prennent part au déchargement si un cluster est disponible.</span><span class="sxs-lookup"><span data-stu-id="82c57-365">Any XLL worksheet functions registered as cluster-safe take part in offloading if a cluster is available.</span></span> <span data-ttu-id="82c57-366">Les fonctions de cluster sont inscrites en incluant **&amp;** le caractère qui suit le dernier code de paramètre dans l'argument _pxTypeText_ .</span><span class="sxs-lookup"><span data-stu-id="82c57-366">Cluster-safe functions are registered by including the **&amp;** character after the last parameter code in the  _pxTypeText_ argument.</span></span> 
  
<span data-ttu-id="82c57-367">Si vous avez inscrit une fonction comme étant sécurisée en clusters, vous devez vous assurer qu'elle se comporte de manière sécurisée en cluster.</span><span class="sxs-lookup"><span data-stu-id="82c57-367">If you have registered a function as cluster-safe, you must ensure that it behaves in a cluster-safe way.</span></span> <span data-ttu-id="82c57-368">Pour plus d'informations, consultez la rubrique [fonctions de sécurité](cluster-safe-functions.md)des clusters.</span><span class="sxs-lookup"><span data-stu-id="82c57-368">For more information, see [Cluster Safe Functions](cluster-safe-functions.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="82c57-369">Seules les fonctions de feuille de calcul peuvent être déclarées comme étant sécurisées pour les clusters.</span><span class="sxs-lookup"><span data-stu-id="82c57-369">Only worksheet functions can be declared as cluster-safe.</span></span> <span data-ttu-id="82c57-370">Excel ne considère pas une fonction équivalente de feuille macro comme étant sécurisée pour les clusters, de **#** sorte **&amp;** que vous ne pouvez pas ajouter les deux et les caractères à l'argument _pxTypeText_ .</span><span class="sxs-lookup"><span data-stu-id="82c57-370">Excel does not consider a macro sheet equivalent function to be cluster-safe, so that you cannot append both **#** and **&amp;** characters to the  _pxTypeText_ argument.</span></span> <span data-ttu-id="82c57-371">Les fonctions de feuille de calcul peuvent être déclarées en tant que thread-safe et thread-safe.</span><span class="sxs-lookup"><span data-stu-id="82c57-371">Worksheet functions can be declared as both cluster-safe and thread-safe.</span></span> <span data-ttu-id="82c57-372">Dans ce cas, Excel permet à ces fonctions de prendre part au recalcul multithread lorsque le déchargement du cluster est désactivé.</span><span class="sxs-lookup"><span data-stu-id="82c57-372">In this case, Excel will allow these functions to take part in multithreaded recalculation when cluster offloading is disabled.</span></span> 
  
### <a name="category-names"></a><span data-ttu-id="82c57-373">Noms de catégorie</span><span class="sxs-lookup"><span data-stu-id="82c57-373">Category names</span></span>

<span data-ttu-id="82c57-374">Utilisez les instructions suivantes pour déterminer la catégorie dans laquelle placer vos fonctions XLL.</span><span class="sxs-lookup"><span data-stu-id="82c57-374">Use the following guidelines to determine which category to put your XLL functions in.</span></span>
  
- <span data-ttu-id="82c57-375">Si la fonction effectue une opération qui pourrait être réalisée par l'utilisateur dans le cadre de l'interface utilisateur de votre complément, vous devez placer la fonction dans la catégorie **commandes** .</span><span class="sxs-lookup"><span data-stu-id="82c57-375">If the function does something that could be done by the user as a part of your add-in user interface, you should put the function in the **Commands** category.</span></span> 
    
- <span data-ttu-id="82c57-376">Si la fonction renvoie des informations sur l'état du complément ou toute autre information utile, vous devez placer la fonction dans la catégorie d' **informations** .</span><span class="sxs-lookup"><span data-stu-id="82c57-376">If the function returns information about the state of the add-in or any other useful information, you should put the function in the **Information** category.</span></span> 
    
- <span data-ttu-id="82c57-377">Un complément ne doit jamais ajouter de fonctions ni de commandes à la catégorie **définie par l'utilisateur** .</span><span class="sxs-lookup"><span data-stu-id="82c57-377">An add-in should never add functions or commands to the **User Defined** category.</span></span> <span data-ttu-id="82c57-378">Cette catégorie est destinée à l'usage exclusif des utilisateurs finals.</span><span class="sxs-lookup"><span data-stu-id="82c57-378">This category is for the exclusive use of end users.</span></span> 
    
<span data-ttu-id="82c57-379">La catégorie est spécifiée à l'aide du paramètre _pxCategory_ sur **xlfRegister**.</span><span class="sxs-lookup"><span data-stu-id="82c57-379">The category is specified using the  _pxCategory_ parameter to **xlfRegister**.</span></span> <span data-ttu-id="82c57-380">Il peut s'agir d'un nombre ou d'un texte correspondant à l'une des catégories standard codées en dur ou du texte d'une nouvelle catégorie spécifiée par la DLL.</span><span class="sxs-lookup"><span data-stu-id="82c57-380">This can be a number or text that corresponds to one of the hard-coded standard categories, or the text of a new category specified by the DLL.</span></span> <span data-ttu-id="82c57-381">Si le texte indiqué n'existe pas déjà, Excel crée une nouvelle catégorie portant ce nom.</span><span class="sxs-lookup"><span data-stu-id="82c57-381">If the text given does not already exist, Excel creates a new category with that name.</span></span>
  
<span data-ttu-id="82c57-382">Le tableau suivant répertorie les catégories standard qui sont visibles lorsque vous affichez la boîte de dialogue **coller une fonction** à partir d'une feuille de calcul.</span><span class="sxs-lookup"><span data-stu-id="82c57-382">The following table lists the standard categories that are visible when you view the **Paste Function** dialog box from within a worksheet.</span></span> 
  
|<span data-ttu-id="82c57-383">**Number**</span><span class="sxs-lookup"><span data-stu-id="82c57-383">**Number**</span></span>|<span data-ttu-id="82c57-384">**Text**</span><span class="sxs-lookup"><span data-stu-id="82c57-384">**Text**</span></span>|
|:-----|:-----|
|<span data-ttu-id="82c57-385">0,1</span><span class="sxs-lookup"><span data-stu-id="82c57-385">1</span></span>  <br/> |<span data-ttu-id="82c57-386">Financier</span><span class="sxs-lookup"><span data-stu-id="82c57-386">Financial</span></span>  <br/> |
|<span data-ttu-id="82c57-387">n°2</span><span class="sxs-lookup"><span data-stu-id="82c57-387">2</span></span>  <br/> |<span data-ttu-id="82c57-388">Date &amp; et heure</span><span class="sxs-lookup"><span data-stu-id="82c57-388">Date &amp; Time</span></span>  <br/> |
|<span data-ttu-id="82c57-389">3</span><span class="sxs-lookup"><span data-stu-id="82c57-389">3</span></span>  <br/> |<span data-ttu-id="82c57-390">Math &amp; Trig</span><span class="sxs-lookup"><span data-stu-id="82c57-390">Math &amp; Trig</span></span>  <br/> |
|<span data-ttu-id="82c57-391">4</span><span class="sxs-lookup"><span data-stu-id="82c57-391">4</span></span>  <br/> |<span data-ttu-id="82c57-392">Texte</span><span class="sxs-lookup"><span data-stu-id="82c57-392">Text</span></span>  <br/> |
|<span data-ttu-id="82c57-393">disque</span><span class="sxs-lookup"><span data-stu-id="82c57-393">5</span></span>  <br/> |<span data-ttu-id="82c57-394">Logique</span><span class="sxs-lookup"><span data-stu-id="82c57-394">Logical</span></span>  <br/> |
|<span data-ttu-id="82c57-395">6.x</span><span class="sxs-lookup"><span data-stu-id="82c57-395">6</span></span>  <br/> |<span data-ttu-id="82c57-396">Lookup &amp; Reference</span><span class="sxs-lookup"><span data-stu-id="82c57-396">Lookup &amp; Reference</span></span>  <br/> |
|<span data-ttu-id="82c57-397">7j/7</span><span class="sxs-lookup"><span data-stu-id="82c57-397">7</span></span>  <br/> |<span data-ttu-id="82c57-398">Database</span><span class="sxs-lookup"><span data-stu-id="82c57-398">Database</span></span>  <br/> |
|<span data-ttu-id="82c57-399">8bits</span><span class="sxs-lookup"><span data-stu-id="82c57-399">8</span></span>  <br/> |<span data-ttu-id="82c57-400">Statistiques</span><span class="sxs-lookup"><span data-stu-id="82c57-400">Statistical</span></span>  <br/> |
|<span data-ttu-id="82c57-401">4,9</span><span class="sxs-lookup"><span data-stu-id="82c57-401">9</span></span>  <br/> |<span data-ttu-id="82c57-402">Informations</span><span class="sxs-lookup"><span data-stu-id="82c57-402">Information</span></span>  <br/> |
|<span data-ttu-id="82c57-403">13</span><span class="sxs-lookup"><span data-stu-id="82c57-403">14</span></span>  <br/> |<span data-ttu-id="82c57-404">Personnalisées</span><span class="sxs-lookup"><span data-stu-id="82c57-404">User Defined</span></span>  <br/> |
||<span data-ttu-id="82c57-405">Ingénierie (en commençant dans Excel 2007)</span><span class="sxs-lookup"><span data-stu-id="82c57-405">Engineering (starting in Excel 2007)</span></span>  <br/> |
||<span data-ttu-id="82c57-406">Cube (en commençant dans Excel 2007)</span><span class="sxs-lookup"><span data-stu-id="82c57-406">Cube (starting in Excel 2007)</span></span>  <br/> |
   
<span data-ttu-id="82c57-407">En outre, ces catégories sont également visibles lorsque vous affichez la boîte de dialogue **coller une fonction** à partir d'une feuille macro.</span><span class="sxs-lookup"><span data-stu-id="82c57-407">In addition, these categories are also visible when you view the **Paste Function** dialog box from within a macro sheet.</span></span> 
  
|<span data-ttu-id="82c57-408">**Number**</span><span class="sxs-lookup"><span data-stu-id="82c57-408">**Number**</span></span>|<span data-ttu-id="82c57-409">**Text**</span><span class="sxs-lookup"><span data-stu-id="82c57-409">**Text**</span></span>|
|:-----|:-----|
|<span data-ttu-id="82c57-410">10</span><span class="sxs-lookup"><span data-stu-id="82c57-410">10</span></span>  <br/> |<span data-ttu-id="82c57-411">Commandes</span><span class="sxs-lookup"><span data-stu-id="82c57-411">Commands</span></span>  <br/> |
|<span data-ttu-id="82c57-412">a4</span><span class="sxs-lookup"><span data-stu-id="82c57-412">11</span></span>  <br/> |<span data-ttu-id="82c57-413">DDE/Externe</span><span class="sxs-lookup"><span data-stu-id="82c57-413">DDE/External</span></span>  <br/> |
|<span data-ttu-id="82c57-414">an</span><span class="sxs-lookup"><span data-stu-id="82c57-414">12</span></span>  <br/> |<span data-ttu-id="82c57-415">Personnalisation</span><span class="sxs-lookup"><span data-stu-id="82c57-415">Customizing</span></span>  <br/> |
|<span data-ttu-id="82c57-416">kg</span><span class="sxs-lookup"><span data-stu-id="82c57-416">13</span></span>  <br/> |<span data-ttu-id="82c57-417">Contrôle de macros</span><span class="sxs-lookup"><span data-stu-id="82c57-417">Macro Control</span></span>  <br/> |
   
### <a name="example"></a><span data-ttu-id="82c57-418">Exemple</span><span class="sxs-lookup"><span data-stu-id="82c57-418">Example</span></span>

<span data-ttu-id="82c57-419">Voir le code de la fonction **xlAutoOpen** dans `\SAMPLES\GENERIC\GENERIC.C`.</span><span class="sxs-lookup"><span data-stu-id="82c57-419">See the code for the **xlAutoOpen** function in  `\SAMPLES\GENERIC\GENERIC.C`.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="82c57-420">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="82c57-420">See also</span></span>

- [<span data-ttu-id="82c57-421">REGISTER.ID</span><span class="sxs-lookup"><span data-stu-id="82c57-421">REGISTER.ID</span></span>](xlfregisterid.md)
- [<span data-ttu-id="82c57-422">ANNULER l'inscription</span><span class="sxs-lookup"><span data-stu-id="82c57-422">UNREGISTER</span></span>](xlfunregister-form-1.md)
- [<span data-ttu-id="82c57-423">Fonctions XLM essentielles et utiles de l’API C</span><span class="sxs-lookup"><span data-stu-id="82c57-423">Essential and Useful C API XLM Functions</span></span>](essential-and-useful-c-api-xlm-functions.md)

