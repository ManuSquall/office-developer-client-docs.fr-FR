---
title: Problèmes connus concernant le développement de XLL Excel
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- problèmes connus [excel 2007]
localization_priority: Normal
ms.assetid: 3dfecc0b-a91c-448e-8721-5d3486b625fa
description: 'S’applique à : Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 34784f6895386efe7e6c3ca7ec213c7d71931058
ms.sourcegitcommit: f139451a43598b59da22775333779df691df460a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/27/2018
ms.locfileid: "26685178"
---
# <a name="known-issues-in-excel-xll-development"></a><span data-ttu-id="6ffef-104">Problèmes connus concernant le développement de XLL Excel</span><span class="sxs-lookup"><span data-stu-id="6ffef-104">Known Issues in Excel XLL Development</span></span>

 <span data-ttu-id="6ffef-105">**S’applique à**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="6ffef-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="6ffef-106">Cette rubrique décrit les problèmes connus dans Microsoft Excel que vous pouvez rencontrer dans le développement de XLL.</span><span class="sxs-lookup"><span data-stu-id="6ffef-106">This topic describes known issues in Microsoft Excel that you might encounter in XLL development.</span></span>
  
## <a name="unregistering-xll-commands-and-functions"></a><span data-ttu-id="6ffef-107">Annulation de l’inscription commandes XLL et fonctions</span><span class="sxs-lookup"><span data-stu-id="6ffef-107">Unregistering XLL Commands and Functions</span></span>

<span data-ttu-id="6ffef-108">Lorsqu’un XLL enregistre une commande ou une fonction, Excel crée un nouveau nom pour la ressource et l’associe une référence à la fonction DLL portant ce nom.</span><span class="sxs-lookup"><span data-stu-id="6ffef-108">When an XLL registers a function or command, Excel creates a new name for the resource and associates a reference to the DLL function with that name.</span></span> <span data-ttu-id="6ffef-109">Le nom est extrait du quatrième argument, *pxFunctionText* , de la fonction [xlfRegister](xlfregister-form-1.md) .</span><span class="sxs-lookup"><span data-stu-id="6ffef-109">The name is taken from the fourth argument,  *pxFunctionText*  , of the [xlfRegister](xlfregister-form-1.md) function.</span></span> <span data-ttu-id="6ffef-110">Ce nom est masqué dans les boîtes de dialogue normal pour la gestion des noms de feuille de calcul.</span><span class="sxs-lookup"><span data-stu-id="6ffef-110">This name is hidden from the normal dialog boxes for managing worksheet names.</span></span> <span data-ttu-id="6ffef-111">Pour annuler l’inscription d’une fonction ou une commande, vous devez supprimer le nom en utilisant la fonction [xlfSetName](xlfsetname.md) , en passant le nom mais ne pas en passant une définition.</span><span class="sxs-lookup"><span data-stu-id="6ffef-111">To unregister a function or command, you must delete the name by using the [xlfSetName](xlfsetname.md) function, passing the name but not passing a definition.</span></span> <span data-ttu-id="6ffef-112">Toutefois, un bogue les empêche de supprimer le nom de l’Assistant fonction listes.</span><span class="sxs-lookup"><span data-stu-id="6ffef-112">However, a bug prevents this from removing the name from the Function Wizard lists.</span></span> 
  
## <a name="argument-description-string-truncation-in-the-function-wizard"></a><span data-ttu-id="6ffef-113">Troncation de chaîne argument Description dans l’Assistant fonction</span><span class="sxs-lookup"><span data-stu-id="6ffef-113">Argument Description String Truncation in the Function Wizard</span></span>

<span data-ttu-id="6ffef-114">Le paramètre *pxArgumentHelp1* et tous les paramètres suivants de la fonction **xlfRegister** sont facultatifs chaînes qui correspondent aux arguments de la fonction XLL.</span><span class="sxs-lookup"><span data-stu-id="6ffef-114">The  *pxArgumentHelp1*  parameter and all subsequent parameters of the **xlfRegister** function are optional strings that correspond to the arguments of the XLL function.</span></span> <span data-ttu-id="6ffef-115">L’Assistant fonction affiche ces pour fournir plus d’informations sur la boîte de dialogue construction argument.</span><span class="sxs-lookup"><span data-stu-id="6ffef-115">The Function Wizard displays these to provide help in the argument construction dialog box.</span></span> <span data-ttu-id="6ffef-116">Parfois, Excel tronque la chaîne qui correspond à l’argument final d’un ou deux caractères lors de son affichage dans la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="6ffef-116">Sometimes Excel truncates the string that corresponds to the final argument by one or two characters when displaying it in the dialog box.</span></span> <span data-ttu-id="6ffef-117">Vous pouvez éviter cela en ajoutant une « chaîne vide » supplémentaire en tant que le dernier paramètre « aide argument » de l’enregistrement de fonction.</span><span class="sxs-lookup"><span data-stu-id="6ffef-117">You can avoid this by adding an additional "empty string" as the last "argument help" parameter of your function registration.</span></span>
  
## <a name="binary-name-scope-limitation"></a><span data-ttu-id="6ffef-118">Limitation d’étendue nom binaire</span><span class="sxs-lookup"><span data-stu-id="6ffef-118">Binary Name Scope Limitation</span></span>

<span data-ttu-id="6ffef-119">Noms binaires et les données peuvent être récupérées uniquement lorsque la feuille de calcul qui était active au moment qu'ils ont été créés redevient actif.</span><span class="sxs-lookup"><span data-stu-id="6ffef-119">Binary names and their data can be retrieved only when the worksheet that was active at the time they were created is again active.</span></span> <span data-ttu-id="6ffef-120">Étant donné que les fonctions de feuille de calcul ne peuvent pas activer des feuilles de calcul dans un classeur (seuls les commandes possible), des noms binaires sont très limitées.</span><span class="sxs-lookup"><span data-stu-id="6ffef-120">Because worksheet functions cannot activate worksheets within a workbook (only commands can do this), applications of binary names are very limited.</span></span> <span data-ttu-id="6ffef-121">Par exemple, si vous avez une commande qui est appelée uniquement à partir d’une feuille de calcul, vous pouvez utiliser un nom binaire pour stocker les données associées à une commande.</span><span class="sxs-lookup"><span data-stu-id="6ffef-121">If you have a command that is only invoked from a particular worksheet, for example, you could use a binary name to store command-related data.</span></span>
  
## <a name="xlset-and-workbooks-with-array-formulas"></a><span data-ttu-id="6ffef-122">Classeurs avec des formules matricielles et xlSet</span><span class="sxs-lookup"><span data-stu-id="6ffef-122">xlSet and Workbooks with Array Formulas</span></span>

<span data-ttu-id="6ffef-123">Dans Excel 2003 et versions antérieures, la [fonction xlSet](xlset.md) échoue si vous essayez d’affecter des valeurs à une plage dans une feuille de calcul qui n’est pas la feuille de calcul active, où la plage équivalente sur la feuille active contient une formule matricielle.</span><span class="sxs-lookup"><span data-stu-id="6ffef-123">In Excel 2003 and earlier versions, the [xlSet function](xlset.md) fails if you try to assign values to a range on a worksheet that is not the active worksheet, where the equivalent range on the active sheet contains an array formula.</span></span> <span data-ttu-id="6ffef-124">Dans ce cas, Excel affiche le message « Impossible de modifier une partie d’un tableau. »</span><span class="sxs-lookup"><span data-stu-id="6ffef-124">In this case, Excel displays the message "You cannot change part of an array."</span></span> <span data-ttu-id="6ffef-125">Ce problème est résolu dans Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="6ffef-125">This was fixed in Excel 2007.</span></span> 
  
## <a name="circular-references-are-tolerated-in-data-tables"></a><span data-ttu-id="6ffef-126">Références circulaires sont tolérées dans les Tables de données</span><span class="sxs-lookup"><span data-stu-id="6ffef-126">Circular References are Tolerated in Data Tables</span></span>

<span data-ttu-id="6ffef-127">Excel actuellement sans générer une erreur si le calcul basé sur une table de données fait référence à un élément dans le tableau proprement dit.</span><span class="sxs-lookup"><span data-stu-id="6ffef-127">Excel currently does not raise an error if the calculation that a data table is based on refers to something in the table itself.</span></span> <span data-ttu-id="6ffef-128">Probable que ce scénario pourrait être, soyez prudent quand vous créez ou modifiez les formules qui sont utilisés pour calculer les valeurs de table de données.</span><span class="sxs-lookup"><span data-stu-id="6ffef-128">As unlikely as this scenario might be, you should be careful when you are creating or modifying formulas that are used to calculate data table values.</span></span>
  
## <a name="converting-an-integer-xloper12-to-an-xloper"></a><span data-ttu-id="6ffef-129">Convertir un XLOPER12 entier un XLOPER</span><span class="sxs-lookup"><span data-stu-id="6ffef-129">Converting an Integer XLOPER12 to an XLOPER</span></span>

<span data-ttu-id="6ffef-130">Étant donné que le type de nombre entier **xltypeInt** est un entier signé 32 bits dans le type de données **XLOPER12** , mais il est uniquement un entier signé 16 bits dans le type de données **XLOPER** , il est possible que certaines valeurs de **XLOPER12** entier ne peut pas être inclus dans un nombre entier **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="6ffef-130">Because the integer type **xltypeInt** is a 32-bit signed integer in the **XLOPER12** data type, but it is only a 16-bit signed integer in the **XLOPER** data type, it is possible that some integer **XLOPER12** values cannot be contained in an integer **XLOPER**.</span></span> <span data-ttu-id="6ffef-131">Où Excel convertit ce type en interne, il obtient à convertir le type d’une virgule flottante **xltypeNum** **XLOPER**résoudre ce problème.</span><span class="sxs-lookup"><span data-stu-id="6ffef-131">Where Excel converts this type internally, it gets around this problem by converting the type to a floating-point **xltypeNum** **XLOPER**.</span></span>
  
<span data-ttu-id="6ffef-132">La fonction Framework [XLOper12ToXLOper](xloper12toxloper.md) reflète ce comportement pour qu’il soit compatible avec Excel en interne.</span><span class="sxs-lookup"><span data-stu-id="6ffef-132">The Framework [XLOper12ToXLOper](xloper12toxloper.md) function mirrors this behavior to be consistent with Excel internally.</span></span> <span data-ttu-id="6ffef-133">Lorsque vous appelez cette fonction, vous ne devez pas considérer que le renvoyée **XLOPER** sera toujours **xltypeInt**; lecture **my_xloper.val.w** donne la valeur false si le type de **my_xloper** est **xltypeNum**.</span><span class="sxs-lookup"><span data-stu-id="6ffef-133">When you call this function, you should not assume that the returned **XLOPER** will always be **xltypeInt**; reading **my_xloper.val.w** gives a false value if the **my_xloper** type is **xltypeNum**.</span></span>
  
## <a name="returning-xloper-or-xloper12-by-modifying-arguments-in-place"></a><span data-ttu-id="6ffef-134">Renvoi XLOPER ou XLOPER12 en modifiant les Arguments en Place</span><span class="sxs-lookup"><span data-stu-id="6ffef-134">Returning XLOPER or XLOPER12 by Modifying Arguments in Place</span></span>

<span data-ttu-id="6ffef-135">Excel autorise l’inscription des fonctions qui retournent un **XLOPER** ou les **XLOPER12** en modifiant un argument en place.</span><span class="sxs-lookup"><span data-stu-id="6ffef-135">Excel permits the registration of functions that return an **XLOPER** or **XLOPER12** by modifying an argument in place.</span></span> <span data-ttu-id="6ffef-136">Toutefois, si un **XLOPER**/ **XLOPER12** argument points à la mémoire et le pointeur est ensuite remplacé par la valeur de retour de la fonction DLL, Excel peut une fuite de mémoire.</span><span class="sxs-lookup"><span data-stu-id="6ffef-136">However, if an **XLOPER**/ **XLOPER12** argument points to memory, and the pointer is then overwritten by the return value of the DLL function, Excel can leak memory.</span></span> <span data-ttu-id="6ffef-137">Excel n’affiche pas une erreur, mais il peut se bloquer par la suite.</span><span class="sxs-lookup"><span data-stu-id="6ffef-137">Excel does not display an error, but it might eventually crash.</span></span> <span data-ttu-id="6ffef-138">En outre, si la DLL alloué pour la valeur de retour de la mémoire, Excel peut essayer de Libérez de la mémoire, qui peut entraîner un arrêt immédiat des applications.</span><span class="sxs-lookup"><span data-stu-id="6ffef-138">Also, if the DLL allocated memory for the return value, Excel might try to free that memory, which could cause an immediate application crash.</span></span> <span data-ttu-id="6ffef-139">Par conséquent, vous ne devez pas modifier **XLOPER**/ arguments**XLOPER12** en place.</span><span class="sxs-lookup"><span data-stu-id="6ffef-139">Therefore, you should not modify **XLOPER**/ **XLOPER12** arguments in place.</span></span> <span data-ttu-id="6ffef-140">**XLOPER** ou **XLOPER12** de tous les arguments doivent être traités comme strictement en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="6ffef-140">All **XLOPER** or **XLOPER12** arguments should be treated as strictly read-only.</span></span> 
  
<span data-ttu-id="6ffef-141">Pour plus d�informations, voir [Gestion de la m�moire dans Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="6ffef-141">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="6ffef-142">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6ffef-142">See also</span></span>



[<span data-ttu-id="6ffef-143">XLOper12ToXLOper</span><span class="sxs-lookup"><span data-stu-id="6ffef-143">XLOper12ToXLOper</span></span>](xloper12toxloper.md)


[<span data-ttu-id="6ffef-144">Développement de XLL de Excel 2013</span><span class="sxs-lookup"><span data-stu-id="6ffef-144">Developing Excel XLLs</span></span>](developing-excel-xlls.md)
  
[<span data-ttu-id="6ffef-145">Référence des fonctions XLL SDK API Excel 2013</span><span class="sxs-lookup"><span data-stu-id="6ffef-145">Excel XLL SDK API Function Reference</span></span>](excel-xll-sdk-api-function-reference.md)
  
[<span data-ttu-id="6ffef-146">Gestion de la mémoire dans Excel</span><span class="sxs-lookup"><span data-stu-id="6ffef-146">Memory Management in Excel</span></span>](memory-management-in-excel.md)

