---
title: Création de fichiers XLL
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
keywords:
- dll [excel 2007], appel dans excel, fonction xlAutoFree [Excel 2007], fonction xlAutoFree12 [Excel 2007], xlcall32.lib [Excel 2007], fonction xlAutoRegister [Excel 2007], xlcall.cpp [Excel 2007], fonction xlAutoRemove [Excel 2007], fonction xlAddInManagerInfo [Excel 2007], fonction xlAutoAdd [Excel 2007], fonction xlAutoOpen [Excel 2007], fonction xlAutoClose [Excel 2007], DLL [Excel 2007], transformation en XLL, XLL [Excel 2007] appel dans Excel, fonction xlAutoRegister12 [Excel 2007], xlcall.h [Excel 2007], fonction xlAddInManagerInfo12 [Excel 2007]
ms.assetid: 7754998f-4e13-4a37-9724-43b6ee6c919b
description: 'S’applique à : Excel 2013 | Office 2013 | Visual Studio'
localization_priority: Priority
ms.openlocfilehash: 886b8e74f00f2e724785d43475ee0ffa3c922710
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/17/2019
ms.locfileid: "28706743"
---
# <a name="creating-xlls"></a><span data-ttu-id="b4643-104">Création de fichiers XLL</span><span class="sxs-lookup"><span data-stu-id="b4643-104">Creating XLLs</span></span>

<span data-ttu-id="b4643-105">**S’applique à** : Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="b4643-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="b4643-106">Si votre DLL est autonome ou repose uniquement sur d’autres bibliothèques, vous devez savoir comment activer Microsoft Excel pour accéder à ses fonctions et commandes.</span><span class="sxs-lookup"><span data-stu-id="b4643-106">If your DLL is self-contained or relies only on other libraries, you must know how to enable Microsoft Excel to access its functions and commands.</span></span> <span data-ttu-id="b4643-107">Pour plus d’informations, reportez-vous à la rubrique [Accès aux DLL dans Excel](how-to-access-dlls-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="b4643-107">For more information, see [Memory Management in Excel](how-to-access-dlls-in-excel.md).</span></span> 
  
<span data-ttu-id="b4643-108">Toutefois, si votre DLL a besoin d’accéder aux fonctionnalités d’Excel (par exemple, pour obtenir le contenu d’une cellule, pour appeler une fonction de feuille de calcul ou pour interroger Excel en vue d’obtenir des informations sur l’espace de travail), votre code doit être en mesure de rappeler Excel.</span><span class="sxs-lookup"><span data-stu-id="b4643-108">However, if your DLL needs to access Excel functionality (for example, to get the contents of a cell, to call a worksheet function, or to interrogate Excel to obtain workspace information), your code must be able to call back into Excel.</span></span>
  
<span data-ttu-id="b4643-109">L’API Excel C offre plusieurs fonctions qui permettent aux DLL de rappeler Excel.</span><span class="sxs-lookup"><span data-stu-id="b4643-109">The Excel C API provides several functions that enable DLLs to call back into Excel.</span></span> <span data-ttu-id="b4643-110">Pour y accéder, le DLL doit être lié statiquement au moment de la compilation avec la bibliothèque Excel 32 bits xlcall32.lib.</span><span class="sxs-lookup"><span data-stu-id="b4643-110">To access these, the DLL must be linked statically at compile time with the Excel 32-bit library, xlcall32.lib.</span></span> <span data-ttu-id="b4643-111">La bibliothèque statique est téléchargeable auprès de Microsoft dans le cadre du SDK XLL Microsoft Excel 2013, qui inclut les versions 32 et 64 bits de cette bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="b4643-111">The static library is downloadable from Microsoft as part of the Microsoft Excel 2013 XLL SDK, which includes both 32-bit and 64-bit versions of this library.</span></span>
  
## <a name="enabling-dlls-to-call-back-into-excel"></a><span data-ttu-id="b4643-112">Activation du rappel dans Excel pour les DLL</span><span class="sxs-lookup"><span data-stu-id="b4643-112">Enabling DLLs to Call Back into Excel</span></span>

<span data-ttu-id="b4643-113">Pour qu’une DLL puisse accéder aux fonctionnalités d’Excel et obtenir ou définir des informations sur l’espace de travail, elle doit tout d’abord obtenir les adresses des fonctions de rappel Excel **Excel4**, **Excel4v**, \*\* Excel 12\*\* et **Excel12v**.</span><span class="sxs-lookup"><span data-stu-id="b4643-113">For a DLL to be able to access the functionality in Excel and get or set workspace information, it must first obtain the addresses of the Excel callback functions **Excel4**, **Excel4v**, **Excel12**, and **Excel12v**.</span></span> <span data-ttu-id="b4643-114">Les deux dernières ont été introduites dans Excel 2007 et sont disponibles dans les versions suivantes.</span><span class="sxs-lookup"><span data-stu-id="b4643-114">The last two were introduced in Excel 2007 and are available in subsequent versions.</span></span> <span data-ttu-id="b4643-115">Pour accéder à toutes ces fonctions, le projet de DLL doit contenir des références aux fichiers suivants du SDK XLL Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="b4643-115">To access all of these, the DLL project must include references to the following files from the Excel 2013 XLL SDK.</span></span> <span data-ttu-id="b4643-116">Si vous voulez uniquement accéder aux deux premiers rappels (dans n’importe quelle version d’Excel), votre projet doit seulement inclure les deux premiers fichiers.</span><span class="sxs-lookup"><span data-stu-id="b4643-116">If you want to access only the first two callbacks (in any version of Excel), your project needs to include only the first two files.</span></span>
  
### <a name="xlcallh"></a><span data-ttu-id="b4643-117">Xlcall.h</span><span class="sxs-lookup"><span data-stu-id="b4643-117">Xlcall.h</span></span>

<span data-ttu-id="b4643-118">Le fichier Xlcall.h contient les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b4643-118">The Xlcall.h file contains the following items:</span></span>
  
- <span data-ttu-id="b4643-119">Prototypes de fonction pour toutes les fonctions de rappel.</span><span class="sxs-lookup"><span data-stu-id="b4643-119">Function prototypes for all callback functions.</span></span>
    
- <span data-ttu-id="b4643-120">Définitions des structures de données que les rappels utilisent pour échanger des données entre le DLL/XLL et Excel, et définitions des constantes de type de données.</span><span class="sxs-lookup"><span data-stu-id="b4643-120">Definitions of the data structures that the callbacks use to exchange data between the DLL/XLL and Excel, and data-type constant definitions.</span></span>
    
- <span data-ttu-id="b4643-121">Définitions de la fonction d’API C et des équivalents de commande de la feuille de calcul, fonctions macro de la feuille et commandes Excel prises en charge.</span><span class="sxs-lookup"><span data-stu-id="b4643-121">Definitions of the C API function and command equivalents of the worksheet, macro sheet functions, and supported Excel commands.</span></span>
    
- <span data-ttu-id="b4643-122">Définitions des valeurs de retour de la fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="b4643-122">Definitions of callback function return values.</span></span>
    
<span data-ttu-id="b4643-123">Vous devez utiliser la directive **#include** pour ce fichier, directement ou indirectement à partir d’un autre fichier d’en-tête, dans tous les fichiers qui accèdent à l’API C ou qui gèrent les types de données que l’API C utilise.</span><span class="sxs-lookup"><span data-stu-id="b4643-123">You should use the **#include** directive for this file, directly or indirectly via another header file, in all files that access the C API or that handle data types that the C API uses.</span></span> 
  
### <a name="xlcall32lib"></a><span data-ttu-id="b4643-124">Xlcall32.lib</span><span class="sxs-lookup"><span data-stu-id="b4643-124">Xlcall32.lib</span></span>

<span data-ttu-id="b4643-125">La bibliothèque Xlcall32.lib exporte les deux premiers rappels, **Excel4** et **Excel4v**, ainsi que la fonction **XlCallVer**.</span><span class="sxs-lookup"><span data-stu-id="b4643-125">The Xlcall32.lib library exports the first two callbacks, **Excel4** and **Excel4v**, and also the **XlCallVer** function.</span></span> <span data-ttu-id="b4643-126">Sans une référence à cette bibliothèque dans votre projet, l’éditeur de liens ne peut pas créer le XLL si vous avez utilisé l’un de ces rappels dans votre code.</span><span class="sxs-lookup"><span data-stu-id="b4643-126">Without a reference to this library in your project, the linker cannot create the XLL if you have used any of these callbacks in your code.</span></span> <span data-ttu-id="b4643-127">(Vous pouvez obtenir les adresses de ces fonctions en créant un lien dynamique vers le fichier équivalent Xlcall32.dll copié sur votre système dans le cadre d’une installation Excel standard.)</span><span class="sxs-lookup"><span data-stu-id="b4643-127">(You can obtain the addresses of these functions by linking dynamically to the equivalent Xlcall32.dll that is copied to your system as part of a normal Excel installation.)</span></span> 
  
### <a name="xlcallcpp"></a><span data-ttu-id="b4643-128">Xlcall.cpp</span><span class="sxs-lookup"><span data-stu-id="b4643-128">Xlcall.cpp</span></span>

<span data-ttu-id="b4643-129">Les rappels Excel **Excel 12** et **Excel12v** ne sont pas exportés dans Xlcall32.lib.</span><span class="sxs-lookup"><span data-stu-id="b4643-129">The Excel callbacks **Excel12** and **Excel12v** are not exported in Xlcall32.lib.</span></span> <span data-ttu-id="b4643-130">Cela garantit que les projets XLL que vous créez à partir d’Excel 2007 fonctionnent également avec les versions antérieures d’Excel.</span><span class="sxs-lookup"><span data-stu-id="b4643-130">This ensures that XLL projects that you create starting in Excel 2007 will also work with earlier versions of Excel.</span></span> <span data-ttu-id="b4643-131">Le module Xlcall.cpp contient le code des fonctions **Excel12** et **Excel12v**, qui appellent un point d’entrée Excel dans les versions à partir d’Excel 2007 ou renvoient une valeur safe-error si vous exécutez une version antérieure d’Excel.</span><span class="sxs-lookup"><span data-stu-id="b4643-131">The Xlcall.cpp module contains code for the **Excel12** and **Excel12v** functions, which call into an Excel entry point starting in Excel 2007, or return a safe error value if you are running an earlier version of Excel.</span></span> <span data-ttu-id="b4643-132">Vous devez inclure ce module dans votre projet si vous voulez créer un XLL qui s’exécute à partir de la version 2007 d’Excel, et qui soit capable d’utiliser les nouveaux types de données qui traitent les grilles plus grandes et des chaînes Unicode plus longues.</span><span class="sxs-lookup"><span data-stu-id="b4643-132">You should include this module in your project if you want to create an XLL that runs starting in Excel 2007 and that is able to use the new data types that handle larger grids and longer Unicode strings.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b4643-133">Depuis le SDK Excel 2010, ce fichier peut être compilé pour des XLL 32 et 64 bits.</span><span class="sxs-lookup"><span data-stu-id="b4643-133">Starting with the Excel 2010 SDK, this file can be compiled for both 32-bit and 64-bit XLLs.</span></span> 
  
## <a name="turning-dlls-into-xlls-add-in-manager-interface-functions"></a><span data-ttu-id="b4643-134">Transformation de DLL et XLL : fonctions d’interface du gestionnaire de compléments</span><span class="sxs-lookup"><span data-stu-id="b4643-134">Turning DLLs into XLLs: Add-in Manager Interface Functions</span></span>

<span data-ttu-id="b4643-135">Un fichier XLL est une DLL qui exporte plusieurs procédures appelées par Excel ou par le gestionnaire de compléments Excel.</span><span class="sxs-lookup"><span data-stu-id="b4643-135">An XLL is a DLL that exports several procedures that are called by Excel or the Excel Add-in Manager.</span></span> <span data-ttu-id="b4643-136">Ces procédures sont décrites brièvement dans le présent document et présentées en détail dans [Fonctions du Gestionnaire de compléments et de l’interface XLL](add-in-manager-and-xll-interface-functions.md).</span><span class="sxs-lookup"><span data-stu-id="b4643-136">These procedures are described briefly here and discussed in detail in [Add-in Manager and XLL Interface Functions](add-in-manager-and-xll-interface-functions.md).</span></span> <span data-ttu-id="b4643-137">Tous ces rappels de DLL commencent par le préfixe **xlAuto**.</span><span class="sxs-lookup"><span data-stu-id="b4643-137">All of these DLL callbacks start with the prefix **xlAuto**.</span></span> <span data-ttu-id="b4643-138">Seul l’un d’entre eux est obligatoire, à savoir la commande **xlAutoOpen**.</span><span class="sxs-lookup"><span data-stu-id="b4643-138">Only one of these, the command **xlAutoOpen**, is required.</span></span> <span data-ttu-id="b4643-139">Celle-ci est appelée lors de l’activation du complément, et est généralement utilisée pour inscrire les fonctions et commandes du XLL dans Excel, ainsi que pour effectuer d’autres tâches d’initialisation.</span><span class="sxs-lookup"><span data-stu-id="b4643-139">It is called when the add-in is activated, and it is typically used to register XLL functions and commands with Excel and to do other initialization tasks.</span></span> <span data-ttu-id="b4643-140">Les signatures de fonction ainsi que des exemples d’implémentations de toutes les fonctions **xlAuto** sont fournis dans les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="b4643-140">The function signatures and example implementations of all of the **xlAuto** functions are provided in later sections.</span></span> 
  
<span data-ttu-id="b4643-141">Même si **xlAutoOpen** est le seul de ces rappels à être obligatoire, votre complément peut également avoir besoin d’en exporter d’autres, en fonction de son comportement.</span><span class="sxs-lookup"><span data-stu-id="b4643-141">Even though **xlAutoOpen** is the only required one of these callbacks, your add-in may also need to export others depending on its behavior.</span></span> 
  
<span data-ttu-id="b4643-142">Excel 2007 a introduit un nouveau type de données, **XLOPER12**, pour s’adapter aux grilles plus grandes et prendre en charge les chaînes Unicode longues.</span><span class="sxs-lookup"><span data-stu-id="b4643-142">Excel 2007 introduced a new data type, **XLOPER12**, to accommodate larger grids and to support long Unicode strings.</span></span> <span data-ttu-id="b4643-143">**XLOPER12** est décrit plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="b4643-143">**XLOPER12** is described later in this topic.</span></span> <span data-ttu-id="b4643-144">Tandis que les fonctions **xlAuto** prennent ou renvoient l’ancien type de données **XLOPER**, de nouvelles versions de ces fonctions qui utilisent les types de données **XLOPER12** ont été introduites Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="b4643-144">Whereas **xlAuto** functions take or return the old data type **XLOPER**, new versions of these functions were introduced in Excel 2007 that use **XLOPER12** data types.</span></span> <span data-ttu-id="b4643-145">À l’exception de **xlAutoFree12**, que vous devez parfois implémenter pour éviter les fuites de mémoire de **XLOPER12**, vous pouvez ignorer en toute sécurité les fonctions **xlAuto** de la version 12. Le cas échéant, à partir d’Excel 2007, Excel appelle les versions **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="b4643-145">With the exception of **xlAutoFree12**, which you must sometimes implement to avoid **XLOPER12** memory leaks, you can safely omit all the version 12 **xlAuto** functions, in which case, starting in Excel 2007, Excel calls the **XLOPER** versions.</span></span> 
  
### <a name="xlautoopen"></a><span data-ttu-id="b4643-146">xlAutoOpen</span><span class="sxs-lookup"><span data-stu-id="b4643-146">xlAutoOpen</span></span>

<span data-ttu-id="b4643-147">Excel appelle la fonction [xlAutoOpen](xlautoopen.md) à chaque fois que la XLL est activée.</span><span class="sxs-lookup"><span data-stu-id="b4643-147">Excel calls the [xlAutoOpen](xlautoopen.md) function whenever the XLL is activated.</span></span> <span data-ttu-id="b4643-148">Le complément est activé au début d’une session Excel s’il a été actif dans la dernière session Excel qui a pris fin normalement.</span><span class="sxs-lookup"><span data-stu-id="b4643-148">The add-in will be activated at the start of an Excel session if it was active in the last Excel session that ended normally.</span></span> <span data-ttu-id="b4643-149">Le complément est activé s’il est chargé au cours d’une session d’Excel.</span><span class="sxs-lookup"><span data-stu-id="b4643-149">The add-in is activated if it is loaded during an Excel session.</span></span> <span data-ttu-id="b4643-150">Le complément peut être désactivé et réactivé pendant une session Excel et la fonction est appelée lors de la réactivation.</span><span class="sxs-lookup"><span data-stu-id="b4643-150">The add-in can be deactivated and reactivated during an Excel session, and the function is called on reactivation.</span></span> 
  
<span data-ttu-id="b4643-151">Vous devez utiliser **xlAutoOpen** pour inscrire les fonctions et commandes XLL, initialiser les structures de données, personnaliser l’interface utilisateur et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="b4643-151">You should use **xlAutoOpen** to register XLL functions and commands, initialize data structures, customize the user interface, and so on.</span></span> 
  
<span data-ttu-id="b4643-152">Si votre complément implémente et exporte la fonction [xlAutoRegister](xlautoregister-xlautoregister12.md) ou la fonction [xlAutoRegister12](xlautoregister-xlautoregister12.md), Excel peut tenter d’activer et d’inscrire une fonction ou une commande sans appeler préalablement la fonction **xlAutoOpen**.</span><span class="sxs-lookup"><span data-stu-id="b4643-152">If your add-in implements and exports the [xlAutoRegister](xlautoregister-xlautoregister12.md) function or the [xlAutoRegister12](xlautoregister-xlautoregister12.md) function, Excel might attempt to activate and register a function or command without first calling the **xlAutoOpen** function.</span></span> <span data-ttu-id="b4643-153">Dans ce cas, assurez-vous que votre complément est suffisamment initialisé pour que votre fonction ou commande fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="b4643-153">In this case, you should ensure that your add-in is sufficiently initialized for your function or command to work properly.</span></span> <span data-ttu-id="b4643-154">Si ce n’est pas le cas, faites échouer la tentative d’inscription de la fonction ou de la commande, ou procédez à l’initialisation nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b4643-154">If it is not, you should either fail the attempt to register the function or command, or carry out the necessary initialization.</span></span> 
  
### <a name="xlautoclose"></a><span data-ttu-id="b4643-155">xlAutoClose</span><span class="sxs-lookup"><span data-stu-id="b4643-155">xlAutoClose</span></span>

<span data-ttu-id="b4643-156">Excel appelle la fonction [xlAutoClose](xlautoclose.md) à chaque fois que la XLL est désactivée.</span><span class="sxs-lookup"><span data-stu-id="b4643-156">Excel calls the [xlAutoClose](xlautoclose.md) function whenever the XLL is deactivated, that is, unloaded from memory.</span></span> <span data-ttu-id="b4643-157">Le complément est désactivé lorsqu’une session Excel se termine normalement.</span><span class="sxs-lookup"><span data-stu-id="b4643-157">The add-in is deactivated when an Excel session ends normally.</span></span> <span data-ttu-id="b4643-158">Si l’utilisateur désactive le complément au cours d’une session Excel, la fonction est appelée.</span><span class="sxs-lookup"><span data-stu-id="b4643-158">If the user deactivates the add-in during an Excel session, the function is called.</span></span> 
  
<span data-ttu-id="b4643-159">Vous devez utiliser **xlAutoClose** pour annuler l’inscription des fonctions et commandes, libérer des ressources, annuler les personnalisations, etc.</span><span class="sxs-lookup"><span data-stu-id="b4643-159">You should use **xlAutoClose** to unregister functions and commands, release resources, undo customizations, and so on.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b4643-160">Un problème connu survient lors de l’annulation d’inscription des fonctions et commandes.</span><span class="sxs-lookup"><span data-stu-id="b4643-160">There is a known issue with the unregistration of functions and commands.</span></span> <span data-ttu-id="b4643-161">Pour plus d’informations, reportez-vous à la rubrique [Problèmes connus concernant le développement de XLL Excel](known-issues-in-excel-xll-development.md).</span><span class="sxs-lookup"><span data-stu-id="b4643-161">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span> 
  
### <a name="xlautoadd"></a><span data-ttu-id="b4643-162">xlAutoAdd</span><span class="sxs-lookup"><span data-stu-id="b4643-162">xlAutoAdd</span></span>

<span data-ttu-id="b4643-163">Excel appelle la fonction [xlAutoAdd](xlautoadd.md) chaque fois que l’utilisateur active le XLL pendant une session Excel à l’aide du Gestionnaire de compléments.</span><span class="sxs-lookup"><span data-stu-id="b4643-163">Excel calls the [xlAutoAdd function](xlautoadd.md) whenever the user activates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="b4643-164">Cette fonction n’est pas appelée lorsqu’Excel démarre et charge un complément préinstallé.</span><span class="sxs-lookup"><span data-stu-id="b4643-164">This function is not called when Excel starts and loads a preinstalled add-in.</span></span> 
  
<span data-ttu-id="b4643-165">Vous pouvez utiliser cette fonction pour afficher une boîte de dialogue personnalisée qui indique à l’utilisateur que le complément a été activé, qu’il peut lire ou écrire dans le registre ou vérifier les informations sur les licences.</span><span class="sxs-lookup"><span data-stu-id="b4643-165">You can use this function to display a custom dialog box that tells the user that the add-in has been activated, to read from or write to the registry, or to check licensing information.</span></span>
  
### <a name="xlautoremove"></a><span data-ttu-id="b4643-166">xlAutoRemove</span><span class="sxs-lookup"><span data-stu-id="b4643-166">xlAutoRemove</span></span>

<span data-ttu-id="b4643-167">Excel appelle la fonction [xlAutoRemove](xlautoremove.md) à chaque fois que l’utilisateur désactive le XLL au cours d’une session Excel à l’aide du Gestionnaire de compléments.</span><span class="sxs-lookup"><span data-stu-id="b4643-167">Excel calls the [xlAutoRemove](xlautoremove.md) function whenever the user deactivates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="b4643-168">Cette fonction n’est pas appelée lors de la fermeture normale ou anormale d’une session Excel lorsque le complément est installé.</span><span class="sxs-lookup"><span data-stu-id="b4643-168">This function is not called when an Excel session closes, normally or abnormally, with the add-in installed.</span></span> 
  
<span data-ttu-id="b4643-169">Vous pouvez utiliser cette fonction pour afficher une boîte de dialogue personnalisée qui indique à l’utilisateur que le complément a été désactivé, ou qu’il peut lire ou écrire dans le registre.</span><span class="sxs-lookup"><span data-stu-id="b4643-169">You can use this function to display a custom dialog box that tells the user that the add-in has been deactivated, or to read from or write to the registry.</span></span>
  
### <a name="xladdinmanagerinfoxladdinmanagerinfo12"></a><span data-ttu-id="b4643-170">xlAddInManagerInfo/xlAddInManagerInfo12</span><span class="sxs-lookup"><span data-stu-id="b4643-170">xlAddInManagerInfo/xlAddInManagerInfo12</span></span>

<span data-ttu-id="b4643-171">Excel appelle la fonction [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) lorsque le Gestionnaire de compléments est appelé pour la première fois dans une session Excel.</span><span class="sxs-lookup"><span data-stu-id="b4643-171">Excel calls the [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) function when the Add-in Manager is invoked for the first time in an Excel session.</span></span> <span data-ttu-id="b4643-172">Si Excel transmet un argument égal à 1, cette fonction doit renvoyer une chaîne (en règle générale, le nom du complément) ; sinon, elle doit renvoyer **#VALUE!**.</span><span class="sxs-lookup"><span data-stu-id="b4643-172">If Excel passes an argument equal to 1, this function should return a string (typically, the name of the add-in); otherwise, it should return **#VALUE!**.</span></span>
  
<span data-ttu-id="b4643-173">À partir d’Excel 2007, Excel appelle de préférence la fonction **xlAddInManagerInfo12** plutôt que **xlAddInManagerInfo** si elle est exportée par le XLL.</span><span class="sxs-lookup"><span data-stu-id="b4643-173">Starting in Excel 2007, Excel calls the **xlAddInManagerInfo12** function in preference to the **xlAddInManagerInfo** function if it is exported by the XLL.</span></span> <span data-ttu-id="b4643-174">La fonction **xlAddInManagerInfo12** doit fonctionner de la même manière que **xlAddInManagerInfo** afin d’éviter les différences propres à chaque version dans le comportement du fichier XLL.</span><span class="sxs-lookup"><span data-stu-id="b4643-174">The **xlAddInManagerInfo12** function should work in the same way as the **xlAddInManagerInfo** function to avoid version-specific differences in the behavior of the XLL.</span></span> <span data-ttu-id="b4643-175">La fonction **xlAddInManagerInfo12** doit renvoyer un type de données **XLOPER12**, alors que **xlAddInManagerInfo** doit renvoyer le type **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="b4643-175">The **xlAddInManagerInfo12** function should return an **XLOPER12** data type, whereas the **xlAddInManagerInfo** function should return an **XLOPER** data type.</span></span> 
  
### <a name="xlautoregisterxlautoregister12"></a><span data-ttu-id="b4643-176">xlAutoRegister/xlAutoRegister12</span><span class="sxs-lookup"><span data-stu-id="b4643-176">xlAutoRegister/xlAutoRegister12</span></span>

<span data-ttu-id="b4643-177">Excel appelle la fonction [xlAutoRegister](xlautoregister-xlautoregister12.md) chaque fois qu’un appel à la fonction XLM **REGISTER** ou à la fonction API C équivalente [xlfRegister](xlfregister-form-1.md) a été effectué, avec les types de retour et d’argument manquants pour la fonction qui fait l’objet de l’inscription.</span><span class="sxs-lookup"><span data-stu-id="b4643-177">Excel calls the [xlAutoRegister](xlautoregister-xlautoregister12.md) function whenever a call has been made to the XLM function **REGISTER**, or the C API equivalent [xlfRegister](xlfregister-form-1.md) function, with the return and argument types missing for the function being registered.</span></span> <span data-ttu-id="b4643-178">La fonction **xlAutoRegister** permet au XLL de rechercher ses listes internes de fonctions et de commandes exportées pour inscrire la fonction avec l’argument et renvoyer les types spécifiés.</span><span class="sxs-lookup"><span data-stu-id="b4643-178">The **xlAutoRegister** function allows the XLL to search its internal lists of exported functions and commands to register the function with the argument and return the specified types.</span></span> 
  
<span data-ttu-id="b4643-179">À partir d’Excel 2007, Excel appelle la fonction **xlAddInRegister12** plutôt que la fonction **xlAddInRegister** si elle est exportée par le XLL.</span><span class="sxs-lookup"><span data-stu-id="b4643-179">Starting in Excel 2007, Excel calls the **xlAddInRegister12** function in preference to the **xlAddInRegister** function if it is exported by the XLL.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b4643-180">Si **xlAddInRegister**/ **xlAddInRegister12** tente d’inscrire la fonction sans fournir les types d’argument et de retour, une boucle d’appel récursive survient et finit par faire déborder la pile d’appel et par entraîner la fermeture ou le blocage d’Excel.</span><span class="sxs-lookup"><span data-stu-id="b4643-180">If **xlAddInRegister**/ **xlAddInRegister12** tries to register the function without supplying the argument and return types, a recursive calling loop occurs that eventually overflows the call stack and causes Excel to close or stop responding.</span></span> 
  
### <a name="xlautofreexlautofree12"></a><span data-ttu-id="b4643-181">xlAutoFree/xlAutoFree12</span><span class="sxs-lookup"><span data-stu-id="b4643-181">xlAutoFree/xlAutoFree12</span></span>

<span data-ttu-id="b4643-182">Excel appelle la fonction [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) immédiatement après qu’une fonction de feuille de calcul XLL a renvoyé un type de données **XLOPER**/ **XLOPER12** avec un indicateur qui signale à Excel que le XLL a toujours de la mémoire à libérer.</span><span class="sxs-lookup"><span data-stu-id="b4643-182">Excel calls the [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) function just after an XLL worksheet function returns an **XLOPER**/ **XLOPER12** data type with a flag set that tells Excel there is memory that the XLL still needs to release.</span></span> <span data-ttu-id="b4643-183">Le XLL peut ainsi renvoyer des matrices, des chaînes et des références externes allouées dynamiquement vers la feuille de calcul sans pertes de mémoire.</span><span class="sxs-lookup"><span data-stu-id="b4643-183">This enables the XLL to return dynamically allocated arrays, strings, and external references to the worksheet without memory leaks.</span></span> <span data-ttu-id="b4643-184">À partir d’Excel 2007, le type de données **XLOPER12** est pris en charge.</span><span class="sxs-lookup"><span data-stu-id="b4643-184">Starting in Excel 2007, the **XLOPER12** data type is supported.</span></span> <span data-ttu-id="b4643-185">Pour plus d’informations, reportez-vous à la rubrique [Gestion de la mémoire dans Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="b4643-185">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="b4643-186">À partir d’Excel 2007, si Excel est configuré pour utiliser le recalcul multithread de feuille de calcul, la fonction **xlAutoFree**/ **xlAutoFree12** est appelée sur le thread qui vient d’être utilisé pour appeler la fonction qui l’a renvoyée.</span><span class="sxs-lookup"><span data-stu-id="b4643-186">Starting in Excel 2007, when Excel is configured to use multithreaded worksheet recalculation, the **xlAutoFree**/ **xlAutoFree12** function is called on the same thread that was just used to call the function that returned it.</span></span> <span data-ttu-id="b4643-187">L’appel à **xlAutoFree**/ **xlAutoFree12** est toujours effectué avant que d’autres cellules de la feuille de calcul soient évaluées sur ce thread.</span><span class="sxs-lookup"><span data-stu-id="b4643-187">The call to **xlAutoFree**/ **xlAutoFree12** is always made before any subsequent worksheet cells are evaluated on that thread.</span></span> <span data-ttu-id="b4643-188">Cela simplifie la conception thread-safe dans votre XLL.</span><span class="sxs-lookup"><span data-stu-id="b4643-188">This simplifies thread-safe design in your XLL.</span></span> <span data-ttu-id="b4643-189">Pour plus d’informations, reportez-vous à la rubrique [Recalcul multithread dans Excel](multithreaded-recalculation-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="b4643-189">For more information, see [Multithreaded Recalculation in Excel](multithreaded-recalculation-in-excel.md).</span></span> 
  
### <a name="creating-64-bit-xlls"></a><span data-ttu-id="b4643-190">Création de XLL 64 bits</span><span class="sxs-lookup"><span data-stu-id="b4643-190">Creating 64-bit XLLs</span></span>

<span data-ttu-id="b4643-191">Excel et les fonctions définies par l’utilisateur peuvent s’exécuter sur des systèmes d’exploitation 64 bits pour bénéficier de meilleures performances que sur des systèmes d’exploitation 32 bits.</span><span class="sxs-lookup"><span data-stu-id="b4643-191">Excel and user-defined functions can run on 64-bit operating systems to take advantage of performance benefits over 32-bit operating systems.</span></span> <span data-ttu-id="b4643-192">Excel transmet les valeurs dans des structures **XLOPER12** qui contiennent des informations sur les types de données.</span><span class="sxs-lookup"><span data-stu-id="b4643-192">Excel passes values in **XLOPER12** structures that include information about the types for the data.</span></span> <span data-ttu-id="b4643-193">Soyez prudent lorsque vous effectuez des conversions entre les valeurs de la structure **XLOPER12** et des types natifs tels que **int** ou des pointeurs, afin de conserver les valeurs dans le type le plus étendu.</span><span class="sxs-lookup"><span data-stu-id="b4643-193">Be careful when you convert between values in the **XLOPER12** structure and native types like **int** or pointers to preserve the values in the larger type.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="b4643-194">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b4643-194">See also</span></span>



[<span data-ttu-id="b4643-195">Appel des fonctions XLL à partir de l’Assistant Fonction ou des boîtes de dialogue Remplacer</span><span class="sxs-lookup"><span data-stu-id="b4643-195">Call XLL functions from the Function Wizard or Replace dialog boxes</span></span>](how-to-call-xll-functions-from-the-function-wizard-or-replace-dialog-boxes.md)
  
[<span data-ttu-id="b4643-196">Fonctions du Gestionnaire de compléments et de l’interface XLL</span><span class="sxs-lookup"><span data-stu-id="b4643-196">Add-in Manager and XLL Interface Functions</span></span>](add-in-manager-and-xll-interface-functions.md)
  
[<span data-ttu-id="b4643-197">Développement de XLL de Excel</span><span class="sxs-lookup"><span data-stu-id="b4643-197">Developing Excel XLLs</span></span>](developing-excel-xlls.md)

