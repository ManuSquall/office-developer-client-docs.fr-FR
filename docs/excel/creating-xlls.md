---
title: Création de XLL
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
keywords:
- DLL [excel 2007], appel dans excel, fonction xlAutoFree [Excel 2007], fonction xlAutoFree12 [2007],xlcall32.lib Excel [Excel 2007], fonction xlAutoRegister [2007],xlcall.cpp Excel [Excel 2007], fonction xlAutoRemove [Excel 2007], xlAddInManagerInfo fonction [Excel 2007], xlAutoAdd, fonction [Excel 2007], fonction xlAutoOpen [Excel 2007], xlAutoClose fonction [Excel 2007], [Excel 2007], les DLL transformer en XLL, XLL [Excel 2007], appel dans Excel, la fonction xlAutoRegister12 [Excel 2007],xlcall.h [Excel 2007], xlAddInManagerInfo12, fonction [Excel 2007]
localization_priority: Normal
ms.assetid: 7754998f-4e13-4a37-9724-43b6ee6c919b
description: 'S�applique �: Excel 2013�| Office 2013�| Visual Studio'
ms.openlocfilehash: de347d34768c25adf0d96642b4fade781ae26a9c
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19782027"
---
# <a name="creating-xlls"></a><span data-ttu-id="efbde-104">Création de XLL</span><span class="sxs-lookup"><span data-stu-id="efbde-104">Creating XLLs</span></span>

<span data-ttu-id="efbde-105">**S’applique à**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="efbde-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="efbde-106">Si votre DLL est autonome ou s’appuie uniquement sur les autres bibliothèques, vous devez savoir comment permettent à Microsoft Excel accéder aux fonctions et les commandes.</span><span class="sxs-lookup"><span data-stu-id="efbde-106">If your DLL is self-contained or relies only on other libraries, you must know how to enable Microsoft Excel to access its functions and commands.</span></span> <span data-ttu-id="efbde-107">Pour plus d’informations, consultez [Accès aux DLL dans Excel](how-to-access-dlls-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="efbde-107">For more information, see [Access DLLs in Excel](how-to-access-dlls-in-excel.md).</span></span> 
  
<span data-ttu-id="efbde-108">Toutefois, si votre DLL doit accéder aux fonctionnalités d’Excel (par exemple, pour obtenir le contenu d’une cellule, pour appeler une fonction de feuille de calcul ou interroger Excel pour obtenir des informations d’espace de travail), votre code doit être en mesure d’effectuer un rappel dans Excel.</span><span class="sxs-lookup"><span data-stu-id="efbde-108">However, if your DLL needs to access Excel functionality (for example, to get the contents of a cell, to call a worksheet function, or to interrogate Excel to obtain workspace information), your code must be able to call back into Excel.</span></span>
  
<span data-ttu-id="efbde-109">L’API C Excel offre plusieurs fonctions permettant de DLL vers Excel.</span><span class="sxs-lookup"><span data-stu-id="efbde-109">The Excel C API provides several functions that enable DLLs to call back into Excel.</span></span> <span data-ttu-id="efbde-110">Pour accéder à ces, la DLL doit être liée statiquement au moment de la compilation avec la bibliothèque Excel 32 bits, xlcall32.lib.</span><span class="sxs-lookup"><span data-stu-id="efbde-110">To access these, the DLL must be linked statically at compile time with the Excel 32-bit library, xlcall32.lib.</span></span> <span data-ttu-id="efbde-111">La bibliothèque statique est téléchargeable à partir de Microsoft en tant que partie de Microsoft Excel 2013 XLL SDK, qui inclut les versions 32 bits et 64 bits de cette bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="efbde-111">The static library is downloadable from Microsoft as part of the Microsoft Excel 2013 XLL SDK, which includes both 32-bit and 64-bit versions of this library.</span></span>
  
## <a name="enabling-dlls-to-call-back-into-excel"></a><span data-ttu-id="efbde-112">Activation de la DLL à l’appel dans Excel</span><span class="sxs-lookup"><span data-stu-id="efbde-112">Enabling DLLs to Call Back into Excel</span></span>

<span data-ttu-id="efbde-113">Pour être en mesure d’accéder aux fonctionnalités dans Excel et obtenir ou définir une DLL informations d’espace de travail, il doit d’abord obtenir les adresses des fonctions de rappel Excel **Excel4**, **Excel4v**, **Excel12**et **Excel12v**.</span><span class="sxs-lookup"><span data-stu-id="efbde-113">For a DLL to be able to access the functionality in Excel and get or set workspace information, it must first obtain the addresses of the Excel callback functions **Excel4**, **Excel4v**, **Excel12**, and **Excel12v**.</span></span> <span data-ttu-id="efbde-114">Les deux dernières ont été introduits dans Excel 2007 et sont disponibles dans les versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="efbde-114">The last two were introduced in Excel 2007 and are available in subsequent versions.</span></span> <span data-ttu-id="efbde-115">Pour accéder à toutes ces, le projet de DLL doit inclure les références pour les fichiers suivants à partir du Kit de développement logiciel XLL Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="efbde-115">To access all of these, the DLL project must include references to the following files from the Excel 2013 XLL SDK.</span></span> <span data-ttu-id="efbde-116">Si vous souhaitez accéder uniquement les deux premières rappels (dans n’importe quelle version de Microsoft Excel), votre projet doit inclure uniquement les deux premiers fichiers.</span><span class="sxs-lookup"><span data-stu-id="efbde-116">If you want to access only the first two callbacks (in any version of Excel), your project needs to include only the first two files.</span></span>
  
### <a name="xlcallh"></a><span data-ttu-id="efbde-117">Xlcall.h</span><span class="sxs-lookup"><span data-stu-id="efbde-117">Xlcall.h</span></span>

<span data-ttu-id="efbde-118">Le fichier Xlcall.h contient les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="efbde-118">The Xlcall.h file contains the following items:</span></span>
  
- <span data-ttu-id="efbde-119">Prototypes de fonction pour toutes les fonctions de rappel.</span><span class="sxs-lookup"><span data-stu-id="efbde-119">Function prototypes for all callback functions.</span></span>
    
- <span data-ttu-id="efbde-120">Définitions des structures de données qui utilisent des rappels pour échanger des données entre les DLL/XLL Excel et les définitions de constantes de type de données.</span><span class="sxs-lookup"><span data-stu-id="efbde-120">Definitions of the data structures that the callbacks use to exchange data between the DLL/XLL and Excel, and data-type constant definitions.</span></span>
    
- <span data-ttu-id="efbde-121">Définitions des équivalents fonction et commandes API C de la feuille de calcul, fonctions de feuille macro, commandes Excel prises en charge.</span><span class="sxs-lookup"><span data-stu-id="efbde-121">Definitions of the C API function and command equivalents of the worksheet, macro sheet functions, and supported Excel commands.</span></span>
    
- <span data-ttu-id="efbde-122">Valeurs de retour de définitions de fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="efbde-122">Definitions of callback function return values.</span></span>
    
<span data-ttu-id="efbde-123">Vous devez utiliser le **#include** directive pour ce fichier, directement ou indirectement via un autre fichier d’en-tête, tous les fichiers qui accèdent à l’API C ou pour gérer les types de données qui utilise l’API C.</span><span class="sxs-lookup"><span data-stu-id="efbde-123">You should use the **#include** directive for this file, directly or indirectly via another header file, in all files that access the C API or that handle data types that the C API uses.</span></span> 
  
### <a name="xlcall32lib"></a><span data-ttu-id="efbde-124">Xlcall32.lib</span><span class="sxs-lookup"><span data-stu-id="efbde-124">Xlcall32.lib</span></span>

<span data-ttu-id="efbde-125">La bibliothèque Xlcall32.lib exporte les deux premières rappels **Excel4** et **Excel4v**et également la fonction **XlCallVer** .</span><span class="sxs-lookup"><span data-stu-id="efbde-125">The Xlcall32.lib library exports the first two callbacks, **Excel4** and **Excel4v**, and also the **XlCallVer** function.</span></span> <span data-ttu-id="efbde-126">Sans une référence à cette bibliothèque dans votre projet, l’éditeur de liens ne peut pas créer la ressource XLL si vous avez utilisé une de ces rappels dans votre code.</span><span class="sxs-lookup"><span data-stu-id="efbde-126">Without a reference to this library in your project, the linker cannot create the XLL if you have used any of these callbacks in your code.</span></span> <span data-ttu-id="efbde-127">(Vous pouvez obtenir les adresses de ces fonctions par une liaison dynamique à l’équivalent Xlcall32.dll qui est copié dans votre système dans le cadre d’une installation Excel normale).</span><span class="sxs-lookup"><span data-stu-id="efbde-127">(You can obtain the addresses of these functions by linking dynamically to the equivalent Xlcall32.dll that is copied to your system as part of a normal Excel installation.)</span></span> 
  
### <a name="xlcallcpp"></a><span data-ttu-id="efbde-128">Xlcall.cpp</span><span class="sxs-lookup"><span data-stu-id="efbde-128">Xlcall.cpp</span></span>

<span data-ttu-id="efbde-129">Les rappels Excel **Excel12** et **Excel12v** ne sont pas exportés dans Xlcall32.lib.</span><span class="sxs-lookup"><span data-stu-id="efbde-129">The Excel callbacks **Excel12** and **Excel12v** are not exported in Xlcall32.lib.</span></span> <span data-ttu-id="efbde-130">Cela garantit que les projets XLL que vous créez à compter d’Excel 2007 fonctionne également avec les versions antérieures d’Excel.</span><span class="sxs-lookup"><span data-stu-id="efbde-130">This ensures that XLL projects that you create starting in Excel 2007 will also work with earlier versions of Excel.</span></span> <span data-ttu-id="efbde-131">Le module Xlcall.cpp contient le code pour **Excel12** et **Excel12v** fonctions qui appellent une entrée Excel point à compter d’Excel 2007 ou de renvoient une valeur d’erreur de sécurité si vous exécutez une version antérieure de Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="efbde-131">The Xlcall.cpp module contains code for the **Excel12** and **Excel12v** functions, which call into an Excel entry point starting in Excel 2007, or return a safe error value if you are running an earlier version of Excel.</span></span> <span data-ttu-id="efbde-132">Si vous souhaitez créer une solution XLL qui s’exécute à compter d’Excel 2007 et qui est en mesure d’utiliser les nouveaux types de données qui prennent en charge grilles plus grandes et plus chaînes Unicode, vous devez inclure ce module dans votre projet.</span><span class="sxs-lookup"><span data-stu-id="efbde-132">You should include this module in your project if you want to create an XLL that runs starting in Excel 2007 and that is able to use the new data types that handle larger grids and longer Unicode strings.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="efbde-133">Commencer avec le Kit de développement Excel 2010, ce fichier peut être compilé pour XLL 32 bits et 64 bits.</span><span class="sxs-lookup"><span data-stu-id="efbde-133">Starting with the Excel 2010 SDK, this file can be compiled for both 32-bit and 64-bit XLLs.</span></span> 
  
## <a name="turning-dlls-into-xlls-add-in-manager-interface-functions"></a><span data-ttu-id="efbde-134">La DLL en XLL : Gestionnaire de fonctions de l’Interface du complément</span><span class="sxs-lookup"><span data-stu-id="efbde-134">Turning DLLs into XLLs: Add-in Manager Interface Functions</span></span>

<span data-ttu-id="efbde-135">Une solution XLL est une DLL qui exporte plusieurs procédures qui sont appelées par Excel ou le Gestionnaire de compléments Excel.</span><span class="sxs-lookup"><span data-stu-id="efbde-135">An XLL is a DLL that exports several procedures that are called by Excel or the Excel Add-in Manager.</span></span> <span data-ttu-id="efbde-136">Ces procédures sont décrites brièvement ici et décrit en détail dans le [Gestionnaire de compléments et les fonctions de l’Interface XLL](add-in-manager-and-xll-interface-functions.md).</span><span class="sxs-lookup"><span data-stu-id="efbde-136">These procedures are described briefly here and discussed in detail in [Add-in Manager and XLL Interface Functions](add-in-manager-and-xll-interface-functions.md).</span></span> <span data-ttu-id="efbde-137">Tous ces rappels DLL commencent par le préfixe **xlAuto**.</span><span class="sxs-lookup"><span data-stu-id="efbde-137">All of these DLL callbacks start with the prefix **xlAuto**.</span></span> <span data-ttu-id="efbde-138">Seule une d'entre eux, la commande **xlAutoOpen**, est requise.</span><span class="sxs-lookup"><span data-stu-id="efbde-138">Only one of these, the command **xlAutoOpen**, is required.</span></span> <span data-ttu-id="efbde-139">Elle est appelée lorsque le complément est activé, et il est généralement utilisé pour enregistrer les fonctions XLL dans Excel et d’autres tâches d’initialisation des commandes.</span><span class="sxs-lookup"><span data-stu-id="efbde-139">It is called when the add-in is activated, and it is typically used to register XLL functions and commands with Excel and to do other initialization tasks.</span></span> <span data-ttu-id="efbde-140">Exemples d’implémentation de toutes les fonctions **xlAuto** les signatures de fonction sont fournies dans les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="efbde-140">The function signatures and example implementations of all of the **xlAuto** functions are provided in later sections.</span></span> 
  
<span data-ttu-id="efbde-141">Même si **xlAutoOpen** est le seul requis de ces rappels, votre complément deviez également exporter d’autres personnes en fonction de son comportement.</span><span class="sxs-lookup"><span data-stu-id="efbde-141">Even though **xlAutoOpen** is the only required one of these callbacks, your add-in may also need to export others depending on its behavior.</span></span> 
  
<span data-ttu-id="efbde-142">Excel 2007 introduit un nouveau type de données, **XLOPER12**, pour prendre en charge les grilles plus grandes et pour prendre en charge les chaînes Unicode longues.</span><span class="sxs-lookup"><span data-stu-id="efbde-142">Excel 2007 introduced a new data type, **XLOPER12**, to accommodate larger grids and to support long Unicode strings.</span></span> <span data-ttu-id="efbde-143">**XLOPER12** est décrit plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="efbde-143">**XLOPER12** is described later in this topic.</span></span> <span data-ttu-id="efbde-144">Tandis que les fonctions **xlAuto** prendront ou renvoient le type de données ancien **XLOPER**, les nouvelles versions de ces fonctions ont été introduites dans Excel 2007 qui utilisent des types de données **XLOPER12** .</span><span class="sxs-lookup"><span data-stu-id="efbde-144">Whereas **xlAuto** functions take or return the old data type **XLOPER**, new versions of these functions were introduced in Excel 2007 that use **XLOPER12** data types.</span></span> <span data-ttu-id="efbde-145">À l’exception de **xlAutoFree12**, que vous devez parfois implémenter pour éviter la mémoire **XLOPER12** fuites, vous pouvez omettre en toute sécurité de toutes les version 12 **xlAuto** fonctions, dans ce cas, à compter d’Excel 2007, les appels le **XLOPER** Excel versions.</span><span class="sxs-lookup"><span data-stu-id="efbde-145">With the exception of **xlAutoFree12**, which you must sometimes implement to avoid **XLOPER12** memory leaks, you can safely omit all the version 12 **xlAuto** functions, in which case, starting in Excel 2007, Excel calls the **XLOPER** versions.</span></span> 
  
### <a name="xlautoopen"></a><span data-ttu-id="efbde-146">xlAutoOpen</span><span class="sxs-lookup"><span data-stu-id="efbde-146">xlAutoOpen</span></span>

<span data-ttu-id="efbde-147">Excel appelle la fonction [xlAutoOpen](xlautoopen.md) chaque fois que la ressource XLL est activée.</span><span class="sxs-lookup"><span data-stu-id="efbde-147">Excel calls the [xlAutoOpen](xlautoopen.md) function whenever the XLL is activated.</span></span> <span data-ttu-id="efbde-148">Le complément sera activé au début d’une session Excel si elle a été actif dans la dernière session Excel qui s’est terminée normalement.</span><span class="sxs-lookup"><span data-stu-id="efbde-148">The add-in will be activated at the start of an Excel session if it was active in the last Excel session that ended normally.</span></span> <span data-ttu-id="efbde-149">Le complément est activé s’il est chargé pendant une session d’Excel.</span><span class="sxs-lookup"><span data-stu-id="efbde-149">The add-in is activated if it is loaded during an Excel session.</span></span> <span data-ttu-id="efbde-150">Le complément peut être désactivé et réactivé pendant une session de Excel et la fonction est appelée sur réactivation.</span><span class="sxs-lookup"><span data-stu-id="efbde-150">The add-in can be deactivated and reactivated during an Excel session, and the function is called on reactivation.</span></span> 
  
<span data-ttu-id="efbde-151">Vous devez utiliser **xlAutoOpen** pour enregistrer les commandes et les fonctions XLL, initialiser les structures de données, personnaliser l’interface utilisateur et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="efbde-151">You should use **xlAutoOpen** to register XLL functions and commands, initialize data structures, customize the user interface, and so on.</span></span> 
  
<span data-ttu-id="efbde-152">Si votre complément implémente et exporte la fonction [xlAutoRegister](xlautoregister-xlautoregister12.md) ou [xlAutoRegister12](xlautoregister-xlautoregister12.md) , Excel peut tenter d’activer et enregistrer une fonction ou une commande sans appeler d’abord la fonction **xlAutoOpen** .</span><span class="sxs-lookup"><span data-stu-id="efbde-152">If your add-in implements and exports the [xlAutoRegister](xlautoregister-xlautoregister12.md) function or the [xlAutoRegister12](xlautoregister-xlautoregister12.md) function, Excel might attempt to activate and register a function or command without first calling the **xlAutoOpen** function.</span></span> <span data-ttu-id="efbde-153">Dans ce cas, vous devez vous assurer que votre complément est suffisamment initialisé pour votre fonction ou la commande fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="efbde-153">In this case, you should ensure that your add-in is sufficiently initialized for your function or command to work properly.</span></span> <span data-ttu-id="efbde-154">S’il n’est pas le cas, vous défaillance soit la tentative d’inscrire la fonction ou la commande ou d’effectuer l’initialisation nécessaire.</span><span class="sxs-lookup"><span data-stu-id="efbde-154">If it is not, you should either fail the attempt to register the function or command, or carry out the necessary initialization.</span></span> 
  
### <a name="xlautoclose"></a><span data-ttu-id="efbde-155">xlAutoClose</span><span class="sxs-lookup"><span data-stu-id="efbde-155">xlAutoClose</span></span>

<span data-ttu-id="efbde-156">Excel appelle la fonction [xlAutoClose](xlautoclose.md) chaque fois que la ressource XLL est désactivée.</span><span class="sxs-lookup"><span data-stu-id="efbde-156">Excel calls the [xlAutoClose](xlautoclose.md) function whenever the XLL is deactivated.</span></span> <span data-ttu-id="efbde-157">Le complément sera désactivé quand une session Excel se termine normalement.</span><span class="sxs-lookup"><span data-stu-id="efbde-157">The add-in will be deactivated when an Excel session ends normally.</span></span> <span data-ttu-id="efbde-158">Si l’utilisateur désactive le complément pendant une session Excel, la fonction est appelée.</span><span class="sxs-lookup"><span data-stu-id="efbde-158">If the user deactivates the add-in during an Excel session, the function is called.</span></span> 
  
<span data-ttu-id="efbde-159">Vous devez utiliser **xlAutoClose** pour annuler l’inscription des fonctions et les commandes, libérer des ressources, annuler des personnalisations et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="efbde-159">You should use **xlAutoClose** to unregister functions and commands, release resources, undo customizations, and so on.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="efbde-160">Il existe un problème connu avec l’annulation de l’inscription des fonctions et des commandes.</span><span class="sxs-lookup"><span data-stu-id="efbde-160">There is a known issue with the unregistration of functions and commands.</span></span> <span data-ttu-id="efbde-161">Pour plus d�informations, consultez [Probl�mes connus concernant le d�veloppement de XLL Excel](known-issues-in-excel-xll-development.md).</span><span class="sxs-lookup"><span data-stu-id="efbde-161">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span> 
  
### <a name="xlautoadd"></a><span data-ttu-id="efbde-162">xlAutoAdd</span><span class="sxs-lookup"><span data-stu-id="efbde-162">xlAutoAdd</span></span>

<span data-ttu-id="efbde-163">Excel appelle la [fonction xlAutoAdd](xlautoadd.md) dès que l’utilisateur a activé la XLL pendant une session Excel à l’aide du Gestionnaire de compléments.</span><span class="sxs-lookup"><span data-stu-id="efbde-163">Excel calls the [xlAutoAdd function](xlautoadd.md) whenever the user activates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="efbde-164">Cette fonction n’est pas appelée lorsque Excel démarre et charge un complément préinstallé.</span><span class="sxs-lookup"><span data-stu-id="efbde-164">This function is not called when Excel starts and loads a preinstalled add-in.</span></span> 
  
<span data-ttu-id="efbde-165">Vous pouvez utiliser cette fonction pour afficher une boîte de dialogue personnalisée qui indique à l’utilisateur que le complément a été activé pour lire ou écrire dans le Registre ou pour vérifier les informations de licence.</span><span class="sxs-lookup"><span data-stu-id="efbde-165">You can use this function to display a custom dialog box that tells the user that the add-in has been activated, to read from or write to the registry, or to check licensing information.</span></span>
  
### <a name="xlautoremove"></a><span data-ttu-id="efbde-166">xlAutoRemove</span><span class="sxs-lookup"><span data-stu-id="efbde-166">xlAutoRemove</span></span>

<span data-ttu-id="efbde-167">Excel appelle la fonction [xlAutoRemove](xlautoremove.md) chaque fois que l’utilisateur désactive le XLL pendant une session Excel à l’aide du Gestionnaire de compléments.</span><span class="sxs-lookup"><span data-stu-id="efbde-167">Excel calls the [xlAutoRemove](xlautoremove.md) function whenever the user deactivates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="efbde-168">Cette fonction n’est pas appelée lorsqu’une session Excel se ferme, normale ou anormale, avec le complément installé.</span><span class="sxs-lookup"><span data-stu-id="efbde-168">This function is not called when an Excel session closes, normally or abnormally, with the add-in installed.</span></span> 
  
<span data-ttu-id="efbde-169">Vous pouvez utiliser cette fonction pour afficher une boîte de dialogue personnalisée qui indique à l’utilisateur que le complément a été désactivé, ou pour lire ou écrire dans le Registre.</span><span class="sxs-lookup"><span data-stu-id="efbde-169">You can use this function to display a custom dialog box that tells the user that the add-in has been deactivated, or to read from or write to the registry.</span></span>
  
### <a name="xladdinmanagerinfoxladdinmanagerinfo12"></a><span data-ttu-id="efbde-170">xlAddInManagerInfo/xlAddInManagerInfo12</span><span class="sxs-lookup"><span data-stu-id="efbde-170">xlAddInManagerInfo/xlAddInManagerInfo12</span></span>

<span data-ttu-id="efbde-171">Excel appelle la fonction [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) lorsque le Gestionnaire de compléments est appelé pour la première fois dans une session d’Excel.</span><span class="sxs-lookup"><span data-stu-id="efbde-171">Excel calls the [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) function when the Add-in Manager is invoked for the first time in an Excel session.</span></span> <span data-ttu-id="efbde-172">Si Excel passe un argument est égale à 1, cette fonction doit renvoyer une chaîne (en règle générale, le nom de la macro complémentaire) ; Sinon, elle doit retourner **#VALUE !**.</span><span class="sxs-lookup"><span data-stu-id="efbde-172">If Excel passes an argument equal to 1, this function should return a string (typically, the name of the add-in); otherwise, it should return **#VALUE!**.</span></span>
  
<span data-ttu-id="efbde-173">À compter d’Excel 2007, Excel appelle la fonction **xlAddInManagerInfo12** plutôt que la fonction **xlAddInManagerInfo** , si elle est exportée par la ressource XLL.</span><span class="sxs-lookup"><span data-stu-id="efbde-173">Starting in Excel 2007, Excel calls the **xlAddInManagerInfo12** function in preference to the **xlAddInManagerInfo** function if it is exported by the XLL.</span></span> <span data-ttu-id="efbde-174">La fonction **xlAddInManagerInfo12** devrait fonctionner de la même manière que la fonction **xlAddInManagerInfo** pour éviter les différences spécifiques à la version de comportement de la ressource XLL.</span><span class="sxs-lookup"><span data-stu-id="efbde-174">The **xlAddInManagerInfo12** function should work in the same way as the **xlAddInManagerInfo** function to avoid version-specific differences in the behavior of the XLL.</span></span> <span data-ttu-id="efbde-175">La fonction **xlAddInManagerInfo12** doit renvoyer un type de données **XLOPER12** , tandis que la fonction **xlAddInManagerInfo** doit renvoyer un type de données **XLOPER** .</span><span class="sxs-lookup"><span data-stu-id="efbde-175">The **xlAddInManagerInfo12** function should return an **XLOPER12** data type, whereas the **xlAddInManagerInfo** function should return an **XLOPER** data type.</span></span> 
  
### <a name="xlautoregisterxlautoregister12"></a><span data-ttu-id="efbde-176">xlAutoRegister/xlAutoRegister12</span><span class="sxs-lookup"><span data-stu-id="efbde-176">xlAutoRegister/xlAutoRegister12</span></span>

<span data-ttu-id="efbde-177">Excel appelle la fonction [xlAutoRegister](xlautoregister-xlautoregister12.md) chaque fois qu’un appel a été effectué pour la fonction XLM **inscrire**ou la fonction équivalente [xlfRegister](xlfregister-form-1.md) API C, avec le retour et types d’arguments manquante pour la fonction en cours d’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="efbde-177">Excel calls the [xlAutoRegister](xlautoregister-xlautoregister12.md) function whenever a call has been made to the XLM function **REGISTER**, or the C API equivalent [xlfRegister](xlfregister-form-1.md) function, with the return and argument types missing for the function being registered.</span></span> <span data-ttu-id="efbde-178">La fonction **xlAutoRegister** permet la ressource XLL à rechercher ses listes internes de fonctions exportées et commandes pour enregistrer la fonction avec l’argument et renvoyer les types spécifiés.</span><span class="sxs-lookup"><span data-stu-id="efbde-178">The **xlAutoRegister** function allows the XLL to search its internal lists of exported functions and commands to register the function with the argument and return the specified types.</span></span> 
  
<span data-ttu-id="efbde-179">À compter d’Excel 2007, Excel appelle la fonction **xlAddInRegister12** plutôt que la fonction **xlAddInRegister** , si elle est exportée par la ressource XLL.</span><span class="sxs-lookup"><span data-stu-id="efbde-179">Starting in Excel 2007, Excel calls the **xlAddInRegister12** function in preference to the **xlAddInRegister** function if it is exported by the XLL.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="efbde-180">Si **xlAddInRegister**/ **xlAddInRegister12** tente d’inscrire la fonction sans fournir l’argument et retournent des types, une récursive appelant boucle se produit et finalement de dépassement de la pile des appels et obliger Excel à fermer ou arrêter répondre.</span><span class="sxs-lookup"><span data-stu-id="efbde-180">If **xlAddInRegister**/ **xlAddInRegister12** tries to register the function without supplying the argument and return types, a recursive calling loop occurs that eventually overflows the call stack and causes Excel to close or stop responding.</span></span> 
  
### <a name="xlautofreexlautofree12"></a><span data-ttu-id="efbde-181">xlAutoFree/xlAutoFree12</span><span class="sxs-lookup"><span data-stu-id="efbde-181">xlAutoFree/xlAutoFree12</span></span>

<span data-ttu-id="efbde-182">Excel appelle la fonction [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) juste après qu’une fonction de feuille de calcul XLL renvoie un **XLOPER**/ des types de données**XLOPER12** avec un indicateur qui indique à Excel de mémoire que la XLL doit toujours libérer.</span><span class="sxs-lookup"><span data-stu-id="efbde-182">Excel calls the [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) function just after an XLL worksheet function returns an **XLOPER**/ **XLOPER12** data type with a flag set that tells Excel there is memory that the XLL still needs to release.</span></span> <span data-ttu-id="efbde-183">Cela permet à la ressource XLL à renvoyer allouées dynamiquement des tableaux, des chaînes et des références externes de la feuille de calcul sans fuites de mémoire.</span><span class="sxs-lookup"><span data-stu-id="efbde-183">This enables the XLL to return dynamically allocated arrays, strings, and external references to the worksheet without memory leaks.</span></span> <span data-ttu-id="efbde-184">À compter d’Excel 2007, le type de données **XLOPER12** est pris en charge.</span><span class="sxs-lookup"><span data-stu-id="efbde-184">Starting in Excel 2007, the **XLOPER12** data type is supported.</span></span> <span data-ttu-id="efbde-185">Pour plus d�informations, voir [Gestion de la m�moire dans Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="efbde-185">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="efbde-186">À compter d’Excel 2007, lorsque Excel est configuré pour utiliser le recalcul de la feuille de calcul multithread, le **xlAutoFree**/ fonction**xlAutoFree12** est appelée sur le même thread qui a été utilisé seulement pour appeler la fonction qui a renvoyé.</span><span class="sxs-lookup"><span data-stu-id="efbde-186">Starting in Excel 2007, when Excel is configured to use multithreaded worksheet recalculation, the **xlAutoFree**/ **xlAutoFree12** function is called on the same thread that was just used to call the function that returned it.</span></span> <span data-ttu-id="efbde-187">L’appel à **xlAutoFree**/ **xlAutoFree12** est toujours effectuées avant l’évaluation des cellules de la feuille de calcul suivantes sur ce thread.</span><span class="sxs-lookup"><span data-stu-id="efbde-187">The call to **xlAutoFree**/ **xlAutoFree12** is always made before any subsequent worksheet cells are evaluated on that thread.</span></span> <span data-ttu-id="efbde-188">Cela simplifie la création de thread-safe dans votre XLL.</span><span class="sxs-lookup"><span data-stu-id="efbde-188">This simplifies thread-safe design in your XLL.</span></span> <span data-ttu-id="efbde-189">Pour plus d’informations, voir [Multithread le recalcul dans Excel](multithreaded-recalculation-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="efbde-189">For more information, see [Multithreaded Recalculation in Excel](multithreaded-recalculation-in-excel.md).</span></span> 
  
### <a name="creating-64-bit-xlls"></a><span data-ttu-id="efbde-190">Création de XLL 64 bits</span><span class="sxs-lookup"><span data-stu-id="efbde-190">Creating 64-bit XLLs</span></span>

<span data-ttu-id="efbde-191">Excel et les fonctions définies par l’utilisateur peuvent exécuter sur les systèmes d’exploitation 64 bits pour tirer parti des avantages de performances sur les systèmes d’exploitation 32 bits.</span><span class="sxs-lookup"><span data-stu-id="efbde-191">Excel and user-defined functions can run on 64-bit operating systems to take advantage of performance benefits over 32-bit operating systems.</span></span> <span data-ttu-id="efbde-192">Excel passe des valeurs dans des structures **XLOPER12** qui incluent des informations sur les types de données.</span><span class="sxs-lookup"><span data-stu-id="efbde-192">Excel passes values in **XLOPER12** structures that include information about the types for the data.</span></span> <span data-ttu-id="efbde-193">Soyez prudent lors de la conversion entre types natifs comme **int** ou pointeurs pour conserver les valeurs du type supérieure et les valeurs dans la structure **XLOPER12** .</span><span class="sxs-lookup"><span data-stu-id="efbde-193">Be careful when you convert between values in the **XLOPER12** structure and native types like **int** or pointers to preserve the values in the larger type.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="efbde-194">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="efbde-194">See also</span></span>



[<span data-ttu-id="efbde-195">Appel des fonctions XLL à partir de l’Assistant fonction ou remplacer des boîtes de dialogue</span><span class="sxs-lookup"><span data-stu-id="efbde-195">Call XLL Functions from the Function Wizard or Replace Dialog Boxes</span></span>](how-to-call-xll-functions-from-the-function-wizard-or-replace-dialog-boxes.md)
  
[<span data-ttu-id="efbde-196">Gestionnaire de compléments et les fonctions de l’Interface XLL</span><span class="sxs-lookup"><span data-stu-id="efbde-196">Add-in Manager and XLL Interface Functions</span></span>](add-in-manager-and-xll-interface-functions.md)
  
[<span data-ttu-id="efbde-197">D�veloppement de XLL de Excel 2013</span><span class="sxs-lookup"><span data-stu-id="efbde-197">Developing Excel XLLs</span></span>](developing-excel-xlls.md)

